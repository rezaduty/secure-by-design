<!doctype html><html><head><title>Content-Reza</title><base href="../"><meta id="root-path" root-path="../"><link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><style>.markdown-preview-view .heading-collapse-indicator{margin-left:calc(0px - var(--collapse-arrow-size) - 10px)!important;padding:0 0!important}.node-insert-event{animation-duration:unset!important;animation-name:none!important}h1,h2,h3,h4,h5,h6{margin-top:0!important}hr{border:none;border-top:var(--hr-thickness) solid;border-color:var(--hr-color)}@media print{html body>:not(.print){display:unset!important}.collapse-indicator{display:none!important}.is-collapsed>element>.collapse-indicator{display:unset!important}}.list-collapse-indicator{display:none!important}.collapse-icon::before{content:"â€‹"!important;visibility:hidden!important}.mod-header{display:none!important}.markdown-embed .markdown-embed-content .markdown-preview-sizer{padding-left:1em!important}.markdown-embed .embed-title.markdown-embed-title{display:none}.markdown-embed-link{display:none!important}.canvas-card-menu{display:none;cursor:default!important}.canvas-controls{display:none;cursor:default!important}.canvas-background{pointer-events:visible!important;cursor:grab!important}.canvas-background:active{cursor:grabbing!important}.canvas-node-connection-point{display:none;cursor:default!important}.canvas-node-content{backface-visibility:visible!important}.canvas-menu-container{display:none}.canvas-node-content-blocker{cursor:pointer!important}.canvas-wrapper{position:relative;cursor:default!important}.canvas-node-resizer{cursor:default!important}.canvas-node-container{cursor:default!important}.markdown-rendered pre:not(:hover)>button.copy-code-button{display:unset;opacity:0}.markdown-rendered pre:hover>button.copy-code-button{opacity:1}.markdown-rendered pre button.copy-code-button{transition:opacity .2s ease-in-out,width .3s ease-in-out,background-color .2s ease-in-out;text-overflow:clip}.markdown-rendered pre>button.copy-code-button:hover{background-color:var(--interactive-normal)}.markdown-rendered pre>button.copy-code-button:active{background-color:var(--interactive-hover);box-shadow:var(--input-shadow);transition:none}@font-face{font-family:MJXZERO;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff")}@font-face{font-family:'Avenir Next';font-weight:400;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/94f2f163d4b698242fef.otf')}@font-face{font-family:Inter;font-style:normal;font-weight:200;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/72505e6a122c6acd5471.woff2') format('woff2')}@font-face{font-family:Inter;font-style:normal;font-weight:300;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/2d5198822ab091ce4305.woff2') format('woff2')}@font-face{font-family:Inter;font-weight:400;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/c8ba52b05a9ef10f4758.woff2')}@font-face{font-family:Inter;font-weight:400;font-style:italic;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/cb10ffd7684cd9836a05.woff2')}@font-face{font-family:Inter;font-weight:600;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/b5f0f109bc88052d4000.woff2')}@font-face{font-family:Inter;font-weight:800;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/cbe0ae49c52c920fd563.woff2')}@font-face{font-family:Inter;font-weight:800;font-style:italic;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/535a6cf662596b3bd6a6.woff2')}@font-face{font-family:'Source Code Pro';font-weight:400;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/70cc7ff27245e82ad414.ttf')}@font-face{font-family:'Source Code Pro';font-weight:400;font-style:italic;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/454577c22304619db035.ttf')}@font-face{font-family:'Source Code Pro';font-weight:700;font-style:normal;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/52ac8f3034507f1d9e53.ttf')}@font-face{font-family:'Source Code Pro';font-weight:700;font-style:italic;font-display:swap;src:url('https://publish.obsidian.md/public/fonts/05b618077343fbbd92b7.ttf')}@font-face{font-family:'Flow Circular';font-display:swap;src:url('https://publish.obsidian.md/public/fonts/853ff76f08786ae44ca0.woff')}.dialog{--dialog-bg-color:white;--dialog-border-color:white;--dialog-shadow:0 2px 14px 0 rgba(58, 57, 68, 0.2);--text-primary-color:#15141a;--text-secondary-color:#5b5b66;--hover-filter:brightness(0.9);--focus-ring-color:#0060df;--focus-ring-outline:2px solid var(--focus-ring-color);--link-fg-color:#0060df;--link-hover-fg-color:#0250bb;--separator-color:#f0f0f4;--textarea-border-color:#8f8f9d;--textarea-bg-color:white;--textarea-fg-color:var(--text-secondary-color);--radio-bg-color:#f0f0f4;--radio-checked-bg-color:#fbfbfe;--radio-border-color:#8f8f9d;--radio-checked-border-color:#0060df;--button-secondary-bg-color:#f0f0f4;--button-secondary-fg-color:var(--text-primary-color);--button-secondary-border-color:var(--button-secondary-bg-color);--button-secondary-hover-bg-color:var(--button-secondary-bg-color);--button-secondary-hover-fg-color:var(--button-secondary-fg-color);--button-secondary-hover-border-color:var(--button-secondary-hover-bg-color);--button-primary-bg-color:#0060df;--button-primary-fg-color:#fbfbfe;--button-primary-border-color:var(--button-primary-bg-color);--button-primary-hover-bg-color:var(--button-primary-bg-color);--button-primary-hover-fg-color:var(--button-primary-fg-color);--button-primary-hover-border-color:var(--button-primary-hover-bg-color);font-variant:normal;font-size:13px;font-weight:400;line-height:150%;border-radius:4px;padding:12px 16px;border:1px solid var(--dialog-border-color);background:var(--dialog-bg-color);color:var(--text-primary-color);box-shadow:var(--dialog-shadow)}.dialog .mainContainer :focus-visible{outline:var(--focus-ring-outline);outline-offset:2px}.dialog .mainContainer .title{display:flex;width:auto;flex-direction:column;justify-content:flex-end;align-items:flex-start;gap:12px}.dialog .mainContainer .title>span{font-size:13px;font-style:normal;font-weight:590;line-height:150%}.dialog .mainContainer .dialogSeparator{width:100%;height:0;margin-top:4px;margin-bottom:4px;border-top:1px solid var(--separator-color);border-bottom:none}.dialog .mainContainer .dialogButtonsGroup{display:flex;gap:12px;align-self:flex-end}.dialog .mainContainer .radio{display:flex;flex-direction:column;align-items:flex-start;gap:4px}.dialog .mainContainer .radio>.radioButton{display:flex;gap:8px;align-self:stretch;align-items:center}.dialog .mainContainer .radio>.radioButton input{appearance:none;box-sizing:border-box;width:16px;height:16px;border-radius:50%;background-color:var(--radio-bg-color);border:1px solid var(--radio-border-color)}.dialog .mainContainer .radio>.radioButton input:hover{filter:var(--hover-filter)}.dialog .mainContainer .radio>.radioButton input:checked{background-color:var(--radio-checked-bg-color);border:4px solid var(--radio-checked-border-color)}.dialog .mainContainer .radio>.radioLabel{display:flex;padding-left:24px;align-items:flex-start;gap:10px;align-self:stretch}.dialog .mainContainer .radio>.radioLabel>span{flex:1 0 0px;font-size:11px;color:var(--text-secondary-color)}.dialog .mainContainer button:not(.toggle-button):not(.closeButton){border-radius:4px;border:1px solid;font-variant:normal;font-weight:600;padding:4px 16px;width:auto;height:32px}.dialog .mainContainer button:not(.toggle-button):not(.closeButton):hover{cursor:pointer;filter:var(--hover-filter)}.dialog .mainContainer button.secondaryButton:not(.toggle-button):not(.closeButton){color:var(--button-secondary-fg-color);background-color:var(--button-secondary-bg-color);border-color:var(--button-secondary-border-color)}.dialog .mainContainer button.secondaryButton:not(.toggle-button):not(.closeButton):hover{color:var(--button-secondary-hover-fg-color);background-color:var(--button-secondary-hover-bg-color);border-color:var(--button-secondary-hover-border-color)}.dialog .mainContainer button.primaryButton:not(.toggle-button):not(.closeButton){color:var(--button-primary-fg-color);background-color:var(--button-primary-bg-color);border-color:var(--button-primary-border-color);opacity:1}.dialog .mainContainer button.primaryButton:not(.toggle-button):not(.closeButton):hover{color:var(--button-primary-hover-fg-color);background-color:var(--button-primary-hover-bg-color);border-color:var(--button-primary-hover-border-color)}.dialog .mainContainer a{color:var(--link-fg-color)}.dialog .mainContainer a:hover{color:var(--link-hover-fg-color)}.dialog .mainContainer textarea{font:inherit;padding:8px;resize:none;margin:0;box-sizing:border-box;border-radius:4px;border:1px solid var(--textarea-border-color);background:var(--textarea-bg-color);color:var(--textarea-fg-color)}.dialog .mainContainer textarea:focus{outline-offset:0px;border-color:transparent}.dialog .mainContainer textarea:disabled{pointer-events:none;opacity:.4}.dialog .mainContainer .toggler{display:flex;align-items:center;gap:8px;align-self:stretch}.dialog .mainContainer .toggler>.togglerLabel{user-select:none}:root{--xfa-unfocused-field-background:url("data:image/svg+xml;charset=UTF-8,<svg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'><rect width='100%' height='100%' style='fill:rgba(0, 54, 255, 0.13);'/></svg>");--xfa-focus-outline:auto}:root{--viewer-container-height:0;--pdfViewer-padding-bottom:0;--page-margin:1px auto -8px;--page-border:9px solid transparent;--spreadHorizontalWrapped-margin-LR:-3.5px;--loading-icon-delay:400ms}[data-main-rotation="90"]{transform:rotate(90deg) translateY(-100%)}[data-main-rotation="180"]{transform:rotate(180deg) translate(-100%,-100%)}[data-main-rotation="270"]{transform:rotate(270deg) translateX(-100%)}.hiddenCanvasElement,.hiddenCopyElement{position:absolute;top:0;left:0;width:0;height:0;display:none}body{--anim-duration-none:0;--anim-duration-superfast:70ms;--anim-duration-fast:140ms;--anim-duration-moderate:300ms;--anim-duration-slow:560ms;--anim-motion-smooth:cubic-bezier(0.45, 0.05, 0.55, 0.95);--anim-motion-delay:cubic-bezier(0.65, 0.05, 0.36, 1);--anim-motion-jumpy:cubic-bezier(0.68, -0.55, 0.27, 1.55);--anim-motion-swing:cubic-bezier(0, 0.55, 0.45, 1);--blockquote-border-thickness:2px;--blockquote-border-color:var(--interactive-accent);--blockquote-font-style:normal;--blockquote-color:inherit;--blockquote-background-color:transparent;--bold-modifier:200;--bold-color:inherit;--bold-weight:calc(var(--font-weight) + var(--bold-modifier));--border-width:1px;--button-radius:var(--input-radius);--callout-border-width:0px;--callout-border-opacity:0.25;--callout-padding:var(--size-4-3) var(--size-4-3) var(--size-4-3) var(--size-4-6);--callout-radius:var(--radius-s);--callout-blend-mode:var(--highlight-mix-blend-mode);--callout-title-color:inherit;--callout-title-padding:0;--callout-title-size:inherit;--callout-title-weight:calc(var(--font-weight) + var(--bold-modifier));--callout-content-padding:0;--callout-content-background:transparent;--callout-bug:var(--color-red-rgb);--callout-default:var(--color-blue-rgb);--callout-error:var(--color-red-rgb);--callout-example:var(--color-purple-rgb);--callout-fail:var(--color-red-rgb);--callout-important:var(--color-cyan-rgb);--callout-info:var(--color-blue-rgb);--callout-question:var(--color-orange-rgb);--callout-success:var(--color-green-rgb);--callout-summary:var(--color-cyan-rgb);--callout-tip:var(--color-cyan-rgb);--callout-todo:var(--color-blue-rgb);--callout-warning:var(--color-orange-rgb);--callout-quote:158,158,158;--canvas-background:var(--background-primary);--canvas-card-label-color:var(--text-faint);--canvas-color-1:var(--color-red-rgb);--canvas-color-2:var(--color-orange-rgb);--canvas-color-3:var(--color-yellow-rgb);--canvas-color-4:var(--color-green-rgb);--canvas-color-5:var(--color-cyan-rgb);--canvas-color-6:var(--color-purple-rgb);--canvas-dot-pattern:var(--color-base-30);--caret-color:var(--text-normal);--checkbox-radius:var(--radius-s);--checkbox-size:var(--font-text-size);--checkbox-marker-color:var(--background-primary);--checkbox-color:var(--interactive-accent);--checkbox-color-hover:var(--interactive-accent-hover);--checkbox-border-color:var(--text-faint);--checkbox-border-color-hover:var(--text-muted);--checkbox-margin-inline-start:0.85em;--checklist-done-decoration:line-through;--checklist-done-color:var(--text-muted);--code-white-space:pre-wrap;--code-border-width:0px;--code-border-color:var(--background-modifier-border);--code-radius:var(--radius-s);--code-size:var(--font-smaller);--code-background:var(--background-primary-alt);--code-normal:var(--text-normal);--code-comment:var(--text-faint);--code-function:var(--color-yellow);--code-important:var(--color-orange);--code-keyword:var(--color-pink);--code-operator:var(--color-red);--code-property:var(--color-cyan);--code-punctuation:var(--text-muted);--code-string:var(--color-green);--code-tag:var(--color-red);--code-value:var(--color-purple);--collapse-icon-color:var(--text-faint);--collapse-icon-color-collapsed:var(--text-accent);--cursor:default;--cursor-link:pointer;--dialog-width:560px;--dialog-max-width:80vw;--dialog-max-height:85vh;--divider-color:var(--background-modifier-border);--divider-color-hover:var(--interactive-accent);--divider-width:1px;--divider-width-hover:3px;--divider-vertical-height:calc(100% - var(--header-height));--drag-ghost-background:rgba(0, 0, 0, 0.85);--drag-ghost-text-color:#fff;--dropdown-background:var(--interactive-normal);--dropdown-background-blend-mode:hard-light;--dropdown-background-hover:var(--interactive-hover);--dropdown-background-position:right 0.5em top 50%,0 0;--dropdown-background-size:1em auto,100%;--dropdown-padding:0 1.9em 0 0.8em;--embed-max-height:4000px;--embed-canvas-max-height:400px;--embed-background:inherit;--embed-border-start:2px solid var(--interactive-accent);--embed-border-end:none;--embed-border-top:none;--embed-border-bottom:none;--embed-padding:0 0 0 var(--size-4-6);--embed-font-style:inherit;--embed-block-shadow-hover:0 0 0 1px var(--background-modifier-border),inset 0 0 0 1px var(--background-modifier-border);--file-line-width:700px;--file-folding-offset:24px;--file-margins:var(--size-4-8);--file-header-font:var(--font-interface);--file-header-font-size:var(--font-ui-small);--file-header-font-weight:400;--file-header-border:var(--border-width) solid transparent;--file-header-justify:center;--font-smallest:0.8em;--font-smaller:0.875em;--font-small:0.933em;--font-ui-smaller:12px;--font-ui-small:13px;--font-ui-medium:15px;--font-ui-large:20px;--font-weight:var(--font-normal);--font-thin:100;--font-extralight:200;--font-light:300;--font-normal:400;--font-medium:500;--font-semibold:600;--font-bold:700;--font-extrabold:800;--font-black:900;--footnote-size:var(--font-smaller);--graph-controls-width:240px;--graph-text:var(--text-normal);--graph-line:var(--color-base-35, var(--background-modifier-border-focus));--graph-node:var(--text-muted);--graph-node-unresolved:var(--text-faint);--graph-node-focused:var(--text-accent);--graph-node-tag:var(--color-green);--graph-node-attachment:var(--color-yellow);--heading-formatting:var(--text-faint);--heading-spacing:calc(var(--p-spacing) * 2.5);--h1-color:inherit;--h2-color:inherit;--h3-color:inherit;--h4-color:inherit;--h5-color:inherit;--h6-color:inherit;--h1-font:inherit;--h2-font:inherit;--h3-font:inherit;--h4-font:inherit;--h5-font:inherit;--h6-font:inherit;--h1-line-height:1.2;--h2-line-height:1.2;--h3-line-height:1.3;--h4-line-height:1.4;--h5-line-height:var(--line-height-normal);--h6-line-height:var(--line-height-normal);--h1-size:1.802em;--h2-size:1.602em;--h3-size:1.424em;--h4-size:1.266em;--h5-size:1.125em;--h6-size:1em;--h1-style:normal;--h2-style:normal;--h3-style:normal;--h4-style:normal;--h5-style:normal;--h6-style:normal;--h1-variant:normal;--h2-variant:normal;--h3-variant:normal;--h4-variant:normal;--h5-variant:normal;--h6-variant:normal;--h1-weight:700;--h2-weight:600;--h3-weight:600;--h4-weight:600;--h5-weight:600;--h6-weight:600;--header-height:40px;--hr-color:var(--background-modifier-border);--hr-thickness:2px;--icon-size:var(--icon-m);--icon-stroke:var(--icon-m-stroke-width);--icon-xs:14px;--icon-s:16px;--icon-m:18px;--icon-l:18px;--icon-xl:32px;--icon-xs-stroke-width:2px;--icon-s-stroke-width:2px;--icon-m-stroke-width:1.75px;--icon-l-stroke-width:1.75px;--icon-xl-stroke-width:1.25px;--icon-color:var(--text-muted);--icon-color-hover:var(--text-muted);--icon-color-active:var(--text-accent);--icon-color-focused:var(--text-normal);--icon-opacity:0.85;--icon-opacity-hover:1;--icon-opacity-active:1;--clickable-icon-radius:var(--radius-s);--indent-size:4;--indent-unit:0.5625em;--indentation-guide-width:1px;--indentation-guide-width-active:1px;--indentation-guide-color:rgba(var(--mono-rgb-100), 0.12);--indentation-guide-color-active:rgba(var(--mono-rgb-100), 0.3);--indentation-guide-editing-indent:0.85em;--indentation-guide-reading-indent:-0.85em;--indentation-guide-source-indent:0.25em;--inline-title-color:var(--h1-color);--inline-title-font:var(--h1-font);--inline-title-line-height:var(--h1-line-height);--inline-title-size:var(--h1-size);--inline-title-style:var(--h1-style);--inline-title-variant:var(--h1-variant);--inline-title-weight:var(--h1-weight);--inline-title-margin-bottom:0.5em;--input-height:30px;--input-radius:5px;--input-font-weight:var(--font-normal);--input-border-width:1px;--italic-color:inherit;--italic-weight:inherit;--layer-cover:5;--layer-sidedock:10;--layer-status-bar:15;--layer-popover:30;--layer-slides:45;--layer-modal:50;--layer-notice:60;--layer-menu:65;--layer-tooltip:70;--layer-dragged-item:80;--line-height-normal:1.5;--line-height-tight:1.3;--link-color:var(--text-accent);--link-color-hover:var(--text-accent-hover);--link-decoration:underline;--link-decoration-hover:underline;--link-decoration-thickness:auto;--link-weight:var(--font-weight);--link-external-color:var(--text-accent);--link-external-color-hover:var(--text-accent-hover);--link-external-decoration:underline;--link-external-decoration-hover:underline;--link-external-filter:none;--link-unresolved-color:var(--text-accent);--link-unresolved-opacity:0.7;--link-unresolved-filter:none;--link-unresolved-decoration-style:solid;--link-unresolved-decoration-color:hsla(var(--interactive-accent-hsl), 0.3);--list-indent:calc(var(--indent-unit) * var(--indent-size));--list-indent-editing:0.75em;--list-indent-source:0;--list-spacing:0.075em;--list-marker-color:var(--text-faint);--list-marker-color-hover:var(--text-muted);--list-marker-color-collapsed:var(--text-accent);--list-bullet-border:none;--list-bullet-radius:50%;--list-bullet-size:0.3em;--list-bullet-transform:none;--list-numbered-style:decimal;--list-bullet-end-padding:1.3rem;--nav-item-size:var(--font-ui-small);--nav-item-color:var(--text-muted);--nav-item-color-hover:var(--text-normal);--nav-item-color-active:var(--text-normal);--nav-item-color-selected:var(--text-normal);--nav-item-color-highlighted:var(--text-accent);--nav-item-background-hover:var(--background-modifier-hover);--nav-item-background-active:var(--background-modifier-hover);--nav-item-background-selected:hsla(var(--color-accent-hsl), 0.15);--nav-item-padding:var(--size-4-1) var(--size-4-2) var(--size-4-1) var(--size-4-6);--nav-item-parent-padding:var(--nav-item-padding);--nav-item-children-padding-start:var(--size-2-2);--nav-item-children-margin-start:var(--size-4-3);--nav-item-weight:inherit;--nav-item-weight-hover:inherit;--nav-item-weight-active:inherit;--nav-item-white-space:pre;--nav-indentation-guide-width:var(--indentation-guide-width);--nav-indentation-guide-color:var(--indentation-guide-color);--nav-collapse-icon-color:var(--collapse-icon-color);--nav-collapse-icon-color-collapsed:var(--text-faint);--nav-heading-color:var(--text-normal);--nav-heading-color-hover:var(--text-normal);--nav-heading-color-collapsed:var(--text-faint);--nav-heading-color-collapsed-hover:var(--text-muted);--nav-heading-weight:var(--font-medium);--nav-heading-weight-hover:var(--font-medium);--metadata-background:transparent;--metadata-display-reading:block;--metadata-display-editing:block;--metadata-max-width:none;--metadata-padding:var(--size-4-2) 0;--metadata-border-color:var(--background-modifier-border);--metadata-border-radius:0;--metadata-border-width:0;--metadata-divider-color:var(--background-modifier-border);--metadata-divider-color-hover:transparent;--metadata-divider-color-focus:transparent;--metadata-divider-width:0;--metadata-gap:3px;--metadata-property-padding:0;--metadata-property-radius:6px;--metadata-property-radius-hover:6px;--metadata-property-radius-focus:6px;--metadata-property-background:transparent;--metadata-property-background-hover:transparent;--metadata-property-background-active:var(--background-modifier-hover);--metadata-label-background:transparent;--metadata-label-background-hover:transparent;--metadata-label-background-active:var(--background-modifier-hover);--metadata-label-font:var(--font-interface);--metadata-label-font-size:var(--font-smaller);--metadata-label-font-weight:inherit;--metadata-label-text-color:var(--text-muted);--metadata-label-text-color-hover:var(--text-muted);--metadata-label-width:9em;--metadata-input-height:calc(var(--font-text-size) * 1.75);--metadata-input-text-color:var(--text-normal);--metadata-input-font:var(--font-interface);--metadata-input-font-size:var(--font-smaller);--metadata-input-background:transparent;--metadata-input-background-hover:transparent;--metadata-input-background-active:var(--background-modifier-hover);--metadata-sidebar-label-font-size:var(--font-ui-small);--metadata-sidebar-input-font-size:var(--font-ui-small);--modal-background:var(--background-primary);--modal-width:90vw;--modal-height:85vh;--modal-max-width:1100px;--modal-max-height:1000px;--modal-max-width-narrow:800px;--modal-border-width:var(--border-width);--modal-border-color:var(--color-base-40, var(--background-modifier-border-focus));--modal-radius:var(--radius-l);--modal-community-sidebar-width:280px;--pill-color:var(--text-muted);--pill-color-hover:var(--text-normal);--pill-color-remove:var(--text-faint);--pill-color-remove-hover:var(--text-accent);--pill-decoration:none;--pill-decoration-hover:none;--pill-background:transparent;--pill-background-hover:transparent;--pill-border-color:var(--background-modifier-border);--pill-border-color-hover:var(--background-modifier-border-hover);--pill-border-width:var(--border-width);--pill-padding-x:0.65em;--pill-padding-y:0.25em;--pill-radius:2em;--pill-weight:inherit;--p-spacing:1rem;--p-spacing-empty:0rem;--pdf-background:var(--background-primary);--pdf-page-background:var(--background-primary);--pdf-shadow:0 0 0 1px rgba(0, 0, 0, 0.05),0 2px 8px rgba(0, 0, 0, 0.1);--pdf-spread-shadow:0 0 0 1px rgba(0, 0, 0, 0.05);--pdf-sidebar-background:var(--background-primary);--pdf-thumbnail-shadow:0 0 0 1px rgba(0, 0, 0, 0.15),0 2px 8px rgba(0, 0, 0, 0.2);--popover-width:450px;--popover-height:400px;--popover-max-height:95vh;--popover-pdf-width:450px;--popover-pdf-height:400px;--popover-font-size:var(--font-text-size);--prompt-input-height:40px;--prompt-width:700px;--prompt-max-width:80vw;--prompt-max-height:70vh;--prompt-border-width:var(--border-width);--prompt-border-color:var(--color-base-40, var(--background-modifier-border-focus));--radius-s:4px;--radius-m:8px;--radius-l:12px;--radius-xl:16px;--ribbon-background:var(--background-secondary);--ribbon-background-collapsed:var(--background-primary);--ribbon-width:44px;--ribbon-padding:var(--size-4-2) var(--size-4-1) var(--size-4-3);--scrollbar-active-thumb-bg:rgba(var(--mono-rgb-100), 0.2);--scrollbar-bg:rgba(var(--mono-rgb-100), 0.05);--scrollbar-thumb-bg:rgba(var(--mono-rgb-100), 0.1);--search-clear-button-color:var(--text-muted);--search-clear-button-size:13px;--search-icon-color:var(--text-muted);--search-icon-size:18px;--search-result-background:var(--background-primary);--size-2-1:2px;--size-2-2:4px;--size-2-3:6px;--size-4-1:4px;--size-4-2:8px;--size-4-3:12px;--size-4-4:16px;--size-4-5:20px;--size-4-6:24px;--size-4-8:32px;--size-4-9:36px;--size-4-10:40px;--size-4-12:48px;--size-4-16:64px;--size-4-18:72px;--sidebar-markdown-font-size:calc(var(--font-text-size) * 0.9);--sidebar-tab-text-display:none;--slider-thumb-border-width:1px;--slider-thumb-border-color:var(--background-modifier-border-hover);--slider-thumb-height:18px;--slider-thumb-width:18px;--slider-thumb-y:-6px;--slider-thumb-radius:50%;--slider-s-thumb-size:15px;--slider-s-thumb-position:-5px;--slider-track-background:var(--background-modifier-border);--slider-track-height:3px;--status-bar-background:var(--background-secondary);--status-bar-border-color:var(--divider-color);--status-bar-border-width:1px 0 0 1px;--status-bar-font-size:var(--font-ui-smaller);--status-bar-text-color:var(--text-muted);--status-bar-position:fixed;--status-bar-radius:var(--radius-m) 0 0 0;--status-bar-scroll-padding:calc(var(--status-bar-font-size) + 18px);--sync-avatar-color-current-user:transparent;--sync-avatar-color-1:var(--color-red);--sync-avatar-color-2:var(--color-orange);--sync-avatar-color-3:var(--color-yellow);--sync-avatar-color-4:var(--color-green);--sync-avatar-color-5:var(--color-cyan);--sync-avatar-color-6:var(--color-blue);--sync-avatar-color-7:var(--color-purple);--sync-avatar-color-8:var(--color-pink);--swatch-radius:14px;--swatch-height:24px;--swatch-width:24px;--swatch-shadow:inset 0 0 0 1px rgba(var(--mono-rgb-100), 0.15);--tab-background-active:var(--background-primary);--tab-text-color:var(--text-faint);--tab-text-color-active:var(--text-muted);--tab-text-color-focused:var(--text-muted);--tab-text-color-focused-active:var(--text-muted);--tab-text-color-focused-highlighted:var(--text-accent);--tab-text-color-focused-active-current:var(--text-normal);--tab-font-size:var(--font-ui-small);--tab-font-weight:inherit;--tab-container-background:var(--background-secondary);--tab-divider-color:var(--background-modifier-border-hover);--tab-outline-color:var(--divider-color);--tab-outline-width:1px;--tab-curve:6px;--tab-radius:var(--radius-s);--tab-radius-active:6px 6px 0 0;--tab-width:200px;--tab-max-width:320px;--tab-switcher-menubar-background:var(--mobile-sidebar-background);--tab-switcher-background:var(--background-secondary);--tab-switcher-preview-radius:var(--radius-xl);--tab-switcher-preview-background-shadow:0 4px 30px 2px rgba(0, 0, 0, 0.2);--tab-switcher-preview-shadow:0 0 0 1px rgba(var(--mono-rgb-100), 0.05);--tab-switcher-preview-shadow-active:0 0 0 2px var(--color-accent);--tab-stacked-pane-width:700px;--tab-stacked-header-width:var(--header-height);--tab-stacked-font-size:var(--font-ui-small);--tab-stacked-font-weight:400;--tab-stacked-text-align:start;--tab-stacked-text-transform:rotate(0deg);--tab-stacked-text-writing-mode:vertical-lr;--tab-stacked-shadow:-8px 0 8px 0 rgba(0, 0, 0, 0.05);--table-background:transparent;--table-border-width:1px;--table-border-color:var(--background-modifier-border);--table-white-space:break-spaces;--table-header-background:var(--table-background);--table-header-background-hover:inherit;--table-header-border-width:var(--table-border-width);--table-header-border-color:var(--table-border-color);--table-header-font:inherit;--table-header-size:var(--table-text-size);--table-header-weight:calc(var(--font-weight) + var(--bold-modifier));--table-header-color:var(--text-normal);--table-line-height:var(--line-height-tight);--table-text-size:var(--font-text-size);--table-text-color:inherit;--table-column-min-width:6ch;--table-column-max-width:none;--table-column-alt-background:var(--table-background);--table-column-first-border-width:var(--table-border-width);--table-column-last-border-width:var(--table-border-width);--table-row-background-hover:var(--table-background);--table-row-alt-background:var(--table-background);--table-row-alt-background-hover:var(--table-background);--table-row-last-border-width:var(--table-border-width);--table-selection:hsla(var(--color-accent-hsl), 0.1);--table-selection-blend-mode:var(--highlight-mix-blend-mode);--table-selection-border-color:var(--interactive-accent);--table-selection-border-width:2px;--table-selection-border-radius:4px;--table-cell-vertical-alignment:top;--table-drag-handle-background:transparent;--table-drag-handle-background-active:var(--table-selection-border-color);--table-drag-handle-color:var(--text-faint);--table-drag-handle-color-active:var(--text-on-accent);--table-add-button-background:transparent;--table-add-button-border-width:var(--table-border-width);--table-add-button-border-color:var(--background-modifier-border);--tag-size:var(--font-smaller);--tag-color:var(--text-accent);--tag-color-hover:var(--text-accent);--tag-decoration:none;--tag-decoration-hover:none;--tag-background:hsla(var(--interactive-accent-hsl), 0.1);--tag-background-hover:hsla(var(--interactive-accent-hsl), 0.2);--tag-border-color:hsla(var(--interactive-accent-hsl), 0.15);--tag-border-color-hover:hsla(var(--interactive-accent-hsl), 0.15);--tag-border-width:0px;--tag-padding-x:0.65em;--tag-padding-y:0.25em;--tag-radius:2em;--tag-weight:inherit;--titlebar-background:var(--background-secondary);--titlebar-background-focused:var(--background-secondary-alt);--titlebar-border-width:0px;--titlebar-border-color:var(--background-modifier-border);--titlebar-text-color:var(--text-muted);--titlebar-text-color-focused:var(--text-normal);--titlebar-text-weight:var(--font-bold);--toggle-border-width:2px;--toggle-width:40px;--toggle-radius:18px;--toggle-thumb-color:white;--toggle-thumb-radius:18px;--toggle-thumb-height:18px;--toggle-thumb-width:18px;--toggle-s-border-width:2px;--toggle-s-width:34px;--toggle-s-thumb-height:15px;--toggle-s-thumb-width:15px;--vault-profile-display:flex;--vault-profile-actions-display:flex;--vault-profile-font-size:var(--font-ui-small);--vault-profile-font-weight:var(--font-medium);--vault-profile-color:var(--text-normal);--vault-profile-color-hover:var(--vault-profile-color);--workspace-background-translucent:rgba(var(--mono-rgb-0), 0.6);--accent-h:258;--accent-s:88%;--accent-l:66%;--background-primary:var(--color-base-00);--background-primary-alt:var(--color-base-10);--background-secondary:var(--color-base-20);--background-modifier-hover:rgba(var(--mono-rgb-100), 0.075);--background-modifier-active-hover:hsla(var(--interactive-accent-hsl), 0.15);--background-modifier-border:var(--color-base-30);--background-modifier-border-hover:var(--color-base-35);--background-modifier-border-focus:var(--color-base-40);--background-modifier-error-rgb:var(--color-red-rgb);--background-modifier-error:var(--color-red);--background-modifier-error-hover:var(--color-red);--background-modifier-success-rgb:var(--color-green-rgb);--background-modifier-success:var(--color-green);--background-modifier-message:rgba(0, 0, 0, 0.9);--background-modifier-form-field:var(--color-base-00);--text-normal:var(--color-base-100);--text-muted:var(--color-base-70);--text-faint:var(--color-base-50);--text-on-accent:white;--text-on-accent-inverted:black;--text-error:var(--color-red);--text-warning:var(--color-orange);--text-success:var(--color-green);--text-selection:hsla(var(--color-accent-hsl), 0.2);--text-highlight-bg-rgb:255,208,0;--text-highlight-bg:rgba(var(--text-highlight-bg-rgb), 0.4);--text-accent:var(--color-accent);--text-accent-hover:var(--color-accent-2);--interactive-normal:var(--color-base-00);--interactive-hover:var(--color-base-10);--interactive-accent-hsl:var(--color-accent-hsl);--interactive-accent:var(--color-accent-1);--interactive-accent-hover:var(--color-accent-2)}.theme-light{color-scheme:light;--highlight-mix-blend-mode:darken;--mono-rgb-0:255,255,255;--mono-rgb-100:0,0,0;--color-red-rgb:233,49,71;--color-red:#e93147;--color-orange-rgb:236,117,0;--color-orange:#ec7500;--color-yellow-rgb:224,172,0;--color-yellow:#e0ac00;--color-green-rgb:8,185,78;--color-green:#08b94e;--color-cyan-rgb:0,191,188;--color-cyan:#00bfbc;--color-blue-rgb:8,109,221;--color-blue:#086ddd;--color-purple-rgb:120,82,238;--color-purple:#7852ee;--color-pink-rgb:213,57,132;--color-pink:#d53984;--color-base-00:#ffffff;--color-base-05:#fcfcfc;--color-base-10:#fafafa;--color-base-20:#f6f6f6;--color-base-25:#e3e3e3;--color-base-30:#e0e0e0;--color-base-35:#d4d4d4;--color-base-40:#bdbdbd;--color-base-50:#ababab;--color-base-60:#707070;--color-base-70:#5c5c5c;--color-base-100:#222222;--color-accent-hsl:var(--accent-h),var(--accent-s),var(--accent-l);--color-accent:hsl(var(--accent-h), var(--accent-s), var(--accent-l));--color-accent-1:hsl(calc(var(--accent-h) - 1), calc(var(--accent-s) * 1.01), calc(var(--accent-l) * 1.075));--color-accent-2:hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.15));--background-secondary-alt:var(--color-base-05);--background-modifier-box-shadow:rgba(0, 0, 0, 0.1);--background-modifier-cover:rgba(220, 220, 220, 0.4);--input-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.12),0 2px 3px 0 rgba(0,0,0,.05),0 1px 1.5px 0 rgba(0,0,0,.03),0 1px 2px 0 rgba(0,0,0,.04),0 0 0 0 transparent;--input-shadow-hover:inset 0 0 0 1px rgba(0, 0, 0, 0.17),0 2px 3px 0 rgba(0,0,0,.1),0 1px 1.5px 0 rgba(0,0,0,.03),0 1px 2px 0 rgba(0,0,0,.04),0 0 0 0 transparent;--shadow-s:0px 1px 2px rgba(0, 0, 0, 0.028),0px 3.4px 6.7px rgba(0, 0, 0, .042),0px 15px 30px rgba(0, 0, 0, .07);--shadow-l:0px 1.8px 7.3px rgba(0, 0, 0, 0.071),0px 6.3px 24.7px rgba(0, 0, 0, 0.112),0px 30px 90px rgba(0, 0, 0, 0.2)}.theme-dark{color-scheme:dark;--highlight-mix-blend-mode:lighten;--mono-rgb-0:0,0,0;--mono-rgb-100:255,255,255;--color-red-rgb:251,70,76;--color-red:#fb464c;--color-orange-rgb:233,151,63;--color-orange:#e9973f;--color-yellow-rgb:224,222,113;--color-yellow:#e0de71;--color-green-rgb:68,207,110;--color-green:#44cf6e;--color-cyan-rgb:83,223,221;--color-cyan:#53dfdd;--color-blue-rgb:2,122,255;--color-blue:#027aff;--color-purple-rgb:168,130,255;--color-purple:#a882ff;--color-pink-rgb:250,153,205;--color-pink:#fa99cd;--color-base-00:#1e1e1e;--color-base-05:#212121;--color-base-10:#242424;--color-base-20:#262626;--color-base-25:#2a2a2a;--color-base-30:#363636;--color-base-35:#3f3f3f;--color-base-40:#555555;--color-base-50:#666666;--color-base-60:#999999;--color-base-70:#b3b3b3;--color-base-100:#dadada;--color-accent-hsl:var(--accent-h),var(--accent-s),var(--accent-l);--color-accent:hsl(var(--accent-h), var(--accent-s), var(--accent-l));--color-accent-1:hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.15));--color-accent-2:hsl(calc(var(--accent-h) - 5), calc(var(--accent-s) * 1.05), calc(var(--accent-l) * 1.29));--background-modifier-form-field:var(--color-base-25);--background-secondary-alt:var(--color-base-30);--interactive-normal:var(--color-base-30);--interactive-hover:var(--color-base-35);--text-accent:var(--color-accent-1);--interactive-accent:var(--color-accent);--interactive-accent-hover:var(--color-accent-1);--background-modifier-box-shadow:rgba(0, 0, 0, 0.3);--background-modifier-cover:rgba(10, 10, 10, 0.4);--text-selection:hsla(var(--interactive-accent-hsl), 0.25);--input-shadow:inset 0 0.5px 0.5px 0.5px rgba(255, 255, 255, 0.09),0 2px 4px 0 rgba(0,0,0,.15),0 1px 1.5px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.2),0 0 0 0 transparent;--input-shadow-hover:inset 0 0.5px 1px 0.5px rgba(255, 255, 255, 0.16),0 2px 3px 0 rgba(0,0,0,.3),0 1px 1.5px 0 rgba(0,0,0,.2),0 1px 2px 0 rgba(0,0,0,.4),0 0 0 0 transparent;--shadow-s:0px 1px 2px rgba(0, 0, 0, 0.121),0px 3.4px 6.7px rgba(0, 0, 0, 0.179),0px 15px 30px rgba(0, 0, 0, 0.3);--shadow-l:0px 1.8px 7.3px rgba(0, 0, 0, 0.071),0px 6.3px 24.7px rgba(0, 0, 0, 0.112),0px 30px 90px rgba(0, 0, 0, 0.2);--pdf-shadow:0 0 0 1px var(--background-modifier-border);--pdf-thumbnail-shadow:0 0 0 1px var(--background-modifier-border)}iframe{color-scheme:normal}@font-face{font-family:"Avenir Next";font-weight:400;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/94f2f163d4b698242fef.otf")}@font-face{font-family:Inter;font-style:normal;font-weight:200;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/72505e6a122c6acd5471.woff2") format("woff2")}@font-face{font-family:Inter;font-style:normal;font-weight:300;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/2d5198822ab091ce4305.woff2") format("woff2")}@font-face{font-family:Inter;font-weight:400;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/c8ba52b05a9ef10f4758.woff2")}@font-face{font-family:Inter;font-weight:400;font-style:italic;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/cb10ffd7684cd9836a05.woff2")}@font-face{font-family:Inter;font-weight:600;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/b5f0f109bc88052d4000.woff2")}@font-face{font-family:Inter;font-weight:800;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/cbe0ae49c52c920fd563.woff2")}@font-face{font-family:Inter;font-weight:800;font-style:italic;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/535a6cf662596b3bd6a6.woff2")}@font-face{font-family:"Source Code Pro";font-weight:400;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/70cc7ff27245e82ad414.ttf")}@font-face{font-family:"Source Code Pro";font-weight:400;font-style:italic;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/454577c22304619db035.ttf")}@font-face{font-family:"Source Code Pro";font-weight:700;font-style:normal;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/52ac8f3034507f1d9e53.ttf")}@font-face{font-family:"Source Code Pro";font-weight:700;font-style:italic;font-display:swap;src:url("https://publish.obsidian.md/public/fonts/05b618077343fbbd92b7.ttf")}@font-face{font-family:"Flow Circular";font-display:swap;src:url("https://publish.obsidian.md/public/fonts/4bb6ac751d1c5478ff3a.woff2")}@font-face{font-family:"??";unicode-range:U+0}body{--font-default:ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Inter","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",sans-serif;--font-monospace-default:ui-monospace,SFMono-Regular,"Cascadia Mono","Roboto Mono","DejaVu Sans Mono","Liberation Mono",Menlo,Monaco,"Consolas","Source Code Pro",monospace;--font-interface-override:'??';--font-interface-theme:'??';--font-interface:var(--font-interface-override),var(--font-interface-theme),var(--default-font, '??'),var(--font-default);--font-text-override:'??';--font-text-theme:'??';--font-text:var(--font-text-override),var(--font-text-theme),var(--font-default);--font-print-override:'??';--font-print:var(--font-print-override),var(--font-text-override),var(--font-text-theme),'Arial';--font-monospace-override:'??';--font-monospace-theme:'??';--font-monospace:var(--font-monospace-override),var(--font-monospace-theme),var(--font-monospace-default);--font-text-size:16px;--font-mermaid:var(--font-text)}*{box-sizing:border-box}body,html{margin:0;padding:0;height:100%;width:100%;overscroll-behavior:none}body{text-rendering:optimizelegibility;font-family:var(--font-interface);line-height:var(--line-height-tight);font-size:var(--font-ui-medium);background-color:var(--background-primary);color:var(--text-normal);-webkit-tap-highlight-color:rgba(255,255,255,0)}body.is-translucent{background-color:transparent}.node-insert-event{animation-duration:10ms;animation-name:node-inserted}.is-flashing{transition:color .25s,background-color .25s;color:var(--text-normal);mix-blend-mode:var(--highlight-mix-blend-mode);border-radius:var(--radius-s);background-color:var(--text-highlight-bg)!important}body{user-select:none;caret-color:var(--caret-color)}body.is-grabbing iframe:not(.is-controlled),body.is-grabbing webview{pointer-events:none}.app-container{display:flex;height:100%;width:100%;position:relative;flex-direction:column}.app-container.no-transition *{transition:none!important}.horizontal-main-container{width:100%;display:flex;overflow:hidden;flex:1 0 0px}:focus{outline:0}.is-text-garbled *{font-family:"Flow Circular",sans-serif!important;line-height:1.45em!important}.empty-state{position:absolute;height:100%;width:100%;top:0;inset-inline-start:0px;display:flex;align-items:center;justify-content:center;flex-direction:column}.empty-state-container{max-width:480px;max-height:280px;margin:20px;text-align:center}.empty-state-title{margin:20px 0;font-weight:var(--h2-weight);font-size:var(--h2-size);line-height:var(--line-height-tight);position:relative}.empty-state-action-list{font-size:var(--font-text-size);line-height:var(--line-height-tight);color:var(--text-muted);margin-top:20px}.empty-state-action{cursor:var(--cursor);line-height:36px;color:var(--text-accent)}.empty-state-close-button{display:none}body{--zoom-factor:1;--titlebar-height:30px}.is-hidden-frameless{--divider-vertical-height:100%}body.is-frameless>.app-container~*{app-region:no-drag}body.is-frameless .modal{app-region:no-drag}.pane-empty{color:var(--text-faint);font-size:var(--font-ui-small);margin:var(--size-4-2) auto;padding:var(--size-4-6) var(--size-4-4);text-align:center}.pane-empty .pane-empty-actions{margin-top:var(--size-4-4)}.view-header-title::-webkit-scrollbar{display:none}.view-content{width:100%;height:calc(100% - var(--header-height))}.inline-title{color:var(--inline-title-color);white-space:pre-wrap;margin-block-end:var(--inline-title-margin-bottom)}.inline-title:not([data-level]){font-size:var(--inline-title-size);font-weight:var(--inline-title-weight);line-height:var(--inline-title-line-height);font-style:var(--inline-title-style);font-variant:var(--inline-title-variant);font-family:var(--inline-title-font);letter-spacing:-.015em}.inline-title h1,.inline-title h2,.inline-title h3,.inline-title h4,.inline-title h5,.inline-title h6{margin-block:0px}body:not(.show-inline-title) .inline-title:not([data-level]){display:none}::selection{background-color:var(--text-selection)}.markdown-reading-view{display:flex;flex-direction:column}.markdown-preview-view{font-size:var(--font-text-size);font-family:var(--font-text);line-height:var(--line-height-normal);width:100%;height:100%;padding:var(--file-margins);position:relative;overflow-y:auto;overflow-wrap:break-word;color:var(--text-normal);user-select:text;scrollbar-gutter:stable}.markdown-preview-view.is-readable-line-width .markdown-preview-sizer{max-width:var(--file-line-width);margin-left:auto;margin-right:auto}.markdown-rendered{tab-size:var(--indent-size)}.markdown-rendered.rtl{direction:rtl}.markdown-rendered>.markdown-preview-section>.markdown-preview-pusher+div:not(.mod-ui)>:first-child,.markdown-rendered>.markdown-preview-section>.mod-ui+div:not(.mod-ui)>:first-child{margin-top:0}.markdown-rendered>.markdown-preview-section>div:last-child>:last-child,.markdown-rendered>.markdown-preview-section>div:not(.mod-ui):has(+ .mod-ui)>:last-child{margin-bottom:0}body:not(.show-ribbon){--ribbon-width:0px}.release-notes-view{padding:var(--file-margins)}.release-notes-view .markdown-preview-view{overflow:visible}.release-notes-view .is-readable-line-width{max-width:var(--file-line-width);margin-left:auto;margin-right:auto}[dir=ltr],body{--direction:1}.mod-rtl,[dir=rtl]{--direction:-1}@supports selector(:dir(rtl)){.cm-line:dir(ltr),.is-collapsed:dir(ltr){--direction:1}.cm-line:dir(rtl),.is-collapsed:dir(rtl){--direction:-1}}.is-rtl,.mod-rtl,.rtl{--callout-padding:var(--size-4-3) var(--size-4-6) var(--size-4-3) var(--size-4-3);--embed-padding:0 var(--size-4-6) 0 0;--nav-item-padding:var(--size-4-1) var(--size-4-6) var(--size-4-1) var(--size-4-2)}.is-rtl .metadata-container,.mod-rtl .metadata-container,.rtl .metadata-container{--direction:-1}.is-rtl .metadata-container,.is-rtl input.metadata-input-number,.is-rtl input.metadata-property-key-input,.mod-rtl .metadata-container,.mod-rtl input.metadata-input-number,.mod-rtl input.metadata-property-key-input,.rtl .metadata-container,.rtl input.metadata-input-number,.rtl input.metadata-property-key-input{text-align:right}@supports selector(:has(*)){.is-rtl .cm-line:has(.cm-hmd-frontmatter),.mod-rtl .cm-line:has(.cm-hmd-frontmatter),.rtl .cm-line:has(.cm-hmd-frontmatter){direction:rtl}}.is-rtl input[type=date],.is-rtl input[type=datetime-local],.mod-rtl input[type=date],.mod-rtl input[type=datetime-local],.rtl input[type=date],.rtl input[type=datetime-local]{direction:rtl}.is-rtl input[type=date]::-webkit-calendar-picker-indicator,.is-rtl input[type=datetime-local]::-webkit-calendar-picker-indicator,.mod-rtl input[type=date]::-webkit-calendar-picker-indicator,.mod-rtl input[type=datetime-local]::-webkit-calendar-picker-indicator,.rtl input[type=date]::-webkit-calendar-picker-indicator,.rtl input[type=datetime-local]::-webkit-calendar-picker-indicator{right:var(--size-4-1);left:auto}@supports selector(:has(*)){.callout:has(> .callout-title .callout-title-inner:dir(rtl)),.cm-callout:has(.callout .callout-title .callout-title-inner:dir(rtl)){direction:rtl}.callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title,.cm-callout:has(.callout .callout-title .callout-title-inner:dir(rtl))>.callout-title{direction:rtl;--direction:-1}.callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon,.cm-callout:has(.callout .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon{transform:scale(-1,1)}}.mod-rtl{--dropdown-background-position:left 0.5em top 50%,0 0;--dropdown-padding:0 0.8em 0 1.9em;--tab-stacked-text-transform:rotate(180deg)}.mod-rtl .canvas-wrapper,.mod-rtl .community-modal-readme{direction:ltr}.mod-rtl .checkbox-container,.mod-rtl .search-input-container::before{transform:scale(-1,1)}.modal.mod-trust-folder{max-width:700px}.modal.mod-plugin-debug{max-width:500px}.modal.mod-plugin-debug .startup-stat-list,.modal.mod-plugin-debug .startup-timing-list{display:flex;flex-direction:column;margin:var(--size-4-4) 0}.modal.mod-plugin-debug .startup-stat{display:flex;flex-direction:row;font-size:var(--font-ui-medium);padding:var(--size-4-1) 0;gap:var(--size-4-2)}.modal.mod-plugin-debug .startup-stat:not(:last-child){border-bottom:var(--border-width) solid var(--background-modifier-border)}.modal.mod-plugin-debug .startup-stat.mod-heading .startup-label,.modal.mod-plugin-debug .startup-stat.mod-heading .startup-value{font-weight:var(--font-semibold)}.modal.mod-plugin-debug .startup-info{flex-grow:1;white-space:nowrap}.modal.mod-plugin-debug .startup-desc{margin-inline:var(--size-4-2);color:var(--text-faint);font-size:var(--font-ui-smaller)}.modal.mod-plugin-debug .startup-value{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-variant-numeric:tabular-nums;text-align:end;width:50%}.modal.mod-plugin-options .modal-content{margin:var(--size-4-6) 0}.modal.mod-form{max-width:400px}.form-field{display:flex;flex-direction:column;gap:var(--size-4-2)}.hotkey-list-container{overflow:auto}.search-input-container.mod-hotkey .clickable-icon{padding:var(--size-2-1)}.modal.mod-image-lightbox{max-width:90vw;max-height:90vh;padding:0}.modal.mod-image-lightbox .modal-content{padding:var(--size-4-12) var(--size-4-3) var(--size-4-2) var(--size-4-3);text-align:center}.search-input-container input:placeholder-shown~.search-input-clear-button{display:none}.search-input-container input:not(:placeholder-shown){padding-inline-end:28px}.global-search-input-container.search-input-container input:not(:placeholder-shown){padding-inline-end:56px}.community-modal-details-empty-state{padding:0;text-align:center}.community-modal-search-summary{font-size:var(--font-ui-small);padding:var(--size-4-1) var(--size-4-3) var(--size-4-3) var(--size-4-4)}.community-modal-search-results-wrapper{flex:1 0 auto;overflow:auto;border-top:var(--border-width) solid var(--divider-color);scroll-padding:var(--size-4-3);contain:strict}.community-modal-search-results{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:var(--size-4-3);padding:var(--size-4-3)}.community-modal-empty-state{color:var(--text-muted);display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column}.community-item{position:relative;background-color:var(--background-primary);padding:var(--size-4-3);cursor:var(--cursor);border-radius:var(--radius-m);border:1px solid var(--background-modifier-border);display:flex;flex-direction:column;gap:var(--size-2-1)}.community-item:last-child{margin-bottom:0}.community-item .flair{margin-inline-start:var(--size-4-1);background-color:var(--tag-background);color:var(--tag-color);vertical-align:middle;top:-1px}.community-item-name{font-size:var(--font-ui-medium);line-height:var(--line-height-tight);font-weight:var(--font-medium)}.community-item-author{font-size:var(--font-ui-smaller);line-height:var(--line-height-tight);color:var(--text-muted)}.community-item-updated{font-size:var(--font-ui-smaller);color:var(--text-muted);margin-bottom:var(--size-4-2)}.community-item-desc{font-size:var(--font-ui-small);line-height:var(--line-height-tight);margin-top:4px;overflow:hidden}.community-item-badge.mod-update{--icon-size:var(--icon-xs);--icon-stroke:var(--icon-xs-stroke-width);color:var(--interactive-accent);position:absolute;top:var(--size-4-3);inset-inline-end:var(--size-4-3)}.community-item-screenshot{max-width:100%;object-fit:cover;border-radius:var(--radius-s);aspect-ratio:16/9;image-rendering:-webkit-optimize-contrast;margin-top:var(--size-4-1)}.community-item-screenshot.mod-unavailable{text-align:center;color:var(--text-muted)}.community-item-screenshot .placeholder-icon{display:flex;align-items:center;justify-content:center;height:100%}.community-item-screenshot .placeholder-icon .svg-icon{color:var(--text-faint);width:var(--size-4-8);height:var(--size-4-8)}.community-modal-info-name{font-size:var(--h2-size);font-weight:var(--font-semibold);line-height:var(--line-height-tight);margin-bottom:var(--size-4-6)}.community-modal-info-author,.community-modal-info-repo,.community-modal-info-version{font-size:var(--font-ui-small);line-height:var(--line-height-tight);color:var(--text-muted)}.community-modal-info-desc{font-size:var(--font-ui-small);line-height:var(--line-height-tight);margin-top:4px}.community-modal-details{flex:1 1 calc(var(--modal-max-width) - var(--modal-community-sidebar-width));overflow:auto;display:flex;flex-direction:column;border-inline-start:1px solid var(--divider-color)}.community-modal-info{flex:1 1 0px;overflow-y:auto;padding:var(--size-4-8) var(--size-4-16);scroll-padding:var(--size-4-4)}.community-readme{overflow-y:visible;height:auto;padding:var(--size-4-4) 0}.community-readme img,.community-readme video{max-width:100%}.community-modal-info-desc{font-size:var(--font-ui-medium);line-height:var(--line-height-tight);margin-top:var(--size-4-2)}.community-modal-button-container{display:flex;flex-wrap:wrap;gap:var(--size-4-2);margin:1.5em 0}.community-modal-readme{font-size:var(--font-text-size);font-family:var(--font-text);line-height:var(--line-height-normal);overflow-wrap:break-word;color:var(--text-normal);user-select:text}.installed-plugins-container{padding-top:var(--size-4-4);border-top:1px solid var(--background-modifier-border)}.community-modal-grid-button-container{position:absolute;top:var(--size-4-4);inset-inline-end:var(--size-4-12);display:flex;gap:var(--size-4-2)}.is-translucent:not(.is-fullscreen){--nav-collapse-icon-color:rgba(var(--mono-rgb-100), 0.3);--nav-collapse-icon-color-collapsed:rgba(var(--mono-rgb-100), 0.3);--divider-color:rgba(0, 0, 0, 0.15)}.workspace-tab-header-container-inner::-webkit-scrollbar,.workspace-tab-header-container-inner::-webkit-scrollbar-thumb{display:none}.button-container{margin-top:20px}button{--text-color:var(--text-normal);app-region:no-drag;display:inline-flex;align-items:center;justify-content:center;color:var(--text-color);font-size:var(--font-ui-small);border-radius:var(--button-radius);border:0;padding:var(--size-4-1) var(--size-4-3);height:var(--input-height);font-weight:var(--input-font-weight);cursor:var(--cursor);font-family:inherit;outline:0;user-select:none;white-space:nowrap}button:not(.clickable-icon){color:var(--text-color);background-color:var(--interactive-normal);box-shadow:var(--input-shadow)}button:focus-visible{box-shadow:0 0 0 3px var(--background-modifier-border-focus)}button.mod-cta{background-color:var(--interactive-accent);--text-color:var(--text-on-accent)}button.mod-cta:focus-visible{box-shadow:0 0 0 3px var(--background-modifier-border-focus)}button.mod-muted{background-color:var(--background-secondary);--text-color:var(--text-muted)}button.mod-warning{background-color:var(--background-modifier-error);--text-color:var(--text-on-accent)}button.mod-destructive{--text-color:var(--text-error)}.card-container{display:flex}.card-container.mod-horizontal{flex-direction:column}.card{background-color:var(--background-secondary-alt);border-radius:4px;border:1px solid var(--background-modifier-border);margin:0 10px;padding:15px 30px;display:flex;flex-direction:column;flex-grow:1}.card ul{padding:0}.card .button-container{margin:10px 0}.card-container.mod-horizontal .card{margin:10px 0}.card-container.mod-horizontal .card ul{padding-left:24px}.card li{margin:5px 0}.card.u-clickable{cursor:var(--cursor)}.card.is-selected{border:1px solid var(--interactive-accent);background-color:hsla(var(--interactive-accent-hsl),.2)}.card-title{text-align:center;font-size:20px;line-height:30px;color:var(--text-muted);margin-bottom:8px}.card-description{color:var(--text-muted);font-size:var(--font-ui-small);line-height:20px;flex-grow:1}.changelog-item{margin:var(--size-4-2) 0;font-size:var(--font-ui-medium);line-height:var(--line-height)}.changelog-item::before{content:attr(data-label);width:50px;border-radius:var(--radius-m);font-size:var(--font-ui-small);display:inline-block;text-align:center;margin-right:14px;text-transform:uppercase;letter-spacing:1px;line-height:22px}.changelog-item.mod-success::before{background-color:var(--background-modifier-success)}.changelog-item.mod-highlighted::before{background-color:var(--interactive-accent)}.list-container{display:flex;flex-direction:column;gap:var(--size-4-1)}.list-container.has-row-lines .list-item{margin:0 calc(var(--size-4-4) * -1);padding:var(--size-4-2) var(--size-4-4)}.list-item{border-radius:var(--radius-m);display:flex;margin:var(--size-4-2) 0;gap:var(--size-4-2);align-items:center}.list-item.mod-empty{color:var(--text-faint);font-size:var(--font-ui-small);padding:var(--size-4-4);text-align:center;margin:0 auto}.list-item-separator{width:100%;border-bottom:var(--border-width) solid var(--background-modifier-border)}.list-item-actions{display:flex;gap:var(--size-4-2)}.list-item-part.mod-extended{flex-grow:1;overflow-wrap:anywhere}.list-item-part.clickable-icon{display:flex;align-items:center;justify-content:center;padding:var(--size-2-2);cursor:var(--cursor);border-radius:var(--radius-s);color:var(--icon-color)}.list-item-part.clickable-icon:active,.list-item-part.clickable-icon:hover{color:var(--icon-color-hover);background-color:var(--background-modifier-hover)}.list-item-desc{display:flex;flex-wrap:wrap;gap:var(--size-4-2);color:var(--text-faint);font-size:var(--font-ui-smaller);width:100%}.u-center-text{text-align:center}.u-faded-text{color:var(--text-muted)}.u-pop{color:var(--text-accent);font-weight:var(--font-semibold)}.u-muted{color:var(--text-muted)}.u-small{font-size:.8em}.u-clickable{cursor:var(--cursor)}.diff-view{user-select:text}.diff-line{padding:0 var(--size-4-2)}.diff-line.mod-left{background-color:rgba(var(--background-modifier-error-rgb),.2)}.diff-line.mod-left .diff-changed{background-color:rgba(var(--background-modifier-error-rgb),.4)}.diff-line.mod-right{background-color:rgba(var(--background-modifier-success-rgb),.2)}.diff-line.mod-right .diff-changed{background-color:rgba(var(--background-modifier-success-rgb),.4)}.diff-collapsed{text-align:center;color:var(--text-muted);cursor:pointer;font-size:var(--font-ui-small);margin:var(--size-4-2) 0}.mod-active .document-search-container{background-color:var(--background-primary)}.document-search-container{display:flex;flex-direction:column;padding:var(--size-4-2) 0;margin:0 var(--size-4-4);gap:var(--size-4-2);z-index:var(--layer-popover)}.document-replace,.document-search{width:100%;max-width:var(--file-line-width);margin:0 auto;display:flex;padding:0 var(--size-4-2);gap:var(--size-4-2)}.document-replace{display:none}.document-search-container.mod-replace-mode .document-replace{display:flex}.document-replace-input,.document-search-input{flex-grow:1}.document-replace-input.mod-no-match,.document-search-input.mod-no-match{background-color:rgba(var(--background-modifier-error-rgb),.2)}.document-search-count{color:var(--text-muted);font-size:var(--font-ui-smaller);font-variant-numeric:tabular-nums;position:absolute;transform:translateY(-50%);top:50%;inset-inline-end:var(--size-4-2)}.document-replace-buttons,.document-search-buttons{display:flex;gap:var(--size-4-1);align-items:center}.document-search-button{font-size:var(--font-ui-small);color:var(--text-muted)}.markdown-rendered .search-highlight>div{position:absolute;pointer-events:none;box-shadow:0 0 0 2px var(--text-normal);opacity:.3;mix-blend-mode:var(--highlight-mix-blend-mode);border-radius:2px}.markdown-rendered .search-highlight>div.is-active{box-shadow:0 0 0 3px var(--text-accent);opacity:1}.flair{background-color:var(--interactive-normal);border-radius:var(--radius-s);color:var(--text-normal);font-size:10px;letter-spacing:.05em;margin-inline-start:var(--size-4-2);padding:var(--size-2-1) var(--size-2-2);position:relative;text-transform:uppercase;white-space:nowrap;vertical-align:middle}.flair.mod-flat{vertical-align:top}.flair.mod-pop{background-color:var(--interactive-accent);color:var(--text-on-accent)}.markdown-preview-view:not(.allow-fold-headings) .heading-collapse-indicator,.markdown-preview-view:not(.allow-fold-lists) .list-collapse-indicator{display:none}.collapse-icon{display:flex;align-items:center}.collapse-icon::before{content:"â€‹"}.collapse-icon svg.svg-icon{color:var(--nav-collapse-icon-color);stroke-width:4px;width:10px;height:10px;transition:transform .1s ease-in-out}.collapse-icon.is-collapsed svg.svg-icon{transform:rotate(calc(var(--direction) * -1 * 90deg))}.view-content .collapse-indicator svg.svg-icon,.view-content .list-collapse-indicator svg.svg-icon{color:var(--collapse-icon-color)}.view-content .is-collapsed .collapse-indicator svg.svg-icon,.view-content .is-collapsed .list-collapse-indicator svg.svg-icon{color:var(--collapse-icon-color-collapsed)}.markdown-preview-view .collapse-indicator{display:inline-flex;position:absolute;cursor:var(--cursor);user-select:none}.markdown-preview-view .collapse-indicator .svg-icon{vertical-align:middle}.markdown-preview-view li.is-collapsed>ol,.markdown-preview-view li.is-collapsed>ul{display:none}.markdown-preview-view .heading-collapse-indicator{margin-inline-start:-22px;padding:0 6px}svg.svg-icon{height:var(--icon-size);width:var(--icon-size);stroke-width:var(--icon-stroke)}.view-actions{gap:0;align-items:center;--icon-size:var(--icon-s)}.clickable-icon{app-region:no-drag;background-color:transparent;display:flex;align-items:center;justify-content:center;padding:var(--size-2-2) var(--size-2-3);cursor:var(--cursor);border-radius:var(--clickable-icon-radius);color:var(--icon-color);opacity:var(--icon-opacity);transition:opacity .15s ease-in-out;height:auto}.clickable-icon.is-active{opacity:var(--icon-opacity-hover);color:var(--icon-color-active);background-color:var(--background-modifier-active-hover)}.clickable-icon.mod-warning{color:var(--text-error)}.clickable-icon.mod-filled svg{fill:var(--icon-color)}.text-icon-button{app-region:no-drag;display:inline-flex;align-items:center;color:var(--text-muted);font-size:var(--font-ui-small);border-radius:var(--button-radius);padding:var(--size-2-1) var(--size-4-3) var(--size-2-1) var(--size-4-2);height:var(--input-height);font-weight:var(--input-font-weight);cursor:var(--cursor);font-family:inherit;gap:var(--size-2-2);user-select:none;white-space:nowrap}.text-icon-button .text-button-icon{display:flex;align-items:center;justify-content:center}.text-icon-button .text-button-icon svg.svg-icon{height:var(--icon-size);width:var(--icon-size);stroke-width:var(--icon-stroke)}.text-icon-button:focus{box-shadow:0 0 0 2px var(--background-modifier-border-focus);outline:0}.markdown-rendered.show-indentation-guide li>ol,.markdown-rendered.show-indentation-guide li>ul{position:relative}.markdown-rendered.show-indentation-guide li>ol::before,.markdown-rendered.show-indentation-guide li>ul::before{content:"â€‹";position:absolute;display:block;inset-inline-start:var(--indentation-guide-reading-indent);top:0;bottom:0;border-inline-end:var(--indentation-guide-width) solid var(--indentation-guide-color)}.input-button{padding:6px 14px;margin-inline-start:14px;color:var(--text-muted);font-size:var(--font-ui-medium);position:relative;top:-1px}input.metadata-input-text,input[type=date],input[type=datetime-local],input[type=email],input[type=number],input[type=password],input[type=search],input[type=text],textarea{app-region:no-drag;background:var(--background-modifier-form-field);border:var(--input-border-width) solid var(--background-modifier-border);color:var(--text-normal);font-family:inherit;padding:var(--size-4-1) var(--size-4-2);font-size:var(--font-ui-small);border-radius:var(--input-radius);outline:0}input.metadata-input-text:active,input.metadata-input-text:focus,input[type=date]:active,input[type=date]:focus,input[type=datetime-local]:active,input[type=datetime-local]:focus,input[type=email]:active,input[type=email]:focus,input[type=number]:active,input[type=number]:focus,input[type=password]:active,input[type=password]:focus,input[type=search]:active,input[type=search]:focus,input[type=text]:active,input[type=text]:focus,textarea:active,textarea:focus{border-color:var(--background-modifier-border-focus);transition:box-shadow .15s ease-in-out,border .15s ease-in-out}input.metadata-input-text:active,input.metadata-input-text:focus,input.metadata-input-text:focus-visible,input[type=date]:active,input[type=date]:focus,input[type=date]:focus-visible,input[type=datetime-local]:active,input[type=datetime-local]:focus,input[type=datetime-local]:focus-visible,input[type=email]:active,input[type=email]:focus,input[type=email]:focus-visible,input[type=number]:active,input[type=number]:focus,input[type=number]:focus-visible,input[type=password]:active,input[type=password]:focus,input[type=password]:focus-visible,input[type=search]:active,input[type=search]:focus,input[type=search]:focus-visible,input[type=text]:active,input[type=text]:focus,input[type=text]:focus-visible,textarea:active,textarea:focus,textarea:focus-visible{box-shadow:0 0 0 2px var(--background-modifier-border-focus)}input.metadata-input-text::placeholder,input[type=date]::placeholder,input[type=datetime-local]::placeholder,input[type=email]::placeholder,input[type=number]::placeholder,input[type=password]::placeholder,input[type=search]::placeholder,input[type=text]::placeholder,textarea::placeholder{color:var(--text-faint)}input[type=email],input[type=number],input[type=password],input[type=search],input[type=text]{height:var(--input-height)}textarea{line-height:var(--line-height-tight)}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{display:none;pointer-events:none}input[type=number]::-webkit-inner-spin-button{appearance:none}input[type=date],input[type=datetime-local]{font-variant-numeric:tabular-nums;position:relative}input[type=date]::-webkit-calendar-picker-indicator,input[type=datetime-local]::-webkit-calendar-picker-indicator{position:absolute;left:var(--size-4-1);right:auto;opacity:.5}body:not(.is-ios):not(.is-android) input[type=date],body:not(.is-ios):not(.is-android) input[type=datetime-local]{padding-inline-start:var(--size-4-6)}input[type=range]{width:100px;appearance:none;background-color:var(--slider-track-background);border-radius:var(--slider-track-height);height:var(--slider-track-height);padding:0;outline:0}input[type=range]::-webkit-slider-runnable-track{height:6px;appearance:none}input[type=range]::-webkit-slider-thumb{appearance:none;height:var(--slider-thumb-height);width:var(--slider-thumb-width);border-radius:var(--slider-thumb-radius);cursor:default;background:#fff;border:var(--slider-thumb-border-width) solid var(--slider-thumb-border-color);position:relative;top:var(--slider-thumb-y);transition:.1s linear;box-shadow:rgba(0,0,0,.05) 0 1px 1px 0,rgba(0,0,0,.1) 0 2px 2px 0}input[type=range]::-webkit-slider-thumb:active,input[type=range]::-webkit-slider-thumb:hover{background:#fff;border-color:var(--background-modifier-border-focus);box-shadow:rgba(0,0,0,.1) 0 1px 2px 0,rgba(0,0,0,.2) 0 2px 3px 0;transition:.1s linear}input[type=color]{appearance:none;width:calc(var(--swatch-width) + 4px);background-color:transparent;border:none;cursor:var(--cursor);padding:0}input[type=color]::-webkit-color-swatch-wrapper{padding:2px}input[type=color]::-webkit-color-swatch{border:0;box-shadow:var(--swatch-shadow);border-radius:var(--swatch-radius);height:var(--swatch-height);width:var(--swatch-width);align-self:center}input[type=color]:focus-visible::-webkit-color-swatch,input[type=color]:focus::-webkit-color-swatch{box-shadow:var(--swatch-shadow),0 0 0 3px var(--background-modifier-border-focus)}select.mod-hidden{display:none}.notice-container{z-index:var(--layer-notice);position:fixed;top:22px;inset-inline-end:0px;padding:10px;overflow:hidden;pointer-events:none}.notice{display:flex;flex-direction:column;gap:var(--size-4-2);background-color:var(--background-modifier-message);border-radius:var(--radius-m);box-shadow:0 2px 8px var(--background-modifier-box-shadow);color:#fafafa;font-size:var(--font-ui-small);line-height:var(--line-height-tight);padding:.75em 1em;max-width:300px;margin-bottom:14px;white-space:pre-wrap;overflow-wrap:anywhere;word-break:break-word;cursor:var(--cursor);pointer-events:auto}.notice-cta{display:flex;align-items:center;color:var(--text-accent);white-space:nowrap}.debug-textarea{width:100%;min-height:50vh;height:100%;max-height:80vh;font-family:var(--font-monospace);tab-size:4;resize:none}.modal-container{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;inset-inline-start:0px;width:100%;z-index:var(--layer-modal)}.modal-container.mod-dim .modal{box-shadow:var(--shadow-l)}.modal-confirmation-state{align-items:center;display:flex;flex-direction:column;flex-grow:1;justify-content:center;text-align:center}.modal-bg{position:absolute;top:0;inset-inline-start:0px;width:100%;height:100%;background-color:var(--background-modifier-cover)}.modal{--checkbox-size:var(--font-ui-medium);background-color:var(--modal-background);border-radius:var(--modal-radius);border:var(--modal-border-width) solid var(--modal-border-color);padding:var(--size-4-4);position:relative;min-height:100px;width:var(--dialog-width);max-width:var(--dialog-max-width);max-height:var(--dialog-max-height);display:flex;flex-direction:column;overflow:auto}.modal.mod-scrollable-content{padding:0;overflow:hidden}.modal.mod-scrollable-content .modal-title{padding:var(--size-4-4) var(--size-4-4) 0 var(--size-4-4);border-top:var(--border-width) solid var(--background-modifier-border)}.modal.mod-scrollable-content .modal-content{padding:0 var(--size-4-4) var(--size-4-4) var(--size-4-4);overflow:auto}.modal.mod-scrollable-content .modal-button-container{margin-top:0;border-top:var(--border-width) solid var(--background-modifier-border);padding:var(--size-4-4)}.modal.mod-narrow{max-width:var(--modal-max-width-narrow)}body:not(.native-scrollbars) .modal-close-button{inset-inline-end:12px}.modal-close-button{transition:opacity .15s ease-in-out;cursor:var(--cursor);position:absolute;top:var(--size-2-3);inset-inline-end:var(--size-2-3);font-size:24px;line-height:20px;height:24px;width:24px;padding:0 var(--size-2-2);border-radius:var(--radius-s);color:var(--text-muted)}.modal-close-button::before{font-family:Inter,sans-serif;content:"Ã—";font-weight:300}.modal-title{font-size:var(--font-ui-large);margin-left:auto;margin-right:auto;font-weight:var(--font-semibold);text-align:start;line-height:var(--line-height-tight)}.modal-title:empty{display:none}.modal-content{flex:1 1 auto;font-size:var(--font-ui-medium)}.modal-button-container{margin-top:1.5em;display:flex;justify-content:flex-end;gap:var(--size-4-2);flex-wrap:wrap;font-size:var(--font-ui-medium)}.modal-button-container .mod-checkbox{flex-grow:1;display:flex;align-items:center;gap:var(--size-4-1)}.modal-checkbox-label{cursor:var(--cursor);margin-inline-start:10px;user-select:none}.error-container{align-items:center;display:flex;flex-direction:column;padding:var(--size-4-4);gap:var(--size-4-6);text-align:center}.mod-warning{color:var(--text-error)}.mod-success{color:var(--text-success)}.modal .modal-nav-action{background-color:unset;margin-top:var(--size-4-1);position:absolute;top:0;width:unset}.modal .modal-nav-action.mod-secondary{inset-inline-start:0px}.modal .modal-nav-action.mod-cta{color:var(--color-accent);font-weight:var(--font-semibold);inset-inline-end:0px}.modal.mod-scrollable{height:var(--modal-height);width:var(--modal-width);max-width:var(--modal-max-width-narrow);padding:var(--size-4-4) 0 0 0;position:relative;overflow:hidden}.modal.mod-scrollable .modal-title{padding:0 var(--size-4-4)}.modal.mod-scrollable .modal-content{overflow:auto;padding:0 var(--size-4-4) var(--size-4-4);margin-bottom:calc(var(--input-height) + var(--size-4-8));border-top:var(--border-width) solid var(--background-modifier-border)}.modal.mod-scrollable .modal-button-container{margin:0 0 0 calc(var(--size-4-4) * -1);padding:var(--size-4-4);gap:var(--size-4-2);position:absolute;bottom:0;background-color:var(--background-primary);border-top:var(--border-width) solid var(--background-modifier-border);width:100%}.nav-buttons-container{flex-wrap:wrap;gap:var(--size-2-1)}.nav-buttons-container.has-separator{border-bottom:1px solid var(--background-modifier-border);padding-bottom:var(--size-2-3);margin-bottom:var(--size-4-2)}body{--pill-focus-width:calc(100% + 6px);--pill-focus-left-adjust:-4px}.multi-select-container{cursor:text;display:inline-flex;vertical-align:top;flex-wrap:wrap;min-height:var(--input-height);width:100%;background:var(--background-modifier-form-field);border:var(--input-border-width) solid var(--background-modifier-border);color:var(--text-normal);font-size:var(--font-ui-small);border-radius:var(--input-radius);outline:0;padding:var(--size-4-1);gap:var(--size-2-3)}.multi-select-pill{--icon-size:var(--icon-xs);--icon-stroke:var(--icon-xs-stroke-width);display:flex;align-items:center;background-color:var(--pill-background);border:var(--pill-border-width) solid var(--pill-border-color);border-radius:var(--pill-radius);color:var(--pill-color);cursor:var(--cursor);font-weight:var(--pill-weight);padding:var(--pill-padding-y) 0;line-height:1;max-width:calc(100% - var(--size-2-3) - 1ch);gap:var(--size-2-1);position:relative}.multi-select-pill:focus::after{content:"";display:block;position:absolute;pointer-events:none;border-radius:var(--pill-radius);inset-inline-end:var(--pill-focus-left-adjust);width:var(--pill-focus-width);height:100%;box-shadow:0 0 0 1px var(--background-modifier-border-focus),inset 0 0 0 1px var(--background-modifier-border-focus)}.multi-select-pill-content{overflow:hidden;text-overflow:ellipsis;margin-inline-start:var(--pill-padding-x)}.multi-select-pill-remove-button{margin-inline-end:min(var(--size-2-3),var(--pill-padding-x));cursor:var(--cursor);color:var(--pill-color-remove);border-radius:var(--radius-s);display:flex;align-items:center;--icon-size:var(--icon-xs);--icon-stroke:var(--icon-xs-stroke-width)}.multi-select-input{cursor:text;font-family:var(--font-interface);min-width:1ch;max-width:max-content;color:var(--text-normal);background-color:inherit;border:none;overflow-x:auto;white-space:nowrap}.multi-select-input::-webkit-scrollbar{display:none}.multi-select-input::before{content:"â€‹"}.multi-select-input:empty::before{content:attr(placeholder);color:var(--text-faint);pointer-events:none}.multi-select-duplicate{animation:2s ease-in 0s 1 normal none running multi-select-highlight}body:not(.native-scrollbars) ::-webkit-scrollbar{width:12px;height:12px;border-radius:var(--radius-l);background-color:transparent}body:not(.native-scrollbars) ::-webkit-scrollbar-track{background-color:transparent}body:not(.native-scrollbars) ::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb-bg);border-radius:var(--radius-l);background-clip:padding-box;border-style:solid;border-color:transparent;border-image:initial;border-width:3px 3px 3px 2px;min-height:45px}body:not(.native-scrollbars) ::-webkit-scrollbar-thumb:active{border-radius:var(--radius-l)}body:not(.native-scrollbars) ::-webkit-scrollbar-thumb:active,body:not(.native-scrollbars) ::-webkit-scrollbar-thumb:hover{background-color:var(--scrollbar-active-thumb-bg)}body:not(.native-scrollbars) ::-webkit-scrollbar-corner{background:0 0}@supports not selector(::-webkit-scrollbar){body:not(.native-scrollbars){scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb-bg) var(--scrollbar-bg)}}.checkbox-container{app-region:no-drag;cursor:var(--cursor);background-color:var(--background-modifier-border-hover);border-radius:var(--toggle-radius);display:inline-block;flex-shrink:0;height:calc(var(--toggle-thumb-height) + var(--toggle-border-width) * 2);position:relative;user-select:none;width:var(--toggle-width);box-shadow:rgba(0,0,0,.07) 0 4px 10px inset,rgba(0,0,0,.21) 0 0 1px inset;transition:box-shadow .15s ease-in-out,outline .15s ease-in-out,border .15s ease-in-out,opacity .15s ease-in-out;outline:0 solid var(--background-modifier-border-focus)}.checkbox-container input[type=checkbox]{position:absolute;opacity:0;left:0}.checkbox-container:focus-within{outline:var(--toggle-border-width) solid var(--background-modifier-border-focus)}.checkbox-container.is-enabled{background-color:var(--interactive-accent)}.checkbox-container.is-enabled::after{transform:translate3d(calc(var(--toggle-width) - var(--toggle-thumb-width) - var(--toggle-border-width)),0,0)}.checkbox-container.is-enabled:active::after{left:-4px}.checkbox-container::before{content:"";display:block;position:absolute;inset:0px;opacity:0}.checkbox-container::after{pointer-events:none;content:"";display:block;position:absolute;background-color:var(--toggle-thumb-color);width:var(--toggle-thumb-width);height:var(--toggle-thumb-height);margin:var(--toggle-border-width) 0 0 0;border-radius:var(--toggle-thumb-radius);transition:transform .15s ease-in-out,width .1s ease-in-out,left .1s ease-in-out;left:0;transform:translate3d(var(--toggle-border-width),0,0);box-shadow:rgba(0,0,0,.15) 0 1px 2px}.checkbox-container:active::after{width:calc(var(--toggle-thumb-width) + var(--toggle-border-width))}.checkbox-container.mod-small{width:var(--toggle-s-width);height:calc(var(--toggle-s-thumb-height) + var(--toggle-s-border-width) * 2)}.checkbox-container.mod-small:focus-within{outline:var(--toggle-s-border-width) solid var(--background-modifier-border-focus)}.checkbox-container.mod-small::after{width:var(--toggle-s-thumb-width);height:var(--toggle-s-thumb-height);margin:var(--toggle-s-border-width) 0 0 0;transform:translate3d(var(--toggle-s-border-width),0,0)}.checkbox-container.mod-small.is-enabled::after{transform:translate3d(calc(var(--toggle-s-width) - var(--toggle-s-thumb-width) - var(--toggle-s-border-width)),0,0)}.checkbox-container.mod-small:active::after{width:calc(var(--toggle-s-thumb-width) + var(--toggle-s-border-width))}.tree-item-self{align-items:baseline;display:flex;border-radius:var(--radius-s);color:var(--nav-item-color);font-size:var(--nav-item-size);line-height:var(--line-height-tight);font-weight:var(--nav-item-weight);margin-bottom:var(--size-2-1);padding:var(--nav-item-padding);position:relative}.tree-item-self::before{content:"â€‹"}.tree-item-self.mod-collapsible{padding:var(--nav-item-parent-padding)}.tree-item-self.is-being-dragged-over{color:var(--nav-item-color-highlighted);background:hsla(var(--interactive-accent-hsl),.1)}.tree-item-self.is-being-dragged-over .collapse-icon{color:var(--nav-item-color-highlighted)}.tree-item-self.is-clickable{cursor:var(--cursor)}.tree-item-self.is-active,body:not(.is-grabbing) .tree-item-self.is-active:hover{color:var(--nav-item-color-active);background-color:var(--nav-item-background-active);font-weight:var(--nav-item-weight-active)}.tree-item-self.is-selected,body:not(.is-grabbing) .tree-item-self.is-selected:hover{color:var(--nav-item-color-selected);background-color:var(--nav-item-background-selected)}.tree-item-self.is-being-dragged,body:not(.is-grabbing) .tree-item-self.is-being-dragged:hover{color:var(--text-on-accent);background-color:var(--interactive-accent)}.tree-item-self.is-being-dragged .tree-item-icon,body:not(.is-grabbing) .tree-item-self.is-being-dragged:hover .tree-item-icon{color:var(--text-on-accent)}.tree-item-self .tree-item-icon{position:absolute;margin-inline-start:calc(-1 * var(--size-4-5));width:var(--size-4-4);display:flex;align-items:center;justify-content:center;opacity:var(--icon-opacity);color:var(--icon-color);flex:0 0 auto}.tree-item-self .tree-item-icon::before{content:"â€‹"}.tree-item-self .tree-item-icon .svg-icon:not(.right-triangle){--icon-size:var(--icon-xs);--icon-stroke:var(--icon-s-stroke-width)}.tree-item-flair-outer{padding-inline-start:var(--size-4-1);margin-inline-start:auto;display:flex;flex-shrink:0;align-items:center}.tree-item-flair{font-size:var(--font-ui-smaller);color:var(--text-faint);line-height:1;border-radius:var(--radius-s)}.tree-item-inner{overflow:hidden;white-space:pre-wrap}.tree-item-inner-text{overflow:hidden;text-overflow:ellipsis}.tree-item-inner-subtext{color:var(--text-faint);font-size:85%}.tree-item-children{padding-inline-start:var(--nav-item-children-padding-start,var(--nav-item-children-padding-left));margin-inline-start:var(--nav-item-children-margin-start,var(--nav-item-children-margin-left));margin-bottom:1px;border-inline-start:var(--nav-indentation-guide-width) solid var(--nav-indentation-guide-color)}audio{outline:0}.markdown-rendered audio{max-width:100%;outline:0}audio{width:100%;height:42px}audio::-webkit-media-controls-enclosure{border-radius:calc(var(--radius-m) - 1px);border:1px solid var(--background-modifier-border);background-color:var(--background-primary-alt)}audio::-webkit-media-controls-current-time-display,audio::-webkit-media-controls-time-remaining-display{font-family:var(--font-interface)}iframe{border:0}kbd{color:var(--code-normal);font-family:var(--font-monospace);background-color:var(--code-background);border-radius:var(--radius-s);font-size:var(--code-size);padding:.1em .25em}.popupWrapper{--pdf-popup-width:280px;font-size:var(--font-ui-medium);pointer-events:none;position:absolute;transform:translate(-50%,0);z-index:10000}.popupWrapper>div{margin:var(--size-4-3);background-color:var(--background-primary);border-radius:var(--radius-s);filter:drop-shadow(rgba(0, 0, 0, .2) 0px 0px 1px) drop-shadow(rgba(0, 0, 0, .3) 0px 1px 2px) drop-shadow(rgba(0, 0, 0, .3) 0px 4px 6px)}.popupWrapper>div::after{background:var(--background-primary);border-start-start-radius:2px;content:"";height:var(--size-4-3);inset-inline-start:calc(50% - 2px);position:absolute;top:-5px;transform:rotate(45deg);width:var(--size-4-3);z-index:-1}.popup{cursor:initial;display:flex;flex-direction:column;pointer-events:auto;user-select:text;white-space:normal;width:var(--pdf-popup-width);overflow-wrap:break-word}.popupContent{font-size:var(--font-ui-small);line-height:var(--line-height-tight);max-height:200px;overflow:auto;padding:var(--size-4-4);text-align:start}.popupContent:empty{display:none}.popupMeta{--icon-size:var(--font-ui-small);--icon-stroke:2.5px;align-items:center;background-color:var(--background-secondary);border-top:1px solid var(--background-modifier-border);color:var(--text-muted);display:flex;font-size:var(--font-ui-smaller);gap:var(--size-4-1);justify-content:space-between;padding:var(--size-4-1) var(--size-4-2);border-bottom-left-radius:var(--radius-s);border-bottom-right-radius:var(--radius-s)}.popupContent:empty+.popupMeta{border-top:none;background-color:var(--background-primary);border-top-left-radius:var(--radius-s);border-top-right-radius:var(--radius-s)}.popupMeta .clickable-icon{margin-inline-end:calc(var(--size-4-1) * -1);margin-inline-start:calc(var(--size-2-1) * -1)}.popupDate{white-space:nowrap}.markdown-rendered video{max-width:100%;outline:0}.markdown-rendered blockquote{color:var(--blockquote-color);font-style:var(--blockquote-font-style);background-color:var(--blockquote-background-color);border-inline-start:var(--blockquote-border-thickness) solid var(--blockquote-border-color);padding-top:0;padding-bottom:0;padding-inline-start:var(--size-4-6);margin-inline:0px}.markdown-rendered blockquote>:first-child{margin-top:0}.markdown-rendered blockquote>:last-child{margin-bottom:0}.callout{--callout-color:var(--callout-default);--callout-icon:lucide-pencil}.callout[data-callout=abstract],.callout[data-callout=summary],.callout[data-callout=tldr]{--callout-color:var(--callout-summary);--callout-icon:lucide-clipboard-list}.callout[data-callout=info]{--callout-color:var(--callout-info);--callout-icon:lucide-info}.callout[data-callout=todo]{--callout-color:var(--callout-todo);--callout-icon:lucide-check-circle-2}.callout[data-callout=important]{--callout-color:var(--callout-important);--callout-icon:lucide-flame}.callout[data-callout=hint],.callout[data-callout=tip]{--callout-color:var(--callout-tip);--callout-icon:lucide-flame}.callout[data-callout=check],.callout[data-callout=done],.callout[data-callout=success]{--callout-color:var(--callout-success);--callout-icon:lucide-check}.callout[data-callout=faq],.callout[data-callout=help],.callout[data-callout=question]{--callout-color:var(--callout-question);--callout-icon:help-circle}.callout[data-callout=attention],.callout[data-callout=caution],.callout[data-callout=warning]{--callout-color:var(--callout-warning);--callout-icon:lucide-alert-triangle}.callout[data-callout=fail],.callout[data-callout=failure],.callout[data-callout=missing]{--callout-color:var(--callout-fail);--callout-icon:lucide-x}.callout[data-callout=danger],.callout[data-callout=error]{--callout-color:var(--callout-error);--callout-icon:lucide-zap}.callout[data-callout=bug]{--callout-color:var(--callout-bug);--callout-icon:lucide-bug}.callout[data-callout=example]{--callout-color:var(--callout-example);--callout-icon:lucide-list}.callout[data-callout=cite],.callout[data-callout=quote]{--callout-color:var(--callout-quote);--callout-icon:quote-glyph}.callout{overflow:hidden;border-style:solid;border-color:rgba(var(--callout-color),var(--callout-border-opacity));border-width:var(--callout-border-width);border-radius:var(--callout-radius);margin:1em 0;mix-blend-mode:var(--callout-blend-mode);background-color:rgba(var(--callout-color),.1);padding:var(--callout-padding)}.callout.is-collapsible .callout-title{cursor:var(--cursor)}.callout-title{padding:var(--callout-title-padding);display:flex;gap:var(--size-4-1);font-size:var(--callout-title-size);color:rgb(var(--callout-color));line-height:var(--line-height-tight);align-items:flex-start}.callout-content{overflow-x:auto;padding:var(--callout-content-padding);background-color:var(--callout-content-background)}.callout-content .callout{margin-top:20px}.callout-icon{flex:0 0 auto;display:flex;align-items:center}.callout-icon .svg-icon{color:rgb(var(--callout-color))}.callout-icon::after{content:"â€‹"}.callout-title-inner{--font-weight:var(--callout-title-weight);font-weight:var(--font-weight);color:var(--callout-title-color)}.callout-fold{display:flex;align-items:center;padding-inline-end:var(--size-4-2)}.callout-fold::after{content:"â€‹"}.callout-fold .svg-icon{transition:transform .1s ease-in-out}.callout-fold.is-collapsed .svg-icon{transform:rotate(calc(var(--direction) * -1 * 90deg))}.markdown-rendered code{color:var(--code-normal);font-family:var(--font-monospace);background-color:var(--code-background);border-radius:var(--code-radius);font-size:var(--code-size);padding:.15em .3em;border:var(--code-border-width) solid var(--code-border-color);-webkit-box-decoration-break:clone}.markdown-rendered pre{position:relative;padding:var(--size-4-3) var(--size-4-4);min-height:38px;background-color:var(--code-background);border-radius:var(--code-radius);white-space:var(--code-white-space);border:var(--code-border-width) solid var(--code-border-color);overflow-x:auto}.markdown-rendered pre code{border:none;padding:0;background-color:transparent}.markdown-rendered pre:not(:hover)>button.copy-code-button{display:none}.markdown-rendered button.copy-code-button{margin:6px;padding:6px 8px;height:auto;background-color:transparent;box-shadow:none;color:var(--text-muted);font-size:var(--font-ui-smaller);font-family:var(--font-interface);position:absolute;top:0;inset-inline-end:0px}.theme-dark .mermaid>svg{filter:invert(100%) hue-rotate(180deg) saturate(1.25)}code[class*=language-],pre[class*=language-]{color:var(--code-normal);background:0 0;overflow-wrap:break-word;white-space:pre-wrap;word-break:normal;direction:ltr;font-family:var(--font-monospace);text-align:left;word-spacing:normal;line-height:var(--line-height-normal);hyphens:none}:not(pre)>code[class*=language-],pre[class*=language-]{background:var(--code-background)}pre[class*=language-]{overflow:hidden}code[class*=language-]{display:block;padding:1em;overflow:auto}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:var(--code-comment)}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.symbol,.token.tag{color:var(--code-tag)}.token.punctuation{color:var(--code-punctuation)}.token.boolean,.token.number{color:var(--code-value)}.token.attr-name,.token.char,.token.inserted,.token.selector,.token.string{color:var(--code-string)}.token.operator{color:var(--code-operator)}.token.atrule,.token.attr-value,.token.builtin,.token.class-name,.token.function,.token.property-access{color:var(--code-function)}.token.keyword{color:var(--code-keyword)}.token.important,.token.regex{color:var(--code-important)}.markdown-preview-view .markdown-embed .markdown-preview-view{--file-folding-offset:0px;height:100%;padding:0}.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h1,.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h2,.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h3,.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h4,.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h5,.markdown-preview-view .markdown-embed .markdown-preview-view .markdown-preview-pusher h6{margin-top:0}.file-embed,.markdown-embed{position:relative}.file-embed-link,.markdown-embed-link{position:absolute;top:4px;inset-inline-end:4px;color:var(--icon-color);opacity:var(--icon-opacity);cursor:var(--cursor-link);padding:var(--size-2-2);border-radius:var(--radius-s);display:flex;align-items:center;--icon-size:var(--icon-s);--icon-stroke:var(--icon-s-stroke-width)}.file-embed-title{display:flex;align-items:center;justify-content:center;gap:var(--size-4-2)}.file-embed-icon{color:var(--text-muted);display:flex}.file-embed{display:flex;justify-content:center;border-radius:var(--radius-m);background-color:var(--background-primary-alt)}.file-embed.mod-empty,.file-embed.mod-generic{cursor:var(--cursor-link);padding:var(--size-4-2);color:var(--text-muted);text-align:center;font-size:var(--font-smaller)}.file-embed.mod-empty-attachment{padding:var(--size-4-2);color:var(--text-muted);text-align:center;font-size:var(--font-smaller)}.markdown-embed-content{height:100%}.embed-title{align-items:center;display:flex;gap:var(--size-4-1);font-size:var(--font-text-size);font-weight:calc(var(--font-weight) + var(--bold-modifier));text-align:start;text-overflow:ellipsis;white-space:nowrap;padding:0 0 var(--size-4-2) 0}.markdown-embed{font-style:var(--embed-font-style);background-color:var(--embed-background);border-top:var(--embed-border-top);border-inline-end:var(--embed-border-end,var(--embed-border-right));border-bottom:var(--embed-border-bottom);border-inline-start:var(--embed-border-start,var(--embed-border-left));margin:0;padding:var(--embed-padding)}.markdown-embed .markdown-preview-view{padding:0}.internal-embed:not(.image-embed){display:block}.internal-embed audio,.internal-embed img:not([width]),.internal-embed video{max-width:100%}.inline-embed .markdown-embed-content{height:fit-content;max-height:var(--embed-max-height);overflow:auto}.embed-iframe{width:100%;height:100%}iframe.external-embed{width:600px;max-width:100%;height:350px}.footnote-link{text-decoration:none}.footnotes{font-size:var(--footnote-size)}.footnote-ref{vertical-align:super}.footnote-backref{display:inline-block;margin-inline-start:var(--size-4-1);color:var(--text-faint);text-decoration:none}.markdown-rendered .frontmatter.mod-failed{position:relative}.markdown-rendered .frontmatter.mod-failed .mod-error{color:var(--text-error);font-size:var(--font-smaller)}.markdown-rendered .frontmatter.mod-failed::after{content:"";position:absolute;top:0;inset-inline-end:0px;width:100%;height:100%;background-color:var(--background-modifier-error);opacity:.3;mix-blend-mode:var(--highlight-mix-blend-mode)}.metadata-container{--input-height:var(--metadata-input-height);border-radius:var(--metadata-border-radius);background-color:var(--metadata-background);border-color:var(--metadata-border-color);border-style:solid;border-width:var(--metadata-border-width);padding:var(--metadata-padding);color:var(--text-muted);position:relative;max-width:var(--metadata-max-width);margin-block-end:var(--p-spacing)}.markdown-embed-content .metadata-container{display:none}.metadata-container.is-collapsed .metadata-property{display:none}.metadata-container:focus-within .metadata-property.is-selected{color:var(--nav-item-color-selected);background-color:var(--nav-item-background-selected)}.metadata-properties{display:flex;flex-direction:column;gap:var(--metadata-gap)}.metadata-properties-heading{display:inline-block;padding:var(--size-4-1);margin-bottom:var(--size-4-2);position:relative;line-height:1.2}.metadata-properties-heading::before{content:"";border-radius:var(--metadata-property-radius);position:absolute;display:inline-block;inset:0px}.metadata-properties-heading:focus::before{box-shadow:0 0 0 2px var(--background-modifier-border-focus)}.metadata-properties-heading .collapse-indicator{position:absolute;inset-inline-start:-22px;padding:0 6px}.metadata-properties-title{user-select:none;font-size:max(var(--font-ui-small), 1em);color:var(--text-normal);font-weight:var(--font-medium);font-family:var(--font-interface)}.metadata-error-container{border-radius:var(--callout-radius);padding:var(--size-4-1) var(--size-4-2);background-color:rgba(var(--callout-error),.1)}.metadata-error-title{color:var(--text-error);font-size:max(var(--font-ui-small), 1em);font-weight:var(--font-medium)}.metadata-error-cta{cursor:var(--cursor);color:var(--text-accent);font-size:var(--font-ui-small);font-weight:var(--font-medium);margin-left:auto}.metadata-input-text{background-color:transparent;width:100%;min-height:var(--input-height);border-width:0;resize:none;overflow-y:hidden}.metadata-input-text::-webkit-date-and-time-value{text-align:start}.metadata-input-text.mod-date{padding-inline-end:0px;width:auto}.metadata-property{position:relative;display:flex;align-items:start;padding:var(--metadata-property-padding);border-radius:var(--metadata-property-radius);overflow:hidden;background-color:var(--metadata-property-background)}.metadata-property:focus-within{background-color:var(--metadata-property-background-hover);--metadata-divider-color:var(--metadata-divider-color-focus);border-radius:var(--metadata-property-radius-focus);box-shadow:0 0 0 2px var(--background-modifier-border-focus)}.metadata-property-icon{cursor:var(--cursor);color:var(--icon-color);display:flex;align-items:center;padding:var(--size-4-1) 0;height:var(--input-height);user-select:none}.metadata-property-icon::before{content:"â€‹";width:var(--size-4-1)}.metadata-input-number{background-color:transparent;width:100%;border-width:0}input[type=checkbox].metadata-input-checkbox{margin-inline-start:var(--size-4-2)}.metadata-property-key{display:flex;align-self:stretch;align-items:flex-start;flex-direction:row;flex-shrink:0;font-family:var(--metadata-label-font);border-bottom:var(--metadata-divider-width) solid var(--metadata-divider-color);background-color:var(--metadata-label-background);width:var(--metadata-label-width);min-width:var(--metadata-label-width)}.metadata-property-key:focus-within{background-color:var(--metadata-label-background-active)}input.metadata-property-key-input{border:none;flex-grow:1;color:var(--metadata-label-text-color);font-size:var(--metadata-label-font-size);font-weight:var(--metadata-label-font-weight);height:var(--input-height);background-color:transparent;display:flex;align-items:center;text-overflow:ellipsis;overflow:hidden;width:100%;text-align:left}input.metadata-property-key-input:active,input.metadata-property-key-input:focus{background-color:transparent}.metadata-property button{margin-top:var(--size-4-2)}.metadata-property .multi-select-container,.metadata-property input[type=date],.metadata-property input[type=datetime-local],.metadata-property input[type=number],.metadata-property input[type=text]{border-radius:0;border:none}.metadata-property .multi-select-container:active,.metadata-property .multi-select-container:focus,.metadata-property .multi-select-container:hover,.metadata-property input[type=date]:active,.metadata-property input[type=date]:focus,.metadata-property input[type=date]:hover,.metadata-property input[type=datetime-local]:active,.metadata-property input[type=datetime-local]:focus,.metadata-property input[type=datetime-local]:hover,.metadata-property input[type=number]:active,.metadata-property input[type=number]:focus,.metadata-property input[type=number]:hover,.metadata-property input[type=text]:active,.metadata-property input[type=text]:focus,.metadata-property input[type=text]:hover{box-shadow:none;border:none}.metadata-property .metadata-input-number,.metadata-property .metadata-input-text,.metadata-property .multi-select-container{background-color:transparent}.metadata-property .metadata-input-number:hover,.metadata-property .metadata-input-text:hover,.metadata-property .multi-select-container:hover{background-color:transparent}.metadata-property .metadata-input-number:active,.metadata-property .metadata-input-number:focus,.metadata-property .metadata-input-number:focus-within,.metadata-property .metadata-input-text:active,.metadata-property .metadata-input-text:focus,.metadata-property .metadata-input-text:focus-within,.metadata-property .multi-select-container:active,.metadata-property .multi-select-container:focus,.metadata-property .multi-select-container:focus-within{background-color:transparent}.metadata-property .metadata-input-text{text-overflow:ellipsis;overflow:hidden}.metadata-property .multi-select-container input{background-color:transparent}.metadata-property .multi-select-container{padding:var(--size-4-1) var(--size-4-2)}.metadata-property[data-property-key=tags]{--pill-color:var(--tag-color);--pill-color-hover:var(--tag-color-hover);--pill-color-remove:var(--tag-color);--pill-color-remove-hover:var(--tag-color-hover);--pill-decoration:var(--tag-decoration);--pill-decoration-hover:var(--tag-decoration-hover);--pill-background:var(--tag-background);--pill-background-hover:var(--tag-background-hover);--pill-border-color:var(--tag-border-color);--pill-border-color-hover:var(--tag-border-color-hover);--pill-border-width:var(--tag-border-width);--pill-padding-x:var(--tag-padding-x);--pill-padding-y:var(--tag-padding-y);--pill-radius:var(--tag-radius);--pill-weight:var(--tag-weight);--pill-focus-width:100%;--pill-focus-left-adjust:0}.metadata-property[data-property-key=tags] .multi-select-pill{cursor:var(--cursor-link)}.metadata-property:not([data-property-key=tags]){--pill-border-width:0;--pill-padding-x:0;--pill-padding-y:0;--pill-color:var(--metadata-input-text-color)}.metadata-property:not([data-property-key=tags]) .multi-select-pill{line-height:var(--line-height-tight)}.metadata-property-warning-icon{--icon-size:var(--icon-s);position:absolute;inset-inline-end:var(--size-2-1);top:var(--size-2-1);bottom:var(--size-2-1);align-items:center;display:flex;color:var(--text-warning)}.metadata-property-value{display:flex;flex:1 1 auto;gap:var(--size-2-2);align-items:center;align-self:stretch;font-family:var(--metadata-input-font);min-height:var(--input-height);background-color:var(--metadata-input-background);border-bottom:var(--metadata-divider-width) solid var(--metadata-divider-color);overflow:hidden}.metadata-property-value.mod-external-link:not(:placeholder-shown){text-decoration-line:var(--link-decoration);text-decoration-thickness:var(--link-decoration-thickness);text-decoration-color:var(--text-faint)}.metadata-property-value .mod-unknown{color:var(--text-warning);padding:var(--size-4-1) var(--size-4-2);font-size:var(--metadata-input-font-size);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.metadata-property-value .multi-select-input{font-size:inherit}.metadata-property-value .metadata-link-inner,.metadata-property-value .multi-select-container,.metadata-property-value input{font-size:var(--metadata-input-font-size)}.metadata-property-value .multi-select-container{--background-modifier-form-field:transparent;--background-modifier-border:transparent;align-items:center}.metadata-property-value .multi-select-container .multi-select-pill.is-invalid{--pill-background:transparent;--pill-color:var(--text-error);--pill-color-remove:var(--text-error)}.metadata-property-value .external-link.multi-select-pill-content,.metadata-property-value .internal-link .multi-select-pill-content{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.metadata-property-value .clickable-icon{--icon-size:var(--icon-xs);--icon-stroke:var(--icon-xs-stroke-width);margin-inline:-4px 2px;padding:4px}.metadata-property-value .clickable-icon:hover{background:0 0;color:var(--text-normal);cursor:var(--cursor-link)}.metadata-property-value:focus-within{background-color:var(--metadata-input-background-active)}.metadata-input-longtext{cursor:text;white-space:pre-wrap;-webkit-box-orient:vertical;-webkit-line-clamp:3;color:var(--metadata-input-text-color);font-size:var(--metadata-input-font-size);max-height:300px;overflow-y:auto;padding:var(--size-4-1) var(--size-4-2);width:100%}.metadata-input-longtext:focus{-webkit-line-clamp:unset}.metadata-input-longtext:not(:empty){display:-webkit-box}.metadata-input-longtext:empty::before{content:attr(placeholder);color:var(--text-faint)}.metadata-link{cursor:text;align-items:center;padding:var(--size-4-1) var(--size-4-2);display:flex;gap:var(--size-4-2);width:100%}.metadata-link-inner{cursor:var(--cursor-link);color:var(--link-color);text-decoration-line:var(--link-decoration);text-decoration-thickness:var(--link-decoration-thickness);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.metadata-link-flair{--icon-size:var(--icon-xs);background-color:transparent;cursor:text;margin-inline-start:auto;display:flex;align-items:center;justify-content:center;padding:var(--size-2-1);border-radius:var(--clickable-icon-radius);color:var(--icon-color);opacity:0;transition:opacity .15s ease-in-out;height:auto}.markdown-preview-view.show-properties .metadata-container{display:var(--metadata-display-reading)}.markdown-rendered li h1,.markdown-rendered li h2,.markdown-rendered li h3,.markdown-rendered li h4,.markdown-rendered li h5{margin-top:0;margin-bottom:0}h1,h2,h3,h4,h5,h6{margin-block-start:var(--p-spacing);margin-block-end:var(--p-spacing)}.markdown-rendered h1,h1{--font-weight:var(--h1-weight);font-variant:var(--h1-variant);letter-spacing:-.015em;line-height:var(--h1-line-height);font-size:var(--h1-size);color:var(--h1-color);font-weight:var(--font-weight);font-style:var(--h1-style);font-family:var(--h1-font)}.markdown-rendered h1 a,h1 a{--link-weight:var(--h1-weight)}.markdown-rendered h2,h2{--font-weight:var(--h2-weight);font-variant:var(--h2-variant);letter-spacing:-.015em;line-height:var(--h2-line-height);font-size:var(--h2-size);color:var(--h2-color);font-weight:var(--font-weight);font-style:var(--h2-style);font-family:var(--h2-font)}.markdown-rendered h2 a,h2 a{--link-weight:var(--h2-weight)}.markdown-rendered h3,h3{--font-weight:var(--h3-weight);font-variant:var(--h3-variant);letter-spacing:-.015em;line-height:var(--h3-line-height);font-size:var(--h3-size);color:var(--h3-color);font-weight:var(--font-weight);font-style:var(--h3-style);font-family:var(--h3-font)}.markdown-rendered h3 a,h3 a{--link-weight:var(--h3-weight)}.markdown-rendered h4,h4{--font-weight:var(--h4-weight);font-variant:var(--h4-variant);letter-spacing:.015em;line-height:var(--h4-line-height);font-size:var(--h4-size);color:var(--h4-color);font-weight:var(--font-weight);font-style:var(--h4-style);font-family:var(--h4-font)}.markdown-rendered h4 a,h4 a{--link-weight:var(--h4-weight)}.markdown-rendered h5,h5{--font-weight:var(--h5-weight);font-variant:var(--h5-variant);letter-spacing:.015em;font-size:var(--h5-size);line-height:var(--h5-line-height);color:var(--h5-color);font-weight:var(--font-weight);font-style:var(--h5-style);font-family:var(--h5-font)}.markdown-rendered h5 a,h5 a{--link-weight:var(--h5-weight)}.markdown-rendered h6,h6{--font-weight:var(--h6-weight);font-variant:var(--h6-variant);letter-spacing:.015em;font-size:var(--h6-size);line-height:var(--h6-line-height);color:var(--h6-color);font-weight:var(--font-weight);font-style:var(--h6-style);font-family:var(--h6-font)}.markdown-rendered h6 a,h6 a{--link-weight:var(--h6-weight)}hr{border-right-width:initial;border-bottom-width:initial;border-left-width:initial;border-right-style:none;border-bottom-style:none;border-left-style:none;border-image:initial;border-color:var(--hr-color);margin:2rem 0}.markdown-rendered hr{border-right-width:initial;border-bottom-width:initial;border-left-width:initial;border-right-style:none;border-bottom-style:none;border-left-style:none;border-image:initial;border-color:var(--hr-color)}.markdown-preview-view img,.markdown-rendered img{image-rendering:-webkit-optimize-contrast}.markdown-preview-view img:not([width]),.markdown-rendered img:not([width]){max-width:100%;outline:0}.internal-query{margin:0;border-top:1px solid var(--background-modifier-border)}.internal-query .search-result-container{padding:var(--size-4-2);max-height:800px;overflow:auto;border:1px solid var(--background-modifier-border);background-color:var(--background-secondary);border-radius:var(--radius-m)}ol ol ul,ol ul,ol ul ul,ul ol ul,ul ul,ul ul ul{list-style-type:disc}ol{list-style-type:var(--list-numbered-style)}ol>li,ul>li{text-align:start}ol>li::marker,ul>li::marker{color:var(--list-marker-color)}ol>li.is-collapsed::marker,ul>li.is-collapsed::marker{color:var(--list-marker-color-collapsed)}.markdown-rendered ol,.markdown-rendered ul{padding-inline-start:0px;margin-block-start:var(--p-spacing);margin-block-end:var(--p-spacing)}.markdown-rendered ol ol,.markdown-rendered ol ul,.markdown-rendered ul ol,.markdown-rendered ul ul{margin-block:0px}.markdown-rendered ol li p:first-of-type,.markdown-rendered ul li p:first-of-type{margin-block-start:0px}.markdown-rendered ol li p:last-of-type,.markdown-rendered ul li p:last-of-type{margin-block-end:0px}.markdown-rendered ol>li,.markdown-rendered ul>li{padding-top:var(--list-spacing);padding-bottom:var(--list-spacing);position:relative}.markdown-rendered ul>li{margin-inline-start:3ch}.markdown-rendered ol>li{margin-inline-start:3ch}.markdown-rendered ol ol>li,.markdown-rendered ul ul>li{margin-inline-start:var(--list-indent)}.markdown-rendered .list-collapse-indicator{margin-inline-start:-2.65em;padding-inline-end:2em}.markdown-rendered .list-bullet{float:inline-start;margin-inline-start:-.8em}.markdown-rendered .task-list-item>.list-bullet{display:none}.markdown-rendered ul.has-list-bullet{list-style-type:"â€‹"}.markdown-rendered ul.has-list-bullet>li::marker{color:transparent}.list-bullet{color:transparent;position:relative;display:inline-flex;justify-content:center;align-items:center}.list-bullet::before{content:"â€‹"}.list-bullet::after{position:absolute;content:"â€‹";pointer-events:none;color:var(--list-marker-color);border-radius:var(--list-bullet-radius);width:var(--list-bullet-size);height:var(--list-bullet-size);border:var(--list-bullet-border);transform:var(--list-bullet-transform);background-color:var(--list-marker-color);transition:transform .15s,box-shadow .15s}.list-bullet::selection{background-color:transparent!important}a{--font-weight:var(--link-weight);color:var(--link-color);font-weight:var(--link-weight);outline:0;text-decoration-line:var(--link-decoration);text-decoration-thickness:var(--link-decoration-thickness);cursor:var(--cursor-link);transition:opacity .15s ease-in-out}.external-link{color:var(--link-external-color);text-decoration-line:var(--link-external-decoration);background-position:right .25em;background-repeat:no-repeat;background-image:linear-gradient(transparent,transparent),url("https://publish.obsidian.md/public/images/6155340132a851f6089e.svg");background-size:.825em;padding-inline-end:0.9em;cursor:var(--cursor-link);filter:var(--link-external-filter);transition:opacity .15s ease-in-out}@supports selector(:dir(rtl)){:dir(rtl) .external-link{background-position:left center;background-image:linear-gradient(transparent,transparent),url("https://publish.obsidian.md/public/images/2308ab1944a6bfa5c5b8.svg");background-repeat:no-repeat}}.markdown-rendered .internal-link,.metadata-container .internal-link{cursor:var(--cursor-link);text-decoration-line:var(--link-decoration);color:var(--link-color);transition:opacity .15s ease-in-out}.markdown-rendered .internal-link.is-unresolved,.metadata-container .internal-link.is-unresolved{color:var(--link-unresolved-color);opacity:var(--link-unresolved-opacity);filter:var(--link-unresolved-filter);text-decoration-style:var(--link-unresolved-decoration-style);text-decoration-color:var(--link-unresolved-decoration-color)}.inline-block{display:inline-block;vertical-align:middle}.hidden-token{display:inline;letter-spacing:-1ch;font-family:monospace;color:transparent;font-size:1px!important}mjx-container{outline:0}a.tag{background-color:var(--tag-background);border:var(--tag-border-width) solid var(--tag-border-color);border-radius:var(--tag-radius);color:var(--tag-color);font-size:var(--tag-size);font-weight:var(--tag-weight);text-decoration:var(--tag-decoration);padding:var(--tag-padding-y) var(--tag-padding-x);line-height:1}a.tag{background-color:var(--tag-background);border:var(--tag-border-width) solid var(--tag-border-color);border-radius:var(--tag-radius);color:var(--tag-color);font-size:var(--tag-size);font-weight:var(--tag-weight);text-decoration:var(--tag-decoration);padding:var(--tag-padding-y) var(--tag-padding-x);line-height:1}input[type=checkbox]{appearance:none;border-radius:var(--checkbox-radius);border:1px solid var(--checkbox-border-color);flex-shrink:0;padding:0;margin:0;margin-inline-end:6px;width:var(--checkbox-size);height:var(--checkbox-size);position:relative;transition:box-shadow .15s ease-in-out}input[type=checkbox]:active,input[type=checkbox]:focus,input[type=checkbox]:hover{outline:0;border-color:var(--checkbox-border-color-hover)}input[type=checkbox]:focus-visible{box-shadow:0 0 0 2px var(--background-modifier-border-focus)}input[type=checkbox]:checked::after{content:"";top:-1px;inset-inline-start:-1px;position:absolute;width:var(--checkbox-size);height:var(--checkbox-size);display:block;background-color:var(--checkbox-marker-color);mask-position:52% 52%;mask-size:65%;mask-repeat:no-repeat;mask-image:url("data:image/svg+xml; utf8, <svg width=\"12px\" height=\"10px\" viewBox=\"0 0 12 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g transform=\"translate(-4.000000, -6.000000)\" fill=\"%23000000\"><path d=\"M8.1043257,14.0367999 L4.52468714,10.5420499 C4.32525014,10.3497722 4.32525014,10.0368095 4.52468714,9.8424863 L5.24777413,9.1439454 C5.44721114,8.95166768 5.77142411,8.95166768 5.97086112,9.1439454 L8.46638057,11.5903727 L14.0291389,6.1442083 C14.2285759,5.95193057 14.5527889,5.95193057 14.7522259,6.1442083 L15.4753129,6.84377194 C15.6747499,7.03604967 15.6747499,7.35003511 15.4753129,7.54129009 L8.82741268,14.0367999 C8.62797568,14.2290777 8.3037627,14.2290777 8.1043257,14.0367999\"></path></g></g></svg>")}input[type=checkbox]:checked{background-color:var(--checkbox-color);border-color:var(--checkbox-color)}input[type=checkbox][data-indeterminate=true]:not(:checked)::after{content:"";position:absolute;top:calc(var(--checkbox-size)/ 2 - 2px);width:calc(var(--checkbox-size) - 6px);left:0;right:0;margin:0 auto;height:2px;display:block;border-radius:2px;background-color:var(--text-normal)}.task-list-item-checkbox{width:var(--checkbox-size);height:var(--checkbox-size)}.markdown-preview-view .task-list-item-checkbox{position:relative;top:.2em;margin-inline-end:.6em}ul>li.task-list-item{list-style:none}ul>li.task-list-item>.task-list-item-checkbox{margin-inline-start:calc(var(--checkbox-size) * -1.5)}ul>li.task-list-item[data-task="X"],ul>li.task-list-item[data-task="x"]{text-decoration:var(--checklist-done-decoration);color:var(--checklist-done-color)}b,strong{font-weight:calc(var(--font-weight) + var(--bold-modifier));color:var(--bold-color)}b a,strong a{font-weight:calc(var(--link-weight) + var(--bold-modifier))}em,i{font-style:italic;color:var(--italic-color)}.markdown-rendered p{margin-block-start:var(--p-spacing);margin-block-end:var(--p-spacing);unicode-bidi:plaintext}.markdown-rendered mark{background-color:var(--text-highlight-bg);color:var(--text-normal)}.markdown-rendered mark .internal-link{color:var(--text-normal)}.outgoing-link-pane{padding-top:var(--size-4-3)}.view-action.mod-bookmarked{--icon-color:var(--icon-color-active);--icon-color-hover:var(--icon-color-active)}.nav-files-container{flex-grow:1;overflow:hidden auto;padding:var(--size-4-1) var(--size-4-3) var(--size-4-6) var(--size-4-3);scroll-padding-block:var(--size-4-2)}.nav-file-tag{background-color:var(--background-modifier-hover);border-radius:var(--radius-s);font-size:9px;font-weight:var(--font-semibold);letter-spacing:.05em;line-height:var(--line-height-normal);margin-inline-start:var(--size-2-3);padding:0 var(--size-4-1);text-transform:uppercase;align-self:center}.nav-file-icon{display:inline-flex;align-items:center;margin-inline-end:var(--size-2-3);position:relative;color:var(--icon-color);opacity:var(--icon-opacity)}.nav-files-container:not(.show-unsupported) .is-unsupported{display:none}.nav-file-title-content,.nav-folder-title-content{display:inline-block;overflow-wrap:anywhere;overflow:hidden;white-space:var(--nav-item-white-space)}.nav-folder.is-being-dragged-over{border-radius:var(--radius-s);background:hsla(var(--interactive-accent-hsl),.1)}.nav-folder.is-being-dragged-over>.nav-folder-title{color:var(--nav-item-color-highlighted)}.nav-folder.is-being-dragged-over>.nav-folder-title .collapse-icon{color:var(--nav-item-color-highlighted)}.nav-folder-title{padding:var(--nav-item-parent-padding)}.nav-file-title{padding:var(--nav-item-padding)}.nav-file-title,.nav-folder-title{margin-bottom:var(--size-2-1);display:flex;border-radius:var(--radius-s);cursor:var(--cursor);color:var(--nav-item-color);font-size:var(--nav-item-size);font-weight:var(--nav-item-weight);line-height:var(--line-height-tight)}.nav-file-title.is-active,.nav-folder-title.is-active,body:not(.is-grabbing) .nav-file-title.is-active:hover,body:not(.is-grabbing) .nav-folder-title.is-active:hover{color:var(--nav-item-color-active);background-color:var(--nav-item-background-active);font-weight:var(--nav-item-weight-active)}.nav-file-title.is-selected,.nav-folder-title.is-selected,body:not(.is-grabbing) .nav-file-title.is-selected:hover,body:not(.is-grabbing) .nav-folder-title.is-selected:hover{color:var(--nav-item-color-selected);background-color:var(--nav-item-background-selected)}.nav-file-title.is-being-dragged,.nav-folder-title.is-being-dragged,body:not(.is-grabbing) .nav-file-title.is-being-dragged,body:not(.is-grabbing) .nav-folder-title.is-being-dragged{background-color:var(--interactive-accent);color:var(--text-on-accent)}.nav-file-title.is-being-dragged .tree-item-icon.collapse-icon,.nav-folder-title.is-being-dragged .tree-item-icon.collapse-icon,body:not(.is-grabbing) .nav-file-title.is-being-dragged .tree-item-icon.collapse-icon,body:not(.is-grabbing) .nav-folder-title.is-being-dragged .tree-item-icon.collapse-icon{color:var(--text-on-accent)}.nav-file-title.is-being-dragged .nav-file-tag,.nav-folder-title.is-being-dragged .nav-file-tag,body:not(.is-grabbing) .nav-file-title.is-being-dragged .nav-file-tag,body:not(.is-grabbing) .nav-folder-title.is-being-dragged .nav-file-tag{color:var(--text-normal)}.file-tree-item-checkbox,.file-tree-item-icon{flex-shrink:0}.file-tree-item-title{flex-grow:1;word-break:break-word}.file-tree-item-icon{--icon-size:var(--icon-s);--icon-stroke:var(--icon-s-stroke-width);margin-right:var(--size-4-1);color:var(--icon-color);position:relative;top:var(--size-2-1)}.file-tree .tree-item-inner{display:flex;align-items:center;position:relative;width:100%}.file-tree .tree-item-flair{line-height:1;padding:var(--size-2-1) var(--size-2-3);color:var(--text-on-accent)}.file-tree .is-selected{color:var(--text-normal)}.file-tree .mod-changed.is-selected{background-color:hsla(var(--interactive-accent-hsl),.2)}.file-tree .mod-changed .tree-item-flair{color:var(--text-accent-hover)}.file-tree .mod-new.is-selected{background-color:rgba(var(--background-modifier-success-rgb),.2)}.file-tree .mod-new .tree-item-flair{color:var(--text-success)}.file-tree .mod-deleted.is-selected,.file-tree .mod-to-delete.is-selected{background-color:rgba(var(--background-modifier-error-rgb),.2)}.file-tree .mod-deleted .tree-item-flair,.file-tree .mod-to-delete .tree-item-flair{color:var(--text-error)}.file-tree .mod-to-delete .tree-item-flair{display:none}.file-tree .mod-to-delete.is-selected .tree-item-flair{display:block}.file-tree .clickable-icon{display:flex;--icon-size:var(--icon-s);--icon-stroke:var(--icon-s-stroke-width)}.file-recovery-list-item-container{overflow:auto;flex:1 1 0px}.file-recovery-list{overflow:auto;padding:var(--size-4-3) var(--size-4-2);flex-grow:1;display:flex;flex-direction:column}.file-recovery-list .search-input-container{width:100%}.file-recovery-list-container{display:flex;flex-direction:column;flex-basis:250px;flex-shrink:0;border-inline-end:1px solid var(--background-modifier-border)}.graph-view.color-fill{color:var(--graph-node)}.graph-view.color-fill-focused{color:var(--graph-node-focused)}.graph-view.color-fill-tag{color:var(--graph-node-tag)}.graph-view.color-fill-attachment{color:var(--graph-node-attachment)}.graph-view.color-fill-unresolved{color:var(--graph-node-unresolved);opacity:.5}.graph-view.color-fill-1{color:var(--text-muted)}.graph-view.color-fill-2{color:var(--text-muted)}.graph-view.color-fill-3{color:var(--text-muted)}.graph-view.color-fill-4{color:var(--text-muted)}.graph-view.color-fill-5{color:var(--text-muted)}.graph-view.color-fill-6{color:var(--text-muted)}.graph-view.color-arrow{color:var(--text-normal);opacity:.5}.graph-view.color-circle{color:var(--graph-node-focused)}.graph-view.color-line{color:var(--graph-line)}.graph-view.color-text{color:var(--graph-text)}.graph-view.color-fill-highlight{color:var(--interactive-accent)}.graph-view.color-line-highlight{color:var(--interactive-accent)}.graph-controls{border-radius:var(--radius-m);position:absolute;inset-inline-end:var(--size-4-3);top:var(--size-4-3);padding:0;background-color:var(--background-primary);width:var(--graph-controls-width);overflow:auto}.graph-controls:not(.is-close){max-height:calc(100% - var(--size-4-4));border:1px solid var(--background-modifier-border);box-shadow:var(--shadow-s)}.graph-controls.is-close{min-width:inherit;width:auto;background-color:var(--background-primary);border:1px solid transparent;padding:var(--size-2-3)}.graph-controls.is-close>.graph-control-section{display:none}.graph-controls input[type=range],.graph-controls input[type=text]{width:100%;font-size:var(--font-ui-small)}.graph-controls .mod-cta{margin-top:var(--size-2-3);width:100%}.graph-controls::-webkit-scrollbar,.graph-controls::-webkit-scrollbar-thumb{display:none}.graph-color-group{--swatch-height:18px;--swatch-width:18px;position:relative;display:flex;align-items:center;padding:0 0 6px;transition:top .2s ease-in-out}.graph-color-group input[type=color]{margin:0 2px 0 6px}.graph-color-group .clickable-icon{padding:var(--size-2-2)}.graph-color-button-container{text-align:center;margin-bottom:10px}.graph-color-button-container button{margin:0;width:100%}.graph-control-section.mod-color-groups .tree-item-children.is-grabbing .graph-color-groups-container{padding-bottom:40px}.graph-controls-button{display:none;z-index:1}.graph-controls-button.mod-close,.graph-controls-button.mod-reset{position:absolute;top:var(--size-4-2);inset-inline-end:var(--size-4-2);padding:var(--size-2-2)}.graph-controls:not(.is-close) .graph-controls-button.mod-close,.graph-controls:not(.is-close) .graph-controls-button.mod-reset{display:flex}.graph-controls-button.mod-reset{inset-inline-end:36px}.graph-controls.is-close .graph-controls-button.mod-open{display:flex}.graph-controls-button.mod-animate{margin-top:var(--size-4-2)}.graph-controls.is-close .graph-controls-button.mod-animate{display:flex}.graph-control-section{padding:var(--size-2-3) var(--size-4-3);border-bottom:1px solid var(--background-modifier-border)}.graph-control-section:last-child{border-bottom:none}.graph-control-section:last-child .tree-item-children{padding-bottom:var(--size-4-4)}.graph-control-section>.tree-item-self{padding-inline-start:var(--size-4-4)}.graph-control-section .tree-item-children{margin:0;padding:var(--size-4-1) 0;border-inline-start:none}.metadata-container{container:metadata/inline-size}@container (width < 250px){.metadata-property{flex-wrap:wrap}.metadata-property .metadata-property-key{width:100%;border-bottom:0}.metadata-property .metadata-property-value{margin-top:-2px;padding-inline-start:calc(var(--icon-size) + var(--size-4-1))}}.site-list-container{border-top:1px solid var(--background-modifier-border);margin-bottom:var(--size-4-4)}.site-list-container .list-item:last-child{padding-top:var(--size-4-4)}.site-list-item-name{flex-grow:1}.slug-input{text-transform:lowercase}.passwords-container{margin-bottom:var(--size-4-4)}.password-item{border-radius:var(--radius-s);padding:var(--size-4-2) var(--size-4-4);margin:var(--size-4-1) 0}.tree-item.mod-custom-nav.hidden .tree-item-self{color:var(--text-faint)}.tree-item.mod-custom-nav .tree-item-inner{display:flex;align-items:center;position:relative}.tree-list{padding:var(--size-4-4) 0}.tree-list-title{font-size:var(--font-ui-medium);font-weight:var(--font-semibold)}.tree-list-action{align-items:center;display:flex;color:var(--text-muted);font-size:var(--font-ui-small)}.search-input-container{position:relative}.search-input-container::before{top:calc((var(--input-height) - var(--search-icon-size))/ 2);inset-inline-start:var(--size-4-2);position:absolute;content:"";height:var(--search-icon-size);width:var(--search-icon-size);display:block;background-color:var(--search-icon-color);mask-image:url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='11' cy='11' r='8'></circle><line x1='21' y1='21' x2='16.65' y2='16.65'></line></svg>");mask-repeat:no-repeat}.search-input-container input{display:block;width:100%;padding-inline-start:36px}.search-input-clear-button{position:absolute;background:0 0;border-radius:50%;color:var(--search-clear-button-color);cursor:var(--cursor);top:0;inset-inline-end:2px;bottom:0;line-height:0;height:var(--input-height);width:28px;margin:auto;padding:0;text-align:center;display:flex;justify-content:center;align-items:center;transition:color .15s ease-in-out}.search-input-clear-button::after{content:"";height:var(--search-clear-button-size);width:var(--search-clear-button-size);display:block;background-color:currentcolor;mask-image:url("data:image/svg+xml,<svg viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M6 12C9.31371 12 12 9.31371 12 6C12 2.68629 9.31371 0 6 0C2.68629 0 0 2.68629 0 6C0 9.31371 2.68629 12 6 12ZM3.8705 3.09766L6.00003 5.22718L8.12955 3.09766L8.9024 3.8705L6.77287 6.00003L8.9024 8.12955L8.12955 8.9024L6.00003 6.77287L3.8705 8.9024L3.09766 8.12955L5.22718 6.00003L3.09766 3.8705L3.8705 3.09766Z' fill='currentColor'/></svg>");mask-repeat:no-repeat}.search-input-clear-button:active,.search-input-clear-button:hover{color:var(--text-normal);transition:color .15s ease-in-out}.search-input-suggest-button{position:absolute;left:0;top:0;color:var(--text-faint);cursor:var(--cursor);padding:var(--size-4-1) var(--size-4-2);opacity:0;z-index:10}.search-result-container{padding:var(--size-4-3) var(--size-4-3) var(--size-4-4);position:relative;flex:1 0 0px}.search-result-container.mod-global-search{overflow-y:auto}.search-result-container::before{content:" ";position:absolute;top:0;width:0;height:3px}.search-suggest-info-text{color:var(--text-muted);margin-inline-start:4px}.search-suggest-icon{padding:4px;border-radius:var(--radius-s)}.search-suggest-icon{align-items:center;display:flex}.search-suggest-item{padding:var(--size-4-1) var(--size-4-2);border-radius:var(--radius-s)}.search-suggest-item.mod-group{align-items:center;margin:0;color:var(--text-muted);padding:0 0 0 var(--size-4-2);cursor:default;font-weight:var(--font-semibold);font-size:var(--font-ui-smaller);border-radius:0}.search-suggest-item.mod-group:not(:first-child){border-top:1px solid var(--background-modifier-border);margin-top:6px;padding-top:6px;padding-inline:14px 6px;padding-bottom:0;margin-inline-end:-6px}.search-suggest-item.mod-group.is-selected,.search-suggest-item.mod-group:hover{background-color:initial}.search-empty-state{color:var(--text-faint);font-size:var(--font-ui-small);margin:0 0 var(--size-4-3);padding-inline-start:var(--size-4-2)}.search-result{word-break:break-word}.search-result:not(.is-collapsed) .search-result-file-title{color:var(--nav-item-color-active)}.search-result-file-matches{font-size:var(--font-ui-smaller);line-height:var(--line-height-tight);background-color:var(--search-result-background);border-radius:var(--radius-s);overflow:hidden;margin:var(--size-4-1) 0 var(--size-4-2);color:var(--text-muted);box-shadow:0 0 0 1px var(--background-modifier-border)}.search-result-file-matches:empty{display:none}.search-info-more-matches{color:var(--text-faint)}.search-result-file-match{cursor:var(--cursor);position:relative;padding:var(--size-4-2) var(--size-4-5) var(--size-4-2) var(--size-4-3);white-space:pre-wrap;width:100%;border-bottom:1px solid var(--background-modifier-border)}.search-result-file-match:last-child{border-bottom:none}.search-result-file-match-replace-button{display:none;position:absolute;height:auto;bottom:5px;inset-inline-end:24px;padding:var(--size-4-1) var(--size-4-2);color:var(--text-muted);font-size:var(--font-ui-smaller)}.search-result-hover-button{position:absolute;display:flex;inset-inline-end:2px;border-radius:var(--radius-s);color:var(--text-faint);padding:1px 3px}.search-result-hover-button.mod-top{top:2px}.search-result-hover-button.mod-bottom{bottom:2px}.search-result-file-matched-text{color:var(--text-normal);background-color:var(--text-highlight-bg)}.search-info-container{color:var(--text-muted);padding:var(--size-4-1) var(--size-4-4) var(--size-4-2);font-size:var(--font-ui-smaller)}.search-info-children{padding-inline-start:20px;border-inline-start:1px solid var(--background-modifier-border);margin:1px 0}.copy-search-result-container{display:flex;flex-direction:column}.copy-search-result-textarea{height:300px;max-height:20vh;resize:none}.search-result-file-match-destination-file-container{display:flex;flex-wrap:wrap;margin-top:var(--size-2-3);gap:var(--size-2-1)}.search-result-file-match-destination-file{display:inline-flex;background-color:var(--interactive-normal);border-radius:var(--radius-s);box-shadow:var(--input-shadow);color:var(--text-muted);padding:var(--size-2-2) var(--size-2-3)}.search-result-file-match-destination-file-icon{--icon-size:var(--icon-xs);--icon-stroke:var(--icon-xs-stroke-width);margin-inline-end:var(--size-4-1);display:flex;color:var(--text-faint)}.search-result-file-match-destination-file-icon .svg-icon{align-self:center}.search-result-file-match-destination-file-name{white-space:pre-wrap;word-break:break-all}.search-results-info{color:var(--text-muted);display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--background-modifier-border);margin:0;min-width:0;padding:0 var(--size-4-3) var(--size-4-2);white-space:nowrap}.search-results-result-count{font-size:var(--font-ui-smaller);font-variant-numeric:tabular-nums}.search-row{display:flex;margin:var(--size-4-3) var(--size-4-3) var(--size-4-2);gap:var(--size-4-1)}.search-params{margin:var(--size-4-1) var(--size-4-4)}.search-params input[type=range],.search-params input[type=text]{width:100%;font-size:var(--font-ui-small)}.search-params .mod-cta{margin-top:var(--size-2-3);width:100%}.search-params::-webkit-scrollbar,.search-params::-webkit-scrollbar-thumb{display:none}.global-search-input-container{flex-grow:1}.more-options-icon{--icon-size:10px;background-color:var(--icon-color);border-radius:50%;color:var(--background-secondary);display:flex;margin-inline-start:var(--size-2-3);opacity:var(--icon-opacity);padding:.5px}.clickable-icon:hover .more-options-icon{background-color:var(--icon-color-hover);opacity:var(--icon-opacity-hover)}.slides-container{position:fixed;top:0;inset-inline-start:0px;height:100vh;width:100vw;transition:-webkit-transform .8s;background-color:#191919;z-index:var(--layer-slides);border:none}.slides-container li .collapse-indicator{display:none}.slides-close-btn{display:inline-block;position:absolute;top:var(--size-4-2);inset-inline-end:var(--size-4-2);color:var(--text-faint);cursor:var(--cursor);z-index:1}.reveal input[type=checkbox]{width:24px;height:24px}.reveal .footnote-item,.reveal .task-list-item{list-style:none}.reveal .task-list-item{margin-inline-start:-1.5em}.recent-changes-container{padding:var(--size-4-3) var(--size-4-3) var(--size-4-8);overflow:hidden auto}.recent-changes-container .nav-folder-title{font-weight:var(--nav-heading-weight);color:var(--nav-heading-color)}.recent-changes-container .nav-folder-title:hover{font-weight:var(--nav-heading-weight)!important}.recent-changes-container .nav-folder-title .collapse-icon{display:none}.recent-changes-container .tree-item.nav-folder.is-collapsed .nav-folder-title{color:var(--nav-heading-color-collapsed)}.recent-changes-container .nav-folder-children{margin-bottom:var(--size-4-4)}.recent-changes-container .nav-file-title,.recent-changes-container .nav-folder-title{padding-inline-start:var(--size-4-2)}.recent-changes-container .tree-item-children{border-inline-start:unset;padding-inline-start:0px;margin-inline-start:0}.recent-changes-container .more-button{justify-content:center;color:var(--text-faint)}.tag-pane-tag.is-active{background-color:var(--interactive-accent);color:var(--text-on-accent)}.tag-pane-tag.is-active .tag-pane-tag-count{background-color:var(--background-modifier-hover);color:var(--text-normal)}.tag-container{font-size:var(--font-ui-small);padding:var(--size-4-3) var(--size-4-3) var(--size-4-8);overflow:auto}.tree-item-children .tag-pane-tag .tag-pane-tag-parent{display:none}.mod-canvas-color-1{--canvas-color:var(--canvas-color-1)}.mod-canvas-color-2{--canvas-color:var(--canvas-color-2)}.mod-canvas-color-3{--canvas-color:var(--canvas-color-3)}.mod-canvas-color-4{--canvas-color:var(--canvas-color-4)}.mod-canvas-color-5{--canvas-color:var(--canvas-color-5)}.mod-canvas-color-6{--canvas-color:var(--canvas-color-6)}body{--canvas-color:192,192,192}body.theme-dark{--canvas-color:126,126,126}.canvas-wrapper{position:absolute;width:100%;height:100%;left:0;top:0;--resizer-size:20px;--shadow-stationary:0px 0.5px 1px 0.5px rgba(0, 0, 0, 0.1);--shadow-drag:0px 2px 10px rgba(0, 0, 0, 0.1);--shadow-border-accent:0 0 0 2px var(--color-accent);--zoom-multiplier:1;background-color:var(--canvas-background);overflow:hidden;contain:strict;touch-action:none;user-select:none}.canvas-wrapper.is-dragging{cursor:grabbing}.canvas-wrapper.is-dragging iframe:not(.is-controlled),.canvas-wrapper.is-dragging webview{pointer-events:none}.canvas-wrapper.is-screenshotting{z-index:999999}.canvas-wrapper.is-screenshotting *{pointer-events:none!important}.canvas-mover{position:absolute;width:100%;height:100%;left:0;top:0;cursor:grab}.canvas-mover:active{cursor:grabbing}.canvas-background{position:absolute;width:100%;height:100%;left:0;top:0;pointer-events:none}.canvas-background circle{fill:var(--canvas-dot-pattern)}.canvas{position:absolute;width:100%;height:100%;left:0;top:0;transform-origin:0px 0px;pointer-events:none}.canvas>*{pointer-events:initial}.canvas-selection{pointer-events:none;position:absolute;background-color:hsla(var(--color-accent-hsl),.1);border:2px solid var(--color-accent);z-index:-1}.canvas-selection.mod-group-selection{border-width:3px;border-radius:3px;background-color:hsla(var(--color-accent-hsl),.03);border-color:hsla(var(--color-accent-hsl),.3);pointer-events:initial}.canvas-wrapper:not(.mod-readonly) .canvas-selection.mod-group-selection{cursor:grab}.canvas-wrapper:not(.mod-readonly) .canvas-selection.mod-group-selection:active{cursor:grabbing}.canvas-selection.mod-node-highlight{border-radius:var(--radius-m)}.canvas-controls{right:var(--size-4-2);top:var(--size-4-2);gap:var(--size-4-2);display:flex;flex-direction:column}.canvas-control-group{border-radius:var(--radius-s);background-color:var(--background-primary);border:1px solid var(--background-modifier-border);box-shadow:var(--input-shadow);display:flex;flex-direction:column;overflow:hidden}.canvas-control-item{border-radius:0;box-shadow:none;height:auto;display:flex;line-height:1;font-size:inherit;align-items:center;justify-content:center;cursor:var(--cursor);padding:var(--size-4-2);border-bottom:1px solid var(--background-modifier-border);color:var(--text-muted);background-color:var(--interactive-normal);--icon-size:var(--icon-s);--icon-stroke:var(--icon-s-stroke-width)}.canvas-control-item:last-child{border-bottom:none}.canvas-control-item.is-active{color:var(--color-accent)}.canvas-control-item.is-disabled svg{color:var(--text-faint)}.canvas-control-item svg{pointer-events:none}.canvas-node-container{background-color:var(--background-primary);border-radius:var(--radius-m);border:2px solid rgb(var(--canvas-color));contain:strict;display:flex;flex-direction:column;overflow:hidden;position:absolute;left:0;top:0;width:100%;height:100%;box-shadow:var(--shadow-stationary)}.canvas-node-label{position:absolute;left:0;top:calc(-1 * var(--size-4-1) * var(--zoom-multiplier));transform:translate(0,-100%) scale(var(--zoom-multiplier));transform-origin:left bottom;max-width:calc(100% / var(--zoom-multiplier));overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--canvas-card-label-color);--icon-size:1em}body:not(.is-ios) .canvas-wrapper.mod-animating .canvas-node-label{transition:transform .5s cubic-bezier(.16, 1, .3, 1)}.canvas-node-label svg{position:relative;top:2px;margin-right:var(--size-4-1)}.canvas-node-label.mod-hover-label{opacity:0}.canvas-wrapper.mod-zoomed-out .canvas-node-label{display:none}.canvas-node-placeholder{display:flex;align-items:center;justify-content:center;text-align:center;width:100%;height:100%;overflow:hidden;overflow-wrap:anywhere;padding:var(--size-4-6);font-size:32px;font-weight:var(--font-semibold)}.canvas-node-placeholder::after{border-radius:var(--radius-s);content:" ";display:block;position:absolute;top:var(--size-4-4);right:var(--size-4-4);bottom:var(--size-4-4);left:var(--size-4-4);background-color:rgba(var(--canvas-color),.1)}.canvas-icon-placeholder{display:flex;width:40%;height:40%}.canvas-icon-placeholder svg{opacity:.3;color:rgb(var(--canvas-color));width:100%;height:100%}.canvas-node-interaction-layer{position:absolute;width:0;height:0;pointer-events:none}.canvas-node-interaction-layer>*{pointer-events:initial}.canvas-node{--shadow-border-themed-inset:inset 0 0 0 1px rgb(var(--canvas-color));--shadow-border-themed:0 0 0 2px rgb(var(--canvas-color));position:absolute;width:0;height:0}.canvas-node.is-dragging{pointer-events:none}.canvas-node.is-dragging .canvas-node-container{box-shadow:var(--shadow-drag)}.canvas-node.is-focused,.canvas-node.is-selected{touch-action:initial}.canvas-node.is-focused .canvas-node-label,.canvas-node.is-selected .canvas-node-label{color:var(--text-muted)}.canvas-node.is-focused .canvas-node-container,.canvas-node.is-selected .canvas-node-container{border-color:var(--color-accent);box-shadow:var(--shadow-stationary),var(--shadow-border-accent)}.canvas-node.is-focused.is-dragging .canvas-node-container,.canvas-node.is-selected.is-dragging .canvas-node-container{box-shadow:var(--shadow-drag),var(--shadow-border-accent)}.canvas-node.is-themed .canvas-node-container{border-color:rgba(var(--canvas-color),.7);box-shadow:inset 0 0 0 1px rgba(var(--canvas-color),.7),var(--shadow-stationary)}.canvas-node.is-focused.is-themed .canvas-node-container,.canvas-node.is-selected.is-themed .canvas-node-container{border-color:rgb(var(--canvas-color));box-shadow:var(--shadow-border-themed-inset),var(--shadow-border-themed)}.canvas-node.is-focused.is-themed.is-dragging .canvas-node-container,.canvas-node.is-selected.is-themed.is-dragging .canvas-node-container{box-shadow:var(--shadow-border-themed-inset),var(--shadow-border-themed)}.canvas-node.is-dummy{cursor:grabbing}.canvas-node.is-dummy .canvas-node-container{border:4px solid var(--color-accent);box-shadow:rgba(0,0,0,.15) 0 2px 10px;background-color:hsla(var(--color-accent-hsl),.2)}.canvas-node.is-focused:not(.is-dragging) .canvas-node-content-blocker{display:none}.canvas-node-content-blocker{position:absolute;width:100%;height:100%;left:0;top:0;z-index:var(--layer-cover)}.canvas-node-group:not(.is-focused):not(.is-selected){pointer-events:none}.canvas-node-group .canvas-node-resizer{pointer-events:initial}.canvas-node-group .canvas-node-container{background-color:transparent}.canvas-node-group .canvas-node-content{background-color:rgba(var(--canvas-color),.07)}.canvas-group-label{position:absolute;left:0;top:calc(-1 * var(--size-4-1) * var(--zoom-multiplier));transform:translate(0,-100%) scale(var(--zoom-multiplier));transform-origin:left bottom;max-width:calc(100% / var(--zoom-multiplier));overflow:hidden;text-overflow:ellipsis;white-space:nowrap;pointer-events:initial;font-size:1.5em;padding:var(--size-4-1) var(--size-4-2);border-radius:var(--radius-s);color:var(--text-muted);background-color:rgba(var(--canvas-color),.1);line-height:1}body:not(.is-ios) .canvas-wrapper.mod-animating .canvas-group-label{transition:transform .5s cubic-bezier(.16, 1, .3, 1)}.canvas-wrapper:not(.mod-readonly) .canvas-group-label{cursor:grab}.canvas-wrapper:not(.mod-readonly) .canvas-group-label:active{cursor:grabbing}.canvas-node-content{width:100%;height:100%;overflow:hidden;position:relative}.canvas-node-content.markdown-embed{border:none;padding:0}.canvas-node-content.markdown-embed .inline-title{cursor:text}.canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view{padding:0 var(--size-4-6);display:flex;flex-direction:column}.canvas-wrapper:not(.mod-readonly) .canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view{user-select:none}.canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view::after,.canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view::before{content:" ";display:block;min-height:min(calc(var(--canvas-node-height) * .1 - 3px),var(--size-4-6));max-height:var(--size-4-4);flex:1 1 0px}.canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view>.markdown-preview-sizer{flex:1 0 0px}.canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view .callout{mix-blend-mode:normal}.is-focused .canvas-node-content.markdown-embed>.markdown-embed-content>.markdown-preview-view{transform:translateZ(0)}.canvas-node.is-themed .canvas-node-content{background-color:rgba(var(--canvas-color),.07)}.canvas-node-content.media-embed{justify-content:center;align-items:center;display:flex}.canvas-node-content.media-embed audio,.canvas-node-content.media-embed img,.canvas-node-content.media-embed video{flex-shrink:0;flex-grow:1}.canvas-node-content.media-embed audio,.canvas-node-content.media-embed img:not([width]),.canvas-node-content.media-embed video{max-width:100%}.canvas-node-resizer{position:absolute;height:calc(var(--resizer-size) * var(--zoom-multiplier));width:calc(var(--resizer-size) * var(--zoom-multiplier))}.is-selected .canvas-node-resizer{pointer-events:none}.canvas-wrapper.mod-readonly .canvas-node-resizer{display:none}.canvas-node-resizer[data-resize=top]{left:0;right:0;width:auto;top:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:ns-resize}.canvas-node-resizer[data-resize=bottom]{left:0;right:0;width:auto;bottom:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:ns-resize}.canvas-node-resizer[data-resize=left]{top:0;bottom:0;height:auto;left:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:ew-resize}.canvas-node-resizer[data-resize=right]{top:0;bottom:0;height:auto;right:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:ew-resize}.canvas-node-resizer[data-resize=topright]{right:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);top:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:nesw-resize}.canvas-node-resizer[data-resize=bottomright]{right:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);bottom:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:nwse-resize}.canvas-node-resizer[data-resize=topleft]{left:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);top:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:nwse-resize}.canvas-node-resizer[data-resize=bottomleft]{left:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);bottom:calc(var(--resizer-size) * var(--zoom-multiplier) * -.5);cursor:nesw-resize}.canvas-node-connection-point{width:calc(var(--resizer-size) * var(--zoom-multiplier));height:calc(var(--resizer-size) * var(--zoom-multiplier));position:absolute;pointer-events:all;cursor:pointer}.canvas-node-connection-point[data-side=top]{top:1px;left:calc(50% - var(--resizer-size) * var(--zoom-multiplier)/ 2)}.canvas-node-connection-point[data-side=right]{right:1px;top:calc(50% - var(--resizer-size) * var(--zoom-multiplier)/ 2)}.canvas-node-connection-point[data-side=bottom]{bottom:1px;left:calc(50% - var(--resizer-size) * var(--zoom-multiplier)/ 2)}.canvas-node-connection-point[data-side=left]{left:1px;top:calc(50% - var(--resizer-size) * var(--zoom-multiplier)/ 2)}.canvas-node-connection-point::after{content:" ";background-color:var(--color-accent);border-radius:50%;border:3px solid var(--background-modifier-border);box-sizing:border-box;display:block;height:calc(var(--resizer-size) * var(--zoom-multiplier));opacity:0;position:relative;width:calc(var(--resizer-size) * var(--zoom-multiplier));left:0;top:0}.canvas-snaps{position:absolute;width:100%;height:100%;left:0;top:0;overflow:visible;pointer-events:none;opacity:.6}.canvas-snaps line{stroke-width:1px;stroke:var(--color-accent)}.canvas-snaps circle{fill:var(--color-accent)}.canvas-edges{position:absolute;width:100%;height:100%;left:0;top:0;overflow:visible;pointer-events:none}.canvas-edges>*{pointer-events:initial}.canvas-edges path.canvas-display-path{pointer-events:none;stroke-width:calc(3px * var(--zoom-multiplier));stroke:rgb(var(--canvas-color));fill:none;transition:stroke-width .1s ease-out}.canvas-edges path.canvas-interaction-path{pointer-events:stroke;stroke-width:calc(24px * var(--zoom-multiplier));stroke-linecap:round;stroke:transparent;fill:none;transition:stroke .1s ease-out}.canvas-wrapper:not(.mod-readonly) .canvas-edges path.canvas-interaction-path{cursor:grab}.canvas-wrapper:not(.mod-readonly) .canvas-edges path.canvas-interaction-path:active{cursor:grabbing}.canvas-edges polygon.canvas-path-end{pointer-events:none;stroke:rgb(var(--canvas-color));fill:rgb(var(--canvas-color));stroke-linecap:round;stroke-linejoin:round;stroke-width:1px;transform-box:fill-box;transform:scale(var(--zoom-multiplier));transform-origin:center top}.canvas-edges g.is-focused path.canvas-display-path,.canvas:not(.is-connecting) .canvas-edges g:hover path.canvas-display-path{stroke-width:calc(5.5px * var(--zoom-multiplier))}.canvas-edges g.is-focused path.canvas-interaction-path,.canvas:not(.is-connecting) .canvas-edges g:hover path.canvas-interaction-path{stroke:rgba(var(--canvas-color),0.1)}.canvas-path-label-wrapper{position:absolute;width:fit-content;height:fit-content}.canvas-path-label{font-size:calc(var(--font-ui-large) * var(--zoom-multiplier));background-color:var(--background-primary);border-radius:var(--radius-s);padding:calc(var(--size-2-3) * var(--zoom-multiplier));line-height:var(--line-height-tight);white-space:pre-wrap;transform:translate(-50%,-50%);text-align:center;max-width:calc(17em * var(--zoom-multiplier))}.canvas-color-picker-item{cursor:var(--cursor);width:24px;height:24px;margin:2px;border-radius:12px;border:2px solid var(--background-primary);background-color:rgb(var(--canvas-color))}.canvas-color-picker-item.is-active{box-shadow:0 0 0 2px rgb(var(--canvas-color))}.canvas-color-picker-item input[type=color]{margin:-4px 0 0 -2px;--swatch-width:20px;--swatch-height:20px;opacity:0}.canvas-color-picker-item.canvas-color-picker-custom:not(.is-active){background:conic-gradient(var(--color-red),var(--color-yellow),var(--color-green),var(--color-blue),var(--color-purple),var(--color-red))}.canvas-empty-embed-container{align-items:center;display:flex;flex-direction:column;gap:var(--size-4-6);justify-content:center;height:100%;padding:var(--size-4-3);text-align:center}.canvas-empty-embed-action-list{display:flex;flex-direction:column;gap:var(--size-4-3)}.canvas-empty-embed-action-list button{font-size:var(--font-text-size);padding:var(--size-4-5) var(--size-4-9)}.canvas-help{display:flex;flex-direction:column;gap:var(--size-4-3)}.canvas-instruction{display:flex;justify-content:space-between}.canvas-instruction-desc{display:flex;gap:var(--size-4-1)}.canvas-minimap{width:100%;height:100%;padding:var(--size-4-1)}.inline-embed>.canvas-minimap{max-height:var(--embed-canvas-max-height)}.canvas-minimap rect{stroke-width:5px;stroke:var(--background-modifier-border);fill:var(--background-modifier-border);fill-opacity:0.65}.canvas-minimap rect.is-themed{stroke:rgb(var(--canvas-color));fill:rgb(var(--canvas-color));fill-opacity:0.5}.canvas-minimap path{stroke:rgb(192,192,192);fill:none}.canvas-minimap path.is-themed{stroke:rgb(var(--canvas-color))}.canvas-cursor{position:absolute;width:1px;height:1px;border:5px solid var(--color-accent);border-radius:5px;pointer-events:none}.canvas-watermark *{font-family:var(--font-default)!important}.webviewer-favicon-container{display:flex;align-items:center}.webviewer-favicon-container>*{height:var(--icon-size);max-width:var(--icon-size)}.view-action.mod-webviewer{--icon-color:var(--icon-color-active);--icon-color-hover:var(--icon-color-active)}.webviewer-container{height:100%;display:flex;flex-direction:column}.webviewer-address{width:100%;display:flex;margin:0 2px}.webviewer-address input{flex-grow:1;min-width:50px}.webviewer-address-container{padding:0 var(--size-4-2)}.webviewer-address-container::after{background:0 0!important}.view-content.webviewer-content{padding:0}.webviewer-content{border-top:1px solid var(--divider-color);height:100%;display:flex;flex-direction:column}.webviewer-content webview{flex-grow:1;width:100%}.webviewer-content .reader-mode-content{overflow-y:auto}.webviewer-content .reader-mode-content.is-readable-line-width .markdown-preview-sizer{max-width:var(--file-line-width);margin-left:auto;margin-right:auto}.webviewer-content .markdown-preview-view .external-link{background-image:none;padding-right:0}.webviewer-content .error-notice{max-width:var(--file-line-width);margin:25% auto 0;padding:var(--file-margins)}.webviewer-history-view-item{text-wrap:nowrap;overflow:hidden}textarea.webviewer-adblock-lists{flex-grow:1}.starter{user-select:none;padding-top:0!important}.starter-screen{display:flex;flex-direction:column;background-color:var(--background-primary);width:100%;height:100%}.starter-screen-inner{flex-grow:1;display:flex;height:calc(100% - 24px)}.splash{align-items:center;background-color:var(--background-primary);display:flex;flex-direction:column;justify-content:center;flex:1 1 auto;text-align:center;padding:36px 0 0}.splash-brand{flex:0 0 content;padding:20px 0}.splash-brand-logo-text{margin-top:20px;color:#fff}.splash-brand-version{color:var(--text-muted);margin-top:8px;font-size:var(--font-ui-small)}.help-options-container{flex:1 0 0px;overflow:auto;width:100%;max-width:82%;text-align:start;padding:var(--size-4-6) 0}.help-options-container::-webkit-scrollbar{display:none}.open-vault-options-container::-webkit-scrollbar{display:none}.quick-start-container{margin-bottom:10px}.quick-start-container button{font-size:var(--font-ui-medium);padding:8px 60px}.open-folder-input[type=text]{font-size:var(--font-ui-small);width:200px;height:28px}.browse-folder-button{margin-left:10px}.open-folder-button{margin-top:14px;padding:6px 36px}.starter .notice{top:38px}:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left);--safe-area-inset-right:env(safe-area-inset-right)}body.hide-cursor{caret-color:transparent!important}body.is-screenshotting ::-webkit-scrollbar{display:none}.mod-fade{--scroll-fade-offset-right:0;--scroll-fade-offset-left:0}.mod-fade:not(.mod-at-start)::before{content:" ";pointer-events:none;position:absolute;top:0;z-index:1;left:var(--scroll-fade-offset-left);width:30px;height:100%;background:linear-gradient(to right,var(--background-primary),transparent)}.mod-fade:not(.mod-at-end)::after{content:" ";position:absolute;pointer-events:none;top:0;right:var(--scroll-fade-offset-right);width:30px;height:100%;background:linear-gradient(to right,transparent,var(--background-primary))}.workspace-drawer .nav-buttons-container::-webkit-scrollbar,.workspace-drawer .nav-buttons-container::-webkit-scrollbar-thumb,.workspace-drawer .workspace-drawer-actions::-webkit-scrollbar,.workspace-drawer .workspace-drawer-actions::-webkit-scrollbar-thumb{visibility:hidden}.workspace-drawer-ribbon::-webkit-scrollbar,.workspace-drawer-ribbon::-webkit-scrollbar-thumb{visibility:hidden;width:0}.pull-action{position:absolute;background-color:var(--background-secondary);z-index:var(--layer-popover);color:var(--text-muted);font-size:90%;transition:background-color 150ms ease-in-out}.pull-action.mod-activated{background-color:var(--interactive-accent);color:var(--text-on-accent)}.pull-down-action{top:0;left:0;right:0;width:96%;max-width:500px;margin:var(--safe-area-inset-top) auto 0 auto;padding:var(--size-4-3) var(--size-4-4);text-align:center;border-radius:40px}.pull-out-action{top:50%;padding:var(--size-4-3) var(--size-4-4);border-radius:40px;margin:0 var(--size-4-4)}.mobile-toolbar-options-list::-webkit-scrollbar{width:0!important;height:0!important}.mobile-tab-preview-embed ::-webkit-scrollbar{display:none}</style><style></style><style>.theme-dark{--background-primary:#2f3136;--background-primary-alt:#36393f;--background-secondary:#141414;--background-secondary-alt:#222222;--text-normal:#5dbcd2;--text-faint:#999999;--text-muted:#aaaaaa;--text-selection:#164f92;--text-on-accent:#5dbcd2;--text-accent:#319cb4;--text-title-h1:#c7c400;--text-title-h2:#b9adff;--text-title-h3:#52c1da;--text-title-h4:#67c073;--text-title-h5:#de87ca;--text-title-h6:#b4b4b4;--text-link:#99ff99;--text-a:#d669bc;--text-a-hover:#ec9ad9;--text-mark:transparent;--pre-code:#40444d;--text-highlight-bg:rgba(252, 246, 1, 0.4);--interactive-accent:rgb(252, 246, 1, 0.95);--interactive-accent-muted:rgb(252, 246, 1, 0.55);--interactive-accent-hover:#9e8aff;--interactive-before:#5e6565;--interactive-hover:#36393f;--background-modifier-border:#595959;--blockquote-border:#9e8aff;--interactive-accent-rgb:#fe8019;--font-family-editor:Avenir,Avenir Next,var(--default-font),sans-serif;--font-family-preview:Avenir,Avenir Next,var(--default-font),sans-serif;--scrollbar-bg:rgb(20, 20, 20, 0.0);--scrollbar-thumb-bg:#595959;--background-modifier-error:#36393f;--background-modifier-success:#36393f;--background-modifier-form-field:#2f3136;--background-modifier-form-field-highlighted:#2f3136}#graph-view-canvas .links{stroke:var(--interactive-accent-rgb)!important}.theme-dark .graph-view.color-fill-tag{color:#5dbcd2}.theme-dark .graph-view.color-fill-attachment{color:#d669bc}.theme-dark .graph-view.color-fill-unresolved{color:#9e8aff;Opacity:1}.theme-dark .graph-view.color-arrow{color:#d669bc}.graph-view.color-fill{color:#fcf601}.graph-view.color-circle{color:#26798c}.graph-view.color-line{color:#26798c}.graph-view.color-text{color:#ccc}.graph-view.color-fill-highlight{color:#26798c}.graph-view.color-line-highlight{color:#5dbcd2}strong{color:#9e8aff;font-weight:700}em{color:#bac04f}mark{background-color:var(--text-mark)!important;padding-top:0;padding-bottom:0;padding-left:0;padding-right:0}.cm-s-obsidian span.cm-highlight{color:#6ce4ff;font-weight:500;background-color:transparent;text-shadow:0 0 .6em #fcf60159}.markdown-preview-view mark{color:#6ce4ff;font-weight:500;text-shadow:0 0 .6em #fcf60159}.modal-bg{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(252,246,1,.1)}.modal{background-color:var(--background-primary);border-radius:4px;border:1px solid var(--background-primary);box-shadow:0 2px 8px var(--background-modifier-box-shadow);padding:30px 50px;position:relative;min-width:560px}.vertical-tab-content{background-color:var(--background-primary);padding:5px 30px}.u-pop{color:var(--text-title-h2)}.mod-settings .setting-item{padding:0}.setting-item-name{color:#b9adff}.cm-s-obsidian span.cm-formatting-link{color:#d669bc!important}.markdown-preview-view blockquote{background-color:#222229;border:0 solid;border-color:#8272d0!important;border-left-width:2px!important;border-radius:0 0 0 0;font-family:var(--font-family-preview);font-size:.95em;color:#5dbcd2;line-height:1.5em;margin-top:10px;margin-left:10px;margin-right:10px;margin-bottom:20px}.cm-formatting-link,.cm-hmd-internal-link,.cm-link,.internal-link,a{color:var(--text-a)!important;text-decoration:none!important;font-family:var(--font-family-preview)!important}.internal-link:hover,a:hover{color:var(--text-a-hover)!important;text-decoration:none!important}a:not(.internal-link){font-style:italic}.cm-quote{color:var(--text-normal)!important}.cm-formatting.cm-formatting-quote.cm-formatting-quote-1.cm-quote.cm-quote-1{color:#9e8aff!important}blockquote{border-color:var(--blockquote-border)!important}.file-view-actions a{color:var(--text-muted)!important}.file-view-actions a:hover{color:var(--text-a)!important}.cm-tag{color:var(--text-accent)!important}pre code{padding:6px!important;line-height:normal;display:block;background-color:var(--pre-code)!important}.markdown-preview-view pre{padding:0!important}.cm-inline-code,code{background-color:var(--pre-code)!important;color:var(--text-muted)!important;bottom:0!important}.markdown-preview-view code{font-size:13.5px}th{font-weight:800!important}thead{border-bottom:4px solid var(--background-modifier-border)}.table{background-color:var(--background-secondary-alt);border:1px solid var(--background-modifier-border);padding:4px;line-height:normal;display:block;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:4px;border-bottom-left-radius:4px}img{display:block}.markdown-preview-view hr{background-color:var(--text-normal)}.reveal h1{color:var(--text-title-h1)}.reveal h2{color:var(--text-title-h2)}.reveal h3{color:var(--text-title-h3)}.reveal h4{color:var(--text-title-h4)}.reveal h5{color:var(--text-title-h5)}.reveal h6{color:var(--text-title-h6)}.markdown-preview-view .task-list-item-checkbox{-webkit-appearance:none;top:1.8px!important;box-sizing:border-box;border:1px solid #888;position:relative;width:1em;height:1em;margin:0;margin-right:.7em}.markdown-preview-view .task-list-item-checkbox:checked::before{content:'âœ“';position:absolute;color:#999;font-size:1em;line-height:1em;width:1em;text-align:center;text-shadow:0 0 .1em #8d8d8d}.markdown-preview-view .task-list-item-checkbox{top:0}.checkbox-container{background-color:#9196a1;border-radius:14px;display:inline-block;height:22px;position:relative;top:4px;user-select:none;width:42px;box-shadow:inset 0 1px 1px rgba(0,0,0,.15);transition:background .15s ease-in-out,box-shadow .15s ease-in-out,border .15s ease-in-out,opacity .15s ease-in-out,-webkit-box-shadow .15s ease-in-out}.checkbox-container.is-enabled{background-color:#5dbcd2}.list-item-ending-flair{position:absolute;top:7px;right:10px;font-size:12px;color:var(--text-accent);background-color:var(--background-secondary-alt);line-height:12px;border-radius:3px;padding:2px 4px}.list-item:hover .list-item-ending-flair{color:var(--text-accent);background-color:var(--background-secondary-alt)}button.mod-cta{background-color:#5dbcd2;color:#36393f}.cm-hmd-frontmatter{font-size:13px}.side-dock-ribbon{background-color:#141414}.side-dock-ribbon-tab-inner{background-color:#141414}.side-dock-ribbon-action{background-color:#141414}side-dock-ribbon-tab is-before-active{color:#141414;background-color:#141414}side-dock-ribbon-before is-before-active{color:#141414;background-color:#141414}side-dock-ribbon-tab-inner is-before-active{color:#141414;background-color:#141414}side-dock-ribbon-tab-inner{color:#141414;background-color:#141414}.side-dock-plugin-panel.mod-file-explorer,.side-dock-plugin-panel.mod-starred,.side-dock-ribbon-after.is-before-active,.side-dock-ribbon-before.is-before-active,.side-dock-ribbon-tab.is-after-active{background-color:#141414}side-dock-ribbon-tab-inner is-after-active{background-color:#141414}.side-dock-ribbon-tab.is-active{color:#ccc!important}.side-dock-title{background-color:#141414}.nav-buttons-container{background-color:#141414}.nav-header{background-color:#141414}.nav-folder-title{color:#ccc;background-color:#141414;font-weight:500;margin-top:0;margin-bottom:-2px}.nav-file-title{color:#999;background-color:#141414}.nav-folder-children{background-color:#141414}.search-result-file-matches{color:#999;background-color:#141414}.search-result-file-match:hover{color:#d669bc;background-color:#141414}.search-result-file-title{color:#5dbcd2;background-color:#141414}.search-result-file-title:hover{color:#d669bc;background-color:#333}.search-result-file-matched-text{color:#ccc;background-color:#141414}.search-result-container{color:#999;background-color:#141414}.side-dock-ribbon-tab.is-active .side-dock-ribbon-tab-inner:hover{color:var(--text-normal)!important;background-color:#1a1a1a}.side-dock-ribbon-tab.is-active .side-dock-ribbon-tab-inner:hover{color:#d669bc!important;background-color:#1a1a1a}.nav-file-tag{color:var(--text-normal)}.nav-file.is-active .nav-file-tag{color:var(--text-normal)}.side-dock-panels-container *{font-size:13px!important}.side-dock-plugin-panel-inner{background-color:#1a1a1a}.side-dock-title{font-size:20px!important;font-weight:800!important}.nav-action-button:hover,.side-dock-collapse-btn:hover,.side-dock-ribbon-action.is-active:hover,.side-dock-ribbon-action:hover,.side-dock-ribbon-tab-inner:hover,.side-dock-ribbon-tab:hover{color:var(--text-a)}.nav-file-title-content,.search-result-file-match,.search-result-file-title{padding-top:0!important;padding-bottom:0!important;line-height:normal!important;word-break:keep-all;font-size:14px}.search-empty-state{width:auto;padding-left:15px;padding-right:15px;line-height:normal}.app-container{font-family:var(--font-family-preview)}.status-bar-item{font-family:var(--font-family-preview);font-size:12px}.cm-s-obsidian{font-family:var(--font-family-editor);font-size:15px;color:var(--text-normal);padding-left:3%!important;padding-right:0!important}.mod-single-child .cm-s-obsidian{font-family:var(--font-family-editor);font-size:15px;color:var(--text-normal);padding-left:8%!important;padding-right:4%!important}.cm-header-1{font-family:var(--font-family-editor);font-weight:500;font-size:28px;font-weight:700;color:var(--text-title-h1)}.cm-header-2{font-family:var(--font-family-editor);font-weight:500;font-size:26px;font-weight:700;color:var(--text-title-h2)}.cm-header-3{font-family:var(--font-family-editor);font-weight:500;font-size:23px;font-weight:700;color:var(--text-title-h3)}.cm-header-4{font-family:var(--font-family-editor);font-weight:500;font-size:19px;font-weight:700;line-height:30px;color:var(--text-title-h4)}.cm-header-5{font-family:var(--font-family-editor);font-weight:500;font-size:18px;font-weight:700;line-height:30px;color:var(--text-title-h5)}.cm-header-6{font-family:var(--font-family-editor);font-weight:500;font-size:16px;font-weight:700;line-height:30px;color:var(--text-title-h6)}.cm-strong{color:#9e8aff;font-weight:700}.cm-em{color:#bac04f}.cm-s-obsidian span.cm-hashtag{color:#d669bc;text-decoration:underline}.cm-formatting-list{color:#fcf601;font-weight:700}.cm-formatting .cm-formatting-list-ul .cm-list-1 .cm-hashtag{color:#fcf601}.cm-meta cm-hashtag-end{color:#fcf601}.cm-meta cm-hashtag-end{color:#fcf601}.cm-s-obsidian span.cm-formatting-list{color:#b9adff!important}p{margin-block-start:0px}.markdown-preview-view{font-family:var(--font-family-preview);font-size:15px;color:var(--text-normal);padding-left:10%!important;padding-right:10%!important;line-height:22px}.mod-single-child .markdown-preview-view{font-family:var(--font-family-preview);font-size:15px;color:var(--text-normal);padding-left:10%!important;padding-right:10%!important}.markdown-preview-view h1{font-family:var(--font-family-preview);font-weight:500;font-size:26px;font-weight:700;line-height:36px;margin-bottom:15px;color:var(--text-title-h1)}.markdown-preview-view h2{font-family:var(--font-family-preview);font-weight:500;font-size:24px;font-weight:700;line-height:34px;color:var(--text-title-h2)}.markdown-preview-view h3{font-family:var(--font-family-preview);font-weight:500;font-size:22px;font-weight:700;line-height:32px;color:var(--text-title-h3)}.markdown-preview-view h4{font-family:var(--font-family-preview);font-weight:500;font-size:19px;font-weight:700;line-height:28px;color:var(--text-title-h4)}.markdown-preview-view h5{font-family:var(--font-family-preview);font-weight:500;font-size:18px;font-weight:700;line-height:27px;color:var(--text-title-h5)}.markdown-preview-view h6{font-family:var(--font-family-preview);font-weight:500;font-size:16px;font-weight:700;line-height:24px;margin-bottom:3px;color:var(--text-title-h6)}code{font-family:var(--font-family-preview);font-weight:500;font-size:16px;font-weight:none;color:var(--text-title-h3)}.code{background-color:var(--grey)!important;border:1px solid var(--background-modifier-border)!important;border-color:#ba6ea0!important}.markdown-embed-title{font-weight:600}.markdown-preview-view{font-family:var(--font-family-preview);font-size:15px;color:var(--text-normal);padding-left:8%!important;padding-right:4%!important}.CodeMirror-scroll::-webkit-scrollbar{display:none}.markdown-embed-title{font-weight:600}.search-empty-state{width:auto;padding-left:10px;padding-right:5px;line-height:normal}.CodeMirror-scroll::-webkit-scrollbar{display:none}.CodeMirror-code span.cm-inline-code{color:#d4d4d4!important}.cm-s-obsidian pre.HyperMD-codeblock{color:#d4d4d4!important}.cm-s-obsidian pre.HyperMD-list-line{padding-top:0;min-height:1em}br+.internal-embed{margin-top:-2rem}.markdown-preview-view code{color:#d4d4d4!important;background-color:var(--pre-code)!important;bottom:-.1px!important}.markdown-embed{padding-left:0!important;padding-right:5px!important;margin-left:10px!important;margin-right:4px!important}.markdown-preview-view .file-embed,.markdown-preview-view .markdown-embed{border-top:.25px solid #b3a14b;border-bottom:.25px solid #b3a14b;padding:0 0;margin:10px 0}.markdown-embed-title{display:none}.markdown-preview-view .markdown-embed-content>:first-child{margin-top:0}.markdown-preview-view .markdown-embed-content>:last-child{margin-bottom:0}.markdown-embed-link{color:#5bb983!important;right:2px!important}.markdown-embed-link:hover{color:#38dc7f!important}.theme-dark .notice{background-color:#2f3136;color:rgba(252,246,1)}.titlebar-button{-webkit-app-region:no-drag;padding:0 10px;cursor:pointer;opacity:.9;display:inline-block;color:#52c1da}.titlebar-text{position:absolute;width:100%;height:100%;top:0;left:0;flex-grow:1;font-size:12px;text-align:center;letter-spacing:.05em;opacity:.9;color:#52c1da}.markdown-preview-view .markdown-embed{padding:0 calc(var(--nested-padding)/ 2) 0 var(--nested-padding)}.markdown-embed-title{line-height:18px;height:24px;display:none}.markdown-embed .markdown-preview-sizer{padding-left:0!important;padding-top:.25em!important;padding-bottom:0!important;min-height:0!important}.markdown-embed .markdown-preview-sizer:first-child ul{margin-block-start:2px}.markdown-embed .markdown-preview-section:last-child p,.markdown-embed .markdown-preview-section:last-child ul{margin-block-end:15px}.file-embed-link,.markdown-embed-link{top:0;right:0;text-align:right}.file-embed-link svg,.markdown-embed-link svg{width:16px;opacity:0}.markdown-embed:hover .file-embed-link svg,.markdown-embed:hover .markdown-embed-link svg{opacity:1}.markdown-preview-view .markdown-embed-content>.markdown-preview-view{max-height:none!important}.markdown-embed .markdown-preview-view{padding:0}.internal-embed .markdown-embed{border:0;border:.5px solid var(--background-tertiary);border-left:2px solid #37aec8;border-radius:0;padding-left:0;background-color:var(--background-primary-alt);box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);transition:all .3s cubic-bezier(.25,.8,.25,1)}.internal-embed .markdown-embed:hover{box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22);transform:translate3d(0,-3px,0)}br+.internal-embed{margin-top:1rem}.internal-embed[src*="#"] .markdown-embed-link,.markdown-embed-title~.markdown-embed-link{right:0!important;width:3%}.internal-embed:not([src*="#^"]) .markdown-embed-link{left:auto}.internal-embed[src*="^"] .markdown-preview-sizer{padding-left:.25em!important;padding-top:0!important}li>div.internal-embed{display:inline-flex;width:99%}li .internal-embed .markdown-embed{width:99%}.markdown-embed-title{line-height:18px;height:24px;display:none}.markdown-embed .markdown-preview-sizer{padding-left:1em;padding-top:.5em}.popover{box-shadow:0 20px 40px var(--background-modifier-box-shadow);pointer-events:auto!important;border:1px solid var(--background-modifier-border)}.popover .markdown-embed-link{display:none}.popover .markdown-embed .markdown-preview-view{padding-bottom:1em}.popover.hover-popover .markdown-embed .markdown-embed-content{max-height:none!important}.popover.hover-popover .internal-embed[src*="^"] .markdown-embed{height:100%;max-height:none}.popover.hover-popover .internal-embed[src*="^"]{height:3.25em}.popover.hover-popover{max-height:40vh}ul ul{position:relative}ul ul::before{content:'';border-left:0 solid #2c8ba0;position:absolute}ul ul::before{left:-1em;top:0;bottom:0}ul .task-list-item ul::before{left:-1.03em!important}li::marker{color:var(--text-title-h2)}.markdown-preview-view li .collapse-indicator{display:flex;margin-top:6px}.markdown-preview-view .collapse-indicator{display:flex;margin-top:.5em}.nav-action-button:hover,.side-dock-collapse-btn:hover .workspace-tab-header-inner:hover,.side-dock-ribbon-action.is-active:hover,.side-dock-ribbon-action:hover,.side-dock-ribbon-tab-inner:hover,.side-dock-ribbon-tab:hover,.workspace-tab-header-inner-icon:hover{color:var(--text-normal)}.workspace-ribbon.mod-left,.workspace-ribbon.mod-left.is-collapsed{border-right-color:rgb(158,138,255,.66)}.workspace-ribbon.mod-right,.workspace-ribbon.mod-right.is-collapsed{border-left-color:rgb(61,216,127,.66)}.workspace-split.mod-left-split>.workspace-leaf-resize-handle,.workspace-split.mod-right-split>.workspace-leaf-resize-handle,.workspace-split.mod-vertical>*>.workspace-leaf-resize-handle{right:0;top:0;width:2px;height:100%;color:#d669bc;background-color:rgb(20,20,20,0);z-index:rgb(20,20,20,0.0);cursor:col-resize}.sync-status-icon.mod-success{color:rgb(61,216,127,.44)}::-webkit-scrollbar{width:9px;height:8px;border-radius:0}::-webkit-scrollbar{background-color:var(--scrollbar-bg)}::-webkit-scrollbar-corner{background:0 0}::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb:active{border-radius:2px}::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb-bg)}::-webkit-scrollbar-thumb:active{background-color:rgb(93,188,210,.9)}.workspace-split.mod-root>.workspace-leaf:last-of-type .workspace-leaf-content{border-top-right-radius:0}.file-tree-item.mod-new .flair{background-color:var(--background-modifier-success);color:#5dd263}.file-tree-item.mod-deleted .flair,.file-tree-item.mod-to-delete .flair{background-color:var(--background-modifier-error)}.file-tree-item .flair{line-height:1.4;padding:3px 8px;color:#e65959}.file-tree-item.mod-changed .flair{background-color:var(--background-modifier-error);color:rgb(252,246,1,.75)}.progress-bar-message{color:var(--text-faint)}.modal.mod-sync-history{background-color:var(--shade-0)}.modal{border-top:1px solid #8272d0;border-bottom:1px solid #8272d0;background:var(--background-primary);border-radius:0;max-width:1000px;max-height:90vh}.modal.mod-settings .vertical-tab-content-container{border-left:var(--border-width) solid var(--background-modifier-border);padding-bottom:0;padding-right:0}.modal.mod-settings{max-width:1000px;width:90vw;height:90vh}.modal.mod-settings .vertical-tab-header{height:90vh}.modal.mod-settings .vertical-tab-content-container{height:90vh}.modal.mod-community-plugin,.modal.mod-community-theme{width:90vw}.modal,.prompt,.suggestion-container{box-shadow:0 20px 30px rgba(0,0,0,.2)}.prompt-instructions{color:var(--text-title-h6)}.modal-close-button:before{font-weight:200}.horizontal-tab-content,.vertical-tab-content{background:var(--background-primary)}.modal.mod-settings .vertical-tab-header{background:var(--background-secondary-alt);padding-top:0;padding-left:10px}.vertical-tab-header-group-title{font-size:16px;font-weight:700;text-transform:none;letter-spacing:0;padding:6px 18px;background:var(--background-secondary-alt)}.vertical-tab-nav-item{font-size:15px;padding:7px 6px;line-height:1;cursor:var(--cursor);color:var(--text-normal);border-radius:var(--radius-s);background:var(--background-secondary-alt)}.vertical-tab-nav-item:hover{background:var(--background-secondary)}.vertical-tab-nav-item.is-active{color:var(--text-normal);background:var(--background-secondary)}.hotkey-list-container,.hotkey-search-container{padding-left:2px}.setting-hotkey{background-color:var(--background-modifier-border);padding:4px 0 4px 0;line-height:8px;min-height:0}.setting-add-hotkey-button,.setting-restore-hotkey-button{color:var(--text-muted)}.setting-hotkey.mod-empty{background:0 0}button.mod-cta{background-color:var(--background-primary);color:var(--text-on-accent);border:1px solid var(--background-modifier-border)}button.mod-cta:hover{background-color:var(--background-primary);color:var(--text-on-accent);border:1px solid var(--interactive-accent)}.tree-item-self:hover .tree-item-flair{background-color:var(--interactive-accent);color:var(--background-secondary-alt)}.flair.mod-pop{background-color:var(--background-primary);color:var(--text-on-accent)}.tree-item-self{display:flex;align-items:flex-start;padding-top:0;padding-right:6px;padding-bottom:0;padding-left:20px;border-radius:3px;color:var(--text-muted)}.theme-dark .setting-hotkey.has-conflict{background-color:var(--background-modifier-error);color:#ff7575}.setting-hotkey-icon.setting-delete-hotkey:hover{color:#5dbcd2}button.mod-warning{background-color:var(--background-modifier-error);color:#b9adff}button.mod-warning:hover{background-color:var(--background-modifier-error);color:#ff7575}.markdown-preview-view .internal-query.is-embed .internal-query-header{display:none}.frontmatter-container .frontmatter-alias,.frontmatter-container .tag{text-decoration:none;background-color:var(--background-secondary-alt);border-radius:30px;color:var(--text-a);font-size:.9em;padding:2px 8px;margin:2px 4px;line-height:19px;border:1px solid transparent;white-space:nowrap}.frontmatter-container .frontmatter-alias,.frontmatter-container .tag{text-decoration:none;background-color:var(--background-secondary-alt);border-radius:8px;color:var(--text-a);font-size:.9em;padding:2px 8px;margin:2px 4px;line-height:19px;border:1px solid transparent;white-space:nowrap}img.emoji{display:inline-block}.nav-action-button.is-active{background-color:transparent;color:var(--text-on-accent)}.suggestion-container.mod-search-suggestion{font-family:var(--font-family-preview);font-size:16px;line-height:18px}mark{background-color:var(--text-mark)!important;padding-top:0;padding-bottom:0;padding-left:0;padding-right:0}.markdown-preview-view mark{color:#6ce4ff;font-weight:500;text-shadow:0 0 .6em #fcf60159}.cm-s-obsidian span.cm-highlight{-webkit-background-clip:text;-webkit-text-fill-color:transparent;padding:0 .1rem;background-image:linear-gradient(60deg,#86c3ff 0,#ddb9ff 100%)!important;text-shadow:0 0 .6em #fcf80118}.markdown-preview-view mark{-webkit-background-clip:text;-webkit-text-fill-color:transparent;padding:0 .1rem;background-image:linear-gradient(60deg,#86c3ff 0,#ddb9ff 100%)!important;text-shadow:0 0 .6em #fcf80118}</style><style>body{--color-fade-speed:0.2s}.sidebar{font-size:14px;display:contents;z-index:1}.sidebar-container{background-color:var(--background-secondary);height:100%;z-index:inherit;transition:width ease-in-out,flex-basis ease-in-out,min-width ease-in-out,background-color var(--color-fade-speed) ease-in-out,box-shadow ease-in-out;transition-duration:.2s;overflow:hidden;flex:none}.floating-sidebars .sidebar:not(.is-collapsed) .sidebar-container{box-shadow:0 0 50px 3em rgba(0,0,0,.4)}.sidebar-gutter{height:100%;width:3em;padding:12px;background-color:hsla(var(--color-accent-hsl),.25);padding-left:calc(12px / 2);padding-right:calc(12px / 2);transition:width ease-in-out,padding-left ease-in-out,padding-right ease-in-out,background-color var(--color-fade-speed) ease-in-out,border ease-in-out;transition-duration:.2s;z-index:1;flex:none;position:relative;pointer-events:none}.sidebar.is-collapsed .sidebar-gutter{background-color:transparent}.sidebar-left .sidebar-gutter{border-left:solid var(--divider-width) var(--divider-color);border-radius:0 var(--radius-l) var(--radius-l) 0}.sidebar-right .sidebar-gutter{border-right:solid var(--divider-width) var(--divider-color);margin-left:auto;border-radius:var(--radius-l) 0 0 var(--radius-l)}.sidebar-gutter.is-collapsed,body.loading .sidebar-gutter{height:100%;width:0!important;padding:var(--sidebar-margin);padding-left:0;padding-right:0}.sidebar-sizer{width:calc(100vw - var(--sidebar-width) - var(--content-width));height:100%;transition:width .2s ease-in-out,min-width .2s ease-in-out;min-width:var(--sidebar-width)}.sidebar.is-collapsed .sidebar-sizer,body.loading .sidebar-sizer{width:0;min-width:0}.sidebar-left .sidebar-sizer{float:left}.sidebar-right .sidebar-sizer{float:right}.sidebar-content-positioner{width:var(--sidebar-width);height:100%}.sidebar-left .sidebar-content-positioner{float:right}.sidebar-right .sidebar-content-positioner{float:left}.sidebar-content{width:var(--sidebar-width);line-height:var(--line-height-tight);display:flex;flex-direction:column;padding:var(--sidebar-margin);height:100%;transition:width ease-in-out,padding-left ease-in-out,padding-right ease-in-out;transition-duration:.2s}.sidebar-left .sidebar-content{float:left}.sidebar-right .sidebar-content{float:right}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}.clickable-icon.sidebar-collapse-icon{width:100%;background-color:transparent;height:75px;border-radius:12px;padding:13%;display:block;max-width:3em;max-height:3em;color:var(--icon-color-focused);pointer-events:all}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:fit-content}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;position:fixed;align-items:stretch;justify-content:center}.document-container{opacity:0;flex-basis:var(--content-width);width:var(--content-width);height:100%;z-index:0;display:flex;flex-direction:column;align-items:center;padding:1em;max-width:100%;padding-right:0}@keyframes hide{from{opacity:1}to{opacity:0}}@keyframes show{from{opacity:0}to{opacity:1}}.document-container.hide{animation:hide .3s forwards ease-in-out}body:not(.loading) .document-container.show{opacity:0;animation:show .3s forwards ease-in-out;animation-delay:.2s}.floating-sidebars .document-container{position:absolute}.markdown-reading-view{display:none}.document-container>.markdown-preview-view{display:flex;padding-bottom:30em;align-items:flex-start;justify-content:center;overflow-x:hidden;overflow-y:scroll}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding:1.5em;padding-bottom:50vh;width:100%;position:absolute;background-color:var(--background-primary);border-radius:var(--window-radius);max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}.document-container>.view-content{overflow-x:scroll;contain:content;padding:0;margin:0;height:100%}.tree-container{position:relative;height:100%;width:auto;margin-top:3em;margin-bottom:0}.tree-container .tree-header{display:flex;flex-direction:row;align-items:center;position:absolute;top:-3em}.tree-container .tree-header .sidebar-section-header{margin:1em;margin-left:0}.tree-container:has(.tree-scroll-area:empty){display:none}.tree-container .tree-scroll-area{width:100%;height:100%;max-height:100%;overflow-y:scroll;padding-right:1em;border-radius:var(--radius-m);position:absolute}.tree-container .tree-item{display:flex;flex-direction:column;align-items:flex-start;padding:0}.tree-container .tree-item-children{padding:0;margin-left:0;border-left:none;width:100%}.tree-item-title *{padding:0;margin:0;overflow:visible}.tree-container .tree-item.mod-active>.tree-item-contents>.tree-item-link{color:var(--color-accent)}.tree-container .tree-item-contents{position:relative;display:flex;flex-direction:row;align-items:center;border-radius:.4em;color:var(--nav-item-color);width:100%;margin-left:var(--tree-horizontal-spacing)}.tree-container .tree-item-contents:active{color:var(--nav-item-color-active)}.tree-container .tree-item-link{width:100%;height:100%;transition:background-color .1s;border-radius:var(--radius-s);padding-left:calc(var(--tree-horizontal-spacing) * 2 + var(--collapse-arrow-size));padding-bottom:calc(var(--tree-vertical-spacing)/ 2);padding-top:calc(var(--tree-vertical-spacing)/ 2);color:var(--nav-item-color);text-decoration:none}.tree-container .mod-tree-file>.tree-item-contents>.tree-item-link{padding-left:calc(var(--tree-horizontal-spacing) * 2)}.tree-container .tree-item-icon.collapse-icon{margin-left:calc(0px - var(--collapse-arrow-size) - var(--tree-horizontal-spacing));position:absolute}.tree-container .tree-item.mod-tree-folder>.tree-item-contents>.tree-item-icon.collapse-icon{width:100%}.collapse-icon>svg{color:unset!important}.collapse-icon:hover{color:var(--nav-item-color-hover)}.tree-container .clickable-icon{width:3.2em;height:2.2em}.tree-container .tree-item.is-collapsed>.tree-item-contents>.tree-item-link>.tree-item-icon.collapse-icon>svg{transition:transform .1s ease-in-out;transform:rotate(-90deg)}.tree-container .tree-item-link:hover{cursor:pointer;color:var(--nav-item-color-hover);text-decoration:underline}.tree-container>.tree-scroll-area>* .tree-item{margin-left:calc(var(--tree-horizontal-spacing) * 2 + var(--collapse-arrow-size)/ 2);border-left:var(--nav-indentation-guide-width) solid var(--nav-indentation-guide-color)}.tree-container .tree-scroll-area>*>*>.tree-item{margin-left:calc(var(--tree-horizontal-spacing) + var(--collapse-arrow-size)/ 2)}.tree-container:not(.mod-nav-indicator) .tree-scroll-area>*>*>.tree-item{margin-left:0}.tree-container .tree-item.mod-active{border-left:var(--nav-indentation-guide-width) solid var(--color-accent)}.tree-container .tree-item:hover:not(.mod-active):not(.mod-collapsible):not(:has(.tree-item:hover)){border-left:var(--nav-indentation-guide-width) solid var(--nav-item-color-hover)}.tree-container .tree-item-contents:hover{background-color:var(--nav-item-background-hover)}.webpage-container .tree-container .tree-item:not(.mod-collapsible)>.tree-item-children>.tree-item,.webpage-container .tree-container:not(.mod-nav-indicator) .tree-item,.webpage-container .tree-container>.tree-scroll-area>.tree-item{border-left:none!important}.webpage-container .tree-container .tree-item:not(.mod-collapsible)>.tree-item-children>.tree-item>.tree-item-contents,.webpage-container .tree-container:not(.mod-nav-indicator) .tree-item .tree-item-contents,.webpage-container .tree-container>.tree-scroll-area>.tree-item>.tree-item-contents{margin-left:0!important;width:calc(100% + var(--tree-horizontal-spacing))}.tree-container.outline-tree .tree-item[data-depth='1']>.tree-item-contents>.tree-item-link{font-weight:900;font-size:1.1em;margin-left:0;padding-left:1em}.heading-wrapper{transition:height ease-in-out,margin-bottom ease-in-out;transition-duration:.2s;display:block}html>body>.webpage-container>.document-container .heading-wrapper,html>body>.webpage-container>.document-container>.markdown-preview-view>.markdown-preview-sizer>*{margin-inline:0!important;margin:0!important;padding:0!important;width:100%;max-width:100%}body>.webpage-container>.document-container .heading-wrapper>.heading{margin:0;margin-inline:0;margin-block:0}.markdown-preview-sizer>.heading-wrapper>h1{margin-top:var(--p-spacing)!important}body>.webpage-container>.document-container .heading-children>div:not(.heading-wrapper):first-child>*{margin-top:0}.heading-children{transition:height ease-in-out,margin-bottom ease-in-out;transition-duration:.2s;display:inline-block;width:100%;padding-top:1em}.heading-children.is-collapsed{padding-top:0}.heading-wrapper.is-animating>.heading-children,.heading-wrapper.is-collapsed>.heading-children{overflow:hidden}.heading-wrapper>.heading>.heading-after{display:none}.heading-wrapper.is-collapsed>.heading>.heading-after{display:inline-block;margin-left:.3em;opacity:.4;font-size:1em;cursor:auto;user-select:none}.heading-wrapper.is-hidden>*{display:none}.heading-wrapper.is-hidden{visibility:hidden}.collapse-icon svg.svg-icon{color:var(--nav-collapse-icon-color);stroke-width:4px;width:var(--collapse-arrow-size);height:var(--collapse-arrow-size);transition:transform .1s ease-in-out 0s;min-width:10px;min-height:10px}div.is-collapsed>*>.heading-collapse-indicator.collapse-icon>svg{transition:transform .1s ease-in-out;transform:rotate(-90deg)}body .webpage-container>.document-container .heading-collapse-indicator,body .webpage-container>.document-container .heading-collapse-indicator>svg{position:relative!important}a{overflow-wrap:anywhere}*{overflow-wrap:break-word}.theme-toggle-container{--toggle-width:3.5em;--toggle-height:1.75em;--border-radius:calc(var(--toggle-height) / 2);--handle-width:calc(var(--toggle-height) * 0.65);--handle-radius:calc(var(--handle-width) / 2);--handle-margin:calc((var(--toggle-height) / 2.0) - var(--handle-radius));--handle-translation:calc(var(--toggle-width) - var(--handle-width) - (var(--handle-margin) * 2));display:inline-block;cursor:pointer;margin:10px}.clickable-icon,.sidebar-section-header{transition:color var(--color-fade-speed) ease-in-out}@keyframes toggle-slide-right{0%{width:var(--handle-width);transform:translateX(0)}50%{width:calc(var(--toggle-width) * .5)}90%{width:var(--handle-width)}100%{transform:translateX(var(--handle-translation))}}@keyframes toggle-slide-left{0%{width:var(--handle-width);transform:translateX(calc(var(--handle-translation) - ((var(--toggle-width) * .33) - var(--handle-width))))}70%{width:calc(var(--toggle-width) * .5)}100%{width:var(--handle-width);transform:translateX(0)}}@keyframes toggle-expand-right{0%{width:var(--handle-width)}100%{width:calc(var(--toggle-width) * .33)}}@keyframes toggle-expand-left{0%{width:var(--handle-width);transform:translateX(var(--handle-translation))}100%{width:calc(var(--toggle-width) * .33);transform:translateX(calc(var(--handle-translation) - ((var(--toggle-width) * .33) - var(--handle-width))))}}@keyframes toggle-contract{0%{width:calc(var(--toggle-width) * .33)}100%{width:var(--handle-width)}}.theme-toggle-input{display:none;z-index:1000}.toggle-background{position:relative;width:var(--toggle-width);height:var(--toggle-height);border-radius:var(--border-radius);background-color:var(--background-modifier-border);transition:background-color var(--color-fade-speed);z-index:1000}.toggle-background::before{content:"";position:absolute;left:var(--handle-margin);top:var(--handle-margin);height:var(--handle-width);width:var(--handle-width);border-radius:var(--handle-radius);background-color:var(--text-normal);box-shadow:inset 0 1px 1px rgba(0,0,0,.2);animation:toggle-slide-left .2s ease-in-out normal both;z-index:1000}.theme-toggle-input:checked~.toggle-background::before{animation:toggle-slide-right .2s ease-in-out normal both}.theme-toggle-input:active~.toggle-background::before{animation:toggle-expand-right .2s ease-in-out normal both}.theme-toggle-input:active:checked~.toggle-background::before{animation:toggle-expand-left .2s ease-in-out normal both}.toggle-background::after{content:"";position:absolute;right:var(--handle-margin);top:calc(var(--handle-margin));height:var(--handle-width);width:var(--handle-width);transition:transform .3s;background:url('https://api.iconify.design/lucide/moon.svg?color=white') no-repeat center center;transform:scale(.9)}.theme-toggle-input:checked~.toggle-background::after{transform:translateX(calc(var(--handle-translation) * -1)) scale(.9);background:url('https://api.iconify.design/lucide/sun.svg') no-repeat center center}#graph-canvas{width:100%;height:100%;aspect-ratio:1/1}.graph-view-container.expanded{position:fixed;width:60%;height:90%;right:20%;top:5%;background-color:var(--background-secondary);z-index:100}body.is-phone .graph-view-container.expanded{position:fixed;width:94%;height:94%;right:3%;top:3%}body.is-tablet .graph-view-container.expanded{position:fixed;width:90%;right:5%}body.is-small-screen .graph-view-container.expanded{position:fixed;width:80%;right:10%}.graph-view-container{position:relative;width:100%;aspect-ratio:1/1;display:flex;transition:background-color var(--color-fade-speed) ease-in-out;touch-action:none;border:1px solid var(--modal-border-color);border-radius:var(--modal-radius)}.graph-icon{cursor:pointer;color:var(--text-muted)}.graph-view-container .graph-icon>svg{width:24px;height:24px;background-color:var(--color-base-00);outline-width:6px;outline-color:var(--color-base-00);outline-offset:-1px;outline-style:solid;border-radius:100px;margin:10px}.graph-view-placeholder{padding:0;width:auto;aspect-ratio:1/1;position:relative;flex:none}.graph-view-placeholder:has(.expanded){border-radius:var(--modal-radius);border:1px solid var(--modal-border-color)}.scale-down{transition:transform .2s ease-in-out;transform:scale(.9)}.scale-up{transition:transform .2s ease-in-out;transform:scale(1)}.graph-expand{position:absolute;top:5px;right:5px}.canvas{translate:0 0;scale:1 1;will-change:translate,scale}.canvas-controls{display:none;cursor:default!important}.canvas-card-menu{display:none;cursor:default!important}.canvas-node-content-blocker{pointer-events:none}body.is-phone .sidebar{font-size:1.06em}body.is-phone{--collapse-arrow-size:0.5em;--tree-vertical-spacing:0.8em;--tree-horizontal-spacing:0.45em}body.post-load .sidebar-sizer{transition-delay:0.5s!important;transition-duration:.4s!important}body.post-load .sidebar-gutter{transition-delay:0.8s!important;transition-duration:.4s!important}.loading-icon{--width:80px;--height:80px;display:inline-block;position:fixed;left:calc(50% - var(--width)/ 2);top:calc(50% - var(--height)/ 2);width:var(--width);height:var(--height);opacity:0;transition:opacity .5s ease-in-out;pointer-events:none}.loading-icon.shown{opacity:1}.loading-icon div{position:absolute;top:33px;width:13px;height:13px;border-radius:50%;background:var(--color-accent);animation-timing-function:cubic-bezier(0,1,1,0)}.loading-icon div:first-child{left:8px;animation:lds-ellipsis1 .6s infinite}.loading-icon div:nth-child(2){left:8px;animation:lds-ellipsis2 .6s infinite}.loading-icon div:nth-child(3){left:32px;animation:lds-ellipsis2 .6s infinite}.loading-icon div:nth-child(4){left:56px;animation:lds-ellipsis3 .6s infinite}.loading-icon:not(.shown) div{animation-play-state:paused}@keyframes lds-ellipsis1{0%{transform:scale(0)}100%{transform:scale(1)}}@keyframes lds-ellipsis3{0%{transform:scale(1)}100%{transform:scale(0)}}@keyframes lds-ellipsis2{0%{transform:translate(0,0)}100%{transform:translate(24px,0)}}@media print{.outline-container,.sidebar,.theme-toggle-container,.theme-toggle-container-inline,.theme-toggle-input,.toggle-background{display:none!important}}body.resizing :not(:is(.sidebar-sizer,.sidebar-gutter)){transition:none!important}.document-container .kanban-plugin{position:absolute;padding:0;margin:0;height:100%}.document-container .kanban-plugin{font-family:var(--font-text, var(--default-font));font-size:.875rem;line-height:var(--line-height-tight);width:unset;overflow-y:unset;overflow-wrap:unset;color:unset;user-select:unset;-webkit-user-select:unset}.document-container .kanban-plugin__item-button-wrapper,.kanban-plugin__item-postfix-button.clickable-icon,.kanban-plugin__lane-grip,.kanban-plugin__lane-settings-button.clickable-icon{display:none}.excalidraw-plugin rect,.excalidraw-svg rect{fill:transparent}body.theme-dark .excalidraw-plugin svg.dark,body.theme-dark .excalidraw-svg svg.dark,body.theme-light .excalidraw-plugin svg.light,body.theme-light .excalidraw-svg svg.light{filter:invert(93%) hue-rotate(180deg)}.excalidraw-plugin>svg{width:100%;height:100%}.excalidraw-plugin{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%;padding:10px}.columnParent{display:flex;padding:15px 20px;flex-wrap:wrap;gap:20px}.columnParent{white-space:normal}.columnChild{flex-grow:1;flex-basis:0px}.view-content:has(.mm-mindmap){overflow-y:none}.view-content .mm-mindmap{transform:scale(1);translate:-4000px -4000px;top:70%;left:50%;position:absolute;overflow:hidden;width:100vw}.setting-item.ex-setting-item{border-top:unset;padding-top:0}[hidden]{display:none}.mm-mindmap{color:#666;font-size:16px;width:8000px;height:8000px}.theme-dark .mm-node{color:#f5f5f5}.theme-dark .mm-node.mm-root{color:#333}.theme-light .mm-node.mm-root .mm-node-content{color:#fff;background-color:#0af}.mm-node{position:absolute;cursor:pointer;box-sizing:border-box}.mm-node .mm-node-content{padding:2px 4px;max-width:800px;word-break:break-word}.mm-node-content>h1,.mm-node-content>h2,.mm-node-content>h3,.mm-node-content>h4,.mm-node-content>h5,.mm-node-content>h6,.mm-node-content>p{padding:0;margin:0}.mm-node.mm-root .mm-node-content{font-size:1.6em;padding:14px 20px;border-radius:.25rem;background:#fff}.mm-node.mm-node-second .mm-node-content{padding:8px 10px;font-size:1.2em}.mm-node.mm-node-select{border:2px solid var(--interactive-accent);border-radius:.25rem}.mm-node-bar{position:absolute;height:12px;width:12px;border-radius:50%;padding:0 3px;bottom:-8px;box-sizing:border-box}.mm-node-bar:hover{transform:scale(1.2)}.mm-node-right .mm-node-bar,.mm-node.mm-root .mm-node-bar{right:-12px}.mm-node-second .mm-node-bar,.mm-root .mm-node-bar{top:50%;margin-top:-5px;bottom:inherit}.mm-node-left .mm-node-bar{left:-12px}.mm-node-leaf .mm-node-bar,.mm-root .mm-node-bar{display:none}.mm-node-collapse .mm-node-bar{display:block!important;box-sizing:border-box;border:0;background-color:#fff!important;border:2px solid #ccc}.mm-node-layout-indicate{position:absolute;left:0;top:0;width:0;height:0;border:20px solid transparent;border-bottom:40px solid var(--interactive-accent);transform-origin:center center;z-index:100}.mm-node-layout-indicate.mm-arrow-left{transform:rotate(-90deg)}.mm-node-layout-indicate.mm-arrow-down{transform:rotate(180deg)}.mm-node-layout-indicate.mm-arrow-right{transform:rotate(-270deg)}.mm-node.mm-edit-node{z-index:50}.mm-node.mm-edit-node .mm-node-content{background-color:#333;color:#fff}.theme-light .mm-node.mm-edit-node .mm-node-content{background-color:#fff;color:#333}.mm-node-menu{position:absolute;background:#333;border:1px solid #000;width:56px;border-radius:.25rem;z-index:60}.theme-light .mm-node-menu{background:#fff;border:1px solid #666}.mm-node-menu span{vertical-align:middle;cursor:pointer;margin:0 5px}.mm-node-menu span svg{fill:#ccc}.mm-node-menu span svg:hover{opacity:.8}.theme-light .mm-node-menu svg{fill:#333}:root{--shadow-color:0deg 0% 0%;--shadow-elevation-medium:0.5px 0.5px 0.7px hsl(var(--shadow-color) / 0.14),1.1px 1.1px 1.5px -0.9px hsl(var(--shadow-color) / 0.12),2.4px 2.5px 3.3px -1.8px hsl(var(--shadow-color) / 0.1),5.3px 5.6px 7.3px -2.7px hsl(var(--shadow-color) / 0.09),11px 11.4px 15.1px -3.6px hsl(var(--shadow-color) / 0.07)}.image-rename-modal .modal{width:65%;min-width:600px}.image-rename-modal .modal-content{padding:10px 5px}.image-rename-modal .image-container{display:flex;justify-content:center}.image-rename-modal .info{padding:10px 0;color:var(--text-muted);user-select:text}.image-rename-modal .info li>span:first-of-type{display:inline-block;width:6em;margin-right:.5em}.image-rename-modal .info li>span:first-of-type:after{content:":";float:right}.image-rename-modal .image-container img{display:block;max-height:300px;box-shadow:var(--shadow-elevation-medium)}.image-rename-modal .setting-item-control input{min-width:300px}.image-rename-modal .error{border:1px solid #c95a5a;color:#861616;padding:10px}.image-rename-modal table{font-size:.9em;line-height:1.8;margin-bottom:1.5em;user-select:text}.image-rename-modal table td{padding-right:1em}.image-rename-modal table thead td{font-weight:700}.image-rename-modal table tbody td .file-path{font-size:.8em;color:var(--text-faint);line-height:1}.long-description-setting-item{flex-wrap:wrap}.long-description-setting-item .setting-item-description{white-space:pre-wrap;line-height:1.3em}.long-description-setting-item .setting-item-control{padding-top:10px}.long-description-setting-item .setting-item-control input{min-width:300px;width:50%}.choices{position:relative;margin-bottom:24px;font-size:16px}.choices:focus{outline:0}.choices:last-child{margin-bottom:0}.choices.is-disabled .choices__inner,.choices.is-disabled .choices__input{background-color:#eaeaea;cursor:not-allowed;-webkit-user-select:none;-ms-user-select:none;user-select:none}.choices.is-disabled .choices__item{cursor:not-allowed}.choices [hidden]{display:none!important}.choices[data-type*=select-one]{cursor:pointer}.choices[data-type*=select-one] .choices__inner{padding-bottom:7.5px}.choices[data-type*=select-one] .choices__input{display:block;width:100%;padding:10px;border-bottom:1px solid #ddd;background-color:#fff;margin:0}.choices[data-type*=select-one] .choices__button{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);padding:0;background-size:8px;position:absolute;top:50%;right:0;margin-top:-10px;margin-right:25px;height:20px;width:20px;border-radius:10em;opacity:.5}.choices[data-type*=select-one] .choices__button:focus,.choices[data-type*=select-one] .choices__button:hover{opacity:1}.choices[data-type*=select-one] .choices__button:focus{box-shadow:0 0 0 2px #00bcd4}.choices[data-type*=select-one] .choices__item[data-value=""] .choices__button{display:none}.choices[data-type*=select-one]:after{content:"";height:0;width:0;border-style:solid;border-color:#333 transparent transparent transparent;border-width:5px;position:absolute;right:11.5px;top:50%;margin-top:-2.5px;pointer-events:none}.choices[data-type*=select-one].is-open:after{border-color:transparent transparent #333 transparent;margin-top:-7.5px}.choices[data-type*=select-one][dir=rtl]:after{left:11.5px;right:auto}.choices[data-type*=select-one][dir=rtl] .choices__button{right:auto;left:0;margin-left:25px;margin-right:0}.choices[data-type*=select-multiple] .choices__inner,.choices[data-type*=text] .choices__inner{cursor:text}.choices[data-type*=select-multiple] .choices__button,.choices[data-type*=text] .choices__button{position:relative;display:inline-block;margin:0 -4px 0 8px;padding-left:16px;border-left:1px solid #008fa1;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);background-size:8px;width:8px;line-height:1;opacity:.75;border-radius:0}.choices[data-type*=select-multiple] .choices__button:focus,.choices[data-type*=select-multiple] .choices__button:hover,.choices[data-type*=text] .choices__button:focus,.choices[data-type*=text] .choices__button:hover{opacity:1}.choices__inner{display:inline-block;vertical-align:top;width:100%;background-color:#f9f9f9;padding:7.5px 7.5px 3.75px;border:1px solid #ddd;border-radius:2.5px;font-size:14px;min-height:44px;overflow:hidden}.is-focused .choices__inner,.is-open .choices__inner{border-color:#b7b7b7}.is-open .choices__inner{border-radius:2.5px 2.5px 0 0}.is-flipped.is-open .choices__inner{border-radius:0 0 2.5px 2.5px}.choices__list{margin:0;padding-left:0;list-style:none}.choices__list--single{display:inline-block;padding:4px 16px 4px 4px;width:100%}[dir=rtl] .choices__list--single{padding-right:4px;padding-left:16px}.choices__list--single .choices__item{width:100%}.choices__list--multiple{display:inline}.choices__list--multiple .choices__item{display:inline-block;vertical-align:middle;border-radius:20px;padding:4px 10px;font-size:12px;font-weight:500;margin-right:3.75px;margin-bottom:3.75px;background-color:#00bcd4;border:1px solid #00a5bb;color:#fff;word-break:break-all;box-sizing:border-box}.choices__list--multiple .choices__item[data-deletable]{padding-right:5px}[dir=rtl] .choices__list--multiple .choices__item{margin-right:0;margin-left:3.75px}.choices__list--multiple .choices__item.is-highlighted{background-color:#00a5bb;border:1px solid #008fa1}.is-disabled .choices__list--multiple .choices__item{background-color:#aaa;border:1px solid #919191}.choices__list--dropdown{visibility:hidden;z-index:1;position:absolute;width:100%;background-color:#fff;border:1px solid #ddd;top:100%;margin-top:-1px;border-bottom-left-radius:2.5px;border-bottom-right-radius:2.5px;overflow:hidden;word-break:break-all;will-change:visibility}.choices__list--dropdown.is-active{visibility:visible}.is-open .choices__list--dropdown{border-color:#b7b7b7}.is-flipped .choices__list--dropdown{top:auto;bottom:100%;margin-top:0;margin-bottom:-1px;border-radius:.25rem .25rem 0 0}.choices__list--dropdown .choices__list{position:relative;max-height:300px;overflow:auto;-webkit-overflow-scrolling:touch;will-change:scroll-position}.choices__list--dropdown .choices__item{position:relative;padding:10px;font-size:14px}[dir=rtl] .choices__list--dropdown .choices__item{text-align:right}@media (min-width:640px){.choices__list--dropdown .choices__item--selectable{padding-right:100px}.choices__list--dropdown .choices__item--selectable:after{content:attr(data-select-text);font-size:12px;opacity:0;position:absolute;right:10px;top:50%;transform:translateY(-50%)}[dir=rtl] .choices__list--dropdown .choices__item--selectable{text-align:right;padding-left:100px;padding-right:10px}[dir=rtl] .choices__list--dropdown .choices__item--selectable:after{right:auto;left:10px}}.choices__list--dropdown .choices__item--selectable.is-highlighted{background-color:#f2f2f2}.choices__list--dropdown .choices__item--selectable.is-highlighted:after{opacity:.5}.choices__item{cursor:default}.choices__item--selectable{cursor:pointer}.choices__item--disabled{cursor:not-allowed;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.5}.choices__heading{font-weight:600;font-size:12px;padding:10px;border-bottom:1px solid #f7f7f7;color:gray}.choices__button{text-indent:-9999px;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;background-color:transparent;background-repeat:no-repeat;background-position:center;cursor:pointer}.choices__button:focus{outline:0}.choices__input{display:inline-block;vertical-align:baseline;background-color:#f9f9f9;font-size:14px;margin-bottom:5px;border:0;border-radius:0;max-width:100%;padding:4px 0 4px 2px}.choices__input:focus{outline:0}[dir=rtl] .choices__input{padding-right:2px;padding-left:0}.choices__placeholder{opacity:.5}.flatpickr-calendar{background:0 0;opacity:0;display:none;text-align:center;visibility:hidden;padding:0;-webkit-animation:none;animation:none;direction:ltr;border:0;font-size:14px;line-height:24px;border-radius:5px;position:absolute;width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-touch-action:manipulation;touch-action:manipulation;background:#fff;-webkit-box-shadow:1px 0 0 #e6e6e6,-1px 0 0 #e6e6e6,0 1px 0 #e6e6e6,0 -1px 0 #e6e6e6,0 3px 13px rgba(0,0,0,.08);box-shadow:1px 0 #e6e6e6,-1px 0 #e6e6e6,0 1px #e6e6e6,0 -1px #e6e6e6,0 3px 13px #00000014}.flatpickr-calendar.inline,.flatpickr-calendar.open{opacity:1;max-height:640px;visibility:visible}.flatpickr-calendar.open{display:inline-block;z-index:99999}.flatpickr-calendar.animate.open{-webkit-animation:fpFadeInDown .3s cubic-bezier(.23,1,.32,1);animation:fpFadeInDown .3s cubic-bezier(.23,1,.32,1)}.flatpickr-calendar.inline{display:block;position:relative;top:2px}.flatpickr-calendar.static{position:absolute;top:calc(100% + 2px)}.flatpickr-calendar.static.open{z-index:999;display:block}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7){-webkit-box-shadow:none!important;box-shadow:none!important}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1){-webkit-box-shadow:-2px 0 0 #e6e6e6,5px 0 0 #e6e6e6;box-shadow:-2px 0 #e6e6e6,5px 0 #e6e6e6}.flatpickr-calendar .hasTime .dayContainer,.flatpickr-calendar .hasWeeks .dayContainer{border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0}.flatpickr-calendar .hasWeeks .dayContainer{border-left:0}.flatpickr-calendar.hasTime .flatpickr-time{height:40px;border-top:1px solid #e6e6e6}.flatpickr-calendar.noCalendar.hasTime .flatpickr-time{height:auto}.flatpickr-calendar:after,.flatpickr-calendar:before{position:absolute;display:block;pointer-events:none;border:solid transparent;content:"";height:0;width:0;left:22px}.flatpickr-calendar.arrowRight:after,.flatpickr-calendar.arrowRight:before,.flatpickr-calendar.rightMost:after,.flatpickr-calendar.rightMost:before{left:auto;right:22px}.flatpickr-calendar.arrowCenter:after,.flatpickr-calendar.arrowCenter:before{left:50%;right:50%}.flatpickr-calendar:before{border-width:5px;margin:0 -5px}.flatpickr-calendar:after{border-width:4px;margin:0 -4px}.flatpickr-calendar.arrowTop:after,.flatpickr-calendar.arrowTop:before{bottom:100%}.flatpickr-calendar.arrowTop:before{border-bottom-color:#e6e6e6}.flatpickr-calendar.arrowTop:after{border-bottom-color:#fff}.flatpickr-calendar.arrowBottom:after,.flatpickr-calendar.arrowBottom:before{top:100%}.flatpickr-calendar.arrowBottom:before{border-top-color:#e6e6e6}.flatpickr-calendar.arrowBottom:after{border-top-color:#fff}.flatpickr-calendar:focus{outline:0}.flatpickr-wrapper{position:relative;display:inline-block}.flatpickr-months{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.flatpickr-months .flatpickr-month{background:0 0;color:#000000e6;fill:#000000e6;height:34px;line-height:1;text-align:center;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flatpickr-months .flatpickr-next-month,.flatpickr-months .flatpickr-prev-month{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-decoration:none;cursor:pointer;position:absolute;top:0;height:34px;padding:10px;z-index:3;color:#000000e6;fill:#000000e6}.flatpickr-months .flatpickr-next-month.flatpickr-disabled,.flatpickr-months .flatpickr-prev-month.flatpickr-disabled{display:none}.flatpickr-months .flatpickr-next-month i,.flatpickr-months .flatpickr-prev-month i{position:relative}.flatpickr-months .flatpickr-next-month.flatpickr-prev-month,.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month{left:0}.flatpickr-months .flatpickr-next-month.flatpickr-next-month,.flatpickr-months .flatpickr-prev-month.flatpickr-next-month{right:0}.flatpickr-months .flatpickr-next-month:hover,.flatpickr-months .flatpickr-prev-month:hover{color:#959ea9}.flatpickr-months .flatpickr-next-month:hover svg,.flatpickr-months .flatpickr-prev-month:hover svg{fill:#f64747}.flatpickr-months .flatpickr-next-month svg,.flatpickr-months .flatpickr-prev-month svg{width:14px;height:14px}.flatpickr-months .flatpickr-next-month svg path,.flatpickr-months .flatpickr-prev-month svg path{-webkit-transition:fill .1s;transition:fill .1s;fill:inherit}.numInputWrapper{position:relative;height:auto}.numInputWrapper input,.numInputWrapper span{display:inline-block}.numInputWrapper input{width:100%}.numInputWrapper input::-ms-clear{display:none}.numInputWrapper input::-webkit-inner-spin-button,.numInputWrapper input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.numInputWrapper span{position:absolute;right:0;width:14px;padding:0 4px 0 2px;height:50%;line-height:50%;opacity:0;cursor:pointer;border:1px solid rgba(57,57,57,.15);-webkit-box-sizing:border-box;box-sizing:border-box}.numInputWrapper span:hover{background:rgba(0,0,0,.1)}.numInputWrapper span:active{background:rgba(0,0,0,.2)}.numInputWrapper span:after{display:block;content:"";position:absolute}.numInputWrapper span.arrowUp{top:0;border-bottom:0}.numInputWrapper span.arrowUp:after{border-left:4px solid transparent;border-right:4px solid transparent;border-bottom:4px solid rgba(57,57,57,.6);top:26%}.numInputWrapper span.arrowDown{top:50%}.numInputWrapper span.arrowDown:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid rgba(57,57,57,.6);top:40%}.numInputWrapper span svg{width:inherit;height:auto}.numInputWrapper span svg path{fill:#00000080}.numInputWrapper:hover{background:rgba(0,0,0,.05)}.numInputWrapper:hover span{opacity:1}.flatpickr-current-month{font-size:135%;line-height:inherit;font-weight:300;color:inherit;position:absolute;width:75%;left:12.5%;padding:7.48px 0 0;line-height:1;height:34px;display:inline-block;text-align:center;-webkit-transform:translate3d(0,0,0);transform:translate(0)}.flatpickr-current-month span.cur-month{font-family:inherit;font-weight:700;color:inherit;display:inline-block;margin-left:.5ch;padding:0}.flatpickr-current-month span.cur-month:hover{background:rgba(0,0,0,.05)}.flatpickr-current-month .numInputWrapper{width:6ch;width:7ch\fffd;display:inline-block}.flatpickr-current-month .numInputWrapper span.arrowUp:after{border-bottom-color:#000000e6}.flatpickr-current-month .numInputWrapper span.arrowDown:after{border-top-color:#000000e6}.flatpickr-current-month input.cur-year{background:0 0;-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;cursor:text;padding:0 0 0 .5ch;margin:0;display:inline-block;font-size:inherit;font-family:inherit;font-weight:300;line-height:inherit;height:auto;border:0;border-radius:0;vertical-align:initial;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield}.flatpickr-current-month input.cur-year:focus{outline:0}.flatpickr-current-month input.cur-year[disabled],.flatpickr-current-month input.cur-year[disabled]:hover{font-size:100%;color:#00000080;background:0 0;pointer-events:none}.flatpickr-current-month .flatpickr-monthDropdown-months{appearance:menulist;background:0 0;border:none;border-radius:0;box-sizing:border-box;color:inherit;cursor:pointer;font-size:inherit;font-family:inherit;font-weight:300;height:auto;line-height:inherit;margin:-1px 0 0;outline:0;padding:0 0 0 .5ch;position:relative;vertical-align:initial;-webkit-box-sizing:border-box;-webkit-appearance:menulist;-moz-appearance:menulist;width:auto}.flatpickr-current-month .flatpickr-monthDropdown-months:active,.flatpickr-current-month .flatpickr-monthDropdown-months:focus{outline:0}.flatpickr-current-month .flatpickr-monthDropdown-months:hover{background:rgba(0,0,0,.05)}.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month{background-color:transparent;outline:0;padding:0}.flatpickr-weekdays{background:0 0;text-align:center;overflow:hidden;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:28px}.flatpickr-weekdays .flatpickr-weekdaycontainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}span.flatpickr-weekday{cursor:default;font-size:90%;background:0 0;color:#0000008a;line-height:1;margin:0;text-align:center;display:block;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;font-weight:bolder}.dayContainer,.flatpickr-weeks{padding:1px 0 0}.flatpickr-days{position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:307.875px}.flatpickr-days:focus{outline:0}.dayContainer{padding:0;outline:0;text-align:left;width:307.875px;min-width:307.875px;max-width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-wrap:wrap;-ms-flex-pack:justify;-webkit-justify-content:space-around;justify-content:space-around;-webkit-transform:translate3d(0,0,0);transform:translate(0);opacity:1}.dayContainer+.dayContainer{-webkit-box-shadow:-1px 0 0 #e6e6e6;box-shadow:-1px 0 #e6e6e6}.flatpickr-day{background:0 0;border:1px solid transparent;border-radius:150px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#393939;cursor:pointer;font-weight:400;width:14.2857143%;-webkit-flex-basis:14.2857143%;-ms-flex-preferred-size:14.2857143%;flex-basis:14.2857143%;max-width:39px;height:39px;line-height:39px;margin:0;display:inline-block;position:relative;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center}.flatpickr-day.inRange,.flatpickr-day.nextMonthDay.inRange,.flatpickr-day.nextMonthDay.today.inRange,.flatpickr-day.nextMonthDay:focus,.flatpickr-day.nextMonthDay:hover,.flatpickr-day.prevMonthDay.inRange,.flatpickr-day.prevMonthDay.today.inRange,.flatpickr-day.prevMonthDay:focus,.flatpickr-day.prevMonthDay:hover,.flatpickr-day.today.inRange,.flatpickr-day:focus,.flatpickr-day:hover{cursor:pointer;outline:0;background:#e6e6e6;border-color:#e6e6e6}.flatpickr-day.today{border-color:#959ea9}.flatpickr-day.today:focus,.flatpickr-day.today:hover{border-color:#959ea9;background:#959ea9;color:#fff}.flatpickr-day.endRange,.flatpickr-day.endRange.inRange,.flatpickr-day.endRange.nextMonthDay,.flatpickr-day.endRange.prevMonthDay,.flatpickr-day.endRange:focus,.flatpickr-day.endRange:hover,.flatpickr-day.selected,.flatpickr-day.selected.inRange,.flatpickr-day.selected.nextMonthDay,.flatpickr-day.selected.prevMonthDay,.flatpickr-day.selected:focus,.flatpickr-day.selected:hover,.flatpickr-day.startRange,.flatpickr-day.startRange.inRange,.flatpickr-day.startRange.nextMonthDay,.flatpickr-day.startRange.prevMonthDay,.flatpickr-day.startRange:focus,.flatpickr-day.startRange:hover{background:#569ff7;-webkit-box-shadow:none;box-shadow:none;color:#fff;border-color:#569ff7}.flatpickr-day.endRange.startRange,.flatpickr-day.selected.startRange,.flatpickr-day.startRange.startRange{border-radius:50px 0 0 50px}.flatpickr-day.endRange.endRange,.flatpickr-day.selected.endRange,.flatpickr-day.startRange.endRange{border-radius:0 50px 50px 0}.flatpickr-day.endRange.startRange+.endRange:not(:nth-child(7n+1)),.flatpickr-day.selected.startRange+.endRange:not(:nth-child(7n+1)),.flatpickr-day.startRange.startRange+.endRange:not(:nth-child(7n+1)){-webkit-box-shadow:-10px 0 0 #569ff7;box-shadow:-10px 0 #569ff7}.flatpickr-day.endRange.startRange.endRange,.flatpickr-day.selected.startRange.endRange,.flatpickr-day.startRange.startRange.endRange{border-radius:50px}.flatpickr-day.inRange{border-radius:0;-webkit-box-shadow:-5px 0 0 #e6e6e6,5px 0 0 #e6e6e6;box-shadow:-5px 0 #e6e6e6,5px 0 #e6e6e6}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover,.flatpickr-day.nextMonthDay,.flatpickr-day.notAllowed,.flatpickr-day.notAllowed.nextMonthDay,.flatpickr-day.notAllowed.prevMonthDay,.flatpickr-day.prevMonthDay{color:#3939394d;background:0 0;border-color:transparent;cursor:default}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover{cursor:not-allowed;color:#3939391a}.flatpickr-day.week.selected{border-radius:0;-webkit-box-shadow:-5px 0 0 #569ff7,5px 0 0 #569ff7;box-shadow:-5px 0 #569ff7,5px 0 #569ff7}.flatpickr-day.hidden{visibility:hidden}.rangeMode .flatpickr-day{margin-top:1px}.flatpickr-weekwrapper{float:left}.flatpickr-weekwrapper .flatpickr-weeks{padding:0 12px;-webkit-box-shadow:1px 0 0 #e6e6e6;box-shadow:1px 0 #e6e6e6}.flatpickr-weekwrapper .flatpickr-weekday{float:none;width:100%;line-height:28px}.flatpickr-weekwrapper span.flatpickr-day,.flatpickr-weekwrapper span.flatpickr-day:hover{display:block;width:100%;max-width:none;color:#3939394d;background:0 0;cursor:default;border:none}.flatpickr-innerContainer{display:block;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}.flatpickr-rContainer{display:inline-block;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box}.flatpickr-time{text-align:center;outline:0;display:block;height:0;line-height:40px;max-height:40px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.flatpickr-time:after{content:"";display:table;clear:both}.flatpickr-time .numInputWrapper{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;width:40%;height:40px;float:left}.flatpickr-time .numInputWrapper span.arrowUp:after{border-bottom-color:#393939}.flatpickr-time .numInputWrapper span.arrowDown:after{border-top-color:#393939}.flatpickr-time.hasSeconds .numInputWrapper{width:26%}.flatpickr-time.time24hr .numInputWrapper{width:49%}.flatpickr-time input{background:0 0;-webkit-box-shadow:none;box-shadow:none;border:0;border-radius:0;text-align:center;margin:0;padding:0;height:inherit;line-height:inherit;color:#393939;font-size:14px;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield}.flatpickr-time input.flatpickr-hour{font-weight:700}.flatpickr-time input.flatpickr-minute,.flatpickr-time input.flatpickr-second{font-weight:400}.flatpickr-time input:focus{outline:0;border:0}.flatpickr-time .flatpickr-am-pm,.flatpickr-time .flatpickr-time-separator{height:inherit;float:left;line-height:inherit;color:#393939;font-weight:700;width:2%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center}.flatpickr-time .flatpickr-am-pm{outline:0;width:18%;cursor:pointer;text-align:center;font-weight:400}.flatpickr-time .flatpickr-am-pm:focus,.flatpickr-time .flatpickr-am-pm:hover,.flatpickr-time input:focus,.flatpickr-time input:hover{background:#eee}.flatpickr-input[readonly]{cursor:pointer}@-webkit-keyframes fpFadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-20px,0);transform:translateY(-20px)}to{opacity:1;-webkit-transform:translate3d(0,0,0);transform:translate(0)}}@keyframes fpFadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-20px,0);transform:translateY(-20px)}to{opacity:1;-webkit-transform:translate3d(0,0,0);transform:translate(0)}}.workspace-leaf-content[data-type=kanban] .view-content{padding:0}.workspace-leaf-content[data-type=kanban]>.view-header{display:flex}.kanban-plugin{--lane-width:272px}.kanban-plugin{contain:content;height:100%;width:100%;position:relative;display:flex;flex-direction:column}.kanban-plugin.something-is-dragging{cursor:grabbing;cursor:-webkit-grabbing}.kanban-plugin.something-is-dragging *{pointer-events:none}.kanban-plugin button,.kanban-plugin__item button,.kanban-plugin__lane button{line-height:1;padding:10px 12px;margin:0;transition:.1s color,.1s background-color}.kanban-plugin__search-wrapper{width:100%;position:sticky;top:0;left:0;padding:10px 13px;display:flex;justify-content:flex-end;align-items:center;z-index:2;background-color:var(--background-secondary);border-bottom:1px solid var(--background-modifier-border)}button.kanban-plugin__search-cancel-button{display:flex;line-height:1;padding:6px;border:1px solid var(--background-modifier-border);background:var(--background-secondary-alt);color:var(--text-muted);margin:0 0 0 5px;font-size:16px}button.kanban-plugin__search-cancel-button .kanban-plugin__icon{display:flex}.kanban-plugin__icon{display:inline-block;line-height:1}.kanban-plugin__icon>svg{width:1em;height:1em}.kanban-plugin__board{display:flex;width:100%;height:100%}.kanban-plugin__board>div{display:flex;align-items:flex-start;justify-content:flex-start;padding:1rem;width:fit-content;height:100%}.kanban-plugin__board.is-adding-lane>div{padding-right:calc(250px + 1rem)}.kanban-plugin__lane-wrapper{display:flex;flex-shrink:0;margin-right:10px;max-height:100%;width:var(--lane-width)}.kanban-plugin__lane{width:100%;display:flex;flex-direction:column;background-color:var(--background-secondary);border-radius:6px;border:1px solid var(--background-modifier-border)}.kanban-plugin__placeholder.kanban-plugin__lane-placeholder{height:100%;flex-grow:1;margin-right:5px}.kanban-plugin__lane.is-hidden{display:none}.kanban-plugin__lane button{padding:8px 10px}.kanban-plugin__lane-form-wrapper{position:absolute;top:1rem;right:1rem;width:250px;background-color:var(--background-secondary);border-radius:6px;border:2px solid hsla(var(--interactive-accent-hsl),.7);z-index:var(--layer-popover);box-shadow:0 .5px 1px .5px #0000001a,0 2px 10px #0000001a,0 10px 20px #0000001a}.kanban-plugin__lane-input-wrapper{padding:10px}.kanban-plugin__item-input-actions,.kanban-plugin__lane-input-actions{display:flex;align-items:flex-start;justify-content:flex-start;padding:0 10px 10px}.kanban-plugin__item-input-actions button,.kanban-plugin__lane-input-actions button{display:block;margin-right:5px}.kanban-plugin__item-action-add,.kanban-plugin__lane-action-add{background-color:var(--interactive-accent);color:var(--text-on-accent)}.kanban-plugin__item-action-add:hover,.kanban-plugin__lane-action-add:hover{background-color:var(--interactive-accent-hover)}.kanban-plugin__lane-header-wrapper{padding:8px 12px 8px 8px;display:flex;align-items:center;flex-shrink:0;flex-grow:0;border-bottom:1px solid var(--background-modifier-border)}.will-prepend .kanban-plugin__lane-header-wrapper{border-bottom:none}.kanban-plugin__lane-grip{cursor:grab;flex-grow:0;margin-right:5px;color:var(--text-faint)}.kanban-plugin__lane-grip:active{cursor:grabbing}.kanban-plugin__lane-grip>svg{display:block;height:1rem}.kanban-plugin__lane-title{font-weight:600;font-size:.875rem;flex-grow:1;width:100%;display:flex;flex-direction:column}.kanban-plugin__lane-title-text{flex-grow:1}div.kanban-plugin__markdown-preview-view>div>*{overflow-wrap:anywhere}div.kanban-plugin__lane-title-count{border-radius:3px;color:var(--text-muted);display:block;font-size:13px;line-height:1;padding:4px;margin-left:5px}div.kanban-plugin__lane-title-count.wip-exceeded{font-weight:700;color:var(--text-normal);background-color:rgba(var(--background-modifier-error-rgb),.25)}.kanban-plugin__item button.kanban-plugin__item-postfix-button,.kanban-plugin__item button.kanban-plugin__item-prefix-button,.kanban-plugin__lane button.kanban-plugin__lane-settings-button{font-size:13px;line-height:1;color:var(--text-muted);padding:4px;display:flex;margin-left:5px;background-color:transparent;margin-right:-4px}.kanban-plugin__item button.kanban-plugin__item-postfix-button.is-enabled,.kanban-plugin__item button.kanban-plugin__item-prefix-button.is-enabled,.kanban-plugin__lane button.kanban-plugin__lane-settings-button.is-enabled{color:var(--text-accent)}.kanban-plugin__item button.kanban-plugin__item-postfix-button:hover,.kanban-plugin__item button.kanban-plugin__item-prefix-button:hover,.kanban-plugin__lane button.kanban-plugin__lane-settings-button:hover{background-color:transparent;color:var(--text-normal)}.kanban-plugin__item button.kanban-plugin__item-prefix-button{margin:4px 7px 4px 0;padding:0}.kanban-plugin__item-edit-archive-button,.kanban-plugin__item-edit-archive-button>.kanban-plugin__icon,.kanban-plugin__item-postfix-button>.kanban-plugin__icon,.kanban-plugin__item-prefix-button>.kanban-plugin__icon,.kanban-plugin__item-settings-actions .kanban-plugin__icon,.kanban-plugin__lane-action-wrapper,.kanban-plugin__lane-settings-button>.kanban-plugin__icon{display:flex}.kanban-plugin__lane-settings-button-wrapper{display:flex}button.kanban-plugin__lane-settings-button+button.kanban-plugin__lane-settings-button{margin-left:2px}.kanban-plugin__lane-settings-button svg{width:1em;height:1em}.kanban-plugin__lane-items-wrapper{margin:4px;height:100%}.kanban-plugin__lane-items{padding:4px;margin:0 4px;display:flex;flex-direction:column}.kanban-plugin__lane-items>div{margin-top:4px}.kanban-plugin__lane-items>.kanban-plugin__placeholder{flex-grow:1}.kanban-plugin__lane-items>.kanban-plugin__placeholder:only-child{height:2.55em;border:3px dashed rgba(var(--text-muted-rgb),.1);margin-bottom:4px;border-radius:6px;transition:border .2s ease}.is-sorting .kanban-plugin__lane-items>.kanban-plugin__placeholder:only-child{border-color:hsla(var(--interactive-accent-hsl),.6)}.kanban-plugin__item-button-wrapper{border-top:1px solid var(--background-modifier-border);padding:8px;flex-shrink:0;flex-grow:0}.kanban-plugin__item-button-wrapper>button{text-align:left;width:100%}.kanban-plugin__lane-header-wrapper+.kanban-plugin__item-button-wrapper{border-top:none;border-bottom:1px solid var(--background-modifier-border);padding:4px 8px 8px}.kanban-plugin__item-form{border-top:1px solid var(--background-modifier-border);padding:8px}.kanban-plugin__item-form .kanban-plugin__item-input-wrapper{padding:6px 8px;border:1px solid var(--background-modifier-border);background-color:var(--background-primary);border-radius:var(--input-radius);min-height:var(--input-height)}.kanban-plugin__lane-header-wrapper+.kanban-plugin__item-form{border-top:none;border-bottom:1px solid var(--background-modifier-border);padding:4px 8px 8px}.kanban-plugin__item-input-wrapper{display:flex;flex-direction:column;flex-grow:1}.kanban-plugin button.kanban-plugin__item-submit-button{background-color:var(--background-secondary-alt);flex-grow:0;flex-shrink:1;width:auto;margin-top:5px;line-height:1;font-size:14px}button.kanban-plugin__new-item-button{background-color:transparent;color:var(--text-muted)}.kanban-plugin__new-item-button:hover{color:var(--text-on-accent);background-color:var(--interactive-accent-hover)}.kanban-plugin__drag-container>.kanban-plugin__item-wrapper .kanban-plugin__item{border-color:var(--interactive-accent);box-shadow:var(--shadow-s),0 0 0 2px hsla(var(--interactive-accent-hsl),.2)}.kanban-plugin__item{font-size:.875rem;border:1px solid var(--background-modifier-border);border-radius:var(--input-radius);overflow:hidden;transition:.3s opacity cubic-bezier(.25,1,.5,1)}.kanban-plugin__item.is-search-hit{box-shadow:0 15px 25px #0003,0 0 0 1px var(--background-modifier-border)}.kanban-plugin__item.is-search-miss{font-size:.75rem;opacity:.5}.kanban-plugin__item.is-search-miss .kanban-plugin__item-metadata-wrapper{display:none}.kanban-plugin__item-content-wrapper{background:var(--background-primary)}.kanban-plugin__item-title-wrapper{background:var(--background-primary);display:flex;padding:6px 8px;align-items:center}.kanban-plugin__item-title-wrapper:not(:only-child){border-bottom:1px solid var(--background-modifier-border)}.kanban-plugin__item-title{width:100%;line-height:var(--line-height-tight);overflow:hidden}.kanban-plugin__markdown-preview-view{font-family:var(--font-text, var(--default-font));font-size:.875rem;line-height:var(--line-height-tight);padding:unset;width:unset;height:unset;position:unset;overflow-y:unset;overflow-wrap:unset;color:unset;user-select:unset;-webkit-user-select:unset}.kanban-plugin__markdown-preview-view blockquote,.kanban-plugin__markdown-preview-view ol,.kanban-plugin__markdown-preview-view p,.kanban-plugin__markdown-preview-view ul{margin-block-start:.66em;margin-block-end:.66em}.kanban-plugin__markdown-preview-view blockquote{margin-inline-start:0;margin-inline-end:0}.kanban-plugin__markdown-preview-view ol ol,.kanban-plugin__markdown-preview-view ol ul,.kanban-plugin__markdown-preview-view ul ol,.kanban-plugin__markdown-preview-view ul ul{margin-block-start:0em;margin-block-end:0em}.kanban-plugin__markdown-preview-view>div>*{overflow-x:auto;overflow-wrap:break-word}.kanban-plugin__markdown-preview-view>div>.frontmatter-container+*,.kanban-plugin__markdown-preview-view>div>:first-child{margin-top:0}.kanban-plugin__markdown-preview-view>div>:last-child{margin-bottom:0}.kanban-plugin__markdown-preview-view ol,.kanban-plugin__markdown-preview-view ul{padding-inline-start:24px}.kanban-plugin__meta-value .kanban-plugin__markdown-preview-view,.kanban-plugin__meta-value .kanban-plugin__markdown-preview-view p{font-size:inherit;color:inherit;line-height:inherit}.kanban-plugin__markdown-preview-view.inline,.kanban-plugin__markdown-preview-view.inline p{display:inline-block}.kanban-plugin__markdown-preview-view .frontmatter,.kanban-plugin__markdown-preview-view .frontmatter-container{display:none}.kanban-plugin__markdown-preview-view .file-link span{display:inline-flex;align-items:center;justify-content:center;color:var(--text-faint);margin-left:2px;position:relative;top:3px}.kanban-plugin__embed-link-wrapper{padding:2px;float:right}.kanban-plugin__item-metadata-wrapper:not(:empty){background-color:var(--background-primary-alt);padding:6px 8px}.kanban-plugin__item-metadata:not(:empty){padding-top:5px;font-size:12px;font-weight:500;color:var(--text-muted)}.kanban-plugin__item-metadata>span{display:block}.kanban-plugin__item-metadata .is-button{cursor:var(--cursor)}.kanban-plugin__item-metadata .is-button:hover{color:var(--text-normal)}.kanban-plugin__item-metadata-date-relative:first-letter{text-transform:uppercase}.kanban-plugin__item-metadata a{text-decoration:none}.kanban-plugin__item-metadata-time:before{content:" \2022  "}.kanban-plugin__item-metadata-time.is-button:hover:before{color:var(--text-muted)}.kanban-plugin__item-tags:not(:empty){padding-top:2px}.kanban-plugin__item-tag{display:inline-block;margin-right:4px}.kanban-plugin__item-tags .kanban-plugin__item-tag{font-size:12px;background-color:var(--tag-background-color,hsla(var(--interactive-accent-hsl),.1));color:var(--tag-color,var(--text-accent));margin:3px 3px 0 0}.kanban-plugin__item-tag.is-search-match,.kanban-plugin__item-tags .kanban-plugin__item-tag.is-search-match{background-color:var(--text-highlight-bg);color:var(--text-normal)}.kanban-plugin__meta-table{width:100%;margin:0;line-height:1.5;font-size:.75rem}.kanban-plugin__meta-table td{vertical-align:top;padding:3px 0;width:10%}.kanban-plugin__meta-table td+td{width:90%}.kanban-plugin__meta-table td:only-child{width:100%}.kanban-plugin__meta-table td.kanban-plugin__meta-key{white-space:nowrap;padding-right:5px;color:var(--text-muted)}.kanban-plugin__meta-table td.kanban-plugin__meta-key.is-search-match>span{background-color:var(--text-highlight-bg);color:var(--text-normal)}.kanban-plugin__meta-value{white-space:pre-wrap;display:flex}.kanban-plugin__meta-value.is-search-match,.kanban-plugin__meta-value>.is-search-match{background-color:var(--text-highlight-bg);color:var(--text-normal)}.kanban-plugin__item-postfix-button-wrapper,.kanban-plugin__item-prefix-button-wrapper{display:flex;flex-grow:0;flex-shrink:0;align-self:start}.kanban-plugin__item-prefix-button-wrapper{flex-direction:column}.kanban-plugin__item-prefix-button-wrapper input[type=checkbox]{margin:4px 7px 4px 0;width:15px;height:15px;filter:hue-rotate(42deg)}.kanban-plugin__item-prefix-button-wrapper input[type=checkbox]+button{margin-top:10px}button.kanban-plugin__item-postfix-button{visibility:hidden;opacity:0;transition:.1s opacity;display:flex;align-self:flex-start}.kanban-plugin__item:hover button.kanban-plugin__item-postfix-button,button.kanban-plugin__item-postfix-button.is-enabled{visibility:visible;opacity:1}.kanban-plugin__item-settings-actions{padding:5px;display:flex}.kanban-plugin__item-settings-actions>button{line-height:1;display:flex;align-items:center;justify-content:center;font-size:.75rem;width:100%}.kanban-plugin__item-settings-actions button>.kanban-plugin__icon,.kanban-plugin__lane-action-wrapper button>.kanban-plugin__icon{margin-right:5px}.kanban-plugin__item-settings-actions>button:first-child,.kanban-plugin__lane-action-wrapper>button:first-child{margin-right:2.5px}.kanban-plugin__item-settings-actions>button:last-child,.kanban-plugin__lane-action-wrapper>button:last-child{margin-left:2.5px}.kanban-plugin__archive-lane-button,.kanban-plugin__item-button-archive{color:var(--text-muted);border:1px solid var(--background-modifier-border)}.kanban-plugin__archive-lane-button:hover,.kanban-plugin__item-button-archive:hover{color:var(--text-normal)}.kanban-plugin__item-button-delete{border:1px solid rgba(var(--background-modifier-error-rgb),.15);color:rgba(var(--background-modifier-error-rgb),1)}.kanban-plugin__item-button-delete:hover{background-color:rgba(var(--background-modifier-error-rgb),.2);color:var(--text-error)}.theme-dark .kanban-plugin__item-button-delete{background-color:transparent;border:1px solid rgba(var(--background-modifier-error-rgb),1);color:var(--text-error)}.theme-dark .kanban-plugin__item-button-delete:hover{background-color:rgba(var(--background-modifier-error-rgb),1);color:var(--text-error)}.kanban-plugin__checkbox-wrapper{border-top:1px solid var(--background-modifier-border);border-bottom:1px solid var(--background-modifier-border);padding:10px;margin-bottom:10px;display:flex;align-items:center}.kanban-plugin__checkbox-wrapper .checkbox-container{flex-shrink:0;flex-grow:0;margin-left:15px}.kanban-plugin__checkbox-label{font-size:.8125rem;line-height:1.4}.kanban-plugin__lane-setting-wrapper>div{border-top:none;border-bottom:none;padding:10px 15px;margin-bottom:0}.kanban-plugin__lane-setting-wrapper>div:last-child{border-bottom:1px solid var(--background-modifier-border);margin-bottom:10px}.kanban-plugin__action-confirm-wrapper{border:1px solid rgba(var(--background-modifier-error-rgb),.2);background-color:rgba(var(--background-modifier-error-rgb),.1);border-radius:4px;padding:10px;margin:5px 10px}.theme-dark .kanban-plugin__action-confirm-wrapper{border:1px solid rgba(var(--background-modifier-error-rgb),1)}.kanban-plugin__archive-lane-button,.kanban-plugin__delete-lane-button{display:flex;align-items:center;justify-content:center;font-size:.75rem;width:50%}.kanban-plugin__delete-lane-button{border:1px solid rgba(var(--background-modifier-error-rgb),.15);color:rgba(var(--background-modifier-error-rgb),1)}.kanban-plugin__delete-lane-button:hover{background-color:rgba(var(--background-modifier-error-rgb),.2);color:var(--text-error)}.theme-dark .kanban-plugin__delete-lane-button{background-color:transparent;border:1px solid rgba(var(--background-modifier-error-rgb),1);color:var(--text-error)}.theme-dark .kanban-plugin__delete-lane-button:hover{background-color:rgba(var(--background-modifier-error-rgb),1);color:var(--text-error)}.kanban-plugin__action-confirm-text{font-size:.875rem;color:var(--text-error);margin-bottom:10px;line-height:1.4}button.kanban-plugin__confirm-action-button{border:1px solid rgba(var(--background-modifier-error-rgb),.2);margin-right:5px;color:var(--text-error)}button.kanban-plugin__confirm-action-button:hover{background-color:rgba(var(--background-modifier-error-rgb),.5)}button.kanban-plugin__cancel-action-button{border:1px solid var(--background-modifier-border)}.kanban-plugin__grow-wrap{width:100%;display:grid}.kanban-plugin__grow-wrap:after{content:attr(data-replicated-value) " ";white-space:pre-wrap;visibility:hidden}.kanban-plugin__grow-wrap>textarea{resize:none;overflow:hidden;tab-size:2}.kanban-plugin__grow-wrap>textarea:focus{border:none;box-shadow:none}.kanban-plugin__grow-wrap:after,.kanban-plugin__grow-wrap>textarea{border:none;border-radius:0;padding:0;font:inherit;line-height:var(--line-height-tight);grid-area:1/1/2/2;font-size:.875rem;overflow:hidden;overflow-wrap:break-word;white-space:pre-wrap}.kanban-plugin__autocomplete{font-size:.875rem;border:1px solid var(--background-modifier-border);background-color:var(--background-primary);list-style:none;padding:0;margin:0;min-width:20ch;max-width:40ch;max-height:200px;border-radius:6px;box-shadow:0 15px 25px #0003;overflow-x:hidden;overflow-y:auto}.kanban-plugin__autocomplete li{margin:0}.kanban-plugin__autocomplete li em{opacity:.6}.kanban-plugin .textcomplete-footer,.kanban-plugin .textcomplete-header{display:none}.kanban-plugin__autocomplete-item,.kanban-plugin__autocomplete-item-active{border-top:1px solid var(--background-modifier-border);padding:4px 6px;cursor:var(--cursor)}.kanban-plugin__autocomplete .textcomplete-header+.kanban-plugin__autocomplete-item,.kanban-plugin__autocomplete .textcomplete-header+.kanban-plugin__autocomplete-item-active{border-top:none}.kanban-plugin__autocomplete-item-active,.kanban-plugin__autocomplete-item:hover{color:var(--text-on-accent);background-color:var(--interactive-accent-hover)}.kanban-plugin__file-suggestion-wrapper{display:flex;line-height:1.2}.kanban-plugin__file-suggestion-icon{flex-shrink:0;flex-grow:0;padding-right:4px}.kanban-plugin__file-suggestion-subtitle{font-size:.875em;color:var(--text-muted)}.kanban-plugin__autocomplete-item-active .kanban-plugin__file-suggestion-subtitle,.kanban-plugin__autocomplete-item:hover .kanban-plugin__file-suggestion-subtitle{color:var(--text-on-accent)}.modal.kanban-plugin__board-settings-modal{width:var(--modal-width);height:var(--modal-height);max-height:var(--modal-max-height);max-width:var(--modal-max-width);padding:0;display:flex;flex-direction:column}.modal.kanban-plugin__board-settings-modal .modal-content{padding:30px 50px;height:100%;overflow-y:auto;overflow-x:hidden;margin:0}.kanban-plugin__board-settings-modal .setting-item{flex-wrap:wrap;justify-content:space-between}.kanban-plugin__board-settings-modal .setting-item-info{max-width:400px;min-width:300px;width:50%}.kanban-plugin__board-settings-modal .setting-item-control{min-width:300px;flex-shrink:0}.kanban-plugin__board-settings-modal .choices{width:100%;text-align:left}.kanban-plugin__board-settings-modal .choices[data-type*=select-one] .choices__inner{background-color:var(--background-primary);border-color:var(--background-modifier-border);padding:0;min-height:0}.kanban-plugin__board-settings-modal .choices[data-type*=select-one] .choices__input{background-color:var(--background-primary);border-bottom-color:var(--background-modifier-border);font-size:14px}.kanban-plugin__board-settings-modal .choices__input{border-radius:0;border-top:none;border-left:none;border-right:none}.kanban-plugin__board-settings-modal .choices__list[role=listbox]{overflow-x:hidden}.kanban-plugin__board-settings-modal .choices__list--single{padding:4px 20px 4px 6px}.kanban-plugin__board-settings-modal .choices__list--dropdown,.kanban-plugin__board-settings-modal .is-open .choices__list--dropdown{background-color:var(--background-primary);border-color:var(--background-modifier-border);word-break:normal;max-height:200px;display:flex;flex-direction:column}.kanban-plugin__board-settings-modal .choices__list--dropdown .choices__item--selectable:after{display:none}.kanban-plugin__board-settings-modal .choices__list--dropdown .choices__item--selectable{padding:4px 6px}.kanban-plugin__board-settings-modal .choices__list--dropdown .choices__item.is-highlighted{background-color:var(--background-primary-alt)}.kanban-plugin__board-settings-modal .choices__placeholder{opacity:1;color:var(--text-muted)}.kanban-plugin__board-settings-modal .error{border-color:var(--background-modifier-error-hover)!important}.kanban-plugin__date-picker{position:absolute;z-index:var(--layer-popover);--cell-size:2.4em}.kanban-plugin__date-picker .flatpickr-input{width:0;height:0;opacity:0;border:none;padding:0;display:block;margin-bottom:-1px}.kanban-plugin__date-picker .flatpickr-current-month{color:var(--text-normal);font-weight:600;font-size:inherit;width:100%;position:static;height:auto;display:flex;align-items:center;justify-content:center;padding:0}.kanban-plugin__date-picker .flatpickr-current-month .numInputWrapper span.arrowUp:after{border-bottom-color:var(--text-normal)}.kanban-plugin__date-picker .flatpickr-current-month .numInputWrapper span.arrowDown:after{border-top-color:var(--text-normal)}.flatpickr-months .flatpickr-next-month svg path,.flatpickr-months .flatpickr-prev-month svg path{fill:currentColor}.kanban-plugin__date-picker .flatpickr-calendar{font-size:13px;overflow:hidden;background-color:var(--background-primary);width:calc(var(--cell-size) * 7 + 8px);box-shadow:0 0 0 1px var(--background-modifier-border),0 15px 25px #0003}.kanban-plugin__date-picker .flatpickr-months{font-size:13px;padding:2px 2px 4px;align-items:center}.kanban-plugin__date-picker .flatpickr-months .flatpickr-current-month input.cur-year,.kanban-plugin__date-picker .flatpickr-months select{border-radius:4px;padding:4px}.kanban-plugin__date-picker .flatpickr-months .numInputWrapper{border-radius:4px}.kanban-plugin__date-picker .flatpickr-months .flatpickr-month{width:100%;height:auto}.kanban-plugin__date-picker .flatpickr-months .flatpickr-next-month,.kanban-plugin__date-picker .flatpickr-months .flatpickr-prev-month{color:var(--text-normal);fill:currentColor;border-radius:4px;display:flex;align-items:center;justify-content:center;line-height:1;height:auto;padding:5px;position:static;flex-shrink:0}.kanban-plugin__date-picker .flatpickr-months .flatpickr-next-month:hover,.kanban-plugin__date-picker .flatpickr-months .flatpickr-prev-month:hover{background-color:var(--background-primary-alt);color:var(--text-normal)}.kanban-plugin__date-picker .flatpickr-months .flatpickr-next-month:hover svg,.kanban-plugin__date-picker .flatpickr-months .flatpickr-prev-month:hover svg{fill:currentColor}.kanban-plugin__date-picker .flatpickr-current-month .flatpickr-monthDropdown-months{color:var(--text-normal);font-weight:inherit;margin-right:5px}.kanban-plugin__date-picker .flatpickr-current-month input.cur-year{color:var(--text-normal);font-weight:inherit}.kanban-plugin__date-picker .flatpickr-weekdays{height:auto;padding:8px 0 12px}.kanban-plugin__date-picker span.flatpickr-weekday{font-weight:400;color:var(--text-muted)}.kanban-plugin__date-picker .flatpickr-innerContainer{padding:4px}.kanban-plugin__date-picker .flatpickr-day{color:var(--text-normal);display:inline-flex;align-items:center;justify-content:center;width:var(--cell-size);height:var(--cell-size);line-height:1;border-radius:6px}.kanban-plugin__date-picker .flatpickr-day.today{border-color:var(--interactive-accent)}.kanban-plugin__date-picker .flatpickr-day.today:hover{color:var(--text-normal);border-color:var(--interactive-accent);background-color:var(--background-primary-alt)}.kanban-plugin__date-picker .flatpickr-day.selected{border-color:var(--interactive-accent);background-color:var(--interactive-accent);color:var(--text-on-accent)}.kanban-plugin__date-picker .flatpickr-day.selected:hover{border-color:var(--interactive-accent);background-color:var(--interactive-accent)}.kanban-plugin__date-picker .flatpickr-days{width:calc(var(--cell-size) * 7)}.kanban-plugin__date-picker .dayContainer{width:calc(var(--cell-size) * 7);min-width:calc(var(--cell-size) * 7);max-width:calc(var(--cell-size) * 7)}.kanban-plugin__date-picker .flatpickr-day.inRange,.kanban-plugin__date-picker .flatpickr-day.nextMonthDay.inRange,.kanban-plugin__date-picker .flatpickr-day.nextMonthDay.today.inRange,.kanban-plugin__date-picker .flatpickr-day.nextMonthDay:focus,.kanban-plugin__date-picker .flatpickr-day.nextMonthDay:hover,.kanban-plugin__date-picker .flatpickr-day.prevMonthDay.inRange,.kanban-plugin__date-picker .flatpickr-day.prevMonthDay.today.inRange,.kanban-plugin__date-picker .flatpickr-day.prevMonthDay:focus,.kanban-plugin__date-picker .flatpickr-day.prevMonthDay:hover,.kanban-plugin__date-picker .flatpickr-day.today.inRange,.kanban-plugin__date-picker .flatpickr-day:focus,.kanban-plugin__date-picker .flatpickr-day:hover{background-color:var(--background-primary-alt);border-color:var(--background-primary-alt)}.kanban-plugin__date-picker .flatpickr-day.flatpickr-disabled,.kanban-plugin__date-picker .flatpickr-day.flatpickr-disabled:hover,.kanban-plugin__date-picker .flatpickr-day.nextMonthDay,.kanban-plugin__date-picker .flatpickr-day.notAllowed,.kanban-plugin__date-picker .flatpickr-day.notAllowed.nextMonthDay,.kanban-plugin__date-picker .flatpickr-day.notAllowed.prevMonthDay,.kanban-plugin__date-picker .flatpickr-day.prevMonthDay{color:var(--text-faint)}.kanban-plugin__time-picker{position:absolute;max-height:250px;overflow:auto;border-radius:4px;border:1px solid var(--background-modifier-border);box-shadow:0 2px 8px var(--background-modifier-box-shadow);background:var(--background-primary);color:var(--text-normal);font-size:14px;z-index:var(--layer-menu)}.kanban-plugin__time-picker-item{display:flex;align-items:center;color:var(--text-muted);cursor:var(--cursor);line-height:1;padding:6px 8px}.kanban-plugin__time-picker-check{visibility:hidden;display:inline-flex;margin-right:5px}.kanban-plugin__time-picker-item.is-hour{color:var(--text-normal);font-weight:600}.kanban-plugin__time-picker-item.is-selected .kanban-plugin__time-picker-check{visibility:visible}.kanban-plugin__time-picker-item.is-selected,.kanban-plugin__time-picker-item:hover{background:var(--background-secondary)}.kanban-plugin mark{background-color:var(--text-highlight-bg)}.kanban-plugin__draggable-setting-container{border-top:0;padding:0;flex-direction:column}.kanban-plugin__draggable-setting-container>div{width:100%;margin-right:0!important}.kanban-plugin__setting-item-wrapper{border-top:1px solid var(--background-modifier-border)}.kanban-plugin__draggable-setting-container>.kanban-plugin__placeholder{border-top:1px solid var(--background-modifier-border)}.kanban-plugin__setting-item{background-color:var(--background-secondary);width:100%;font-size:16px;display:flex;align-items:flex-start;padding:12px;color:var(--text-muted)}.kanban-plugin__drag-container .kanban-plugin__setting-item{border:1px solid hsla(var(--interactive-accent-hsl),.8);box-shadow:0 15px 25px #0003,0 0 0 2px hsla(var(--interactive-accent-hsl),.8)}.kanban-plugin__setting-controls-wrapper{flex-grow:1;flex-shrink:1}.kanban-plugin__setting-input-wrapper{display:flex;flex-wrap:wrap;margin-bottom:1rem}.kanban-plugin__setting-input-wrapper>div{margin-right:10px}.kanban-plugin__setting-toggle-wrapper>div{display:flex;align-items:center;line-height:1;margin-bottom:10px}.kanban-plugin__setting-toggle-wrapper .checkbox-container{margin-right:10px}.kanban-plugin__setting-button-wrapper{display:flex;justify-content:flex-end;flex-grow:1;flex-shrink:0;max-width:25px}.kanban-plugin__setting-button-wrapper>div{margin-left:12px}.kanban-plugin__setting-key-input-wrapper{margin:1rem 0}.kanban-plugin__setting-key-input-wrapper>input{margin-right:10px}.kanban-plugin__date-color-input-wrapper,.kanban-plugin__tag-color-input-wrapper{display:flex;flex-direction:column;flex-grow:1;gap:1rem}.kanban-plugin__add-tag-color-button{align-self:baseline;margin:0}.kanban-plugin__date-color-wrapper,.kanban-plugin__tag-color-input .kanban-plugin__item-tags{background-color:var(--background-primary);padding:10px;margin:0;border-radius:4px}.kanban-plugin__tag-color-input .kanban-plugin__item-tag{margin-top:0;font-size:13px;font-weight:500;line-height:1.5}.kanban-plugin__item-metadata>.kanban-plugin__item-metadata-date-wrapper,.kanban-plugin__item-metadata>.kanban-plugin__item-metadata-date-wrapper .is-button:hover{display:inline-block;color:var(--date-color,var(--text-muted));line-height:1}.kanban-plugin__item-metadata>.kanban-plugin__item-metadata-date-wrapper.has-background{background-color:var(--date-background-color,transparent);margin-top:4px;border-radius:var(--tag-radius);padding:var(--tag-padding-y) var(--tag-padding-x)}.kanban-plugin__date-color-input-wrapper input[type=number]{width:75px;padding:.6em .8em;height:auto;border-radius:.5em}.kanban-plugin__date-color-input-wrapper .kanban-plugin__setting-item-label{margin-bottom:0}.kanban-plugin__date-color-config{padding:0 0 10px;display:flex;flex-wrap:wrap;gap:5px;align-items:center}.kanban-plugin__date-color-wrapper{display:inline-block;margin-top:10px}.kanban-plugin__date-color-wrapper .kanban-plugin__item-metadata{padding:0}.kanban-plugin__metadata-setting-desc{font-size:14px}.kanban-plugin__setting-button-spacer{visibility:hidden}.kanban-plugin__setting-item-label{font-size:12px;font-weight:700;margin-bottom:5px}.kanban-plugin__setting-toggle-wrapper .kanban-plugin__setting-item-label{margin-bottom:0}.kanban-plugin__hitbox{border:2px dashed tomato}.kanban-plugin__placeholder{flex-grow:0;flex-shrink:0;width:0;height:0;pointer-events:none}.kanban-plugin__placeholder[data-axis=horizontal]{height:100%}.kanban-plugin__placeholder[data-axis=vertical]{width:100%}body:not(.native-scrollbars) .kanban-plugin__scroll-container::-webkit-scrollbar{background-color:transparent;width:16px;height:16px}body:not(.native-scrollbars) .kanban-plugin__scroll-container::-webkit-scrollbar-thumb{border:4px solid transparent;background-clip:content-box}.kanban-plugin__scroll-container{will-change:transform}.kanban-plugin__scroll-container.kanban-plugin__horizontal{overflow-y:hidden;overflow-x:auto}.kanban-plugin__scroll-container.kanban-plugin__vertical{overflow-y:auto;overflow-x:hidden}.kanban-plugin__drag-container{contain:layout size;z-index:10000;pointer-events:none;position:fixed;top:0;left:0}.kanban-plugin__loading{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.sk-pulse{width:60px;height:60px;background-color:var(--text-faint);border-radius:100%;animation:sk-pulse 1.2s infinite cubic-bezier(.455,.03,.515,.955)}@keyframes sk-pulse{0%{transform:scale(0)}to{transform:scale(1);opacity:0}}.kanban-plugin__color-picker-wrapper{position:relative}.kanban-plugin__color-picker{position:absolute;top:-5px;left:0;transform:translateY(-100%)}#cMenuModalBar{width:auto;height:auto;padding:3px;display:grid;user-select:none;border-radius:6px;position:absolute;transition:.2s ease;min-width:fit-content;justify-content:space-around;z-index:var(--layer-status-bar);box-shadow:0 3px 32px rgb(31 38 135 / 15%);border:1px solid var(--background-modifier-border)}#cMenuModalBar .cMenuCommandItem{margin:2px;border:none;display:flex;cursor:pointer;padding:5px 6px;box-shadow:none;margin-left:3px;margin-right:3px;position:relative;border-radius:3px;font-size:initial!important;background-color:var(--background-primary-alt)}#cMenuModalBar button.cMenuCommandItem:hover{background-color:var(--background-secondary)}#cMenuModalBar button.cMenuCommandItem svg{width:1.3em;height:1.3em}.modal.mod-settings button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonAdd,button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonAdd{background-color:var(--interactive-accent)}.modal.mod-settings button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonDelete,button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonDelete{background-color:#989cab}.modal.mod-settings button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonRefresh,button:not(.mod-cta):not(.mod-warning).cMenuSettingsButton.cMenuSettingsButtonRefresh{background-color:var(--text-accent)}button.cMenuSettingsButton{padding:4px 14px;border-radius:6px}.cMenuSettingsButton svg{width:1.3em;height:1.3em;display:flex}.setting-item.cMenuCommandItem:first-child{padding-top:18px}.cMenuCommandItem{cursor:grab;padding:18px 0 18px 0}.sortable-fallback{cursor:grabbing;box-shadow:0 3px 32px rgb(31 38 135 / 15%)}.sortable-grab{cursor:grabbing!important}.sortable-ghost{opacity:.4;cursor:grabbing}.sortable-chosen{cursor:grabbing;padding:18px 0 18px 18px;background-color:var(--background-primary)}.sortable-drag{cursor:grabbing;box-shadow:0 3px 32px rgb(31 38 135 / 15%)}.cMenuSettingsTabsContainer{border-top:1px solid var(--background-modifier-border);border-bottom:1px solid var(--background-modifier-border)}.cMenuGlassAesthetic{backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}.cMenuDefaultAesthetic{background-color:var(--background-primary)}.cMenuIconPick{line-height:normal;vertical-align:middle;margin-right:8px}.cMenuIconPick svg{width:17px;height:17px}.cMenu-statusbar-menu{width:200px}.cMenu-statusbar-menu .menu-item-icon{display:none}.cMenu-statusbar-menu .menu-item{display:flex;align-items:center;justify-content:space-between;flex-direction:row}.cMenu-statusbar-menu .menu-item.settings-item{font-size:12px;text-align:center;line-height:1;border-radius:5px;height:auto;padding:8px 5px 0 5px;margin:0 auto;width:fit-content;color:var(--text-faint)}.cMenu-statusbar-menu .menu-item.settings-item .menu-item-title{text-align:center}.cMenu-statusbar-menu .menu-item .selected:hover,.cMenu-statusbar-menu .menu-item.selected:not(.is-disabled):not(.is-label),.cMenu-statusbar-menu .menu-item:hover{background-color:transparent}.cMenu-statusbar-menu .menu-item-title{margin-right:10px}.cMenu-statusbar-menu .slider{width:100%}.cMenu-statusbar-menu .menu-item.buttonitem{padding-top:10px;padding-bottom:4px;height:fit-content}.cMenu-statusbar-menu .menu-item.buttonitem button.cMenuSettingsButton{margin:0}.cMenu-statusbar-button{cursor:pointer;display:flex;align-items:center;line-height:1}.cMenu-statusbar-button svg{display:flex;width:1.3em;height:1.3em}.cDonationSection{width:60%;height:50vh;margin:0 auto;text-align:center;color:var(--text-normal)}</style><style>body{--file-line-width:1900px}</style><style>body{--line-width:50em;--line-width-adaptive:50em;--file-line-width:50em;--content-width:500em;--sidebar-width:calc(min(25em, 80vw));--collapse-arrow-size:0.35em;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:24px}body{--zoom-factor:0.7607257743127308!important;--accent-h:254!important;--accent-s:68%!important;--accent-l:56%!important;--font-text-size:17px!important;--indent-size:3}</style><script>let webpageContainer,documentContainer,viewContent,leftSidebar,rightSidebar,sidebarCollapseIcons,sidebarGutters,sidebars,sidebarTargetWidth,contentTargetWidth,canvasWrapper,canvas,canvasNodes,canvasBackground,canvasBackgroundPattern,focusedCanvasNode,loadingIcon,documentType,embedType,customType,deviceSize,lastScreenWidth,isOffline=!1,collapseIconUp=["m7 15 5 5 5-5","m7 9 5-5 5 5"],collapseIconDown=["m7 20 5-5 5 5","m7 4 5 5 5-5"],isTouchDevice=isTouchCapable(),fullyInitialized=!1;function initGlobalObjects(){loadingIcon=document.createElement("div"),loadingIcon.classList.add("loading-icon"),document.body.appendChild(loadingIcon),loadingIcon.innerHTML="<div></div><div></div><div></div><div></div>",webpageContainer=document.querySelector(".webpage-container"),documentContainer=document.querySelector(".document-container"),leftSidebar=document.querySelector(".sidebar-left"),rightSidebar=document.querySelector(".sidebar-right"),sidebarCollapseIcons=Array.from(document.querySelectorAll(".sidebar-collapse-icon")),sidebarGutters=[sidebarCollapseIcons[0].parentElement,sidebarCollapseIcons[1].parentElement],sidebars=[sidebarGutters[0].parentElement,sidebarGutters[1].parentElement]}async function initializePage(){focusedCanvasNode=null,canvasWrapper=document.querySelector(".canvas-wrapper")??canvasWrapper,canvas=document.querySelector(".canvas")??canvas;let e=document.querySelectorAll(".canvas-node");canvasNodes=e.length>0?e:canvasNodes,canvasBackground=document.querySelector(".canvas-background")??canvasBackground,canvasBackgroundPattern=document.querySelector(".canvas-background pattern")??canvasBackgroundPattern,viewContent=document.querySelector(".document-container > .view-content")??document.querySelector(".document-container > .markdown-preview-view")??viewContent,fullyInitialized||(initGlobalObjects(),initializeDocumentTypes(),setupSidebars(),setupThemeToggle(),sidebarTargetWidth=await getComputedPixelValue("--sidebar-width"),contentTargetWidth=.9*await getComputedPixelValue("--line-width"),window.addEventListener("resize",(()=>onResize())),onResize(),document.body.classList.toggle("post-load",!0),document.body.classList.toggle("loading",!1),setTimeout((function(){document.body.classList.toggle("loaded",!0),document.body.classList.toggle("post-load",!1)}),2e3),fullyInitialized=!0),"video"==embedType||"embed"==embedType||"excalidraw"==customType||"kanban"==customType||"canvas"==documentType?rightSidebar.collapsed||rightSidebar.temporaryCollapse():rightSidebar.temporarilyCollapsed&&rightSidebar.collapsed&&(rightSidebar.collapse(!1),rightSidebar.temporarilyCollapsed=!1)}function initializePageEvents(e){setupHeaders(e),setupTrees(e),setupCallouts(e),setupCheckboxes(e),setupCanvas(e),setupCodeblocks(e),setupLinks(e),setupScroll(e)}function initializeDocumentTypes(){document.querySelector(".document-container > .markdown-preview-view")?documentType="markdown":document.querySelector(".canvas-wrapper")?documentType="canvas":(documentType="custom",document.querySelector(".kanban-plugin")?customType="kanban":document.querySelector(".excalidraw-plugin")&&(customType="excalidraw"))}function initializeForFileProtocol(){let e=document.querySelector(".graph-view-placeholder");e&&(console.log("Running locally, skipping graph view initialization and hiding graph."),e.style.display="none",e.previousElementSibling.style.display="none")}function onOffline(e){e.preventDefault(),e.stopPropagation(),console.log("Offline"),isOffline=!0}function onEndResize(){document.body.classList.toggle("resizing",!1)}function onStartResize(){document.body.classList.toggle("resizing",!0)}window.onload=async function(){"file:"==window.location.protocol&&initializeForFileProtocol(),await initializePage(),initializePageEvents(document)},window.addEventListener("offline",onOffline),window.onpopstate=function(e){if(e.preventDefault(),e.stopPropagation(),document.body.classList.contains("floating-sidebars")&&(!leftSidebar.collapsed||!rightSidebar.collapsed))return leftSidebar.collapse(!0),void rightSidebar.collapse(!0);loadDocument(getURLPath(),!1)};let checkStillResizingTimeout,isResizing=!1;function onResize(e=!1){function t(e,t){let o=window.innerWidth;return o>e&&o<t&&null==lastScreenWidth||o>e&&o<t&&(lastScreenWidth<=e||lastScreenWidth>=t)}isResizing||(onStartResize(),isResizing=!0),function(e){let t=window.innerWidth;return t>e&&null==lastScreenWidth||t>e&&lastScreenWidth<e}(contentTargetWidth+2*sidebarTargetWidth)?(deviceSize="large-screen",document.body.classList.toggle("floating-sidebars",!1),document.body.classList.toggle("is-large-screen",!0),document.body.classList.toggle("is-small-screen",!1),document.body.classList.toggle("is-tablet",!1),document.body.classList.toggle("is-phone",!1),sidebars.forEach((function(e){e.collapse(!1)})),document.body.classList.contains("sidebars-always-collapsible")?sidebarGutters.forEach((function(e){e.collapse(!1)})):sidebarGutters.forEach((function(e){e.collapse(!0)}))):t(contentTargetWidth+sidebarTargetWidth,contentTargetWidth+2*sidebarTargetWidth)?(deviceSize="small screen",document.body.classList.toggle("floating-sidebars",!1),document.body.classList.toggle("is-large-screen",!1),document.body.classList.toggle("is-small-screen",!0),document.body.classList.toggle("is-tablet",!1),document.body.classList.toggle("is-phone",!1),sidebarGutters.forEach((function(e){e.collapse(!1)})),leftSidebar.collapsed||rightSidebar.collapse(!0)):t(1.5*sidebarTargetWidth,contentTargetWidth+sidebarTargetWidth)?(deviceSize="tablet",document.body.classList.toggle("floating-sidebars",!0),document.body.classList.toggle("is-large-screen",!1),document.body.classList.toggle("is-small-screen",!1),document.body.classList.toggle("is-tablet",!0),document.body.classList.toggle("is-phone",!1),sidebarGutters.forEach((function(e){e.collapse(!1)})),leftSidebar.collapsed||rightSidebar.collapse(!0),fullyInitialized||leftSidebar.collapse(!0)):function(e){let t=window.innerWidth;return t<e&&null==lastScreenWidth||t<e&&lastScreenWidth>e}(1.5*sidebarTargetWidth)&&(deviceSize="phone",document.body.classList.toggle("floating-sidebars",!0),document.body.classList.toggle("is-large-screen",!1),document.body.classList.toggle("is-small-screen",!1),document.body.classList.toggle("is-tablet",!1),document.body.classList.toggle("is-phone",!0),sidebars.forEach((function(e){e.collapse(!0)})),sidebarGutters.forEach((function(e){e.collapse(!1)}))),lastScreenWidth=window.innerWidth,null!=checkStillResizingTimeout&&clearTimeout(checkStillResizingTimeout);let o=window.innerWidth;checkStillResizingTimeout=setTimeout((function(){window.innerWidth==o&&(checkStillResizingTimeout=void 0,isResizing=!1,onEndResize())}),200)}function clamp(e,t,o){return Math.min(Math.max(e,t),o)}function getElBounds(e){let t=e.getBoundingClientRect(),o=t.x,n=t.y,i=t.width,s=t.height;return{x:o,y:n,width:i,height:s,minX:o,minY:n,maxX:o+i,maxY:n+s,centerX:t.x+t.width/2,centerY:t.y+t.height/2}}async function getComputedPixelValue(e){const t=document.createElement("div");document.body.appendChild(t),t.style.position="absolute",t.style.width=`var(${e})`,await new Promise((e=>setTimeout(e,10)));const o=window.getComputedStyle(t).width;return t.remove(),parseFloat(o)}function getPointerPosition(e){let t=e.touches?Array.from(e.touches):[];return{x:t.length>0?t.reduce(((e,t)=>e+t.clientX),0)/e.touches.length:e.clientX,y:t.length>0?t.reduce(((e,t)=>e+t.clientY),0)/e.touches.length:e.clientY}}function getTouchPosition(e){return{x:e.clientX,y:e.clientY}}function getAllChildrenRecursive(e){let t=[];for(let o=0;o<e.children.length;o++){const n=e.children[o];t.push(n),t=t.concat(getAllChildrenRecursive(n))}return t}function isMobile(){let e=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}function isTouchCapable(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function downloadBlob(e,t="file.txt"){if(window.navigator&&window.navigator.msSaveOrOpenBlob)return window.navigator.msSaveOrOpenBlob(e);const o=window.URL.createObjectURL(e),n=document.createElement("a");n.href=o,n.download=t,n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((()=>{window.URL.revokeObjectURL(o),n.remove()}),100)}function extentionToTag(e){return["png","jpg","jpeg","svg","gif","bmp","ico"].includes(e)?"img":["mp4","mov","avi","webm","mpeg"].includes(e)?"video":["mp3","wav","ogg","aac"].includes(e)?"audio":["pdf"].includes(e)?"embed":void 0}let slideUp=(e,t=500)=>{e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout((async()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},slideUpAll=(e,t=500)=>{e.forEach((async e=>{e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0})),window.setTimeout((async()=>{e.forEach((async e=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}))}),t)},slideDown=(e,t=500)=>{e.style.removeProperty("display");let o=window.getComputedStyle(e).display;"none"===o&&(o="block"),e.style.display=o;let n=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=n+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout((async()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},slideDownAll=(e,t=500)=>{e.forEach((async e=>{e.style.removeProperty("display");let o=window.getComputedStyle(e).display;"none"===o&&(o="block"),e.style.display=o;let n=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=n+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom")})),window.setTimeout((async()=>{e.forEach((async e=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}))}),t)};var slideToggle=(e,t=500)=>"none"===window.getComputedStyle(e).display?slideDown(e,t):slideUp(e,t),slideToggleAll=(e,t=500)=>"none"===window.getComputedStyle(e[0]).display?slideDownAll(e,t):slideUpAll(e,t);let transferDocument=document.implementation.createHTMLDocument();async function loadDocument(e,t=!0,o=!0){let n=e.split("#"),i=n[0]??e;console.log("Loading document: "+i),loadingIcon.classList.toggle("shown",!0);let s,a=getViewBounds();if(loadingIcon.style.left=a.centerX-loadingIcon.offsetWidth/2+"px",loadingIcon.style.top=a.centerY-loadingIcon.offsetHeight/2+"px",documentContainer.classList.toggle("hide",!0),documentContainer.classList.toggle("show",!1),"phone"==deviceSize&&leftSidebar.collapse(!0),!isOffline){try{s=await fetch(i)}catch(e){return console.log("Cannot use fetch API (likely due to CORS), just loading the page normally."),void window.location.assign(i)}if(s.ok){setActiveDocument(i,o,t);let a=e.split(".").pop().split("?")[0].split("#")[0].toLowerCase().trim();if(documentType="none",embedType="none",customType="none","html"==a){let e=(await s.text()).replaceAll("<!DOCTYPE html>","").replaceAll("<html>","").replaceAll("</html>","");transferDocument.write(e);let t=document.importNode(transferDocument.querySelector(".document-container"),!0);documentContainer.remove(),documentContainer=t,webpageContainer.insertBefore(documentContainer,webpageContainer.children[1]),document.querySelector(".outline-tree").innerHTML=transferDocument.querySelector(".outline-tree").innerHTML;let o=n.length>1?n[1]:null;o&&document.getElementById(o).scrollIntoView(),setupRootPath(transferDocument),initializeDocumentTypes(),setTimeout((function(){initializePageEvents(documentContainer),initializePageEvents(document.querySelector(".outline-tree"))}),0),document.title=transferDocument.title,transferDocument.close()}else if(documentType="embed",embedType=extentionToTag(a),null!=embedType){let t=document.createElement(embedType);t.controls=!0,t.src=e,t.style.maxWidth="100%","embed"==embedType&&(t.style.width="100%",t.style.height="100%"),t.style.objectFit="contain",viewContent.innerHTML="",viewContent.setAttribute("class","view-content embed"),viewContent.appendChild(t),document.querySelector(".outline-tree").innerHTML="",document.title=e.split("/").pop()}else downloadBlob(await s.blob(),e.split("/").pop());await initializePage()}else setTimeout((function(){viewContent.innerHTML="\n\t\t\t<div>\n\t\t\t\t<center style='position: relative; transform: translateY(20vh); width: 100%; text-align: center;'>\n\t\t\t\t\t<h1 style>Page Not Found</h1>\n\t\t\t\t</center>\n\t\t\t</div>\n\t\t\t",document.querySelector(".outline-tree").innerHTML="",console.log("Page not found: "+getAbsoluteRootPath()+e);let t=getURLRootPath(getAbsoluteRootPath()+e);rootPath=t,document.querySelector("base").href=t,document.title="Page Not Found"}),1e3);return loadingIcon.classList.toggle("shown",!1),documentContainer.style.transitionDuration="",documentContainer.classList.toggle("hide",!1),documentContainer.classList.toggle("show",!0),transferDocument}setTimeout((function(){viewContent.innerHTML="\n<center style='position: relative; transform: translateY(20vh); width: 100%; text-align: center;'>\n\t<h1>You appear to be offline. Check your internet connection and then try reloading the page.</h1>\n</center>",document.querySelector(".outline-tree").innerHTML="",console.log("Page offline: "+getAbsoluteRootPath()+e);let t=getURLRootPath(getAbsoluteRootPath()+e);rootPath=t,document.querySelector("base").href=t,document.title="Page Offline",documentContainer.classList.toggle("hide",!1),documentContainer.classList.toggle("show",!0),loadingIcon.classList.toggle("shown",!1)}),1e3)}function setActiveDocument(e,t=!0,o=!0){let n=e.split("#")[0]??e;document.querySelector(".tree-item.mod-active")?.classList.remove("mod-active");let i,s=Array.from(document.querySelectorAll(".tree-item > .tree-item-contents > .tree-item-link"));for(let t of s)if(t.getAttribute("href")==decodeURI(e)){let e=t.parentElement.parentElement;for(e.classList.add("mod-active"),i=e;e.hasAttribute("data-depth");)setTreeCollapsed(e,!1,!1),e=e.parentElement.parentElement;break}if(t&&i?.scrollIntoView({block:"center",inline:"nearest"}),"undefined"!=typeof nodes&&window.renderWorker){let e=nodes?.paths.findIndex((function(e){return e.endsWith(n)}))??-1;e>=0&&(window.renderWorker.activeNode=e)}o&&"file:"!=window.location.protocol&&window.history.pushState({path:n},"",n)}function setupRootPath(e){let t=e.querySelector("#root-path").getAttribute("root-path");document.querySelector("base").href=t,document.querySelector("#root-path").setAttribute("root-path",t),rootPath=t}function getAbsoluteRootPath(){return"undefined"==typeof rootPath&&setupRootPath(document),new URL(window.location.href+"/../"+rootPath).pathname}function getURLPath(e=window.location.pathname){let t=getAbsoluteRootPath();return e.substring(t.length)}function getURLRootPath(e=window.location.pathname){let t=getURLPath(e).split("/"),o="";for(let e=0;e<t.length-1;e++)o+="../";return o}function setupHeaders(e){e.querySelectorAll(".heading-collapse-indicator").forEach((function(e){e.addEventListener("click",(function(){toggleTreeHeaderOpen(e.parentElement.parentElement,!0)}))})),e.querySelectorAll(".heading-wrapper").forEach((function(e){e.collapsed=!1,e.childrenContainer=e.querySelector(".heading-children"),e.parentHeader=e.parentElement.parentElement,e.headerElement=e.querySelector(".heading"),e.markdownPreviewSizer=getHeaderSizerEl(e),e.collapse=function(t,o=!0,n=!1){collapseHeader(e,t,o,n)},e.toggleCollapse=function(t=!0){toggleTreeHeaderOpen(e,t)},e.hide=function(){hideHeader(e)},e.show=function(t=!1,o=!1,n=!1){showHeader(e,t,o,n)}})),e.querySelectorAll(".heading").forEach((function(e){e.headingWrapper=e.parentElement}))}function isHeadingWrapper(e){return!!e&&e.classList.contains("heading-wrapper")}function getHeaderSizerEl(e){let t=e;for(;t&&!t.classList.contains("markdown-preview-sizer");)t=t.parentElement;return t||void 0}async function collapseHeader(e,t,o=!0,n=!1){let i=e.childrenContainer;if(o&&!t){let t=e.parentHeader;isHeadingWrapper(t)&&t.collapse(!1,!0,n)}if(e.classList.contains("is-collapsed")==t)return void(t||"canvas"!=documentType||e.show(!0));if(e.timeout&&(clearTimeout(e.timeout),i.style.transitionDuration="",i.style.height="",e.classList.toggle("is-animating",!1)),t){e.collapseHeight=i.offsetHeight+parseFloat(i.lastChild?.marginBottom||0);let t=e.nextElementSibling;for(;t&&"canvas"==documentType;){let e=t;isHeadingWrapper(e)&&e.show(!1,!0,!0),setTimeout((function(){e.forceShown=!1}),500),t=t.nextElementSibling}}let s=e.collapseHeight;if(i.style.height=s+"px",t||"canvas"!=documentType||e.show(!0),e.collapsed=t,n){console.log("instant"),i.style.transitionDuration="0s",e.classList.toggle("is-collapsed",t),i.style.height="",i.style.transitionDuration="";let o=Array.from(e.markdownPreviewSizer.children).reduce(((e,t)=>e+t.offsetHeight),0);return void(e.markdownPreviewSizer.style.minHeight=o+"px")}let a=getComputedStyle(i).transitionDuration;a=a.endsWith("s")?parseFloat(a):a.endsWith("ms")?parseFloat(a)/1e3:0;let l=Math.min(a*Math.sqrt(s)/16,.5);i.style.transitionDuration=`${l}s`,i.style.height=t?"0px":s+"px",e.classList.toggle("is-animating",!0),e.classList.toggle("is-collapsed",t),setTimeout((function(){i.style.transitionDuration="",t||(i.style.height=""),e.classList.toggle("is-animating",!1);let o=Array.from(e.markdownPreviewSizer.children).reduce(((e,t)=>e+t.offsetHeight),0);e.markdownPreviewSizer.style.minHeight=o+"px"}),1e3*l)}function toggleTreeHeaderOpen(e,t=!0){e.collapse(!e.collapsed,t)}function hideHeader(e){if(e.forceShown)return;if(e.classList.contains("is-hidden")||e.classList.contains("is-collapsed"))return;if("none"==getComputedStyle(e).display)return;let t=e.offsetHeight;e.classList.toggle("is-hidden",!0),0!=t&&(e.style.height=t+"px"),e.style.visibility="hidden"}function showHeader(e,t=!0,o=!1,n=!1){if(n&&(e.forceShown=!0),t){let t=e.parentHeader;isHeadingWrapper(t)&&t.show(!0,!1,n)}o&&e.querySelectorAll(".heading-wrapper").forEach((function(e){e.show(!1,!0,n)})),e.classList.contains("is-hidden")&&!e.classList.contains("is-collapsed")&&(e.classList.toggle("is-hidden",!1),e.style.height="",e.style.visibility="")}function setupTrees(e){const t=Array.from(e.querySelectorAll(".tree-container.file-tree .tree-item")),o=Array.from(e.querySelectorAll(".tree-container.outline-tree .tree-item"));e.querySelectorAll(".tree-item-link > .collapse-icon").forEach((function(e){e.addEventListener("click",(function(t){return t.preventDefault(),t.stopPropagation(),toggleTreeCollapsed(e.parentElement.parentElement.parentElement),!1}))})),e.querySelectorAll(".collapse-tree-button").forEach((function(e){e.treeRoot=e.parentElement.parentElement,e.icon=e.firstChild,e.icon.innerHTML="<path d></path><path d></path>";let n=e.treeRoot.classList.contains("file-tree")?t:o;e.setIcon=function(t){e.icon.children[0].setAttribute("d",t?collapseIconUp[0]:collapseIconDown[0]),e.icon.children[1].setAttribute("d",t?collapseIconUp[1]:collapseIconDown[1])},e.collapse=function(t){setTreeCollapsedAll(n,t),e.setIcon(t),e.collapsed=t},e.toggleCollapse=function(){e.collapse(!e.collapsed)},e.collapsed=0!=e.treeRoot.querySelectorAll(".tree-scroll-area + .tree-item.mod-collapsible.is-collapsed"),e.setIcon(e.collapsed),e.addEventListener("click",(function(t){return t.preventDefault(),t.stopPropagation(),e.toggleCollapse(),!1}))})),t.forEach((function(e){let t=e.querySelector(".tree-item-link");if(e.querySelector(".collapse-icon"))t?.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();let t=this.parentElement?.parentElement;t&&toggleTreeCollapsed(t)}));else{let o=t.getAttribute("href").split(".").pop();if(!o.includes(" ")&&"html"!=o){let t=document.createElement("div");t.classList.add("nav-file-tag"),t.textContent=o.toUpperCase(),e.querySelector(".tree-item-contents").appendChild(t)}}}))}async function setTreeCollapsed(e,t,o=!0){if(!e||!e.classList.contains("mod-collapsible"))return;let n=e.querySelector(".tree-item-children");t?(e.classList.add("is-collapsed"),o?slideUp(n,100):n.style.display="none"):(e.classList.remove("is-collapsed"),o?slideDown(n,100):n.style.removeProperty("display"))}async function setTreeCollapsedAll(e,t,o=!0){let n=[];e.forEach((async e=>{if(!e||!e.classList.contains("mod-collapsible"))return;let o=e.querySelector(".tree-item-children");t?e.classList.add("is-collapsed"):e.classList.remove("is-collapsed"),n.push(o)})),t?o?slideUpAll(n,100):n.forEach((async e=>e.style.display="none")):o?slideDownAll(n,100):n.forEach((async e=>e.style.removeProperty("display")))}function toggleTreeCollapsed(e){e&&setTreeCollapsed(e,!e.classList.contains("is-collapsed"))}function toggleTreeCollapsedAll(e){e&&setTreeCollapsedAll(e,!e[0].classList.contains("is-collapsed"))}function setupCanvas(e){if("canvas"!=documentType||!e.querySelector(".canvas-wrapper"))return;e.querySelector(".canvas")?.setAttribute("style","translate: 0px 1px; scale: 1;");let t=getNodesBounds();function o(e){let t=e.touches??[];if(!(t.length>1)&&(1==e.button||0==e.button||t.length>0)){let o=getPointerPosition(e),n=!1,i=0,s=t.length,a=function(t){let a=t.touches??[],l=getPointerPosition(t);s!=a.length&&(o=l,s=a.length);let r=l.x-o.x,c=l.y-o.y,d=!1;if((1==e.button||1==a.length)&&focusedCanvasNode){let e=Math.abs(r)>Math.abs(1.5*c),t=Math.abs(c)>Math.abs(1.5*r),o=focusedCanvasNode.querySelector(".markdown-preview-sizer");if(o){let n=o.scrollHeight>o.parentElement.clientHeight+1,i=o.scrollWidth>o.parentElement.clientWidth+1;(e&&i||t&&n)&&(d=!0)}}if(d||(translateCanvas(r,c),o=l),2==a.length){let e=getPointerPosition(t,!1),o=getTouchPosition(t.touches[0]),s=getTouchPosition(t.touches[1]),a=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2));n||(n=!0,i=a),scaleCanvasAroundPoint(1+(a-i)/i,e.x,e.y),i=a}},l=function(e){document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",l),document.body.removeEventListener("mouseenter",r),document.body.removeEventListener("touchmove",a),document.body.removeEventListener("touchend",l),document.body.removeEventListener("touchcancel",l)},r=function(e){1!=e.buttons&&4!=e.buttons&&l(e)};document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",l),document.body.addEventListener("mouseenter",r),document.body.addEventListener("touchmove",a),document.body.addEventListener("touchend",l),document.body.addEventListener("touchcancel",l)}}setViewCenter(t.centerX,t.centerY),e.querySelectorAll(".canvas-node-container").forEach((function(e){var t=e.parentElement;function o(e){t.classList.toggle("is-focused"),null!=focusedCanvasNode&&focusedCanvasNode!=t&&(focusedCanvasNode.classList.remove("is-focused"),focusedCanvasNode.querySelector(".canvas-node-container").style.display=""),focusedCanvasNode=t,t.addEventListener("mouseleave",n),t.addEventListener("touchend",n)}function n(e){focusedCanvasNode&&(focusedCanvasNode.classList.remove("is-focused"),focusedCanvasNode=null),t.removeEventListener("mouseleave",n),t.removeEventListener("touchend",n)}e.addEventListener("mouseenter",o),e.addEventListener("touchstart",o)})),e.querySelectorAll(".canvas-node").forEach((function(e){e.addEventListener("dblclick",(function(t){fitViewToNode(e)}))})),e.querySelectorAll(".canvas-background").forEach((function(e){e.addEventListener("dblclick",(function(e){fitViewToCanvas()}))})),canvasWrapper.addEventListener("mousedown",o),canvasWrapper.addEventListener("touchstart",o);let n=0,i=0;canvasWrapper.addEventListener("mousemove",(function(e){let t=getPointerPosition(e);n=t.x,i=t.y}));let s=1,a=0,l=!1;canvasWrapper.addEventListener("wheel",(function(e){if(focusedCanvasNode){let e=focusedCanvasNode.querySelector(".markdown-preview-sizer");if(e&&e.scrollHeight>e.parentElement.clientHeight)return}if(e.preventDefault(),e.stopPropagation(),l){let t=1;t-=e.deltaY/700*t,t=clamp(t,.1,10);let o=getViewBounds();scaleCanvasAroundPoint(t,o.centerX,o.centerY)}else{let t=0==a;a-=e.deltaY/200;const o=.14*s;a=clamp(a,-o,o),t&&requestAnimationFrame(u)}}));let r=0,c=0,d=0;function u(e){if(r=e-c,0==c&&(r=30),c=e,d=.05*r+.95*d,d>50)return console.log("Scrolling too slow, turning on instant scroll"),void(l=!0);let t=s;s+=a*(r/1e3)*30,s=clamp(s,.1,10),getViewBounds(),scaleCanvasAroundPoint(s/t,n,i),a*=.4,Math.abs(a)<.01?(a=0,c=0):requestAnimationFrame(u)}fitViewToCanvas()}function getViewBounds(){let e=viewContent.getBoundingClientRect(),t=e.x,o=e.y,n=e.x+e.width,i=e.y+e.height;return{x:t,y:o,width:n-t,height:i-o,minX:t,minY:o,maxX:n,maxY:i,centerX:e.x+e.width/2,centerY:e.y+e.height/2}}function getNodesBounds(){let e=1/0,t=1/0,o=-1/0,n=-1/0;canvasNodes.forEach((function(i){let s=i.getBoundingClientRect();s.x<e&&(e=s.x),s.y<t&&(t=s.y),s.x+s.width>o&&(o=s.x+s.width),s.y+s.height>n&&(n=s.y+s.height)}));let i=o-e,s=n-t;return{x:e,y:t,width:i,height:s,minX:e,minY:t,maxX:o,maxY:n,centerX:e+i/2,centerY:t+s/2}}function getCanvasBounds(){let e=canvas.getBoundingClientRect(),t=e.x,o=e.y,n=e.width,i=e.height;return{x:t,y:o,width:n,height:i,minX:t,minY:o,maxX:t+n,maxY:o+i,centerX:e.x+e.width/2,centerY:e.y+e.height/2}}function scaleCanvasAroundPoint(e,t,o){let n=getCanvasBounds(),i=t-n.x,s=o-n.y,a=t-(n.x+i*e),l=o-(n.y+s*e);return scaleCanvas(e),translateCanvas(a,l),{x:a,y:l}}function scaleCanvas(e){let t=Math.max(e*canvas.style.scale,.001);canvas.style.scale=t,canvasWrapper.style.setProperty("--zoom-multiplier",1/Math.sqrt(t))}function translateCanvas(e,t){let o=canvas.style.translate,n=o.split(" "),i=n.length>0?parseFloat(o.split(" ")[0].trim()):0,s=n.length>1?parseFloat(o.split(" ")[1].trim()):i;canvas.style.translate=`${i+e}px ${s+t}px`}function setViewCenter(e,t){let o=getViewBounds();translateCanvas(o.centerX-e,o.centerY-t)}function getCanvasTranslation(){let e=canvas.style.translate,t=e.split(" "),o=t.length>0?parseFloat(e.split(" ")[0].trim()):0;return{x:o,y:t.length>1?parseFloat(e.split(" ")[1].trim()):o}}function scaleCanvasBackground(e){let t=e*canvasBackgroundPattern.getAttribute("width"),o=e*canvasBackgroundPattern.getAttribute("height");canvasBackgroundPattern.setAttribute("width",t),canvasBackgroundPattern.setAttribute("height",o)}function translateCanvasBackground(e,t){canvasBackgroundPattern.setAttribute("x",e+canvasBackgroundPattern.getAttribute("x")),canvasBackgroundPattern.setAttribute("y",t+canvasBackgroundPattern.getAttribute("y"))}function fitViewToNode(e){let t=getElBounds(e),o=getViewBounds(),n=getCanvasBounds(),i=.8*Math.min(o.width/t.width,o.height/t.height),s=n.x,a=n.y,l=s+(t.centerX-s)*i,r=a+(t.centerY-a)*i,c=o.centerX-l,d=o.centerY-r;t=getElBounds(e),canvas.style.transition="scale 0.5s cubic-bezier(0.5, -0.1, 0.5, 1.1), translate 0.5s cubic-bezier(0.5, -0.1, 0.5, 1.1)",scaleCanvas(i),translateCanvas(c,d),setTimeout((function(){canvas.style.transition=""}),550)}function fitViewToCanvas(){let e=getNodesBounds(),t=getViewBounds(),o=getCanvasBounds(),n=.8*Math.min(t.width/e.width,t.height/e.height),i=o.x,s=o.y,a=i+(e.centerX-i)*n,l=s+(e.centerY-s)*n,r=t.centerX-a,c=t.centerY-l;canvas.style.transition="scale 0.5s cubic-bezier(0.5, -0.1, 0.5, 1.1), translate 0.5s cubic-bezier(0.5, -0.1, 0.5, 1.1)",scaleCanvas(n),translateCanvas(r,c),setTimeout((function(){canvas.style.transition=""}),550)}function setupCallouts(e){e.querySelectorAll(".callout.is-collapsible .callout-title").forEach((function(e){e.addEventListener("click",(function(){var t=this.parentElement;t.classList.toggle("is-collapsed"),e.querySelector(".callout-fold").classList.toggle("is-collapsed"),slideToggle(t.querySelector(".callout-content"),100)}))}))}function setupCheckboxes(e){e.querySelectorAll(".task-list-item-checkbox").forEach((function(e){e.addEventListener("click",(function(){var e=this.parentElement;e.classList.toggle("is-checked"),e.setAttribute("data-task",e.classList.contains("is-checked")?"x":" ")}))})),e.querySelectorAll('.plugin-tasks-list-item input[type="checkbox"]').forEach((function(e){e.checked=e.parentElement.classList.contains("is-checked")})),e.querySelectorAll(".kanban-plugin__item.is-complete").forEach((function(e){e.querySelector('input[type="checkbox"]').checked=!0}))}function setupCodeblocks(e){e.querySelectorAll(".copy-code-button").forEach((function(t){t.addEventListener("click",(function(){var t=this.parentElement.querySelector("code").textContent;navigator.clipboard.writeText(t),this.textContent="Copied!",setTimeout((function(){e.querySelectorAll(".copy-code-button").forEach((function(e){e.textContent="Copy"}))}),2e3)}))}))}function setupLinks(e){e.querySelectorAll(".internal-link, .footnote-link, .tree-item:not(.mod-tree-folder) > .tree-item-contents > .tree-item-link").forEach((function(e){e.addEventListener("click",(function(t){let o=e.getAttribute("href");if(t.preventDefault(),o)if(o.startsWith("#")){let e=document.getElementById(o.substring(1));e?(e.headingWrapper?.collapse(!1,!0,!0),setTimeout((function(){e.classList.contains(".heading")?e.headingWrapper?.scrollIntoView({behavior:"smooth",block:"start"}):e.scrollIntoView({behavior:"smooth",block:"start"}),"phone"==deviceSize&&rightSidebar.collapse(!0)}),0)):console.log("No element found with id: "+o.substring(1))}else loadDocument(o,!0,!e.classList.contains("tree-item-link"))}))}))}function setupSidebars(){sidebarCollapseIcons[0].otherIcon=sidebarCollapseIcons[1],sidebarCollapseIcons[1].otherIcon=sidebarCollapseIcons[0],sidebarCollapseIcons[0].gutter=sidebarGutters[0],sidebarCollapseIcons[1].gutter=sidebarGutters[1],sidebarCollapseIcons[0].sidebar=sidebars[0],sidebarCollapseIcons[1].sidebar=sidebars[1],sidebarGutters[0].otherGutter=sidebarGutters[1],sidebarGutters[1].otherGutter=sidebarGutters[0],sidebarGutters[0].collapseIcon=sidebarCollapseIcons[0],sidebarGutters[1].collapseIcon=sidebarCollapseIcons[1],sidebars[0].otherSidebar=sidebars[1],sidebars[1].otherSidebar=sidebars[0],sidebars[0].gutter=sidebarGutters[0],sidebars[1].gutter=sidebarGutters[1],sidebars.forEach((function(e){e.collapsed=e.classList.contains("is-collapsed"),e.collapse=function(t=!0){!t&&this.temporarilyCollapsed&&"large-screen"==deviceSize&&this.gutter.collapse(!0),!t&&document.body.classList.contains("floating-sidebars")&&document.body.addEventListener("click",(function t(o){e.collapse(!0),document.body.removeEventListener("click",t)})),"phone"==deviceSize&&(t||e.otherSidebar.fullCollapse(!0,!0),t&&e.gutter.otherGutter.collapse(!1,!0)),"tablet"==deviceSize&&(t||e.otherSidebar.collapse(!0)),this.classList.toggle("is-collapsed",t),this.collapsed=t},e.temporaryCollapse=function(e=!0){this.temporarilyCollapsed=!0,this.collapse(!0),this.gutter.collapse(!1),this.collapsed=e},e.fullCollapse=function(e=!0,t=!1){this.collapse(e),this.gutter.collapse(!0,t),this.collapsed=e},e.toggleCollapse=function(){this.collapse(!this.collapsed)},e.toggleFullCollapse=function(){this.fullCollapse(!this.collapsed)}})),sidebarGutters.forEach((function(e){e.collapsed=e.classList.contains("is-collapsed"),e.collapse=function(e,t=!1){!t&&document.body.classList.contains("sidebars-always-collapsible")||(this.classList.toggle("is-collapsed",e),this.collapsed=e)},e.toggleCollapse=function(){this.collapse(!this.collapsed)}})),sidebarCollapseIcons.forEach((function(e){e.addEventListener("click",(function(t){t.stopPropagation(),e.sidebar.toggleCollapse()}))})),document.querySelectorAll(".sidebar-container").forEach((function(e){e.addEventListener("click",(function(e){e.stopPropagation()}))}))}function getSidebarWidthProp(){return getComputedPixelValue("--sidebar-width")}function setupThemeToggle(){function e(e,t=!1){let o=document.querySelector(".theme-toggle-input");if(o.checked=e,t){var n=document.body.style.transition;document.body.style.transition="none"}!o.classList.contains("is-checked")&&e?o.classList.add("is-checked"):o.classList.contains("is-checked")&&!e&&o.classList.remove("is-checked"),e?(document.body.classList.contains("theme-dark")&&document.body.classList.remove("theme-dark"),document.body.classList.contains("theme-light")||document.body.classList.add("theme-light")):(document.body.classList.contains("theme-light")&&document.body.classList.remove("theme-light"),document.body.classList.contains("theme-dark")||document.body.classList.add("theme-dark")),t&&setTimeout((function(){document.body.style.transition=n}),100),localStorage.setItem("theme_toggle",e?"true":"false")}null!=localStorage.getItem("theme_toggle")&&e("true"==localStorage.getItem("theme_toggle")),document.body.classList.contains("theme-light")?e(!0):e(!1),document.querySelector(".theme-toggle-input")?.addEventListener("change",(t=>{console.log("Theme toggle changed to: "+!("true"==localStorage.getItem("theme_toggle"))),e(!("true"==localStorage.getItem("theme_toggle")))}))}function setupScroll(e){if("canvas"!=documentType)return;let t=Array.from(e.querySelectorAll(".markdown-preview-view")),o=0,n=0;t.forEach((async function(e){console.log("Setting up markdown view");let t=Array.from(e.querySelectorAll(".heading-wrapper"));e.updateVisibleWindowMarkdown=function(o=!0,i=!0){let s=e.getBoundingClientRect();n=Math.min(.1*s.height,150);let a=s.top-n,l=s.bottom+n;async function r(e){let t=e?.getBoundingClientRect();if(!t)return;let n=t.top<a&&t.bottom<a||t.top>l&&t.bottom>l;n&&o?e.hide():!n&&i&&e.show()}for(let e=0;e<t.length;e++){let o=t[e];o&&r(o)}};let o=0;e.addEventListener("scroll",(function(){Math.abs(e.scrollTop-o)>n/3&&e.updateVisibleWindowMarkdown(!1,!0),o=e.scrollTop}))})),setInterval((async function(){t.length>0&&(t[o].updateVisibleWindowMarkdown(),o=(o+1)%t.length)}),200)}function setupExcalidraw(e){e.querySelectorAll(".excalidraw-svg svg").forEach((function(e){let t=e.querySelector("rect").getAttribute("fill")>"#7F7F7F";e.classList.add(t?"light":"dark")}))}</script><script></script></head><body class="mod-macos native-scrollbars show-inline-title show-ribbon tab-numbering plugin-tabs theme-light sidebars-always-collapsible loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">HS</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Content</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="Content/Content-Reza.html"><span class="tree-item-title">Content-Reza</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" tabindex="-1"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="min-height:141651px"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header mod-ui"></div><div class="el-h1 heading-wrapper"><h1 data-heading="Secure By Design" dir="auto" class="heading" id="Secure_By_Design"><div class="heading-before"></div>Secure By Design<div class="heading-after">...</div></h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="Software Architecture" dir="auto" class="heading" id="Software_Architecture"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Software Architecture<div class="heading-after">...</div></h2><div class="heading-children"><div class="el-p"><p dir="auto">In a bustling tech hub, a passionate team of developers discovered that building great software wasnâ€™t enoughâ€”they needed resilience against evolving cyber threats. As they embarked on a journey to overhaul their legacy systems, they embraced a "secure by design" mindset. Every line of code and architectural decision was scrutinized for vulnerabilities, ensuring that security was embedded from start to finish. Their efforts, driven by agile risk assessments and modern cryptographic practices, transformed their products into trusted pillars of innovation and safety.</p></div><div class="el-p"><p dir="auto">Their success story quickly spread throughout the organization, inspiring stakeholders and executives alike. The teamâ€™s rigorous approachâ€”from proactive threat modeling to automated security testingâ€”proved that integrating security throughout the software lifecycle was not just a necessity, but also a competitive advantage. This cultural shift not only bolstered customer trust but also set a new industry standard for secure, forward-thinking software architecture.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Authentication/Identity" dir="auto" class="heading" id="Authentication/Identity"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Authentication/Identity<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="**Enterprise-Wide Passwordless Authentication Implementation**" dir="auto" class="heading" id="**Enterprise-Wide_Passwordless_Authentication_Implementation**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Enterprise-Wide Passwordless Authentication Implementation</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Deploying <strong>FIDO2/WebAuthn</strong> for passwordless authentication.</li><li data-line="1" dir="auto">Implementing <strong>biometric authentication</strong> (Windows Hello, Face ID, fingerprint).</li><li data-line="2" dir="auto">Managing <strong>legacy system authentication</strong> with passwordless bridges.</li></ul></div><div class="el-p"><p dir="auto"><strong>Cheatsheet</strong></p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation (Best Practice)</strong></th><th dir="ltr"><strong>Recommendations / Best Practices</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>User Initiation</strong></td><td dir="ltr">User clicks â€œLoginâ€ on a standard UI; authentication prompt has no special security features.</td><td dir="ltr">User accesses a passwordless UI explicitly designed for FIDO2/WebAuthn; clear instructions for secure biometric input.</td><td dir="ltr">Use modern UIs that prompt users for secure authentication methods and educate about biometric verification best practices.</td></tr><tr><td dir="ltr"><strong>Challenge Generation</strong></td><td dir="ltr">Auth Server returns a weak or static challenge (or none at all) that is easily replayed.</td><td dir="ltr">Auth Server generates a unique, dynamic cryptographic challenge following the FIDO2/WebAuthn protocol.</td><td dir="ltr">Ensure each login attempt uses a non-repeating, high-entropy challenge to prevent replay and forgery.</td></tr><tr><td dir="ltr"><strong>Biometric Input &amp; Attestation</strong></td><td dir="ltr">Client collects biometric input without secure hardware attestation.</td><td dir="ltr">Secure authenticator (e.g., Windows Hello) uses hardware-based key storage to sign the challenge, providing attestation.</td><td dir="ltr">Enforce secure hardware attestation so biometric credentials never leave the device in a form that can be intercepted or spoofed.</td></tr><tr><td dir="ltr"><strong>Token Issuance</strong></td><td dir="ltr">Auth Server issues a weakly-signed or unsigned token based solely on the insecure challenge response.</td><td dir="ltr">Auth Server validates the signed response and issues a cryptographically secure, signed token (JWT/SAML), binding it to the challenge.</td><td dir="ltr">Tokens must be signed and, if needed, encrypted. Use proven cryptographic libraries and standards to avoid implementation flaws.</td></tr><tr><td dir="ltr"><strong>Legacy System Bridging</strong></td><td dir="ltr">Legacy system integration simply passes the weak token along for access, without verification.</td><td dir="ltr">A dedicated secure token exchange gateway is used between modern authentication and legacy systems, validating tokens securely.</td><td dir="ltr">Use secure APIs, mutual TLS, and token mapping to integrate legacy systems with modern authentication without compromising integrity.</td></tr><tr><td dir="ltr"><strong>Transmission &amp; Storage</strong></td><td dir="ltr">Communications may occur over unencrypted channels; tokens stored without secure flags.</td><td dir="ltr">All transmissions occur over HTTPS/TLS; tokens stored only in HttpOnly, Secure cookies and encrypted storage where applicable.</td><td dir="ltr">Enforce TLS for all communications. Ensure cookies or tokens are flagged as HttpOnly and Secure, and apply encryption-at-rest for stored tokens.</td></tr><tr><td dir="ltr"><strong>Logging &amp; Monitoring</strong></td><td dir="ltr">Minimal logging with little context, hampering auditing and incident response.</td><td dir="ltr">Comprehensive logging captures user identity, file/token hashes, timestamps, and attestation verifications; integrated with SIEM.</td><td dir="ltr">Implement detailed logging and monitoring for forensic analysis and compliance, demonstrating measurable program maturity to stakeholders and auditors.</td></tr></tbody></table></div><div class="el-ul"><ul><li data-line="0" dir="auto"><strong>Defense in Depth:</strong>&nbsp;The secure design layers dynamic challenges, hardware-backed attestation, cryptographic token issuance, and secure legacy bridging.</li><li data-line="1" dir="auto"><strong>Risk Reduction:</strong>&nbsp;This approach minimizes the attack surface from replay attacks, token forgery, and biometric spoofing.</li><li data-line="2" dir="auto"><strong>Compliance &amp; Reporting:</strong>&nbsp;Comprehensive logging and monitoring meet regulatory requirements and enable CISO-level reporting on risk posture and incident response metrics.</li><li data-line="3" dir="auto"><strong>Cost vs. Security ROI:</strong>&nbsp;Investing in robust passwordless technologies and secure integration yields long-term benefits in reducing breach risks and maintenance costs.</li></ul></div><div class="el-p"><p dir="auto"><strong>Insecure</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-124 -10 1293 1197" height="1197" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-12" style="width:1293px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="969"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="1044"><tspan dy="0" x="1044">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="769"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="844"><tspan dy="0" x="844">User Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="373"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="448"><tspan dy="0" x="448">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="1044" y1="65" x1="1044" id="actor5979"></line><g id="root-5979"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="969"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1044"><tspan dy="0" x="1044">Logger</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="844" y1="65" x1="844" id="actor5978"></line><g id="root-5978"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="769"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="844"><tspan dy="0" x="844">User Database</tspan></text></g></g><g><line name="A" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="448" y1="65" x1="448" id="actor5977"></line><g id="root-5977"><rect class="actor actor-top" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="373"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="448"><tspan dy="0" x="448">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="75" y1="65" x1="75" id="actor5976"></line><g id="root-5976"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-12{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-12 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-12 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-12 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-12 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-12 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-12 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-12 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-12 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-12 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-12 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-12 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-12 p{margin:0}#mermaid-6a213c2d99ee9aa5-12 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-12 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-12 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-12 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-12 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-12 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-12 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-12 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-12 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-12 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-12 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-12 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-12 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-12 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-12 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-12 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-12 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-12 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-12 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-12 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-12 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-12 .actor-man circle,#mermaid-6a213c2d99ee9aa5-12 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-12 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="260">1. Navigate to HTTP login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="444" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="260">2. Enter username and plaintext password</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="444" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="260">3. Click "Login"</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="444" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="260">4. Send credentials via HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="444" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="449">5. Receive unencrypted request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,305 C 509,295 509,335 449,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="449">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="645">6. Query DB for user record (plain text)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="840" y1="383" x1="449"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="449">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="648">7. Return user record with plaintext password</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="452" y1="431" x1="843"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="843">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="449">8. Compare plaintext passwords</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,479 C 509,469 509,509 449,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="449">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="449">9. Accept credentials unchallenged</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,557 C 509,547 509,587 449,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="449">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="449">10. Generate static, unsigned session token</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,635 C 509,625 509,665 449,655"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="449">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="449">11. Attach token to plain HTTP response</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,713 C 509,703 509,743 449,733"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="449">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="758" x="263">12. Send token to User</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="791" x2="79" y1="791" x1="447"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="795" x="447">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="76">13. Store token in local storage (insecure)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,839 C 136,829 136,869 76,859"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="884" x="260">14. Use token in subsequent requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="917" x2="444" y1="917" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="921" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="932" x="449">15. Perform minimal token verification</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 449,965 C 509,955 509,995 449,985"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="969" x="449">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1010" x="745">16. Log basic authentication event (minimal details)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1043" x2="1040" y1="1043" x1="449"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1047" x="449">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1058" x="263">17. Grant access despite replay risks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1091" x2="79" y1="1091" x1="447"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1095" x="447">17</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Secure</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-136.5 -10 1343.5 1371" height="1371" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-14" style="width:1343.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1285" x="1007"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1317.5" x="1082"><tspan dy="0" x="1082">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="1285" x="807"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1317.5" x="882"><tspan dy="0" x="882">User Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="1285" x="404"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1317.5" x="479"><tspan dy="0" x="479">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1285" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1317.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1285" x2="1082" y1="65" x1="1082" id="actor5983"></line><g id="root-5983"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1007"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1082"><tspan dy="0" x="1082">Logger</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1285" x2="882" y1="65" x1="882" id="actor5982"></line><g id="root-5982"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="807"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="882"><tspan dy="0" x="882">User Database</tspan></text></g></g><g><line name="A" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1285" x2="479" y1="65" x1="479" id="actor5981"></line><g id="root-5981"><rect class="actor actor-top" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="404"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="479"><tspan dy="0" x="479">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1285" x2="75" y1="65" x1="75" id="actor5980"></line><g id="root-5980"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-14{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-14 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-14 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-14 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-14 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-14 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-14 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-14 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-14 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-14 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-14 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-14 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-14 p{margin:0}#mermaid-6a213c2d99ee9aa5-14 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-14 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-14 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-14 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-14 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-14 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-14 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-14 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-14 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-14 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-14 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-14 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-14 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-14 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-14 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-14 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-14 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-14 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-14 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-14 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-14 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-14 .actor-man circle,#mermaid-6a213c2d99ee9aa5-14 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-14 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="276">1. Navigate to HTTPS secure login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="475" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="276">2. Enter username and password over TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="475" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="276">3. Click "Login"</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="475" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="276">4. Send encrypted credentials via HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="475" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="480">5. Receive and decrypt HTTPS request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,305 C 540,295 540,335 480,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="480">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="679">6. Query DB for user record (with salted hash)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="878" y1="383" x1="480"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="480">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="682">7. Return user record with hashed password</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="483" y1="431" x1="881"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="881">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="480">8. Validate password using secure hash compare</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,479 C 540,469 540,509 480,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="480">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="279">9. Issue dynamic challenge (nonce) for MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="478"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="478">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="76">10. Complete local MFA (OTP/biometric)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,605 C 136,595 136,635 76,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="276">11. Submit signed challenge response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="475" y1="683" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="480">12. Validate MFA response and challenge signature</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,731 C 540,721 540,761 480,751"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="480">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="480">13. Generate cryptographically signed JWT with expiry/claims</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,809 C 540,799 540,839 480,829"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="480">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="480">14. Attach token to secure HTTPS response</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,887 C 540,877 540,917 480,907"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="480">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="932" x="279">15. Return token via secure response header</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="965" x2="79" y1="965" x1="478"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="969" x="478">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="980" x="76">16. Store token in an HttpOnly, secure cookie</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,1013 C 136,1003 136,1043 76,1033"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1017" x="76">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1058" x="276">17. Use token for subsequent HTTPS requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1091" x2="475" y1="1091" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1095" x="76">17</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1106" x="480">18. Validate token signature and expiry on each request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 480,1139 C 540,1129 540,1169 480,1159"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1143" x="480">18</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1184" x="779">19. Log detailed authentication events (user, IP, MFA)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1217" x2="1078" y1="1217" x1="480"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1221" x="480">19</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1232" x="279">20. Grant access with robust defense in depth</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1265" x2="79" y1="1265" x1="478"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1269" x="478">20</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Approach</strong></th><th dir="ltr"><strong>Secure Approach</strong></th><th dir="ltr"><strong>Remediation / Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Login Request Submission</strong></td><td dir="ltr">HTTP login page; plaintext credentials submitted unencrypted.</td><td dir="ltr">HTTPS secure login page; credentials sent over encrypted channels.</td><td dir="ltr">Always use HTTPS/TLS to encrypt credentials during transmission.</td></tr><tr><td dir="ltr"><strong>2. Credential Verification</strong></td><td dir="ltr">Direct query to DB returning plaintext password; simple password comparison with no challenge.</td><td dir="ltr">Query DB for salted-hashed record; perform secure hash comparison; issue dynamic challenge (nonce) for additional verification.</td><td dir="ltr">Use salted hashes for passwords and implement dynamic challenges to mitigate replay and injection attacks.</td></tr><tr><td dir="ltr"><strong>3. Token Generation / MFA</strong></td><td dir="ltr">Generate static, unsigned token; no MFA invoked.</td><td dir="ltr">After MFA challenge, generate cryptographically signed JWT with expiry and claims.</td><td dir="ltr">Integrate multi-factor authentication and issue signed tokens (e.g., JWT) for session management.</td></tr><tr><td dir="ltr"><strong>4. Session Establishment &amp; Logging</strong></td><td dir="ltr">Token is stored in insecure local storage; minimal logging, no robust token verification.</td><td dir="ltr">Token is stored in HttpOnly, secure cookie; extensive logging (user, IP, MFA event) and continuous token verification.</td><td dir="ltr">Enforce secure storage of tokens and implement comprehensive logging and monitoring for incident response and regulatory compliance.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Multi-Factor Authentication (MFA) &amp; Phishing-Resistant Methods**" dir="auto" class="heading" id="**Multi-Factor_Authentication_(MFA)_&amp;_Phishing-Resistant_Methods**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Multi-Factor Authentication (MFA) &amp; Phishing-Resistant Methods</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Implementing <strong>smartcards, hardware tokens (YubiKey), and passkeys</strong>.</li><li data-line="1" dir="auto"><strong>MFA fatigue protection</strong> (number matching, risk-based MFA).</li><li data-line="2" dir="auto">Secure fallback for <strong>MFA recovery scenarios</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure Authentication/SSO Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-155 -10 1416 1197" height="1197" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-19" style="width:1416px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="1061"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="1136"><tspan dy="0" x="1136">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="861"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="936"><tspan dy="0" x="936">User Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="464"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="539"><tspan dy="0" x="539">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="1136" y1="65" x1="1136" id="actor5987"></line><g id="root-5987"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1061"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1136"><tspan dy="0" x="1136">Logger</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="936" y1="65" x1="936" id="actor5986"></line><g id="root-5986"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="861"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="936"><tspan dy="0" x="936">User Database</tspan></text></g></g><g><line name="A" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="539" y1="65" x1="539" id="actor5985"></line><g id="root-5985"><rect class="actor actor-top" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="464"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="539"><tspan dy="0" x="539">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="75" y1="65" x1="75" id="actor5984"></line><g id="root-5984"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-19{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-19 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-19 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-19 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-19 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-19 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-19 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-19 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-19 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-19 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-19 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-19 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-19 p{margin:0}#mermaid-6a213c2d99ee9aa5-19 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-19 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-19 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-19 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-19 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-19 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-19 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-19 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-19 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-19 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-19 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-19 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-19 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-19 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-19 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-19 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-19 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-19 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-19 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-19 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-19 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-19 .actor-man circle,#mermaid-6a213c2d99ee9aa5-19 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-19 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="306">1. Navigate to HTTP login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="535" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="306">2. Enter username and plain password</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="535" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="306">3. Click "Login"</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="535" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="306">4. Send credentials via HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="535" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="540">5. Receive unencrypted request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,305 C 600,295 600,335 540,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="540">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="736">6. Query DB for user record (plaintext stored)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="932" y1="383" x1="540"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="540">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="739">7. Return user record with plaintext password</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="543" y1="431" x1="935"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="935">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="540">8. Compare entered password with stored value</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,479 C 600,469 600,509 540,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="540">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="540">9. Accept credentials without any challenge</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,557 C 600,547 600,587 540,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="540">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="540">10. Bypass any MFA step</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,635 C 600,625 600,665 540,655"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="540">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="540">11. Generate a static session token (unsigned)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,713 C 600,703 600,743 540,733"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="540">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="758" x="540">12. Attach token to plain HTTP response</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,791 C 600,781 600,821 540,811"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="795" x="540">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="836" x="309">13. Return token via HTTP response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="869" x2="79" y1="869" x1="538"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="873" x="538">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="884" x="76">14. Store token in browser local storage (insecure)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,917 C 136,907 136,947 76,937"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="921" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="962" x="306">15. Use token for subsequent requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="995" x2="535" y1="995" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="999" x="76">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1010" x="836">16. Log basic authentication event (minimal detail)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1043" x2="1132" y1="1043" x1="540"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1047" x="540">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1058" x="309">17. Grant access despite replay and token forgery risks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1091" x2="79" y1="1091" x1="538"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1095" x="538">17</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Diagram B: Secure Authentication/SSO Workflow (Defense in Depth + MFA)</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-260 -10 1740 1449" height="1449" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-21" style="width:1740px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1363" x="1280"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1395.5" x="1355"><tspan dy="0" x="1355">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="1363" x="1080"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1395.5" x="1155"><tspan dy="0" x="1155">User Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="1363" x="604"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1395.5" x="679"><tspan dy="0" x="679">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1363" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1395.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1363" x2="1355" y1="65" x1="1355" id="actor5991"></line><g id="root-5991"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1280"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1355"><tspan dy="0" x="1355">Logger</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1363" x2="1155" y1="65" x1="1155" id="actor5990"></line><g id="root-5990"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1080"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1155"><tspan dy="0" x="1155">User Database</tspan></text></g></g><g><line name="A" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1363" x2="679" y1="65" x1="679" id="actor5989"></line><g id="root-5989"><rect class="actor actor-top" ry="3" rx="3" name="A" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="604"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="679"><tspan dy="0" x="679">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1363" x2="75" y1="65" x1="75" id="actor5988"></line><g id="root-5988"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-21{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-21 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-21 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-21 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-21 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-21 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-21 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-21 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-21 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-21 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-21 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-21 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-21 p{margin:0}#mermaid-6a213c2d99ee9aa5-21 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-21 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-21 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-21 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-21 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-21 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-21 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-21 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-21 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-21 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-21 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-21 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-21 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-21 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-21 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-21 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-21 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-21 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-21 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-21 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-21 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-21 .actor-man circle,#mermaid-6a213c2d99ee9aa5-21 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-21 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="376">1. Navigate to HTTPS secure login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="675" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="376">2. Enter username and password over TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="675" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="376">3. Click "Login"</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="675" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="376">4. Send encrypted credentials via HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="675" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="680">5. Receive and decrypt HTTPS request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,305 C 740,295 740,335 680,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="680">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="916">6. Query DB for user record (password salted &amp; hashed)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="1151" y1="383" x1="680"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="680">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="919">7. Return user record with hashed password</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="683" y1="431" x1="1154"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1154">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="680">8. Validate password using secure hash comparison</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,479 C 740,469 740,509 680,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="680">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="379">9. Issue dynamic challenge (nonce) for MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="678">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="76">10. Complete local MFA using smartcard, hardware token (YubiKey), or passkey</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,605 C 136,595 136,635 76,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="376">11. Submit signed challenge response with MFA factor</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="675" y1="683" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="680">12. Verify MFA response and challenge signature</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,731 C 740,721 740,761 680,751"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="680">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="680">13. Confirm multi-factor authentication success</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,809 C 740,799 740,839 680,829"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="680">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="680">14. Generate a cryptographically signed JWT with expiry and claims</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,887 C 740,877 740,917 680,907"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="680">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="932" x="680">15. Attach token in secure HTTPS response header</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,965 C 740,955 740,995 680,985"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="969" x="680">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1010" x="379">16. Return token via secure HTTPS response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1043" x2="79" y1="1043" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1047" x="678">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1058" x="76">17. Store token in an HttpOnly, secure cookie</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,1091 C 136,1081 136,1121 76,1111"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1095" x="76">17</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1136" x="376">18. Use token in subsequent HTTPS requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1169" x2="675" y1="1169" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1173" x="76">18</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1184" x="680">19. Validate token signature and expiry rigorously</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 680,1217 C 740,1207 740,1247 680,1237"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1221" x="680">19</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1262" x="1016">20. Log detailed audit events (user, IP, MFA outcome, timestamp)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1295" x2="1351" y1="1295" x1="680"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1299" x="680">20</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1310" x="379">21. Grant access with robust defense in depth and phishing-resistant MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1343" x2="79" y1="1343" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1347" x="678">21</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Cheatsheet Table: Insecure vs. Secure Workflow per Stage</strong></p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Login Request Submission</strong></td><td dir="ltr">HTTP login page; plaintext credentials sent unencrypted.</td><td dir="ltr">HTTPS secure login page; credentials transmitted over TLS.</td><td dir="ltr">Use HTTPS/TLS to secure data in transit.</td></tr><tr><td dir="ltr"><strong>2. Credential Verification</strong></td><td dir="ltr">Queries DB returning plaintext passwords; simple, unsalted comparison; no dynamic challenge issued.</td><td dir="ltr">Queries DB for salted-hashed password; secure hash comparison; issues dynamic challenge (nonce) to avoid replay attacks.</td><td dir="ltr">Employ salted hashes; enforce dynamic challenges during authentication.</td></tr><tr><td dir="ltr"><strong>3. Multi-Factor Authentication</strong></td><td dir="ltr">No MFA applied; static, unsigned token generated without additional validation.</td><td dir="ltr">Enforces MFA using smartcards, hardware tokens (YubiKey), or passkeys; verifies signed challenge response to prevent phishing.</td><td dir="ltr">Integrate robust, phishing-resistant MFA methods to supplement password-based authentication.</td></tr><tr><td dir="ltr"><strong>4. Token Issuance, Storage &amp; Logging</strong></td><td dir="ltr">Token is attached in plain HTTP response; stored insecurely in local storage; minimal logging.</td><td dir="ltr">Generates cryptographically signed JWT with expiry &amp; claims; token sent via secure HTTPS, stored in HttpOnly cookies; comprehensive logging.</td><td dir="ltr">Use signed tokens, secure cookie storage, and detailed logging to ensure session integrity and regulatory compliance.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Single Sign-On (SSO) with Identity Federation (SAML, OAuth, OIDC, Kerberos)**" dir="auto" class="heading" id="**Single_Sign-On_(SSO)_with_Identity_Federation_(SAML,_OAuth,_OIDC,_Kerberos)**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Single Sign-On (SSO) with Identity Federation (SAML, OAuth, OIDC, Kerberos)</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Federating identities across <strong>cloud (Azure AD, Okta) and on-prem (Active Directory, LDAP)</strong>.</li><li data-line="1" dir="auto">Implementing <strong>Just-in-Time (JIT) provisioning</strong> for dynamic user creation.</li><li data-line="2" dir="auto">Managing <strong>cross-domain authentication</strong> in <strong>multi-cloud environments</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure SSO / Identity Federation Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1585 1137" height="1137" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-27" style="width:1585px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="1252"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="1327"><tspan dy="0" x="1327">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="857"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="932"><tspan dy="0" x="932">IdentityProvider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="436"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="511"><tspan dy="0" x="511">ServiceProvider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="1327" y1="65" x1="1327" id="actor5995"></line><g id="root-5995"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1252"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1327"><tspan dy="0" x="1327">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="932" y1="65" x1="932" id="actor5994"></line><g id="root-5994"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="857"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="932"><tspan dy="0" x="932">IdentityProvider</tspan></text></g></g><g><line name="SP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="511" y1="65" x1="511" id="actor5993"></line><g id="root-5993"><rect class="actor actor-top" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="436"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="511"><tspan dy="0" x="511">ServiceProvider</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="75" y1="65" x1="75" id="actor5992"></line><g id="root-5992"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-27{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-27 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-27 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-27 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-27 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-27 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-27 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-27 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-27 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-27 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-27 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-27 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-27 p{margin:0}#mermaid-6a213c2d99ee9aa5-27 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-27 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-27 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-27 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-27 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-27 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-27 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-27 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-27 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-27 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-27 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-27 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-27 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-27 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-27 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-27 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-27 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-27 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-27 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-27 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-27 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-27 .actor-man circle,#mermaid-6a213c2d99ee9aa5-27 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-27 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="292">1. Navigate to HTTP SSO login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="507" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="292">2. Enter credentials in plain text</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="507" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="292">3. Click "Login" (no encryption)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="507" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="292">4. Send unencrypted SSO request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="507" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="720">5. Forward SSO request via unprotected channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="928" y1="305" x1="512"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="512">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="933">6. Query user identity (plaintext look-up)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 933,353 C 993,343 993,383 933,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="933">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="723">7. Return user identity info (unsalted, unverified)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="515" y1="431" x1="931"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="931">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="512">8. Accept credentials without challenge</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 512,479 C 572,469 572,509 512,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="512">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="295">9. Bypass dynamic, risk-based verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="510"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="510">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="512">10. Invoke legacy JIT provisioning (static mapping)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 512,605 C 572,595 572,635 512,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="512">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="512">11. Generate static, unsigned federated token</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 512,683 C 572,673 572,713 512,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="512">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="295">12. Redirect user with insecure token (via HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="510"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="510">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="292">13. Use token for subsequent non-secure requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="507" y1="809" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="918">14. Log basic authentication event (few details)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="1323" y1="857" x1="512"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="512">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="872" x="1128">15. Log unsophisticated identity confirmation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="905" x2="1323" y1="905" x1="933"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="909" x="933">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="920" x="295">16. Grant access with minimal audit trail</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="953" x2="79" y1="953" x1="510"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="957" x="510">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="968" x="1328">17. Retain sparse logs, risking forensic gaps</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1328,1001 C 1388,991 1388,1031 1328,1021"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1005" x="1328">17</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure SSO / Identity Federation Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1995 1233" height="1233" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-29" style="width:1995px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1147" x="1592"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1179.5" x="1667"><tspan dy="0" x="1667">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1147" x="1143"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1179.5" x="1218"><tspan dy="0" x="1218">IdentityProvider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1147" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1179.5" x="654"><tspan dy="0" x="654">ServiceProvider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1147" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1179.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1147" x2="1667" y1="65" x1="1667" id="actor5999"></line><g id="root-5999"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1592"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1667"><tspan dy="0" x="1667">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1147" x2="1218" y1="65" x1="1218" id="actor5998"></line><g id="root-5998"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1143"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1218"><tspan dy="0" x="1218">IdentityProvider</tspan></text></g></g><g><line name="SP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1147" x2="654" y1="65" x1="654" id="actor5997"></line><g id="root-5997"><rect class="actor actor-top" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="654"><tspan dy="0" x="654">ServiceProvider</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1147" x2="75" y1="65" x1="75" id="actor5996"></line><g id="root-5996"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-29{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-29 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-29 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-29 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-29 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-29 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-29 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-29 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-29 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-29 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-29 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-29 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-29 p{margin:0}#mermaid-6a213c2d99ee9aa5-29 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-29 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-29 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-29 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-29 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-29 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-29 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-29 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-29 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-29 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-29 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-29 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-29 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-29 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-29 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-29 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-29 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-29 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-29 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-29 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-29 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-29 .actor-man circle,#mermaid-6a213c2d99ee9aa5-29 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-29 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="363">1. Navigate to HTTPS-secured SSO login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="650" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="363">2. Enter username and password securely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="650" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="363">3. Click "Login" over TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="650" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="363">4. Send encrypted SSO request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="650" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="935">5. Forward authentication request (SAML/OIDC) over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1214" y1="305" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="655">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1219">6. Perform robust identity lookup (salted hash, certificate check)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1219,353 C 1279,343 1279,383 1219,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1219">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="938">7. Return signed, verified user identity info</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="658" y1="431" x1="1217"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1217">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="655">8. Validate IdP signature and use dynamic challenge/nonce</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,479 C 715,469 715,509 655,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="655">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="366">9. Trigger risk-based verification or step-up authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="653">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="935">10. Invoke Just-in-Time provisioning for new users (secure mapping)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1214" y1="605" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="655">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="938">11. Confirm identity provisioning using federation rules</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="653" x2="658" y1="653" x1="1217"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1217">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="655">12. Generate cryptographically signed JWT (with expiry)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,701 C 715,691 715,731 655,721"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="655">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="366">13. Return token via secure, HTTPS redirect in an HttpOnly cookie</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="653">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="794" x="363">14. Use token for subsequent authenticated HTTPS requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="827" x2="650" y1="827" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="831" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="842" x="655">15. Validate token integrity (signature, expiration, scopes) continuously</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,875 C 715,865 715,905 655,895"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="879" x="655">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="920" x="1159">16. Log detailed audit data (user, IP, MFA events, timestamps)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="953" x2="1663" y1="953" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="957" x="655">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="968" x="1441">17. Log federated identity validation and provisioning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1001" x2="1663" y1="1001" x1="1219"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1005" x="1219">17</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1016" x="366">18. Grant access across domains with cross-cloud &amp; on-prem controls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1049" x2="79" y1="1049" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1053" x="653">18</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1064" x="1668">19. Ensure logs meet compliance and support forensic analysis</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1668,1097 C 1728,1087 1728,1127 1668,1117"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1101" x="1668">19</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Comparison per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Login Request Submission</strong></td><td dir="ltr">Uses HTTP; credentials sent in plaintext; no encryption or risk-based controls.</td><td dir="ltr">HTTPS-secured login page with TLS; credentials transmitted securely over encryption; risk-based or adaptive authentication enabled.</td><td dir="ltr">Always enforce HTTPS/TLS; use secure forms with adaptive authentication to mitigate credential interception.</td></tr><tr><td dir="ltr"><strong>2. Federation &amp; Identity Retrieval</strong></td><td dir="ltr">Forwards SSO request over unprotected channel; identity lookup returns unsalted, plaintext data; no signature verification.</td><td dir="ltr">Forwards authentication via SAML/OIDC; identity provider validates user using salted hashes and certificates; returns signed identity info.</td><td dir="ltr">Ensure secure federation protocols (SAML, OAuth, OIDC); implement certificate-based signing and dynamic nonce challenges to prevent replay and injection attacks.</td></tr><tr><td dir="ltr"><strong>3. Token Generation &amp; JIT Provisioning</strong></td><td dir="ltr">Legacy JIT without dynamic checks; static, unsigned token issuance; insecure token passed via HTTP.</td><td dir="ltr">Implements JIT provisioning with dynamic checks; generates cryptographically signed JWT with expiry; token delivered securely (HttpOnly cookie).</td><td dir="ltr">Use dynamic provisioning; issue signed tokens with expiration and claims; secure tokens with HttpOnly and secure flags; ensure tokens follow least privilege access controls.</td></tr><tr><td dir="ltr"><strong>4. Logging, Cross-Domain Control &amp; Monitoring</strong></td><td dir="ltr">Performs minimal logging with sparse details; no robust cross-domain controls; forensic gaps present.</td><td dir="ltr">Logs detailed audit data (user, IP, MFA events, timestamps); cross-domain access controlled for multi-cloud and on-prem configurations; compliant logging.</td><td dir="ltr">Use detailed, structured logging integrated with SIEM; enforce cross-domain access with stringent controls; ensure logs meet regulatory standards and provide full forensic traceability.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**OAuth 2.0 &amp; OpenID Connect (OIDC) for Secure API Authentication**" dir="auto" class="heading" id="**OAuth_2.0_&amp;_OpenID_Connect_(OIDC)_for_Secure_API_Authentication**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>OAuth 2.0 &amp; OpenID Connect (OIDC) for Secure API Authentication</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Enforcing <strong>client authentication with PKCE and mutual TLS (mTLS)</strong>.</li><li data-line="1" dir="auto">Using <strong>JWT access tokens</strong> securely (signature validation, expiration, scopes).</li><li data-line="2" dir="auto">Protecting <strong>OAuth refresh tokens</strong> to prevent token theft attacks.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure OAuth 2.0/OIDC Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1315 1119" height="1119" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-35" style="width:1315px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="1033" x="889.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1065.5" x="964.5"><tspan dy="0" x="964.5">RS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="1033" x="546"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1065.5" x="621"><tspan dy="0" x="621">AS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1033" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1065.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="RS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1033" x2="964.5" y1="65" x1="964.5" id="actor6002"></line><g id="root-6002"><rect class="actor actor-top" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="889.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="964.5"><tspan dy="0" x="964.5">RS</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1033" x2="621" y1="65" x1="621" id="actor6001"></line><g id="root-6001"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="546"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="621"><tspan dy="0" x="621">AS</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1033" x2="75" y1="65" x1="75" id="actor6000"></line><g id="root-6000"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-35{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-35 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-35 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-35 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-35 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-35 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-35 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-35 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-35 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-35 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-35 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-35 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-35 p{margin:0}#mermaid-6a213c2d99ee9aa5-35 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-35 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-35 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-35 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-35 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-35 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-35 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-35 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-35 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-35 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-35 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-35 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-35 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-35 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-35 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-35 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-35 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-35 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-35 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-35 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-35 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-35 .actor-man circle,#mermaid-6a213c2d99ee9aa5-35 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-35 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="347">1. Navigate to HTTP authorization endpoint</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="617" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="347">2. Send client credentials in plain text (no PKCE)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="617" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="347">3. Request authorization code without mTLS/nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="617" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="622">4. Accept authorization request (no challenge)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,257 C 682,247 682,287 622,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="622">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="622">5. Issue authorization code (weak generation)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,335 C 682,325 682,365 622,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="622">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="350">6. Return authorization code via HTTP redirect</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="620"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="620">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="347">7. Exchange code for access token over HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="617" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="622">8. Generate unsigned or weakly signed JWT access token with long expiry</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,509 C 682,499 682,539 622,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="622">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="622">9. Issue static refresh token without mTLS binding or proper refresh protection</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,587 C 682,577 682,617 622,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="622">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="350">10. Return access token and refresh token in plain HTTP response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="79" y1="665" x1="620"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="620">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="518">11. Use access token to request protected resource over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="960.5" y1="713" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="966">12. Perform minimal token validation (ignore signature/expiry/scopes)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 965.5,761 C 1025.5,751 1025.5,791 965.5,781"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="965.5">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="521">13. Grant resource access even with expired or forged token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="839" x2="79" y1="839" x1="963.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="963.5">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="347">14. Reuse refresh token in insecure token refresh request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="887" x2="617" y1="887" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="902" x="350">15. Issue new tokens without proper verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="935" x2="79" y1="935" x1="620"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="939" x="620">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="950" x="966">16. Accept tokens without continuous validation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 965.5,983 C 1025.5,973 1025.5,1013 965.5,1003"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="987" x="965.5">16</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure OAuth 2.0/OIDC Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1366.5 1197" height="1197" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-37" style="width:1366.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="944"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="1019"><tspan dy="0" x="1019">Resource Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="654"><tspan dy="0" x="654">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1111" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1143.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="RS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="1019" y1="65" x1="1019" id="actor6005"></line><g id="root-6005"><rect class="actor actor-top" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="944"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1019"><tspan dy="0" x="1019">Resource Server</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="654" y1="65" x1="654" id="actor6004"></line><g id="root-6004"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="654"><tspan dy="0" x="654">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1111" x2="75" y1="65" x1="75" id="actor6003"></line><g id="root-6003"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-37{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-37 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-37 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-37 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-37 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-37 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-37 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-37 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-37 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-37 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-37 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-37 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-37 p{margin:0}#mermaid-6a213c2d99ee9aa5-37 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-37 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-37 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-37 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-37 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-37 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-37 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-37 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-37 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-37 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-37 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-37 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-37 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-37 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-37 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-37 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-37 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-37 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-37 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-37 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-37 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-37 .actor-man circle,#mermaid-6a213c2d99ee9aa5-37 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-37 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="363">1. Navigate to HTTPS authorization endpoint</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="650" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="363">2. Send encrypted client credentials with PKCE challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="650" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="363">3. Request authorization code using dynamic nonce and mTLS binding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="650" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="655">4. Validate PKCE challenge and strict client authentication</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,257 C 715,247 715,287 655,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="655">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="655">5. Issue cryptographically secure authorization code</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,335 C 715,325 715,365 655,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="655">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="366">6. Return authorization code via HTTPS redirect</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="653">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="363">7. Exchange code for token over HTTPS with verified PKCE verifier</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="650" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="655">8. Generate cryptographically signed JWT access token (with proper expiry, scopes)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,509 C 715,499 715,539 655,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="655">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="655">9. Issue refresh token with secure binding (mTLS, rotating tokens)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,587 C 715,577 715,617 655,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="655">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="366">10. Return access &amp; refresh tokens in an encrypted HTTPS response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="79" y1="665" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="653">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="546">11. Use access token to request protected resources over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1015" y1="713" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1020">12. Validate token signature, expiry, audience, and scopes rigorously</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1020,761 C 1080,751 1080,791 1020,781"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1020">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="549">13. Grant access only upon successful token validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="839" x2="79" y1="839" x1="1018"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="1018">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="363">14. Use refresh token for secure token renewal with mTLS channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="887" x2="650" y1="887" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="902" x="655">15. Rotate refresh tokens and validate mTLS during refresh</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 655,935 C 715,925 715,965 655,955"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="939" x="655">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="980" x="366">16. Issue new signed tokens with updated expiry and claims</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1013" x2="79" y1="1013" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1017" x="653">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1028" x="1020">17. Continuously monitor token usage and audit for anomalies</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1020,1061 C 1080,1051 1080,1091 1020,1081"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1065" x="1020">17</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Workflow per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Token Request</strong></td><td dir="ltr">- HTTP endpoint (unencrypted)<br>- Client credentials sent in plain text<br>- No PKCE or nonce used</td><td dir="ltr">- HTTPS endpoint; fully encrypted<br>- Credentials sent with PKCE challenge<br>- Dynamic nonce and mTLS binding for client authentication</td><td dir="ltr">Use TLS encryption; enforce PKCE and dynamic nonces; implement mTLS to prevent interception and replay attacks.</td></tr><tr><td dir="ltr"><strong>2. Token Issuance &amp; Refresh</strong></td><td dir="ltr">- Authorization code and tokens generated with weak/random methods<br>- Unsigned or weakly signed JWT<br>- Static refresh token issued without binding</td><td dir="ltr">- Authorization code issued securely<br>- Cryptographically signed JWT access token with explicit expiry, scopes, and audience<br>- Refresh tokens securely bound (rotated via mTLS)</td><td dir="ltr">Implement cryptographic token signing; enforce expiration and token scopes; secure refresh tokens using binding (mTLS) and rotation.</td></tr><tr><td dir="ltr"><strong>3. API Access &amp; Session Handling</strong></td><td dir="ltr">- Access tokens used over HTTP<br>- Minimal token validation (signature/expiry not checked)<br>- No continuous monitoring</td><td dir="ltr">- Access tokens transmitted via HTTPS<br>- Rigorous token validation (signature, expiry, audience, and scopes)<br>- Continuous monitoring and secure token renewal via mTLS</td><td dir="ltr">Always transmit tokens over secure channels; validate tokens thoroughly on every request; use continuous monitoring and refresh controls.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Enterprise Device Identity &amp; Certificate-Based Authentication (CBA)**" dir="auto" class="heading" id="**Enterprise_Device_Identity_&amp;_Certificate-Based_Authentication_(CBA)**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Enterprise Device Identity &amp; Certificate-Based Authentication (CBA)</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Implementing <strong>X.509 certificate authentication</strong> for devices.</li><li data-line="1" dir="auto">Managing <strong>certificate lifecycle (issuance, renewal, revocation)</strong>.</li><li data-line="2" dir="auto">Enforcing <strong>device identity verification for conditional access</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure Device Identity &amp; CBA Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-124 -10 1348 1053" height="1053" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-43" style="width:1348px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="967" x="1024"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="999.5" x="1099"><tspan dy="0" x="1099">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="967" x="553"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="999.5" x="628"><tspan dy="0" x="628">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="D" height="65" width="150" stroke="#666" fill="#eaeaea" y="967" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="999.5" x="75"><tspan dy="0" x="75">Device</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="967" x2="1099" y1="65" x1="1099" id="actor6008"></line><g id="root-6008"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1024"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1099"><tspan dy="0" x="1099">Logger</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="967" x2="628" y1="65" x1="628" id="actor6007"></line><g id="root-6007"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="553"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="628"><tspan dy="0" x="628">Auth Server</tspan></text></g></g><g><line name="D" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="967" x2="75" y1="65" x1="75" id="actor6006"></line><g id="root-6006"><rect class="actor actor-top" ry="3" rx="3" name="D" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Device</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-43{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-43 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-43 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-43 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-43 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-43 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-43 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-43 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-43 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-43 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-43 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-43 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-43 p{margin:0}#mermaid-6a213c2d99ee9aa5-43 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-43 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-43 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-43 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-43 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-43 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-43 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-43 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-43 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-43 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-43 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-43 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-43 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-43 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-43 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-43 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-43 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-43 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-43 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-43 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-43 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-43 .actor-man circle,#mermaid-6a213c2d99ee9aa5-43 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-43 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="350">1. Initiate connection over unencrypted channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="624" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="350">2. Send device identity without a valid certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="624" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="350">3. Optionally attach an expired or self-signed certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="624" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="629">4. Accept certificate without verifying CA signature</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,257 C 689,247 689,287 629,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="629">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="629">5. Skip revocation checks (no OCSP/CRL lookup)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,335 C 689,325 689,365 629,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="629">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="629">6. Ignore certificate expiration and renewal status</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,413 C 689,403 689,443 629,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="629">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="629">7. Accept certificate and proceed without challenge</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,491 C 689,481 689,521 629,511"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="629">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="536" x="629">8. Generate a static, unsigned session token</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,569 C 689,559 689,599 629,589"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="573" x="629">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="614" x="353">9. Return token in a plain HTTP response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="647" x2="79" y1="647" x1="627"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="651" x="627">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="662" x="76">10. Store token in local storage (insecure)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,695 C 136,685 136,725 76,715"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="699" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="740" x="350">11. Use token for subsequent API requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="773" x2="624" y1="773" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="777" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="788" x="629">12. Perform minimal token validation on each request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 629,821 C 689,811 689,851 629,841"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="825" x="629">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="866" x="862">13. Log basic authentication events with minimal details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="899" x2="1095" y1="899" x1="629"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="903" x="629">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="914" x="353">14. Grant unconditional network access without continuous checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="947" x2="79" y1="947" x1="627"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="951" x="627">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure Device Identity &amp; CBA Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1382 1023" height="1023" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-45" style="width:1382px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="937" x="1132"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="969.5" x="1207"><tspan dy="0" x="1207">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="937" x="541"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="969.5" x="616"><tspan dy="0" x="616">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="D" height="65" width="150" stroke="#666" fill="#eaeaea" y="937" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="969.5" x="75"><tspan dy="0" x="75">Device</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="937" x2="1207" y1="65" x1="1207" id="actor6011"></line><g id="root-6011"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1132"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1207"><tspan dy="0" x="1207">Logger</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="937" x2="616" y1="65" x1="616" id="actor6010"></line><g id="root-6010"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="541"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="616"><tspan dy="0" x="616">Auth Server</tspan></text></g></g><g><line name="D" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="937" x2="75" y1="65" x1="75" id="actor6009"></line><g id="root-6009"><rect class="actor actor-top" ry="3" rx="3" name="D" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Device</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-45{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-45 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-45 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-45 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-45 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-45 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-45 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-45 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-45 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-45 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-45 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-45 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-45 p{margin:0}#mermaid-6a213c2d99ee9aa5-45 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-45 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-45 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-45 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-45 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-45 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-45 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-45 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-45 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-45 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-45 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-45 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-45 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-45 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-45 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-45 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-45 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-45 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-45 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-45 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-45 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-45 .actor-man circle,#mermaid-6a213c2d99ee9aa5-45 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-45 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="344">1. Initiate TLS connection with client certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="612" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="344">2. Transmit a valid certificate chain with device identity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="612" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="344">3. Include a unique identifier and a dynamic nonce for freshness</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="612" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="617">4. Verify the certificateâ€™s CA signature and chain integrity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,257 C 677,247 677,287 617,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="617">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="617">5. Perform revocation check via OCSP/CRL</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,335 C 677,325 677,365 617,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="617">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="617">6. Validate certificate expiration and renewal status</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,413 C 677,403 677,443 617,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="617">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="617">7. Enforce conditional access based on validated device identity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,491 C 677,481 677,521 617,511"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="617">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="536" x="347">8. Challenge device with a dynamic nonce (mutual TLS binding)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="569" x2="79" y1="569" x1="615"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="573" x="615">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="344">9. Respond with signed nonce using the device's private key</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="617" x2="612" y1="617" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="617">10. Validate the response and confirm device authenticity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,665 C 677,655 677,695 617,685"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="617">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="710" x="617">11. Generate a cryptographically signed JWT token with proper expiry and scopes</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 617,743 C 677,733 677,773 617,763"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="747" x="617">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="788" x="347">12. Return the token via HTTPS in a secure HttpOnly cookie</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="821" x2="79" y1="821" x1="615"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="825" x="615">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="836" x="910">13. Log detailed authentication events (certificate details, IP, timestamp)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="869" x2="1203" y1="869" x1="617"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="873" x="617">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="884" x="344">14. Use token for subsequent requests with periodic re-validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="917" x2="612" y1="917" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="921" x="76">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Device Initialization</strong></td><td dir="ltr">Device connects over an unencrypted channel; sends identity without a valid certificate or attaches an expired/self-signed certificate.</td><td dir="ltr">Device initiates a TLS connection, transmitting a valid certificate chain with proper device identity, unique identifier, and a dynamic nonce.</td><td dir="ltr">Enforce TLS; require valid, up-to-date certificates from trusted CAs; include dynamic nonce for freshness.</td></tr><tr><td dir="ltr"><strong>Stage 2: Certificate Validation</strong></td><td dir="ltr">Auth Server accepts the certificate without CA verification; skips revocation checks; ignores certificate expiration; does not challenge the device.</td><td dir="ltr">Auth Server verifies the CA signature and chain integrity; performs revocation checks using OCSP/CRL; validates expiration and enforces conditional access; issues a challenge.</td><td dir="ltr">Enforce complete certificate validation (signature, revocation, expiry) and use dynamic challenges (mTLS).</td></tr><tr><td dir="ltr"><strong>Stage 3: Session Establishment &amp; Logging</strong></td><td dir="ltr">Static, unsigned tokens are generated and returned over HTTP; tokens are stored insecurely; minimal logging; unconditional access is granted.</td><td dir="ltr">Auth Server challenges the device, validates the signed nonce; generates cryptographically signed JWT tokens with expiry and scopes; tokens are returned via HTTPS in secure cookies; detailed logging is performed.</td><td dir="ltr">Use signed tokens (JWT) with proper expiry/scopes; enforce secure token storage (HttpOnly cookies); detailed logging and continuous token validation.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Secure Authentication for Privileged Access Management (PAM) Users**" dir="auto" class="heading" id="**Secure_Authentication_for_Privileged_Access_Management_(PAM)_Users**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Secure Authentication for Privileged Access Management (PAM) Users</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Enforcing <strong>just-in-time (JIT) access</strong> for privileged accounts.</li><li data-line="1" dir="auto">Implementing <strong>temporary credential expiration and session recording</strong>.</li><li data-line="2" dir="auto">Using <strong>hardware security modules (HSMs) for privileged credential storage</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure PAM Authentication Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1148 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-51" style="width:1148px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="898"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="973"><tspan dy="0" x="973">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PAM" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="465"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="540"><tspan dy="0" x="540">PAM Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Privileged User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="973" y1="65" x1="973" id="actor6014"></line><g id="root-6014"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="898"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="973"><tspan dy="0" x="973">Logger</tspan></text></g></g><g><line name="PAM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="540" y1="65" x1="540" id="actor6013"></line><g id="root-6013"><rect class="actor actor-top" ry="3" rx="3" name="PAM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="465"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="540"><tspan dy="0" x="540">PAM Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6012"></line><g id="root-6012"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Privileged User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-51{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-51 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-51 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-51 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-51 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-51 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-51 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-51 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-51 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-51 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-51 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-51 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-51 p{margin:0}#mermaid-6a213c2d99ee9aa5-51 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-51 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-51 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-51 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-51 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-51 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-51 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-51 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-51 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-51 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-51 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-51 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-51 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-51 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-51 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-51 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-51 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-51 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-51 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-51 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-51 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-51 .actor-man circle,#mermaid-6a213c2d99ee9aa5-51 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-51 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="306">1. Navigate to unencrypted PAM login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="536" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="306">2. Enter username and static (plaintext) password</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="536" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="306">3. Click "Login" (no JIT enforced)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="536" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="306">4. Transmit credentials via HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="536" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="541">5. Receive unencrypted credentials</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 541,305 C 601,295 601,335 541,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="541">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="541">6. Query internal DB for user record (plaintext match)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 541,383 C 601,373 601,413 541,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="541">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="541">7. Validate credentials via basic comparison</text><path style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" d="M 541,461 C 601,451 601,491 541,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="541">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="309">8. Issue static, long-lived session token (unsigned)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="79" y1="539" x1="539"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="539">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="309">9. Grant immediate access without ephemeral controls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="79" y1="587" x1="539"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="539">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="306">10. Use token for resource access requests over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="536" y1="635" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="541">11. Perform minimal token verification (ignoring expiration/scopes)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 541,683 C 601,673 601,713 541,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="541">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="755">12. Log basic authentication event (sparse details)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="969" y1="761" x1="541"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="541">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="309">13. Maintain persistent session regardless of risk</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="539"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="539">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure PAM Authentication Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1407 1089" height="1089" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-53" style="width:1407px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="1003" x="1157"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1035.5" x="1232"><tspan dy="0" x="1232">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PAM" height="65" width="150" stroke="#666" fill="#eaeaea" y="1003" x="551"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1035.5" x="626"><tspan dy="0" x="626">PAM Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1003" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1035.5" x="75"><tspan dy="0" x="75">Privileged User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1003" x2="1232" y1="65" x1="1232" id="actor6017"></line><g id="root-6017"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1157"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1232"><tspan dy="0" x="1232">Logger</tspan></text></g></g><g><line name="PAM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1003" x2="626" y1="65" x1="626" id="actor6016"></line><g id="root-6016"><rect class="actor actor-top" ry="3" rx="3" name="PAM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="551"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="626"><tspan dy="0" x="626">PAM Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1003" x2="75" y1="65" x1="75" id="actor6015"></line><g id="root-6015"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Privileged User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-53{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-53 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-53 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-53 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-53 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-53 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-53 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-53 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-53 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-53 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-53 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-53 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-53 p{margin:0}#mermaid-6a213c2d99ee9aa5-53 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-53 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-53 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-53 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-53 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-53 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-53 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-53 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-53 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-53 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-53 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-53 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-53 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-53 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-53 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-53 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-53 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-53 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-53 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-53 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-53 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-53 .actor-man circle,#mermaid-6a213c2d99ee9aa5-53 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-53 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="349">1. Navigate to HTTPS-secured PAM login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="622" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="349">2. Enter username and password via TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="622" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="349">3. Click "Login" with JIT access request enabled</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="622" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="349">4. Transmit credentials and device fingerprint over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="622" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="627">5. Receive and decrypt credentials securely</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 627,305 C 687,295 687,335 627,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="627">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="627">6. Query internal DB using salted/hashed password lookup</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 627,383 C 687,373 687,413 627,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="627">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="627">7. Validate credentials and check user eligibility</text><path style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" d="M 627,461 C 687,451 687,491 627,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="627">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="352">8. Trigger dynamic, context-based challenge (e.g., OTP, biometric)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="79" y1="539" x1="625"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="625">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="349">9. Respond to challenge for multi-factor validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="622" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="627">10. Integrate HSM-backed attestation for credential confirmation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 627,635 C 687,625 687,665 627,655"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="627">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="352">11. Generate cryptographically signed, short-lived JWT token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="79" y1="713" x1="625"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="625">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="352">12. Enforce temporary session with automatic expiration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="625"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="625">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="349">13. Use token for secure HTTPS resource access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="622" y1="809" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="627">14. Validate token signature, expiry, and access scope continuously</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 627,857 C 687,847 687,887 627,877"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="627">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="902" x="928">15. Log detailed authentication events (user, IP, MFA outcome, timestamp)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="935" x2="1228" y1="935" x1="627"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="939" x="627">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="950" x="352">16. Monitor session activity enforce re-authentication on anomaly</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="983" x2="79" y1="983" x1="625"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="987" x="625">16</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure PAM Implementation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Login &amp; Submission</strong></td><td dir="ltr">- Uses unencrypted HTTP login page<br>- Static, plaintext credentials<br>- No Just-in-Time (JIT) enforcement<br>- No device fingerprinting or encryption</td><td dir="ltr">- HTTPS-secured login page<br>- Credentials sent via TLS<br>- JIT access request enabled<br>- Transmit additional device/context fingerprint for risk assessment</td><td dir="ltr">Use HTTPS/TLS; enforce JIT for privileged accounts; require additional context (device fingerprinting) to initiate access.</td></tr><tr><td dir="ltr"><strong>Stage 2: Credential Verification</strong></td><td dir="ltr">- Receives unencrypted credentials<br>- Uses unsalted plaintext password lookup<br>- Basic password comparison with no challenge<br>- Issuance of static, unsigned token</td><td dir="ltr">- Secure receipt and decryption of credentials<br>- Uses salted/hashed password verification<br>- Issues dynamic challenge (OTP/biometric MFA)<br>- HSM-backed attestation and signed JWT generation</td><td dir="ltr">Use secure storage/password hashing; implement multi-factor authentication (MFA) and dynamic challenges; use HSM for high-value security assets.</td></tr><tr><td dir="ltr"><strong>Stage 3: Session Management &amp; Logging</strong></td><td dir="ltr">- Issues persistent sessions with long-lived tokens<br>- Minimal token validation (ignores expiration/scopes)<br>- Sparse logging<br>- No re-authentication on anomalies</td><td dir="ltr">- Issues short-lived, cryptographically signed JWT tokens<br>- Enforces continuous token validation (signature, expiry, scope)<br>- Detailed, audit-compliant logging<br>- Monitors session activity with enforced re-authentication if anomalies occur</td><td dir="ltr">Enforce token lifecycle management with cryptographic signing; apply continuous validation and comprehensive logging for forensic readiness.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Delegated Authentication &amp; Trust Management in a Multi-Tenant Enterprise**" dir="auto" class="heading" id="**Delegated_Authentication_&amp;_Trust_Management_in_a_Multi-Tenant_Enterprise**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Delegated Authentication &amp; Trust Management in a Multi-Tenant Enterprise</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Designing <strong>multi-tenant identity isolation</strong> for SaaS platforms.</li><li data-line="1" dir="auto">Implementing <strong>cross-organization trust boundaries</strong> (B2B authentication).</li><li data-line="2" dir="auto">Enforcing <strong>role-based delegated authentication policies</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure Delegated Authentication &amp; Trust Management Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1367.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-59" style="width:1367.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="963"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1038"><tspan dy="0" x="1038">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="484"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="559"><tspan dy="0" x="559">Service Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1038" y1="65" x1="1038" id="actor6020"></line><g id="root-6020"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="963"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1038"><tspan dy="0" x="1038">Identity Provider</tspan></text></g></g><g><line name="SP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="559" y1="65" x1="559" id="actor6019"></line><g id="root-6019"><rect class="actor actor-top" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="484"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="559"><tspan dy="0" x="559">Service Provider</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6018"></line><g id="root-6018"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-59{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-59 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-59 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-59 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-59 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-59 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-59 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-59 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-59 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-59 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-59 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-59 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-59 p{margin:0}#mermaid-6a213c2d99ee9aa5-59 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-59 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-59 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-59 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-59 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-59 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-59 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-59 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-59 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-59 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-59 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-59 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-59 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-59 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-59 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-59 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-59 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-59 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-59 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-59 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-59 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-59 .actor-man circle,#mermaid-6a213c2d99ee9aa5-59 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-59 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="316">1. Navigate to unencrypted login portal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="555" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="316">2. Enter credentials without tenant isolation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="555" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="316">3. Select tenant from a shared dropdown (no isolation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="555" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="316">4. Click "Login" in plain text</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="555" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="316">5. Transmit credentials via HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="555" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="560">6. Accept credentials without tenant verification</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 560,353 C 620,343 620,383 560,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="560">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="797">7. Forward authentication request without tenant context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1034" y1="431" x1="560"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="560">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1039">8. Look up user identity using common repository (no isolation)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1039,479 C 1099,469 1099,509 1039,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1039">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="800">9. Return unsegregated identity data</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="557" x2="563" y1="557" x1="1037"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1037">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="560">10. Perform basic identity match (insecure string compare)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 560,605 C 620,595 620,635 560,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="560">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="319">11. Accept credentials without delegated policy check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="79" y1="683" x1="558"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="558">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="319">12. Bypass role-based delegation treat all users the same</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="558"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="558">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="319">13. Issue a static token with no tenant-specific claims</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="558"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="558">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure Delegated Authentication &amp; Trust Management Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1593.5 1323" height="1323" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-61" style="width:1593.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1237" x="1175"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1269.5" x="1250"><tspan dy="0" x="1250">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="1237" x="671"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1269.5" x="746"><tspan dy="0" x="746">Service Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1237" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1269.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1237" x2="1250" y1="65" x1="1250" id="actor6023"></line><g id="root-6023"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1175"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1250"><tspan dy="0" x="1250">Identity Provider</tspan></text></g></g><g><line name="SP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1237" x2="746" y1="65" x1="746" id="actor6022"></line><g id="root-6022"><rect class="actor actor-top" ry="3" rx="3" name="SP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="671"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="746"><tspan dy="0" x="746">Service Provider</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1237" x2="75" y1="65" x1="75" id="actor6021"></line><g id="root-6021"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-61{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-61 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-61 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-61 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-61 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-61 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-61 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-61 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-61 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-61 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-61 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-61 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-61 p{margin:0}#mermaid-6a213c2d99ee9aa5-61 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-61 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-61 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-61 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-61 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-61 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-61 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-61 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-61 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-61 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-61 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-61 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-61 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-61 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-61 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-61 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-61 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-61 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-61 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-61 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-61 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-61 .actor-man circle,#mermaid-6a213c2d99ee9aa5-61 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-61 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="409">1. Navigate to HTTPS-secured multi-tenant login portal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="742" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="409">2. Enter credentials with tenant-specific identifier</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="742" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="409">3. Tenant is auto-detected or selected with isolation enforced</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="742" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="409">4. Click "Login" over encrypted channel (TLS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="742" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="409">5. Transmit credentials with tenant metadata over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="742" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="747">6. Validate tenant context before processing</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,353 C 807,343 807,383 747,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="747">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="997">7. Forward request with explicit tenant boundary information</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1246" y1="431" x1="747"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="747">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1251">8. Perform tenant-specific identity lookup using segregated DB</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1251,479 C 1311,469 1311,509 1251,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1251">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1251">9. Verify credentials with salted, hashed values and tenant isolation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1251,557 C 1311,547 1311,587 1251,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1251">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1000">10. Return signed and tenant-scoped identity assertion</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="750" y1="635" x1="1249"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1249">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="747">11. Validate IdP signature, enforce cross-organization trust boundaries</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,683 C 807,673 807,713 747,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="747">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="412">12. Trigger dynamic, role-based delegated policy challenge (e.g., OTP or biometric)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="745">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="409">13. Submit additional factor include tenant and role confirmation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="742" y1="809" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="747">14. Generate cryptographically signed JWT with tenant and role claims</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,857 C 807,847 807,887 747,877"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="747">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="902" x="747">15. Enforce Just-In-Time (JIT) provisioning for dynamic user creation if needed</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,935 C 807,925 807,965 747,955"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="939" x="747">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="980" x="412">16. Return token via secure HTTPS cookie (HttpOnly, Secure flags)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1013" x2="79" y1="1013" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1017" x="745">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1028" x="747">17. Log full authentication event with tenant, role, and access context</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,1061 C 807,1051 807,1091 747,1081"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1065" x="747">17</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1106" x="412">18. Grant access based on delegated, role-based policies and trust boundaries</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1139" x2="79" y1="1139" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1143" x="745">18</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1154" x="747">19. Continuously validate token on API calls (signature, expiration, scopes)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 747,1187 C 807,1177 807,1217 747,1207"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1191" x="747">19</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Delegated Authentication</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Login &amp; Tenant Isolation</strong></td><td dir="ltr">- Uses HTTP (unencrypted)<br>- Credentials sent without tenant-specific measures<br>- Tenant selection via generic shared dropdown<br>- No context isolation</td><td dir="ltr">- HTTPS-secured portal<br>- Credentials transmitted with tenant-specific identifier/data<br>- Tenant isolated automatically or via enforced selection<br>- Encrypted transmission used</td><td dir="ltr">Employ HTTPS/TLS; enforce tenant isolation; require tenant metadata in authentication requests</td></tr><tr><td dir="ltr"><strong>Stage 2: Delegated Identity Verification &amp; Trust</strong></td><td dir="ltr">- Forwards request without tenant context<br>- Uses common identity lookup (no segregation)<br>- No signature verification<br>- No dynamic factor challenge</td><td dir="ltr">- Enforces tenant-specific identity lookup using segregated databases<br>- Credentials verified with salted/hashing<br>- Returns signed, tenant-scoped assertion<br>- Dynamic MFA challenge enforced</td><td dir="ltr">Implement segregated identity lookup; verify IdP signatures; enforce additional MFA and tenant/role validation</td></tr><tr><td dir="ltr"><strong>Stage 3: Token Issuance &amp; Delegated Access</strong></td><td dir="ltr">- Issues static token without tenant or role claims<br>- No JIT provisioning<br>- Minimal logging; token not continuously validated</td><td dir="ltr">- Generates cryptographically signed JWT tokens embedded with tenant and role claims<br>- Uses JIT provisioning for dynamic user creation<br>- Detailed logging and continuous token validation</td><td dir="ltr">Use signed, tenant-specific JWT tokens; enforce Just-In-Time provisioning; secure token storage (HttpOnly cookies) and strong logging</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Identity and Access Governance: Compliance-Driven Authentication**" dir="auto" class="heading" id="**Identity_and_Access_Governance:_Compliance-Driven_Authentication**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Identity and Access Governance: Compliance-Driven Authentication</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Enforcing <strong>least privilege authentication</strong> with <strong>role-based access control (RBAC)</strong>.</li><li data-line="1" dir="auto">Implementing <strong>identity lifecycle automation</strong> (provisioning, deprovisioning).</li><li data-line="2" dir="auto">Conducting <strong>periodic access reviews &amp; audit logs for authentication events</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure Identity and Access Governance Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1389.5 1029" height="1029" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-67" style="width:1389.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IDM" height="65" width="150" stroke="#666" fill="#eaeaea" y="943" x="1005"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="1080"><tspan dy="0" x="1080">IDM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="943" x="507"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="582"><tspan dy="0" x="582">AS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="943" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="IDM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="1080" y1="65" x1="1080" id="actor6026"></line><g id="root-6026"><rect class="actor actor-top" ry="3" rx="3" name="IDM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1005"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1080"><tspan dy="0" x="1080">IDM</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="582" y1="65" x1="582" id="actor6025"></line><g id="root-6025"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="507"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="582"><tspan dy="0" x="582">AS</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="75" y1="65" x1="75" id="actor6024"></line><g id="root-6024"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-67{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-67 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-67 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-67 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-67 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-67 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-67 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-67 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-67 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-67 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-67 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-67 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-67 p{margin:0}#mermaid-6a213c2d99ee9aa5-67 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-67 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-67 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-67 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-67 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-67 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-67 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-67 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-67 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-67 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-67 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-67 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-67 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-67 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-67 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-67 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-67 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-67 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-67 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-67 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-67 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-67 .actor-man circle,#mermaid-6a213c2d99ee9aa5-67 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-67 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="327">1. Navigate to HTTP login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="578" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="327">2. Enter username and password (plaintext)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="578" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="327">3. Click "Login" without tenant/role context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="578" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="327">4. Submit unencrypted credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="578" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="830">5. Forward credentials to IDM (without validation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1076" y1="305" x1="583"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="583">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1081">6. Perform basic lookup using static records</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1081,353 C 1141,343 1141,383 1081,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1081">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="833">7. Return identity record (unsegregated, no lifecycle check)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="586" y1="431" x1="1079"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1079">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="330">8. Accept identity without verifying role or RBAC</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="79" y1="479" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="581">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="330">9. Grant broad access privileges (violating least privilege)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="79" y1="527" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="581">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="583">10. Issue a long-lived, unsigned token without role data</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 583,575 C 643,565 643,605 583,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="583">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="330">11. Return token over HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="581">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="327">12. Use token for resource access without role verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="578" y1="701" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="830">13. Bypass dynamic provisioning/updating processes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1076" y1="749" x1="583"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="583">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="764" x="830">14. Generate rudimentary audit logs (few details)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="797" x2="1076" y1="797" x1="583"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="801" x="583">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="812" x="1081">15. Retain logs without periodic access review automation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1081,845 C 1141,835 1141,875 1081,865"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="849" x="1081">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="890" x="330">16. Maintain persistent session with no timely deprovisioning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="923" x2="79" y1="923" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="927" x="581">16</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure Identity and Access Governance Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1816 1029" height="1029" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-69" style="width:1816px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IDM" height="65" width="173" stroke="#666" fill="#eaeaea" y="943" x="1344.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="1431"><tspan dy="0" x="1431">Identity Management</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="943" x="724"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="799"><tspan dy="0" x="799">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="943" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="975.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="IDM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="1431" y1="65" x1="1431" id="actor6029"></line><g id="root-6029"><rect class="actor actor-top" ry="3" rx="3" name="IDM" height="65" width="173" stroke="#666" fill="#eaeaea" y="0" x="1344.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1431"><tspan dy="0" x="1431">Identity Management</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="799" y1="65" x1="799" id="actor6028"></line><g id="root-6028"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="724"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="799"><tspan dy="0" x="799">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="943" x2="75" y1="65" x1="75" id="actor6027"></line><g id="root-6027"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-69{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-69 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-69 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-69 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-69 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-69 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-69 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-69 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-69 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-69 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-69 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-69 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-69 p{margin:0}#mermaid-6a213c2d99ee9aa5-69 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-69 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-69 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-69 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-69 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-69 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-69 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-69 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-69 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-69 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-69 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-69 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-69 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-69 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-69 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-69 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-69 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-69 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-69 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-69 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-69 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-69 .actor-man circle,#mermaid-6a213c2d99ee9aa5-69 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-69 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="436">1. Navigate to HTTPS-secured login portal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="795" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="436">2. Enter credentials over TLS with unique identifier</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="795" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="436">3. Click "Login" initiating tenant/role context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="795" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="436">4. Submit encrypted credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="795" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="1114">5. Forward credentials with context to IDM for identity verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1427" y1="305" x1="800"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="800">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1432">6. Perform lookup using salted hashes and valid provisioning data</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1432,353 C 1492,343 1492,383 1432,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1432">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1117">7. Return tenant- and role-scoped identity record after lifecycle checks</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="803" y1="431" x1="1430"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1430">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="439">8. Validate identity record against dynamic RBAC policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="79" y1="479" x1="798"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="798">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="439">9. Enforce least privilege by assigning minimal access roles</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="79" y1="527" x1="798"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="798">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="800">10. Issue a cryptographically signed JWT containing role and tenant claims</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 800,575 C 860,565 860,605 800,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="800">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="439">11. Return token via HTTPS (set in HttpOnly, Secure cookie)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="798"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="798">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="436">12. Use token for resource access with continuous RBAC enforcement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="795" y1="701" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1114">13. Trigger automatic, Just-In-Time updates for identity lifecycle management</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1427" y1="749" x1="800"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="800">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="764" x="1114">14. Log full authentication events (user, role, device, IP, timestamp)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="797" x2="1427" y1="797" x1="800"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="801" x="800">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="812" x="1432">15. Automate periodic access reviews and trigger deprovisioning when needed</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1432,845 C 1492,835 1492,875 1432,865"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="849" x="1432">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="890" x="439">16. Monitor session activity with continuous token validation and re-authentication triggers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="923" x2="79" y1="923" x1="798"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="927" x="798">16</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practices / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Login &amp; Identity Provisioning</strong></td><td dir="ltr">- HTTP portal with unencrypted submission<br>- Static, plaintext credentials<br>- No tenant or role context provided<br>- Basic identity lookup with no lifecycle automation</td><td dir="ltr">- HTTPS-secured login with TLS<br>- Encrypted credentials with unique identifiers<br>- Tenant/role context enforced<br>- IDM performs lookup with salted hashes plus lifecycle checks; dynamic provisioning/deprovisioning implemented</td><td dir="ltr">Use HTTPS; enforce encryption, tenant isolation, and identity lifecycle automation; require contextual information.</td></tr><tr><td dir="ltr"><strong>Stage 2: Session Establishment &amp; RBAC Enforcement</strong></td><td dir="ltr">- Issues long-lived, unsigned token<br>- Token lacks embedded role/tenant claims<br>- No dynamic RBAC or least privilege enforcement; credentials kept in active session</td><td dir="ltr">- Issues cryptographically signed JWT with proper expiry and embedded role/tenant claims<br>- Tokens set in HttpOnly, Secure cookies<br>- RBAC enforced continuously; session renewal uses JIT provisioning to update identity attributes</td><td dir="ltr">Employ signed tokens (JWT) with short expiry, embedded roles, use secure cookie storage, enforce dynamic RBAC.</td></tr><tr><td dir="ltr"><strong>Stage 3: Audit Logging &amp; Access Reviews</strong></td><td dir="ltr">- Minimal logging with sparse details<br>- Retention of logs without automation<br>- No periodic access review or enforced deprovisioning</td><td dir="ltr">- Comprehensive logging of all authentication events (user details, role, device, IP, timestamps)<br>- Automated periodic access reviews and deprovisioning via IDM<br>- Continuous monitoring with enforced re-authentication on anomaly</td><td dir="ltr">Integrate detailed, automated audit logging with periodic reviews; ensure proactive deprovisioning and continuous monitoring.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Authentication for Remote Workforce &amp; BYOD Security**" dir="auto" class="heading" id="**Authentication_for_Remote_Workforce_&amp;_BYOD_Security**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Authentication for Remote Workforce &amp; BYOD Security</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Enforcing <strong>device compliance policies for remote users</strong>.</li><li data-line="1" dir="auto">Implementing <strong>VPN-less Zero Trust Network Access (ZTNA)</strong>.</li><li data-line="2" dir="auto">Using <strong>endpoint security signals (MDM, EDR, XDR) for authentication decisions</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure Authentication for Remote Workforce &amp; BYOD (Workflow)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1455.5 963" height="963" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-75" style="width:1455.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="ESS" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="1017"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="1092"><tspan dy="0" x="1092">ESS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="482"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="557"><tspan dy="0" x="557">AS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="ESS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="1092" y1="65" x1="1092" id="actor6032"></line><g id="root-6032"><rect class="actor actor-top" ry="3" rx="3" name="ESS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1017"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1092"><tspan dy="0" x="1092">ESS</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="557" y1="65" x1="557" id="actor6031"></line><g id="root-6031"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="482"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="557"><tspan dy="0" x="557">AS</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="75" y1="65" x1="75" id="actor6030"></line><g id="root-6030"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-75{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-75 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-75 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-75 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-75 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-75 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-75 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-75 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-75 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-75 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-75 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-75 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-75 p{margin:0}#mermaid-6a213c2d99ee9aa5-75 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-75 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-75 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-75 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-75 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-75 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-75 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-75 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-75 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-75 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-75 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-75 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-75 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-75 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-75 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-75 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-75 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-75 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-75 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-75 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-75 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-75 .actor-man circle,#mermaid-6a213c2d99ee9aa5-75 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-75 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="315">1. Navigate to HTTP login portal (no encryption)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="553" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="315">2. Enter username and static password (plaintext)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="553" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="315">3. Click "Login" without any device check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="553" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="315">4. Send credentials over unencrypted network</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="553" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="558">5. Accept credentials without verifying device compliance</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 558,305 C 618,295 618,335 558,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="558">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="823">6. Forward basic user info with no endpoint state check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="1088" y1="383" x1="558"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="558">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1093">7. Perform minimal endpoint verification (e.g., no MDM/EDR/XDR signals)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1093,431 C 1153,421 1153,461 1093,451"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1093">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="826">8. Return generic "device OK" flag regardless of compliance</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="561" y1="509" x1="1091"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1091">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="558">9. Bypass dynamic risk assessment and context</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 558,557 C 618,547 618,587 558,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="558">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="318">10. Issue static, long-lived session token (unsigned)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="556">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="315">11. Use token for accessing internal resources over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="553" y1="683" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="558">12. Perform basic token check (ignoring expiration/scopes)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 558,731 C 618,721 618,761 558,751"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="558">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="823">13. Log minimal endpoint data (without detailed security signals)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="1088" y1="809" x1="558"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="558">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="318">14. Grant access despite weak compliance and risk</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="79" y1="857" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="556">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure Authentication for Remote Workforce &amp; BYOD (Workflow â€“ Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1617.5 1137" height="1137" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-77" style="width:1617.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="ESS" height="65" width="206" stroke="#666" fill="#eaeaea" y="1051" x="1188"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="1291"><tspan dy="0" x="1291">Endpoint Security System</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="609"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="684"><tspan dy="0" x="684">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="1051" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1083.5" x="75"><tspan dy="0" x="75">Remote User</tspan></text></g><g><line name="ESS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="1291" y1="65" x1="1291" id="actor6035"></line><g id="root-6035"><rect class="actor actor-top" ry="3" rx="3" name="ESS" height="65" width="206" stroke="#666" fill="#eaeaea" y="0" x="1188"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1291"><tspan dy="0" x="1291">Endpoint Security System</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="684" y1="65" x1="684" id="actor6034"></line><g id="root-6034"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="609"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="684"><tspan dy="0" x="684">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1051" x2="75" y1="65" x1="75" id="actor6033"></line><g id="root-6033"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Remote User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-77{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-77 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-77 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-77 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-77 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-77 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-77 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-77 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-77 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-77 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-77 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-77 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-77 p{margin:0}#mermaid-6a213c2d99ee9aa5-77 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-77 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-77 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-77 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-77 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-77 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-77 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-77 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-77 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-77 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-77 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-77 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-77 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-77 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-77 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-77 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-77 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-77 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-77 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-77 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-77 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-77 .actor-man circle,#mermaid-6a213c2d99ee9aa5-77 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-77 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="378">1. Navigate to HTTPS-secured login portal with encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="680" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="378">2. Enter username and password over TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="680" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="378">3. Click "Login" with device identifier transmitted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="680" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="378">4. Send encrypted credentials along with device metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="680" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="986">5. Forward user/device info to Endpoint Security for compliance check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1287" y1="305" x1="685"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="685">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1292">6. Evaluate MDM, EDR, and XDR signals for device compliance</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1292,353 C 1352,343 1352,383 1292,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1292">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="989">7. Return detailed, compliant device status and risk score</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="688" y1="431" x1="1290"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1290">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="685">8. Perform dynamic risk-based assessment and multi-factor verification</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 685,479 C 745,469 745,509 685,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="685">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="381">9. Issue a dynamic challenge (OTP/biometric) for secondary authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="683"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="683">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="378">10. Respond with challenge answer over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="680" y1="605" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="685">11. Validate response and context as per Zero Trust rules</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 685,653 C 745,643 745,683 685,673"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="685">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="685">12. Generate cryptographically signed JWT with short expiry and endpoint claims</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 685,731 C 745,721 745,761 685,751"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="685">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="381">13. Return token via HTTPS secured channel in an HttpOnly, Secure cookie</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="683"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="683">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="378">14. Use token for resource access over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="680" y1="857" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="872" x="986">15. Continuously monitor device signals and audit token usage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="905" x2="1287" y1="905" x1="685"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="909" x="685">15</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="920" x="685">16. Enforce periodic re-authentication and risk assessment triggers</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 685,953 C 745,943 745,983 685,973"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="957" x="685">16</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="998" x="986">17. Log comprehensive security events (user, device, IP, MFA, timestamps)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1031" x2="1287" y1="1031" x1="685"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="1035" x="685">17</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Login &amp; Device Submission</strong></td><td dir="ltr">- HTTP login page (unencrypted)<br>- Static username/password transmission in plaintext<br>- No device metadata<br>- No compliance check before submission</td><td dir="ltr">- HTTPS-secured login page (TLS-encrypted)<br>- Credentials transmitted securely<br>- Device metadata (e.g., unique identifier) included<br>- Enforcement of initial device compliance via endpoint reporting</td><td dir="ltr">Use TLS encryption; require device metadata; enforce basic device compliance with proper endpoint identification.</td></tr><tr><td dir="ltr"><strong>Stage 2: Device Verification &amp; Zero Trust Check</strong></td><td dir="ltr">- Minimal endpoint verification<br>- No integration with MDM/EDR/XDR<br>- Generic "device OK" flag returned<br>- No dynamic risk or context-based check</td><td dir="ltr">- Endpoint Security System evaluates MDM, EDR, and XDR signals<br>- Detailed compliance check with risk scoring<br>- Zero Trust policies applied; dynamic challenge (OTP/biometric) issued for additional factors</td><td dir="ltr">Perform comprehensive endpoint checks; integrate MDM/EDR/XDR signals; enforce Zero Trust; issue dynamic MFA challenges.</td></tr><tr><td dir="ltr"><strong>Stage 3: Session Establishment &amp; Logging</strong></td><td dir="ltr">- Issues long-lived static token (unsigned)<br>- Token transmitted over unencrypted channels<br>- Minimal logging with basic endpoint data<br>- No periodic re-authentication</td><td dir="ltr">- Issues cryptographically signed JWT with tenant/device claims, short expiry<br>- Token delivered via HTTPS using HttpOnly, Secure cookies<br>- Comprehensive logging (user, device, IP, timestamps)<br>- Continuous token validation and re-authentication triggers</td><td dir="ltr">Use signed tokens with proper expiry and claims; secure token storage; enforce continuous validation and detailed audit logging.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**Blockchain-Based Decentralized Identity (DID) Authentication**" dir="auto" class="heading" id="**Blockchain-Based_Decentralized_Identity_(DID)_Authentication**"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Blockchain-Based Decentralized Identity (DID) Authentication</strong><div class="heading-after">...</div></h4><div class="heading-children"><div class="el-ul"><ul><li data-line="0" dir="auto">Implementing <strong>Self-Sovereign Identity (SSI) solutions</strong> for authentication.</li><li data-line="1" dir="auto">Using <strong>Verifiable Credentials (VC) &amp; Decentralized Identifiers (DIDs)</strong>.</li><li data-line="2" dir="auto">Exploring <strong>blockchain-based authentication for enterprise use cases</strong>.</li></ul></div><div class="el-p"><p dir="auto">Diagram A: Insecure DID Authentication Workflow</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-161.5 -10 1546.5 1071" height="1071" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-83" style="width:1546.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="985" x="1185"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="1260"><tspan dy="0" x="1260">L</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BC" height="65" width="150" stroke="#666" fill="#eaeaea" y="985" x="564"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="639"><tspan dy="0" x="639">BC</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="985" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="1260" y1="65" x1="1260" id="actor6038"></line><g id="root-6038"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1185"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1260"><tspan dy="0" x="1260">L</tspan></text></g></g><g><line name="BC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="639" y1="65" x1="639" id="actor6037"></line><g id="root-6037"><rect class="actor actor-top" ry="3" rx="3" name="BC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="564"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="639"><tspan dy="0" x="639">BC</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="75" y1="65" x1="75" id="actor6036"></line><g id="root-6036"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-83{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-83 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-83 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-83 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-83 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-83 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-83 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-83 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-83 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-83 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-83 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-83 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-83 p{margin:0}#mermaid-6a213c2d99ee9aa5-83 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-83 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-83 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-83 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-83 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-83 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-83 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-83 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-83 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-83 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-83 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-83 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-83 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-83 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-83 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-83 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-83 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-83 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-83 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-83 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-83 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-83 .actor-man circle,#mermaid-6a213c2d99ee9aa5-83 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-83 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="356">1. Navigate to unencrypted login page (HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="635" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="356">2. Select DID authentication option without secure channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="635" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="356">3. Submit identity claim with DID no dynamic challenge generated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="635" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="640">4. Receive claim without verifying digital signatures</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 640,257 C 700,247 700,287 640,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="640">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="640">5. Retrieve existing DID document using basic lookup</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 640,335 C 700,325 700,365 640,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="640">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="640">6. Accept verifiable credential using legacy, weak algorithms</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 640,413 C 700,403 700,443 640,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="640">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="640">7. Skip nonce/challenge-based validation no fresh challenge issued</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 640,491 C 700,481 700,521 640,511"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="640">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="536" x="359">8. Return static, long-lived authentication assertion</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="569" x2="79" y1="569" x1="638"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="573" x="638">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="76">9. Accept insecure assertion without local validation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,617 C 136,607 136,647 76,637"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="662" x="948">10. Log authentication event with minimal metadata (no cryptographic audit)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="695" x2="1256" y1="695" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="699" x="640">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="710" x="948">11. Do not record revocation or expiry details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="743" x2="1256" y1="743" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="747" x="640">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="758" x="356">12. Use received token over unencrypted channels for API access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="791" x2="635" y1="791" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="795" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="640">13. Perform minimal token validation (ignoring signature and scope)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 640,839 C 700,829 700,869 640,859"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="640">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="884" x="948">14. Retain sparse logs that do not capture anomalies or biometric signals</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="917" x2="1256" y1="917" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="921" x="640">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="932" x="356">15. Gain persistent access regardless of token replay or compromise</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="965" x2="635" y1="965" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="969" x="76">15</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure DID Authentication Workflow (Defense in Depth)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-211.5 -10 1801.5 1071" height="1071" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-85" style="width:1801.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="985" x="1390"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="1465"><tspan dy="0" x="1465">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BC" height="65" width="200" stroke="#666" fill="#eaeaea" y="985" x="688"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="788"><tspan dy="0" x="788">Blockchain Identity Node</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="985" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1017.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="1465" y1="65" x1="1465" id="actor6041"></line><g id="root-6041"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1390"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1465"><tspan dy="0" x="1465">Logger</tspan></text></g></g><g><line name="BC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="788" y1="65" x1="788" id="actor6040"></line><g id="root-6040"><rect class="actor actor-top" ry="3" rx="3" name="BC" height="65" width="200" stroke="#666" fill="#eaeaea" y="0" x="688"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="788"><tspan dy="0" x="788">Blockchain Identity Node</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="985" x2="75" y1="65" x1="75" id="actor6039"></line><g id="root-6039"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-85{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-85 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-85 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-85 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-85 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-85 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-85 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-85 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-85 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-85 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-85 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-85 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-85 p{margin:0}#mermaid-6a213c2d99ee9aa5-85 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-85 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-85 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-85 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-85 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-85 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-85 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-85 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-85 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-85 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-85 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-85 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-85 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-85 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-85 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-85 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-85 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-85 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-85 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-85 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-85 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-85 .actor-man circle,#mermaid-6a213c2d99ee9aa5-85 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-85 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="430">1. Navigate to HTTPS-secured login page</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="784" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="430">2. Select DID authentication with a secure mobile wallet</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="784" y1="161" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="430">3. Request authentication system generates dynamic nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="784" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="789">4. Issue a fresh challenge nonce for user to sign</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 789,257 C 849,247 849,287 789,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="789">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="76">5. Sign nonce with deviceâ€™s private key using strong cryptography</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,335 C 136,325 136,365 76,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="430">6. Transmit signed credential along with DID and additional metadata securely (over TLS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="784" y1="413" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="789">7. Resolve DID by fetching the DID document from distributed ledger</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 789,461 C 849,451 849,491 789,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="789">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="789">8. Verify digital signature against verifiable credentials using robust algorithms</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 789,539 C 849,529 849,569 789,559"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="789">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="789">9. Enforce additional checks (timestamp, certificate validity, revocation status)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 789,617 C 849,607 849,647 789,637"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="789">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="662" x="1125">10. Log full verification details (DID data, challenge response, device fingerprint)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="695" x2="1461" y1="695" x1="789"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="699" x="789">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="710" x="789">11. Generate a cryptographically signed JWT token with short expiry, embedded DID and scopes</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 789,743 C 849,733 849,773 789,763"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="747" x="789">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="788" x="433">12. Return token via HTTPS (delivered as an HttpOnly, Secure cookie)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="821" x2="79" y1="821" x1="787"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="825" x="787">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="836" x="430">13. Use token for API access token validated at each request signature, expiry, scope</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="869" x2="784" y1="869" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="873" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="884" x="1125">14. Log detailed audit events including token usage and risk signals</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="917" x2="1461" y1="917" x1="789"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="921" x="789">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="932" x="1125">15. Continuously monitor for anomalies and trigger re-authentication if risk detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="965" x2="1461" y1="965" x1="789"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="969" x="789">15</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Initiation &amp; Identity Claim Submission</strong></td><td dir="ltr">- Navigation via HTTP (unencrypted)<br>- DID selection without secure channel<br>- Identity claim sent without dynamic challenge<br>- No digital signature verification performed</td><td dir="ltr">- Navigation via HTTPS (TLS encryption)<br>- DID authentication initiated from a secure mobile wallet<br>- Dynamic nonce/challenge is generated<br>- User signs nonce with strong cryptography</td><td dir="ltr">Enforce HTTPS/TLS; employ dynamic nonce challenges; require digital signature on claims to prevent replay attacks and impersonation</td></tr><tr><td dir="ltr"><strong>Stage 2: Credential Verification &amp; Token Issuance</strong></td><td dir="ltr">- Blockchain node retrieves DID without enforcing signature verification<br>- Weak algorithms used for verifying credentials<br>- No revocation or expiry check<br>- Minimal audit logging</td><td dir="ltr">- Blockchain node resolves DID via distributed ledger<br>- Verifiable credentials are checked using robust digital signature validation<br>- Timestamp, certificate, and revocation checks enforced<br>- Detailed logging is performed</td><td dir="ltr">Use blockchain-based DID resolution; verify signatures using strong cryptography; check revocation status and certificate validity; log all events in detail</td></tr><tr><td dir="ltr"><strong>Stage 3: Session Establishment &amp; Continuous Monitoring</strong></td><td dir="ltr">- Static, long-lived token issued without cryptographic signing<br>- Token sent over unencrypted channels<br>- No continuous token validation<br>- Minimal logging &amp; no anomaly detection</td><td dir="ltr">- Cryptographically signed JWT token generated with short expiry and embedded DID/scopes<br>- Token delivered securely as HttpOnly cookie via HTTPS<br>- Continuous token validation (signature, expiry, scope) on each request<br>- Anomaly monitoring and detailed audit logging implemented</td><td dir="ltr">Issue signed tokens with short expiry; transmit tokens with secure cookie attributes; continuously validate token integrity; integrate comprehensive monitoring and logging</td></tr></tbody></table></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Web Service and API" dir="auto" class="heading" id="Web_Service_and_API"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Web Service and API<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="End-to-End TLS Enforcement &amp; HSTS Deployment" dir="auto" class="heading" id="End-to-End_TLS_Enforcement_&amp;_HSTS_Deployment"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>End-to-End TLS Enforcement &amp; HSTS Deployment<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement strict HTTPS/TLS on every endpoint with certificate pinning, enforce HTTP Strict Transport Security (HSTS), and use secure ciphers across the network.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;MitM, protocol downgrade, SSL stripping, certificate spoofing.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;OWASP Transport Security, NIST SP 800-52, regular TLS vulnerability scans.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Security architects, network engineers, CISO oversight; target users include API clients and end-users.</p></div><div class="el-p"><p dir="auto">Diagram A: Insecure End-to-End TLS/HSTS Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1665.5 903" height="903" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-92" style="width:1665.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1280"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1355"><tspan dy="0" x="1355">L</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="P" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1080"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1155"><tspan dy="0" x="1155">P</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="WS" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="616"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="691"><tspan dy="0" x="691">WS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1355" y1="65" x1="1355" id="actor6045"></line><g id="root-6045"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1280"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1355"><tspan dy="0" x="1355">L</tspan></text></g></g><g><line name="P" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1155" y1="65" x1="1155" id="actor6044"></line><g id="root-6044"><rect class="actor actor-top" ry="3" rx="3" name="P" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1080"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1155"><tspan dy="0" x="1155">P</tspan></text></g></g><g><line name="WS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="691" y1="65" x1="691" id="actor6043"></line><g id="root-6043"><rect class="actor actor-top" ry="3" rx="3" name="WS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="616"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="691"><tspan dy="0" x="691">WS</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="75" y1="65" x1="75" id="actor6042"></line><g id="root-6042"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-92{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-92 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-92 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-92 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-92 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-92 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-92 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-92 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-92 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-92 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-92 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-92 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-92 p{margin:0}#mermaid-6a213c2d99ee9aa5-92 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-92 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-92 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-92 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-92 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-92 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-92 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-92 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-92 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-92 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-92 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-92 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-92 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-92 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-92 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-92 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-92 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-92 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-92 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-92 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-92 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-92 .actor-man circle,#mermaid-6a213c2d99ee9aa5-92 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-92 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="382">1. Navigate to http://example.com (no HTTPS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="687" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="385">2. Respond with non-secure HTTP 200 OK (no HSTS header)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="161" x2="79" y1="161" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="690">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="382">3. Send API request over plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="687" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="617">4. (Intercept traffic) Capture request data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="1154"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="1154">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="382">5. Trigger TLS handshake using outdated or weak cipher (forced fallback)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="687" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="692">6. Accept handshake with weak/legacy parameters</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 692,353 C 752,343 752,383 692,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="692">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="925">7. (Man-in-the-Middle) Modify cipher suite parameters</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="695" y1="431" x1="1154"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1154">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="385">8. Complete handshake without certificate validation</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="79" y1="479" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="690">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="385">9. Establish session (non-encrypted cookie, no HttpOnly, Secure attributes)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="79" y1="527" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="690">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1022">10. Log session creation with minimal security details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="1351" y1="575" x1="692"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="692">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="382">11. Send sensitive data requests over established insecure session</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="687" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="925">12. Replay interception with forged session tokens</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="695" y1="671" x1="1154"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1154">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="385">13. Return data responses without HSTS header or certificate pinning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="690">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="734" x="1356">14. Log absence of HSTS, missing auto-redirect to HTTPS</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1356,767 C 1416,757 1416,797 1356,787"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="771" x="1356">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B: Secure End-to-End TLS/HSTS Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1747 1011" height="1011" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-94" style="width:1747px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="1317"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="1392"><tspan dy="0" x="1392">L</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="WS" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="737"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="812"><tspan dy="0" x="812">WS</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="75"><tspan dy="0" x="75">U</tspan></text></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="1392" y1="65" x1="1392" id="actor6048"></line><g id="root-6048"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1317"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1392"><tspan dy="0" x="1392">L</tspan></text></g></g><g><line name="WS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="812" y1="65" x1="812" id="actor6047"></line><g id="root-6047"><rect class="actor actor-top" ry="3" rx="3" name="WS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="737"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="812"><tspan dy="0" x="812">WS</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="75" y1="65" x1="75" id="actor6046"></line><g id="root-6046"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">U</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-94{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-94 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-94 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-94 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-94 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-94 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-94 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-94 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-94 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-94 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-94 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-94 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-94 p{margin:0}#mermaid-6a213c2d99ee9aa5-94 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-94 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-94 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-94 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-94 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-94 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-94 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-94 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-94 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-94 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-94 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-94 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-94 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-94 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-94 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-94 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-94 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-94 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-94 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-94 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-94 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-94 .actor-man circle,#mermaid-6a213c2d99ee9aa5-94 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-94 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="442">1. Navigate to https://example.com (force HTTPS via preconfigured link)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="808" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="445">2. Respond with HTTPS 200 OK and include HSTS header (max-age, preload)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="161" x2="79" y1="161" x1="811"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="811">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="442">3. Send DNS request with certificate pinning enabled</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="808" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="1393">4. Log HTTPS initiation event</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1393,257 C 1453,247 1453,287 1393,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="1393">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="442">5. Initiate TLS handshake using strong cipher suites</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="808" y1="335" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="813">6. Present certificate chain signed by trusted CA</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 813,383 C 873,373 873,413 813,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="813">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="442">7. Validate certificate chain, check revocation (OCSP/CRL) and match pinning info</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="808" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="445">8. Complete handshake with negotiated strong cipher</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="509" x2="79" y1="509" x1="811"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="811">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="445">9. Establish encrypted session set session cookie with HttpOnly, Secure, and SameSite flags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="79" y1="557" x1="811"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="811">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1101">10. Log secure session creation with cipher suite and certificate details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1388" y1="605" x1="813"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="813">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="442">11. Transmit API requests over encrypted channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="808" y1="653" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1393">12. Monitor session for anomalies in real time</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1393,701 C 1453,691 1453,731 1393,721"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1393">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="445">13. Return API responses with HSTS header intact and proper content-security policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="811"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="811">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="794" x="442">14. Automatically enforce HTTPS in future requests (HSTS preloading)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="827" x2="808" y1="827" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="831" x="76">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="842" x="1393">15. Log access events including certificate and HSTS validation details</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1393,875 C 1453,865 1453,905 1393,895"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="879" x="1393">15</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure End-to-End TLS/HSTS Implementation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Stage 1: Connection Initiation</strong></td><td dir="ltr">- User navigates via HTTP<br>- Server responds without HSTS header<br>- Plaintext API request sent<br>- Traffic may be intercepted</td><td dir="ltr">- User uses HTTPS<br>- Server responds with HSTS header (max-age, preload)<br>- DNS requests and certificate pinning enforced<br>- Connection initiation logged securely</td><td dir="ltr">Force HTTPS, enforce HSTS, and utilize certificate pinning to mitigate downgrade attacks and MiTM.</td></tr><tr><td dir="ltr"><strong>Stage 2: TLS Handshake</strong></td><td dir="ltr">- TLS handshake attempted with weak/outdated cipher<br>- No certificate validation<br>- Vulnerable to MiTM and cipher downgrading</td><td dir="ltr">- TLS handshake using strong cipher suites<br>- Full certificate chain validation including OCSP/CRL checks<br>- Negotiated strong encryption parameters</td><td dir="ltr">Use strong cipher suites, validate certificates rigorously, and check revocation statuses to thwart interception and spoofing attacks.</td></tr><tr><td dir="ltr"><strong>Stage 3: Session Establishment</strong></td><td dir="ltr">- Session established with non-secure cookies (lacking HttpOnly, Secure, SameSite)<br>- Minimal logging, session tokens may be intercepted &amp; replayed</td><td dir="ltr">- Encrypted session established with secure cookies (HttpOnly, Secure, SameSite)<br>- Detailed logging of session creation with cipher and certificate details</td><td dir="ltr">Secure session cookies, enforce session renewal and continuous token validation.</td></tr><tr><td dir="ltr"><strong>Stage 4: Resource Access &amp; HSTS</strong></td><td dir="ltr">- Data returned without security headers<br>- HSTS header missing leading to no auto-enforcement of HTTPS on subsequent requests</td><td dir="ltr">- API responses return with HSTS header and robust Content Security Policies<br>- Automatic enforcement of HTTPS on all future accesses<br>- Detailed access logging implemented</td><td dir="ltr">Return secure headers (HSTS) with every response, enforce auto-redirect to HTTPS and ensure continuous monitoring and logging of access events.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="OAuth 2.0 with PKCE &amp; mTLS for API Access" dir="auto" class="heading" id="OAuth_2.0_with_PKCE_&amp;_mTLS_for_API_Access"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>OAuth 2.0 with PKCE &amp; mTLS for API Access<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Integrate OAuth 2.0 flows with PKCE to protect authorization codes; enforce mutual TLS (mTLS) for both client and server, issuing short-lived tokens.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Token interception, replay attacks, authorization code injection.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;OAuth Security Best Current Practice (BCP), IETF RFC 7636, continuous penetration testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;API developers, Identity &amp; Access Management (IAM) specialists, CISO; client apps and authorized users.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure OAuth Flow (Insecure Implementation)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1153 843" height="843" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-100" style="width:1153px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="903"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="978"><tspan dy="0" x="978">Resource Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="703"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="778"><tspan dy="0" x="778">Token Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="503"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="578"><tspan dy="0" x="578">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="RS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="978" y1="65" x1="978" id="actor6052"></line><g id="root-6052"><rect class="actor actor-top" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="903"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="978"><tspan dy="0" x="978">Resource Server</tspan></text></g></g><g><line name="TS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="778" y1="65" x1="778" id="actor6051"></line><g id="root-6051"><rect class="actor actor-top" ry="3" rx="3" name="TS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="703"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="778"><tspan dy="0" x="778">Token Server</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="578" y1="65" x1="578" id="actor6050"></line><g id="root-6050"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="503"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="578"><tspan dy="0" x="578">Auth Server</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="75" y1="65" x1="75" id="actor6049"></line><g id="root-6049"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-100{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-100 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-100 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-100 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-100 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-100 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-100 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-100 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-100 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-100 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-100 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-100 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-100 p{margin:0}#mermaid-6a213c2d99ee9aa5-100 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-100 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-100 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-100 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-100 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-100 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-100 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-100 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-100 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-100 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-100 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-100 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-100 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-100 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-100 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-100 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-100 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-100 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-100 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-100 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-100 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-100 .actor-man circle,#mermaid-6a213c2d99ee9aa5-100 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-100 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="325">1. Initiate authorization request over HTTP (no TLS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="574" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="328">2. Return authorization code without PKCE challenge</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="161" x2="79" y1="161" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="577">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="425">3. Send auth code for token without proper PKCE binding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="774" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="428">4. Issue long-lived access token (no key rotation)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="257" x2="79" y1="257" x1="777"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="777">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="525">5. Use token to access protected resource with no mTLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="974" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="528">6. Serve resource without verifying certificate</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="353" x2="79" y1="353" x1="977"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="977">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="325">7. Replay same authorization request (no nonce verification)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="574" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="328">8. Accept replayed code due to lack of freshness checks</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="449" x2="79" y1="449" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="577">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="428">9. Duplicate tokens issued when re-requested</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="79" y1="497" x1="777"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="777">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="525">10. Token intercepted via an unencrypted channel (proxy)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="545" x2="974" y1="545" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="528">11. Logs generated in plaintext and without validation</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="593" x2="79" y1="593" x1="977"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="977">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="328">12. No certificate pinning vulnerable to MitM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="641" x2="79" y1="641" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="577">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="656" x="428">13. Tokens with excessive lifetime no automatic rotation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="689" x2="79" y1="689" x1="777"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="693" x="777">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="704" x="528">14. Lack of anomaly detection no audit logging</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="737" x2="79" y1="737" x1="977"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="741" x="977">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure OAuth Flow (Secure Implementation)</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1665 843" height="843" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-102" style="width:1665px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="1415"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="1490"><tspan dy="0" x="1490">Resource Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="999"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="1074"><tspan dy="0" x="1074">Token Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="799"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="874"><tspan dy="0" x="874">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="RS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="1490" y1="65" x1="1490" id="actor6056"></line><g id="root-6056"><rect class="actor actor-top" ry="3" rx="3" name="RS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1415"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1490"><tspan dy="0" x="1490">Resource Server</tspan></text></g></g><g><line name="TS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="1074" y1="65" x1="1074" id="actor6055"></line><g id="root-6055"><rect class="actor actor-top" ry="3" rx="3" name="TS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="999"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1074"><tspan dy="0" x="1074">Token Server</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="874" y1="65" x1="874" id="actor6054"></line><g id="root-6054"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="799"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="874"><tspan dy="0" x="874">Auth Server</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="75" y1="65" x1="75" id="actor6053"></line><g id="root-6053"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-102{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-102 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-102 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-102 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-102 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-102 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-102 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-102 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-102 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-102 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-102 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-102 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-102 p{margin:0}#mermaid-6a213c2d99ee9aa5-102 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-102 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-102 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-102 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-102 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-102 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-102 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-102 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-102 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-102 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-102 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-102 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-102 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-102 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-102 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-102 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-102 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-102 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-102 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-102 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-102 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-102 .actor-man circle,#mermaid-6a213c2d99ee9aa5-102 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-102 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="473">1. Initiate authorization request over HTTPS with PKCE challenge\n(includes code_challenge method)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="870" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="476">2. Return authorization code bound to PKCE (with nonce)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="161" x2="79" y1="161" x1="873"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="873">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="573">3. Exchange auth code using PKCE verifier over mTLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="1070" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="576">4. Issue short-lived access token cryptographically bound to PKCE</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="257" x2="79" y1="257" x1="1073"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="1073">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="781">5. Access protected resource using token over mTLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1486" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1284">6. Validate token signature and mTLS certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1078" y1="353" x1="1489"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1489">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="1281">7. Confirm token validity and integrity</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="401" x2="1486" y1="401" x1="1075"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1075">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="784">8. Serve resource upon successful verification</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="449" x2="79" y1="449" x1="1489"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1489">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="473">9. Enforce certificate pinning and continuous TLS validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="870" y1="497" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="476">10. Log access events with audit trails and timestamps</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="79" y1="545" x1="873"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="873">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="576">11. Enforce automated token rotation and short expiry</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="1073"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="1073">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="781">12. Integrate anomaly detection with SIEM for real-time monitoring</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="641" x2="1486" y1="641" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="656" x="784">13. Validate token binding to client identity and mTLS channel</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="689" x2="79" y1="689" x1="1489"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="693" x="1489">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="704" x="573">14. Initiate token refresh flow using PKCE verifier and mTLS re-validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="737" x2="1070" y1="737" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="741" x="76">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure OAuth Implementation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Connection Initiation</strong></td><td dir="ltr">â€¢ Uses HTTP with no encryption<br>â€¢ No PKCE challenge binding<br>â€¢ No nonce/freshness</td><td dir="ltr">â€¢ Enforces HTTPS with certificate pinning<br>â€¢ Uses PKCE challenge (code_challenge method)<br>â€¢ Implements nonce for freshness</td><td dir="ltr">Use TLS/HTTPS, require PKCE, enable nonce usage and certificate pinning to prevent MitM and replay attacks</td></tr><tr><td dir="ltr"><strong>Code Exchange</strong></td><td dir="ltr">â€¢ Auth code exchanged without verifying PKCE<br>â€¢ Long-lived token issued</td><td dir="ltr">â€¢ Auth code exchanged with PKCE verifier<br>â€¢ Token issued short-lived and bound cryptographically (mTLS enforced)</td><td dir="ltr">Bind tokens to PKCE, use mTLS for client-server trust, and enforce token rotation with short expiry</td></tr><tr><td dir="ltr"><strong>Session Establishment</strong></td><td dir="ltr">â€¢ Resources accessed without mTLS<br>â€¢ No token signature verification<br>â€¢ Plaintext logging</td><td dir="ltr">â€¢ Protected resource access over mTLS<br>â€¢ Server validates token signature &amp; mTLS certificate<br>â€¢ Centralized audit &amp; anomaly detection</td><td dir="ltr">Enforce mutual TLS for resource access, verify token integrity, and integrate logging with SIEM for continuous monitoring</td></tr><tr><td dir="ltr"><strong>Additional Security Steps</strong></td><td dir="ltr">â€¢ No replay prevention<br>â€¢ Tokens can be duplicated/intercepted<br>â€¢ No automated audits</td><td dir="ltr">â€¢ Enforces replay prevention (nonce, PKCE binding)<br>â€¢ Automated token refresh and anomaly detection integrated with SIEM</td><td dir="ltr">Integrate replay prevention, short token lifetime, and continuous audit with automated monitoring and analysis</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="JWT Lifecycle Management and Signature Validation" dir="auto" class="heading" id="JWT_Lifecycle_Management_and_Signature_Validation"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>JWT Lifecycle Management and Signature Validation<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy robust JWT mechanismsâ€”create tokens with embedded claims, short expiration, and cryptographic signatures, with regular token reissuance and revocation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Token hijacking, forgery, replay attacks.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-63, JWT Best Practices, automated vulnerability scanning.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Application developers, security analysts, operations teams; end-user sessions across web/mobile apps.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure JWT Lifecycle Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1680 844" height="844" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-108" style="width:1680px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="758" x="1115"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="790.5" x="1190"><tspan dy="0" x="1190">API Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="758" x="915"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="790.5" x="990"><tspan dy="0" x="990">User DB</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="758" x="530"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="790.5" x="605"><tspan dy="0" x="605">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="758" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="790.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="758" x2="1190" y1="65" x1="1190" id="actor6060"></line><g id="root-6060"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1115"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1190"><tspan dy="0" x="1190">API Server</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="758" x2="990" y1="65" x1="990" id="actor6059"></line><g id="root-6059"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="915"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="990"><tspan dy="0" x="990">User DB</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="758" x2="605" y1="65" x1="605" id="actor6058"></line><g id="root-6058"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="530"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="605"><tspan dy="0" x="605">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="758" x2="75" y1="65" x1="75" id="actor6057"></line><g id="root-6057"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-108{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-108 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-108 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-108 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-108 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-108 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-108 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-108 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-108 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-108 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-108 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-108 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-108 p{margin:0}#mermaid-6a213c2d99ee9aa5-108 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-108 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-108 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-108 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-108 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-108 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-108 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-108 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-108 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-108 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-108 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-108 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-108 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-108 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-108 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-108 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-108 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-108 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-108 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-108 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-108 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-108 .actor-man circle,#mermaid-6a213c2d99ee9aa5-108 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-108 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="365" stroke="#666" fill="#EDF2AE" y="603" x="1215"></rect><text style="font-size:16px;font-weight:400" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="1398"><tspan x="1398">No proper revocation list or rotation mechanism</tspan></text></g><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="339">1. Send credentials over plain HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="601" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="796">2. Lookup user account without strong MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="986" y1="161" x1="606"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="606">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="799">3. Return basic credentials &amp; privileges</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="609" y1="209" x1="989"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="989">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="342">4. Issue JWT with weak symmetric key (HS256) and long expiry</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="257" x2="79" y1="257" x1="604"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="604">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="631">5. Present JWT in Authorization header over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1186" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="634">6. Accept token without revalidation of signature algorithm</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="353" x2="79" y1="353" x1="1189"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1189">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="631">7. Replay token in subsequent requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1186" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="634">8. Process token without verifying expiry boundary</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="449" x2="79" y1="449" x1="1189"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1189">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="899">9. Forward token for minimal signature check (using static shared secret)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="609" y1="497" x1="1189"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1189">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="896">10. Return â€œvalidâ€ response even for manipulated tokens</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="1186" y1="545" x1="606"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="606">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="634">11. Continue to accept token despite detected anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="1189"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="1189">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="657" x="631">12. Token reused even after suspected compromise</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="690" x2="1186" y1="690" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="694" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="705" x="634">13. No audit logging or anomaly detection triggered</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="738" x2="79" y1="738" x1="1189"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="742" x="1189">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure JWT Lifecycle Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1775.5 873" height="873" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-110" style="width:1775.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1399"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="1474"><tspan dy="0" x="1474">API Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1199"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="1274"><tspan dy="0" x="1274">User DB</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="701"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="776"><tspan dy="0" x="776">Auth Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="1474" y1="65" x1="1474" id="actor6064"></line><g id="root-6064"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1399"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1474"><tspan dy="0" x="1474">API Server</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="1274" y1="65" x1="1274" id="actor6063"></line><g id="root-6063"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1199"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1274"><tspan dy="0" x="1274">User DB</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="776" y1="65" x1="776" id="actor6062"></line><g id="root-6062"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="701"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="776"><tspan dy="0" x="776">Auth Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="75" y1="65" x1="75" id="actor6061"></line><g id="root-6061"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-110{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-110 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-110 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-110 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-110 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-110 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-110 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-110 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-110 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-110 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-110 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-110 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-110 p{margin:0}#mermaid-6a213c2d99ee9aa5-110 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-110 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-110 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-110 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-110 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-110 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-110 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-110 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-110 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-110 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-110 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-110 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-110 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-110 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-110 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-110 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-110 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-110 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-110 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-110 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-110 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-110 .actor-man circle,#mermaid-6a213c2d99ee9aa5-110 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-110 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="424">1. Send credentials over HTTPS with MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="772" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1024">2. Verify user identity and privileges using multi-factor data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1270" y1="161" x1="777"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="777">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1027">3. Return verified user attributes and claims</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="780" y1="209" x1="1273"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1273">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="427">4. Issue JWT signed with RS256 (asymmetric keys), short expiry, and embedded nonce</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="257" x2="79" y1="257" x1="775"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="775">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="773">5. Present JWT via Authorization header over HTTPS with TLS 1.3</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1470" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1475">6. Validate token structure and check embedded nonce</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1475,353 C 1535,343 1535,383 1475,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1475">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="773">7. Token attached with mutual TLS (mTLS) for client identification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1470" y1="431" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="776">8. Reject any replayed token (using one-time nonce caching)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="79" y1="479" x1="1473"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1473">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1127">9. Forward token for comprehensive signature and expiry check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="780" y1="527" x1="1473"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1473">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1124">10. Confirm token validity by verifying RS256 signature and expiry timestamp</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="1470" y1="575" x1="777"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="777">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="776">11. Notify client of nearing expiry and request token refresh</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="79" y1="623" x1="1473"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="1473">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="424">12. Initiate secure token refresh flow with PKCE verifier over mTLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="772" y1="671" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="427">13. Issue new JWT with updated claims and short expiry</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="719" x2="79" y1="719" x1="775"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="775">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="734" x="776">14. Log transaction and trigger SIEM alerts for anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="767" x2="79" y1="767" x1="1473"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="771" x="1473">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Comparison Per Stage (Insecure vs. Secure)</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Token Issuance</strong></td><td dir="ltr">â€¢ Credentials sent over plain HTTP<br>â€¢ No MFA; weak user checks<br>â€¢ Uses HS256 with static secret<br>â€¢ Long-lived tokens, no nonce</td><td dir="ltr">â€¢ Credentials exchanged over HTTPS with MFA<br>â€¢ User identity verified after multi-factor checks<br>â€¢ Uses RS256 with asymmetric keys<br>â€¢ Short token lifetime with embedded nonce</td><td dir="ltr">Use TLS, enforce MFA and additional identity checks; use asymmetric signing (RS256); enforce short expiry and nonces</td></tr><tr><td dir="ltr"><strong>Token Propagation</strong></td><td dir="ltr">â€¢ Tokens sent in clear text over HTTP<br>â€¢ No replay prevention or binding to TLS<br>â€¢ No mTLS; vulnerable to interception<br>â€¢ No transmission integrity checks</td><td dir="ltr">â€¢ JWT transmitted over HTTPS with TLS 1.3<br>â€¢ mTLS to bind client identity<br>â€¢ Replay prevention using one-time nonce caching<br>â€¢ Integrity guaranteed with secure transport protocols</td><td dir="ltr">Use TLS and mTLS to secure token flow; incorporate nonce-based replay prevention; enforce transmission integrity</td></tr><tr><td dir="ltr"><strong>Token Validation</strong></td><td dir="ltr">â€¢ Minimal signature check using weak static secret<br>â€¢ No thorough expiry verification or claim checking<br>â€¢ Vulnerable to token manipulation</td><td dir="ltr">â€¢ Comprehensive signature verification with RS256<br>â€¢ Checks expiry timestamp and nonce<br>â€¢ Token validated against current claims and client identity</td><td dir="ltr">Validate every claim, signature, and expiry; use strong cryptographic verification; use centralized validation services</td></tr><tr><td dir="ltr"><strong>Revocation/Rotation</strong></td><td dir="ltr">â€¢ No token revocation mechanism<br>â€¢ Tokens reused after compromise<br>â€¢ No audit logging<br>â€¢ No automated rotation</td><td dir="ltr">â€¢ Automated token refresh flow with PKCE verifier<br>â€¢ Revocation &amp; issuance follows secure rotation processes<br>â€¢ Integrated logging with SIEM and audit trails<br>â€¢ Alerts set on anomaly detection</td><td dir="ltr">Implement secure refresh and revocation flows; automate token rotation; integrate logging and alerting mechanisms for rapid anomaly response</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Mutual TLS (mTLS) Client Authentication" dir="auto" class="heading" id="Mutual_TLS_(mTLS)_Client_Authentication"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Mutual TLS (mTLS) Client Authentication<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Require client certificates for API access, perform certificate chain validation, and enforce certificate revocation (OCSP/CRL) during each transaction.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Impersonation, certificate spoofing, rogue client attacks.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-52, PCI-DSS, regular certificate audits.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Certificate authorities, network security admins, API consumers.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure mTLS Client Authentication</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1449 795" height="795" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-116" style="width:1449px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="CA" height="65" width="166" stroke="#666" fill="#eaeaea" y="709" x="1183"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="741.5" x="1266"><tspan dy="0" x="1266">Certificate Authority</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="709" x="603"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="741.5" x="678"><tspan dy="0" x="678">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="709" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="741.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="CA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="709" x2="1266" y1="65" x1="1266" id="actor6067"></line><g id="root-6067"><rect class="actor actor-top" ry="3" rx="3" name="CA" height="65" width="166" stroke="#666" fill="#eaeaea" y="0" x="1183"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1266"><tspan dy="0" x="1266">Certificate Authority</tspan></text></g></g><g><line name="GW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="709" x2="678" y1="65" x1="678" id="actor6066"></line><g id="root-6066"><rect class="actor actor-top" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="603"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="678"><tspan dy="0" x="678">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="709" x2="75" y1="65" x1="75" id="actor6065"></line><g id="root-6065"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-116{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-116 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-116 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-116 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-116 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-116 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-116 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-116 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-116 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-116 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-116 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-116 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-116 p{margin:0}#mermaid-6a213c2d99ee9aa5-116 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-116 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-116 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-116 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-116 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-116 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-116 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-116 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-116 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-116 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-116 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-116 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-116 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-116 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-116 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-116 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-116 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-116 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-116 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-116 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-116 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-116 .actor-man circle,#mermaid-6a213c2d99ee9aa5-116 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-116 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="375">1. Initiate connection over HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="674" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="378">2. Accept connection without verifying client identity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="677"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="677">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="375">3. Present self-signed or expired certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="674" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="971">4. Forward certificate with no OCSP/CRL check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1262" y1="257" x1="679"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="679">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="971">5. Perform minimal (or local) certificate chain check (ignores expiration)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1262" y1="305" x1="679"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="679">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="974">6. Return basic trust result (no revocation check)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="353" x2="682" y1="353" x1="1265"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1265">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="378">7. Complete TLS handshake with weak cipher selection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="79" y1="401" x1="677"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="677">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="375">8. Begin API transaction without binding session to client cert details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="674" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="378">9. Grant access based solely on certificate presence (no algorithm check)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="79" y1="497" x1="677"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="677">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="375">10. Reuse same session credentials across multiple requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="545" x2="674" y1="545" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="378">11. Log connection details in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="677"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="677">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="375">12. Continue sending requests no certificate revalidation is triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="641" x2="674" y1="641" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="656" x="378">13. Accept requests despite warnings (e.g., revoked cert, spoofed issuer)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="689" x2="79" y1="689" x1="677"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="693" x="677">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure mTLS Client Authentication</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1681 843" height="843" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-118" style="width:1681px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="CA" height="65" width="166" stroke="#666" fill="#eaeaea" y="757" x="1415"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="1498"><tspan dy="0" x="1498">Certificate Authority</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="843"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="918"><tspan dy="0" x="918">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="CA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="1498" y1="65" x1="1498" id="actor6070"></line><g id="root-6070"><rect class="actor actor-top" ry="3" rx="3" name="CA" height="65" width="166" stroke="#666" fill="#eaeaea" y="0" x="1415"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1498"><tspan dy="0" x="1498">Certificate Authority</tspan></text></g></g><g><line name="GW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="918" y1="65" x1="918" id="actor6069"></line><g id="root-6069"><rect class="actor actor-top" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="843"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="918"><tspan dy="0" x="918">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="75" y1="65" x1="75" id="actor6068"></line><g id="root-6068"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-118{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-118 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-118 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-118 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-118 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-118 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-118 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-118 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-118 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-118 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-118 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-118 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-118 p{margin:0}#mermaid-6a213c2d99ee9aa5-118 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-118 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-118 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-118 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-118 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-118 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-118 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-118 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-118 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-118 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-118 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-118 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-118 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-118 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-118 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-118 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-118 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-118 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-118 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-118 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-118 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-118 .actor-man circle,#mermaid-6a213c2d99ee9aa5-118 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-118 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="495">1. Initiate connection over HTTPS (TLS 1.3)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="914" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="498">2. Request client certificate via mTLS handshake</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="917">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="495">3. Present valid certificate with current timestamp and nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="914" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="1207">4. Query OCSP/CRL to check certificate status and chain validity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1494" y1="257" x1="919"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="919">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="1210">5. Return full certificate chain with valid revocation status</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="305" x2="922" y1="305" x1="1497"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1497">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="498">6. Negotiate strong ciphers and mutual TLS parameters</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="917">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="498">7. Use certificate pinning and bind session to client certificate details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="79" y1="401" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="917">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="495">8. Begin API transaction using session keys bound to the validated certificate</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="914" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="498">9. Verify token signature and client certificate binding per request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="79" y1="497" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="917">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="495">10. Send subsequent requests over the already established mTLS channel with nonce &amp; timestamp renewal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="545" x2="914" y1="545" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="498">11. Log full transaction details with audit trails (encrypted logs)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="917">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="1207">12. Continuously revalidate certificate status via periodic OCSP checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="641" x2="1494" y1="641" x1="919"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="919">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="656" x="495">13. Initiate re-handshake for session renewal on expiry trigger automated certificate rotation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="689" x2="914" y1="689" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="693" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="704" x="498">14. Confirm session refresh update token and bind new certificate chain verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="737" x2="79" y1="737" x1="917"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="741" x="917">14</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Connection Initiation</strong></td><td dir="ltr">â€¢ Uses plain HTTP (unencrypted)<br>â€¢ Accepts self-signed/expired certificates<br>â€¢ No client certificate validation triggered</td><td dir="ltr">â€¢ Initiates HTTPS (TLS 1.3)<br>â€¢ Demands valid client certificate<br>â€¢ Implements OCSP/CRL check for certificate status</td><td dir="ltr">Use HTTPS/TLS, enforce client certificates, verify certificate chain and revocation status</td></tr><tr><td dir="ltr"><strong>Certificate Validation</strong></td><td dir="ltr">â€¢ Performs minimal chain checking<br>â€¢ Ignores certificate expiration and revocation<br>â€¢ Selects weak ciphers</td><td dir="ltr">â€¢ Completes full certificate chain validation<br>â€¢ Checks expiration, revocation (OCSP/CRL), and uses certificate pinning<br>â€¢ Negotiates strong ciphers in handshake</td><td dir="ltr">Enforce complete chain validation with OCSP/CRL; use strong cipher suites and certificate pinning</td></tr><tr><td dir="ltr"><strong>Session Establishment</strong></td><td dir="ltr">â€¢ Grants access based solely on certificate presence<br>â€¢ No binding of session to certificate details<br>â€¢ Permits token reuse across requests</td><td dir="ltr">â€¢ Binds session to validated certificate details<br>â€¢ Validates each request with certificate binding, nonce, and timestamp<br>â€¢ Uses re-handshake for short session lifetimes</td><td dir="ltr">Bind sessions and tokens to client certificate; enforce non-repudiation and frequent renewal through re-handshake protocols</td></tr><tr><td dir="ltr"><strong>Post-Transaction / Rotation</strong></td><td dir="ltr">â€¢ Logs details in plaintext<br>â€¢ Continues accepting requests despite certificate status<br>â€¢ No automated token/certificate rotation or anomaly detection</td><td dir="ltr">â€¢ Logs transactions with encrypted audit trails<br>â€¢ Periodic re-validation of certificate status<br>â€¢ Initiates session refresh and certificate rotation upon expiry</td><td dir="ltr">Use encrypted, centralized logging; schedule automatic certificate and session renewal; integrate continuous monitoring (SIEM/alerts)</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Dynamic Rate Limiting, Throttling, and DDoS Protection" dir="auto" class="heading" id="Dynamic_Rate_Limiting,_Throttling,_and_DDoS_Protection"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Dynamic Rate Limiting, Throttling, and DDoS Protection<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Integrate dynamic rate limiting and request throttling at the gateway; use behavioral analytics to automatically detect and mitigate DDoS or brute force attacks.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;DDoS, API abuse, application layer attacks.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-61, CIS Controls, load testing and simulated stress tests.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevOps, network security teams, incident response planners; service consumers and partners.</p></div><div class="el-p"><p dir="auto">Insecure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2106.5 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-123" style="width:2106.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Inc" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1856.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1931.5"><tspan dy="0" x="1931.5">Inc</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Sec" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1337.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1412.5"><tspan dy="0" x="1412.5">Sec</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1137.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1212.5"><tspan dy="0" x="1212.5">Load Balancer</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RL" height="65" width="164" stroke="#666" fill="#eaeaea" y="829" x="923.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1005.5"><tspan dy="0" x="1005.5">Rate Limiter (Static)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="536.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="611.5"><tspan dy="0" x="611.5">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SC" height="65" width="153" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="76.5"><tspan dy="0" x="76.5">Service Consumer</tspan></text></g><g><line name="Inc" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1931.5" y1="65" x1="1931.5" id="actor6076"></line><g id="root-6076"><rect class="actor actor-top" ry="3" rx="3" name="Inc" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1856.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1931.5"><tspan dy="0" x="1931.5">Inc</tspan></text></g></g><g><line name="Sec" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1412.5" y1="65" x1="1412.5" id="actor6075"></line><g id="root-6075"><rect class="actor actor-top" ry="3" rx="3" name="Sec" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1337.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1412.5"><tspan dy="0" x="1412.5">Sec</tspan></text></g></g><g><line name="LB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1212.5" y1="65" x1="1212.5" id="actor6074"></line><g id="root-6074"><rect class="actor actor-top" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1137.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1212.5"><tspan dy="0" x="1212.5">Load Balancer</tspan></text></g></g><g><line name="RL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1005.5" y1="65" x1="1005.5" id="actor6073"></line><g id="root-6073"><rect class="actor actor-top" ry="3" rx="3" name="RL" height="65" width="164" stroke="#666" fill="#eaeaea" y="0" x="923.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1005.5"><tspan dy="0" x="1005.5">Rate Limiter (Static)</tspan></text></g></g><g><line name="GW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="611.5" y1="65" x1="611.5" id="actor6072"></line><g id="root-6072"><rect class="actor actor-top" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="536.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="611.5"><tspan dy="0" x="611.5">API Gateway</tspan></text></g></g><g><line name="SC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="76.5" y1="65" x1="76.5" id="actor6071"></line><g id="root-6071"><rect class="actor actor-top" ry="3" rx="3" name="SC" height="65" width="153" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="76.5"><tspan dy="0" x="76.5">Service Consumer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-123{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-123 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-123 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-123 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-123 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-123 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-123 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-123 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-123 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-123 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-123 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-123 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-123 p{margin:0}#mermaid-6a213c2d99ee9aa5-123 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-123 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-123 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-123 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-123 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-123 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-123 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-123 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-123 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-123 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-123 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-123 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-123 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-123 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-123 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-123 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-123 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-123 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-123 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-123 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-123 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-123 .actor-man circle,#mermaid-6a213c2d99ee9aa5-123 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-123 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="343">1. Send API request over HTTP (unencrypted, no auth)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="607.5" y1="113" x1="77.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="77.5">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="613">2. Accept request without source filtering</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 612.5,161 C 672.5,151 672.5,191 612.5,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="612.5">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="807">3. Forward request to static rate limiter</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1001.5" y1="239" x1="612.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="612.5">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="810">4. Return â€œallowâ€ regardless of traffic volume</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="615.5" y1="287" x1="1004.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1004.5">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="911">5. Pass request to load balancer without dynamic controls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="1208.5" y1="335" x1="612.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="612.5">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="914">6. Distribute request without congestion shaping</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="383" x2="615.5" y1="383" x1="1211.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1211.5">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="613">7. Conduct minimal traffic analytics using fixed thresholds</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 612.5,431 C 672.5,421 672.5,461 612.5,451"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="612.5">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="613">8. Fail to dynamically adjust thresholds under increased load</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 612.5,509 C 672.5,499 672.5,539 612.5,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="612.5">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="346">9. Process requests even when volume surges (no auto-throttle)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="80.5" y1="587" x1="610.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="610.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="613">10. Log request details in plaintext (minimal metadata)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 612.5,635 C 672.5,625 672.5,665 612.5,655"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="612.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1011">11. No integration with SIEM delayed or no alerts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1408.5" y1="713" x1="612.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="612.5">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1671">12. Incident response not auto-triggered for anomalous spikes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1927.5" y1="761" x1="1413.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1413.5">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="346">13. Continue accepting abusive requests (no IP blocking)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="80.5" y1="809" x1="610.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="610.5">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2621.5 903" height="903" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-125" style="width:2621.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="2371.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="2446.5"><tspan dy="0" x="2446.5">SIEM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Inc" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="2171.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="2246.5"><tspan dy="0" x="2246.5">Inc</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Sec" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1597.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1672.5"><tspan dy="0" x="1672.5">Sec</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1397.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1472.5"><tspan dy="0" x="1472.5">Load Balancer</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RLD" height="65" width="174" stroke="#666" fill="#eaeaea" y="817" x="1173.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1260.5"><tspan dy="0" x="1260.5">Dynamic Rate Limiter</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="606.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="681.5"><tspan dy="0" x="681.5">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SC" height="65" width="153" stroke="#666" fill="#eaeaea" y="817" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="76.5"><tspan dy="0" x="76.5">Service Consumer</tspan></text></g><g><line name="SIEM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="2446.5" y1="65" x1="2446.5" id="actor6083"></line><g id="root-6083"><rect class="actor actor-top" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="2371.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2446.5"><tspan dy="0" x="2446.5">SIEM</tspan></text></g></g><g><line name="Inc" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="2246.5" y1="65" x1="2246.5" id="actor6082"></line><g id="root-6082"><rect class="actor actor-top" ry="3" rx="3" name="Inc" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="2171.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2246.5"><tspan dy="0" x="2246.5">Inc</tspan></text></g></g><g><line name="Sec" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1672.5" y1="65" x1="1672.5" id="actor6081"></line><g id="root-6081"><rect class="actor actor-top" ry="3" rx="3" name="Sec" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1597.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1672.5"><tspan dy="0" x="1672.5">Sec</tspan></text></g></g><g><line name="LB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1472.5" y1="65" x1="1472.5" id="actor6080"></line><g id="root-6080"><rect class="actor actor-top" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1397.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1472.5"><tspan dy="0" x="1472.5">Load Balancer</tspan></text></g></g><g><line name="RLD" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1260.5" y1="65" x1="1260.5" id="actor6079"></line><g id="root-6079"><rect class="actor actor-top" ry="3" rx="3" name="RLD" height="65" width="174" stroke="#666" fill="#eaeaea" y="0" x="1173.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1260.5"><tspan dy="0" x="1260.5">Dynamic Rate Limiter</tspan></text></g></g><g><line name="GW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="681.5" y1="65" x1="681.5" id="actor6078"></line><g id="root-6078"><rect class="actor actor-top" ry="3" rx="3" name="GW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="606.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="681.5"><tspan dy="0" x="681.5">API Gateway</tspan></text></g></g><g><line name="SC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="76.5" y1="65" x1="76.5" id="actor6077"></line><g id="root-6077"><rect class="actor actor-top" ry="3" rx="3" name="SC" height="65" width="153" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="76.5"><tspan dy="0" x="76.5">Service Consumer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-125{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-125 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-125 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-125 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-125 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-125 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-125 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-125 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-125 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-125 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-125 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-125 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-125 p{margin:0}#mermaid-6a213c2d99ee9aa5-125 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-125 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-125 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-125 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-125 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-125 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-125 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-125 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-125 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-125 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-125 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-125 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-125 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-125 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-125 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-125 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-125 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-125 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-125 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-125 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-125 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-125 .actor-man circle,#mermaid-6a213c2d99ee9aa5-125 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-125 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="378">1. Initiate API request over HTTPS with valid credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="677.5" y1="113" x1="77.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="77.5">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="683">2. Validate source IP and authenticate request</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 682.5,161 C 742.5,151 742.5,191 682.5,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="682.5">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="970">3. Forward pre-filtered request to dynamic rate limiter</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1256.5" y1="239" x1="682.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="682.5">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="973">4. Evaluate traffic and apply adaptive threshold based on client history</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="685.5" y1="287" x1="1259.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1259.5">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="1076">5. Forward requests with adaptive throttle signals</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="1468.5" y1="335" x1="682.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="682.5">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="1079">6. Distribute requests evenly using congestion control</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="685.5" y1="383" x1="1471.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1471.5">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="683">7. Perform real-time behavioral analysis with AI-based analytics</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 682.5,431 C 742.5,421 742.5,461 682.5,451"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="682.5">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1176">8. Auto-detect surges trigger anomaly detection and block malicious IPs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1668.5" y1="509" x1="682.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="682.5">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1958">9. Instantly activate incident response workflows via SOAR integration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="2242.5" y1="557" x1="1673.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1673.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1563">10. Log detailed, encrypted transaction data with full metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="2442.5" y1="605" x1="682.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="682.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="2061">11. Generate immediate alerts and automated incident reports</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1676.5" y1="653" x1="2445.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="2445.5">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="381">12. Respond with HTTP 429/503 status for throttled requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="80.5" y1="701" x1="680.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="680.5">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="381">13. Continuously update rate limiting policies based on live traffic patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="80.5" y1="749" x1="680.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="680.5">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="764" x="381">14. Enforce dynamic throttling and auto-block abusive behaviors</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="797" x2="80.5" y1="797" x1="680.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="801" x="680.5">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Rate Limiting &amp; DDoS Mitigation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Request Ingress</strong></td><td dir="ltr">â€¢ Requests sent over HTTP without authentication<br>â€¢ No source filtering or validation</td><td dir="ltr">â€¢ Requests sent over HTTPS with valid credentials<br>â€¢ Initial filtering based on IP and authentication</td><td dir="ltr">Always use TLS; validate source identity and enforce authentication</td></tr><tr><td dir="ltr"><strong>2. Throttling</strong></td><td dir="ltr">â€¢ Static rate limiter returns â€œallowâ€ regardless of volume<br>â€¢ Load balancer distributes traffic without shaping</td><td dir="ltr">â€¢ Dynamic rate limiter applies adaptive thresholds based on client reputation<br>â€¢ Load balancer enforces congestion control</td><td dir="ltr">Use dynamic rate limiting and adaptive traffic shaping algorithms</td></tr><tr><td dir="ltr"><strong>3. DDoS Detection</strong></td><td dir="ltr">â€¢ Minimal traffic analytics using fixed thresholds<br>â€¢ No auto-adjustment under surges</td><td dir="ltr">â€¢ Real-time behavioral analytics with AI detect anomalies<br>â€¢ Automatic blocking of abusive IPs and activation of SOAR response</td><td dir="ltr">Integrate AI-based detection and auto-mitigation with continuous monitoring</td></tr><tr><td dir="ltr"><strong>4. Logging &amp; Incident</strong></td><td dir="ltr">â€¢ Minimal plaintext logging; delayed or no alerts<br>â€¢ No automated incident response</td><td dir="ltr">â€¢ Detailed encrypted logging with SIEM integration<br>â€¢ Immediate alerts and automated incident response for abnormal patterns</td><td dir="ltr">Use centralized, encrypted logging; ensure real-time alerts and automated incident response mechanisms</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Strict Input Validation and Output Encoding" dir="auto" class="heading" id="Strict_Input_Validation_and_Output_Encoding"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Strict Input Validation and Output Encoding<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Apply multi-stage sanitization on every API request using whitelisting, schema validation, and context-sensitive output encoding to prevent injection and XSS.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;SQL injection, XSS, XML entity expansion attacks.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;OWASP Top 10, SANS Institute guidelines, automated static and dynamic analysis.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Developers, QA/security testers, penetration testers; application users.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1957 975" height="975" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-131" style="width:1957px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="889" x="1584"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="921.5" x="1659"><tspan dy="0" x="1659">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BL" height="65" width="150" stroke="#666" fill="#eaeaea" y="889" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="921.5" x="1276"><tspan dy="0" x="1276">Business Logic</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="889" x="596"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="921.5" x="671"><tspan dy="0" x="671">API Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Cl" height="65" width="150" stroke="#666" fill="#eaeaea" y="889" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="921.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="889" x2="1659" y1="65" x1="1659" id="actor6087"></line><g id="root-6087"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1584"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1659"><tspan dy="0" x="1659">Logger</tspan></text></g></g><g><line name="BL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="889" x2="1276" y1="65" x1="1276" id="actor6086"></line><g id="root-6086"><rect class="actor actor-top" ry="3" rx="3" name="BL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1276"><tspan dy="0" x="1276">Business Logic</tspan></text></g></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="889" x2="671" y1="65" x1="671" id="actor6085"></line><g id="root-6085"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="596"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="671"><tspan dy="0" x="671">API Server</tspan></text></g></g><g><line name="Cl" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="889" x2="75" y1="65" x1="75" id="actor6084"></line><g id="root-6084"><rect class="actor actor-top" ry="3" rx="3" name="Cl" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-131{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-131 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-131 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-131 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-131 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-131 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-131 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-131 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-131 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-131 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-131 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-131 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-131 p{margin:0}#mermaid-6a213c2d99ee9aa5-131 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-131 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-131 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-131 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-131 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-131 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-131 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-131 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-131 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-131 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-131 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-131 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-131 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-131 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-131 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-131 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-131 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-131 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-131 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-131 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-131 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-131 .actor-man circle,#mermaid-6a213c2d99ee9aa5-131 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-131 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="372">1. Send API request (malicious payload for SQL injection/XSS) over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="667" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="672">2. Accept request without HTTPS or source validation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 672,161 C 732,151 732,191 672,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="672">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="972">3. Pass raw input (unsanitized) to business logic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1272" y1="239" x1="672"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="672">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1277">4. Proceed without initial checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,287 C 1337,277 1337,317 1277,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1277">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1277">5. Execute business logic using unsanitized input (no whitelist, no schema check)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,365 C 1337,355 1337,395 1277,385"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1277">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="1277">6. Directly incorporate input into SQL queries or HTML template</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,443 C 1337,433 1337,473 1277,463"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="447" x="1277">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="488" x="1466">7. Prepare audit log with raw unfiltered data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="521" x2="1655" y1="521" x1="1277"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="525" x="1277">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="536" x="1277">8. Generate output without applying context-sensitive encoding</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,569 C 1337,559 1337,599 1277,589"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="573" x="1277">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="614" x="975">9. Return output containing raw user payload (vulnerable to XSS/injection)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="647" x2="675" y1="647" x1="1275"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="651" x="1275">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="662" x="375">10. Transmit response over HTTP (no encryption)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="695" x2="79" y1="695" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="699" x="670">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="710" x="1660">11. Log details in plaintext (includes malicious payload)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1660,743 C 1720,733 1720,773 1660,763"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="747" x="1660">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="788" x="1164">12. No error handling unexpected input triggers unmonitored errors</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="821" x2="1655" y1="821" x1="672"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="825" x="672">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="836" x="869">13. No real-time alert or remediation attackerâ€™s payload remains effective</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="869" x2="79" y1="869" x1="1658"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="873" x="1658">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2635 993" height="993" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-133" style="width:2635px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="2167.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="2242.5"><tspan dy="0" x="2242.5">Logger/Security</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="OE" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="1840"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1915"><tspan dy="0" x="1915">Output Encoder</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BL" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="1346"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1421"><tspan dy="0" x="1421">Business Logic</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IV" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="989"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1064"><tspan dy="0" x="1064">Input Validator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="596"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="671"><tspan dy="0" x="671">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Cl" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="2242.5" y1="65" x1="2242.5" id="actor6093"></line><g id="root-6093"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="2167.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2242.5"><tspan dy="0" x="2242.5">Logger/Security</tspan></text></g></g><g><line name="OE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1915" y1="65" x1="1915" id="actor6092"></line><g id="root-6092"><rect class="actor actor-top" ry="3" rx="3" name="OE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1840"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1915"><tspan dy="0" x="1915">Output Encoder</tspan></text></g></g><g><line name="BL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1421" y1="65" x1="1421" id="actor6091"></line><g id="root-6091"><rect class="actor actor-top" ry="3" rx="3" name="BL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1346"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1421"><tspan dy="0" x="1421">Business Logic</tspan></text></g></g><g><line name="IV" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1064" y1="65" x1="1064" id="actor6090"></line><g id="root-6090"><rect class="actor actor-top" ry="3" rx="3" name="IV" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="989"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1064"><tspan dy="0" x="1064">Input Validator</tspan></text></g></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="671" y1="65" x1="671" id="actor6089"></line><g id="root-6089"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="596"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="671"><tspan dy="0" x="671">API Gateway</tspan></text></g></g><g><line name="Cl" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="75" y1="65" x1="75" id="actor6088"></line><g id="root-6088"><rect class="actor actor-top" ry="3" rx="3" name="Cl" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-133{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-133 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-133 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-133 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-133 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-133 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-133 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-133 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-133 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-133 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-133 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-133 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-133 p{margin:0}#mermaid-6a213c2d99ee9aa5-133 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-133 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-133 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-133 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-133 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-133 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-133 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-133 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-133 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-133 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-133 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-133 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-133 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-133 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-133 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-133 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-133 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-133 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-133 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-133 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-133 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-133 .actor-man circle,#mermaid-6a213c2d99ee9aa5-133 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-133 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="372">1. Send API request over HTTPS with proper credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="667" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="672">2. Verify TLS connection and client identity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 672,161 C 732,151 732,191 672,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="672">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="866">3. Forward request payload to input validator</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1060" y1="239" x1="672"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="672">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1065">4. Apply whitelisted rules and schema validation (reject on mismatch)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1065,287 C 1125,277 1125,317 1065,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1065">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1241">5. Pass sanitized input to business logic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1417" y1="365" x1="1065"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1065">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1422">6. Process input using secure coding practices (parameterized queries)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1422,413 C 1482,403 1482,443 1422,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1422">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1830">7. Record a hash/log of validated input (without sensitive/plaintext data)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="2238.5" y1="491" x1="1422"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1422">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1667">8. Prepare raw output data then forward to output encoder</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1911" y1="539" x1="1422"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1422">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1916">9. Apply context-specific encoding (HTML, URL, etc.) to all dynamic fields</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1916,587 C 1976,577 1976,617 1916,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1916">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1670">10. Return safely encoded response to business logic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="1425" y1="665" x1="1914"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1914">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1048">11. API receives secured response triggers integrity checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="675" y1="713" x1="1420"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="1420">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="375">12. Send response over HTTPS with proper session and security headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="670">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="2244">13. Log transaction details securely (encrypted logs, anomaly detection enabled)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 2243.5,809 C 2303.5,799 2303.5,839 2243.5,829"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="2243.5">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="1458">14. Trigger real-time alerts for any suspicious input or output anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="887" x2="675" y1="887" x1="2241.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="2241.5">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Request Ingress</strong></td><td dir="ltr">â€¢ Requests sent over HTTP<br>â€¢ No client authentication or TLS<br>â€¢ Raw payload forwarded with no source filtering</td><td dir="ltr">â€¢ Requests sent over HTTPS with valid credentials<br>â€¢ API gateway verifies client identity and TLS<br>â€¢ Initial filtering via an input validator</td><td dir="ltr">Always use HTTPS and TLS; authenticate client; perform source filtering and validate incoming requests using whitelisted rules</td></tr><tr><td dir="ltr"><strong>2. Input Handling</strong></td><td dir="ltr">â€¢ No proper input validation<br>â€¢ Data used directly in queries/templates<br>â€¢ No schema or whitelist applied</td><td dir="ltr">â€¢ Input validator enforces strict schema validation and whitelist rules<br>â€¢ Sanitization performed using secure coding best practices (parameterized queries)</td><td dir="ltr">Apply rigorous input validation; use libraries that enforce schema; never use raw input in dynamic content</td></tr><tr><td dir="ltr"><strong>3. Output Generation</strong></td><td dir="ltr">â€¢ No output encoding<br>â€¢ Dynamic content is directly rendered<br>â€¢ Vulnerable to XSS and injection attacks</td><td dir="ltr">â€¢ Output encoder applies context-sensitive encoding (HTML, URL, etc.) on all dynamic content<br>â€¢ Business logic receives pre-filtered content and returns safe results</td><td dir="ltr">Use context-aware output encoding; employ established libraries (e.g., OWASP ESAPI) to prevent injection and XSS attacks</td></tr><tr><td dir="ltr"><strong>4. Response &amp; Logging</strong></td><td dir="ltr">â€¢ Response transmitted in plaintext<br>â€¢ Logging in plaintext, includes malicious payload<br>â€¢ No real-time alerts or incident detection</td><td dir="ltr">â€¢ Response sent securely over HTTPS with correct headers<br>â€¢ Secure, encrypted logging with SIEM integration â€“ anomalies trigger real-time alerts<br>â€¢ Comprehensive audit trails maintained</td><td dir="ltr">Encrypt logs and responses; integrate logging with SIEM and automated alerting; ensure robust monitoring and incident response procedures</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Dynamic API Gateway with Integrated WAF" dir="auto" class="heading" id="Dynamic_API_Gateway_with_Integrated_WAF"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Dynamic API Gateway with Integrated WAF<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Utilize an API gateway that integrates a Web Application Firewall (WAF) for real-time traffic inspection, anomaly detection, and responsive policy enforcement.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;OWASP Top 10 vulnerabilities, API-specific exploits, botnet attacks.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;OWASP API Security Top 10, NIST SP 800-95, continuous security monitoring.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;API gateway administrators, network security, security operations center (SOC); internal and external user access.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1737.5 993" height="993" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-139" style="width:1737.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="SOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="1487.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1562.5"><tspan dy="0" x="1562.5">SOC</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BE" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="1251.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1326.5"><tspan dy="0" x="1326.5">Backend</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="WF" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="940"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="1015"><tspan dy="0" x="1015">WAF</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="505"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="580"><tspan dy="0" x="580">API_Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="EU" height="65" width="150" stroke="#666" fill="#eaeaea" y="907" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="939.5" x="75"><tspan dy="0" x="75">EndUser</tspan></text></g><g><line name="SOC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1562.5" y1="65" x1="1562.5" id="actor6098"></line><g id="root-6098"><rect class="actor actor-top" ry="3" rx="3" name="SOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1487.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1562.5"><tspan dy="0" x="1562.5">SOC</tspan></text></g></g><g><line name="BE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1326.5" y1="65" x1="1326.5" id="actor6097"></line><g id="root-6097"><rect class="actor actor-top" ry="3" rx="3" name="BE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1251.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1326.5"><tspan dy="0" x="1326.5">Backend</tspan></text></g></g><g><line name="WF" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="1015" y1="65" x1="1015" id="actor6096"></line><g id="root-6096"><rect class="actor actor-top" ry="3" rx="3" name="WF" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="940"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1015"><tspan dy="0" x="1015">WAF</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="580" y1="65" x1="580" id="actor6095"></line><g id="root-6095"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="505"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="580"><tspan dy="0" x="580">API_Gateway</tspan></text></g></g><g><line name="EU" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="907" x2="75" y1="65" x1="75" id="actor6094"></line><g id="root-6094"><rect class="actor actor-top" ry="3" rx="3" name="EU" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">EndUser</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-139{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-139 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-139 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-139 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-139 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-139 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-139 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-139 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-139 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-139 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-139 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-139 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-139 p{margin:0}#mermaid-6a213c2d99ee9aa5-139 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-139 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-139 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-139 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-139 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-139 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-139 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-139 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-139 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-139 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-139 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-139 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-139 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-139 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-139 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-139 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-139 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-139 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-139 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-139 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-139 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-139 .actor-man circle,#mermaid-6a213c2d99ee9aa5-139 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-139 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="326">1. Send API request over HTTP (unencrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="576" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="581">2. Accept request without verifying source or rate limiting</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 581,161 C 641,151 641,191 581,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="581">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="796">3. Forward raw request no authentication enforced</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1011" y1="239" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="581">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1016">4. Bypass payload inspection due to misconfigured rules</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1016,287 C 1076,277 1076,317 1016,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1016">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="796">5. Do not apply IP filtering or rate throttling</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1011" y1="365" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="581">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1016">6. Use default WAF rules that do not cover OWASP Top 10 adequately</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1016,413 C 1076,403 1076,443 1016,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1016">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="799">7. Allow all traffic without anomaly checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="584" y1="491" x1="1014"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1014">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="952">8. Forward malicious payload (e.g. SQL/XSS code) unmodified</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1322.5" y1="539" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="581">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1328">9. Process request using unsanitized parameters</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1327.5,587 C 1387.5,577 1387.5,617 1327.5,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1327.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="955">10. Generate normal response (data leak risk)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="584" y1="665" x1="1325.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1325.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="329">11. Return response over HTTP without encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="79" y1="713" x1="579"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="579">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="581">12. Log minimal plaintext details (insufficient metadata)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 581,761 C 641,751 641,791 581,781"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="581">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="1070">13. No alerts generated anomalous patterns are not detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="839" x2="1558.5" y1="839" x1="581"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="581">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="854" x="326">14. Subsequent abusive requests are continuously accepted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="887" x2="576" y1="887" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="891" x="76">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2760.5 1011" height="1011" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-141" style="width:2760.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="SOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="2510.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="2585.5"><tspan dy="0" x="2585.5">SOC</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="1854.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="1929.5"><tspan dy="0" x="1929.5">SIEM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="BE" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="1572.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="1647.5"><tspan dy="0" x="1647.5">Backend</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="WF" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="1276"><tspan dy="0" x="1276">WAF</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="594"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="669"><tspan dy="0" x="669">API_Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="EU" height="65" width="150" stroke="#666" fill="#eaeaea" y="925" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="957.5" x="75"><tspan dy="0" x="75">EndUser</tspan></text></g><g><line name="SOC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="2585.5" y1="65" x1="2585.5" id="actor6104"></line><g id="root-6104"><rect class="actor actor-top" ry="3" rx="3" name="SOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="2510.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2585.5"><tspan dy="0" x="2585.5">SOC</tspan></text></g></g><g><line name="SIEM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="1929.5" y1="65" x1="1929.5" id="actor6103"></line><g id="root-6103"><rect class="actor actor-top" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1854.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1929.5"><tspan dy="0" x="1929.5">SIEM</tspan></text></g></g><g><line name="BE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="1647.5" y1="65" x1="1647.5" id="actor6102"></line><g id="root-6102"><rect class="actor actor-top" ry="3" rx="3" name="BE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1572.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1647.5"><tspan dy="0" x="1647.5">Backend</tspan></text></g></g><g><line name="WF" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="1276" y1="65" x1="1276" id="actor6101"></line><g id="root-6101"><rect class="actor actor-top" ry="3" rx="3" name="WF" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1276"><tspan dy="0" x="1276">WAF</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="669" y1="65" x1="669" id="actor6100"></line><g id="root-6100"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="594"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="669"><tspan dy="0" x="669">API_Gateway</tspan></text></g></g><g><line name="EU" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="925" x2="75" y1="65" x1="75" id="actor6099"></line><g id="root-6099"><rect class="actor actor-top" ry="3" rx="3" name="EU" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">EndUser</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-141{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-141 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-141 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-141 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-141 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-141 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-141 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-141 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-141 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-141 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-141 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-141 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-141 p{margin:0}#mermaid-6a213c2d99ee9aa5-141 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-141 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-141 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-141 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-141 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-141 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-141 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-141 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-141 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-141 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-141 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-141 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-141 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-141 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-141 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-141 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-141 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-141 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-141 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-141 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-141 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-141 .actor-man circle,#mermaid-6a213c2d99ee9aa5-141 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-141 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="371">1. Send API request over HTTPS with valid client certificates</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="665" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="670">2. Enforce TLS, authenticate client, and apply source IP filtering</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 670,161 C 730,151 730,191 670,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="670">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="971">3. Forward request with validated headers and rate limiting metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1272" y1="239" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="670">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1277">4. Inspect payload using updated, context-specific rules (OWASP API Security Top 10)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,287 C 1337,277 1337,317 1277,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1277">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="971">5. Apply dynamic rate limiting and IP reputation checks before inspection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1272" y1="365" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="670">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1277">6. Detect malformed input or injection attempts using anomaly thresholds</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1277,413 C 1337,403 1337,443 1277,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1277">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="974">7. Identify malicious payload (e.g. SQL injection, botnet behavior)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="673" y1="491" x1="1275"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1275">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1157">8. Block malicious payloads forward only sanitized and validated requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1643.5" y1="539" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="670">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1649">9. Process only whitelisted input using parameterized queries</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1648.5,587 C 1708.5,577 1708.5,617 1648.5,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1648.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1160">10. Generate response after processing sanitized inputs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="673" y1="665" x1="1646.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1646.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="374">11. Return response over HTTPS with secure headers (HSTS, CSP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="79" y1="713" x1="668"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="668">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1298">12. Log detailed, encrypted transaction data with full metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1925.5" y1="761" x1="670"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="670">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="2256">13. Generate immediate alerts trigger automated mitigation (e.g., HTTP 429/503)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="2581.5" y1="809" x1="1930.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1930.5">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="374">14. Initiate dynamic policy updates based on real-time threat intelligence</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="79" y1="857" x1="668"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="668">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="872" x="974">15. Continuously update WAF rules from feedback loop (adaptive learning)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="905" x2="673" y1="905" x1="1275"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="909" x="1275">15</text></svg></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Session Management and Cookie Hardening" dir="auto" class="heading" id="Secure_Session_Management_and_Cookie_Hardening"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Session Management and Cookie Hardening<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement secure session management via HttpOnly, Secure, and SameSite cookies; enforce session timeouts and periodic session ID regeneration upon privilege elevation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Session hijacking, cookie theft, fixation.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;OWASP Session Management Cheat Sheet, NIST guidelines, periodic session management audits.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Web developers, application security teams; browser-based users and mobile app sessions.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure Session Management and Cookie Handling</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1736.5 873" height="873" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-145" style="width:1736.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1355"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="1430"><tspan dy="0" x="1430">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1155"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="1230"><tspan dy="0" x="1230">Session Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="602"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="677"><tspan dy="0" x="677">App Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="B" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="75"><tspan dy="0" x="75">Browser</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="1430" y1="65" x1="1430" id="actor6108"></line><g id="root-6108"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1355"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1430"><tspan dy="0" x="1430">Logger</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="1230" y1="65" x1="1230" id="actor6107"></line><g id="root-6107"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1155"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1230"><tspan dy="0" x="1230">Session Manager</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="677" y1="65" x1="677" id="actor6106"></line><g id="root-6106"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="602"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="677"><tspan dy="0" x="677">App Server</tspan></text></g></g><g><line name="B" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="75" y1="65" x1="75" id="actor6105"></line><g id="root-6105"><rect class="actor actor-top" ry="3" rx="3" name="B" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Browser</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-145{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-145 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-145 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-145 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-145 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-145 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-145 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-145 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-145 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-145 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-145 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-145 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-145 p{margin:0}#mermaid-6a213c2d99ee9aa5-145 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-145 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-145 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-145 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-145 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-145 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-145 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-145 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-145 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-145 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-145 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-145 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-145 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-145 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-145 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-145 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-145 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-145 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-145 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-145 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-145 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-145 .actor-man circle,#mermaid-6a213c2d99ee9aa5-145 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-145 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="375">1. Login via HTTP form (credentials sent in plaintext)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="673" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="952">2. Create session with default/random session ID (no regeneration)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1226" y1="161" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="678">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="955">3. Return session ID in cookie with no proper attributes</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="681" y1="209" x1="1229"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1229">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="378">4. Set cookie without HttpOnly, Secure, or SameSite flag</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="676">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="375">5. Send cookie on subsequent HTTP requests (vulnerable to interception)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="673" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="952">6. Lookup session using received session ID</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1226" y1="353" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="678">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="955">7. Validate session with no expiration check or renewal logic</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="401" x2="681" y1="401" x1="1229"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1229">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="375">8. User performs privilege elevation (e.g., admin page)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="673" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="952">9. Continue to use same static session ID (no reissuance)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1226" y1="497" x1="678"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="678">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="955">10. Session remains unchanged attacker can hijack reused cookie</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="681" y1="545" x1="1229"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1229">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="378">11. User ends session or times out cookie not invalidated on server</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="676">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="1431">12. Log simple session data in plaintext (missing context)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1431,641 C 1491,631 1491,671 1431,661"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="1431">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="378">13. Subsequent requests from stolen cookie accepted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="676">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="734" x="375">14. No proper logout mechanism session remains active beyond timeout</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="767" x2="673" y1="767" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="771" x="76">14</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure Session Management and Cookie Hardening</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2112 921" height="921" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-147" style="width:2112px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="835" x="1658"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="867.5" x="1733"><tspan dy="0" x="1733">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="835" x="1458"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="867.5" x="1533"><tspan dy="0" x="1533">Session Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="835" x="687"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="867.5" x="762"><tspan dy="0" x="762">App Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="B" height="65" width="150" stroke="#666" fill="#eaeaea" y="835" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="867.5" x="75"><tspan dy="0" x="75">Browser</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="835" x2="1733" y1="65" x1="1733" id="actor6112"></line><g id="root-6112"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1658"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1733"><tspan dy="0" x="1733">Logger</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="835" x2="1533" y1="65" x1="1533" id="actor6111"></line><g id="root-6111"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1458"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1533"><tspan dy="0" x="1533">Session Manager</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="835" x2="762" y1="65" x1="762" id="actor6110"></line><g id="root-6110"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="687"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="762"><tspan dy="0" x="762">App Server</tspan></text></g></g><g><line name="B" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="835" x2="75" y1="65" x1="75" id="actor6109"></line><g id="root-6109"><rect class="actor actor-top" ry="3" rx="3" name="B" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Browser</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-147{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-147 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-147 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-147 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-147 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-147 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-147 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-147 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-147 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-147 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-147 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-147 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-147 p{margin:0}#mermaid-6a213c2d99ee9aa5-147 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-147 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-147 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-147 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-147 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-147 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-147 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-147 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-147 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-147 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-147 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-147 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-147 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-147 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-147 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-147 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-147 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-147 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-147 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-147 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-147 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-147 .actor-man circle,#mermaid-6a213c2d99ee9aa5-147 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-147 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="417">1. Login via HTTPS form with multi-factor authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="758" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1146">2. Create session with cryptographically strong, unique session ID</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1529" y1="161" x1="763"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="763">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1149">3. Set session expiration and store client fingerprint</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="766" y1="209" x1="1532"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1532">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="420">4. Return session ID in a cookie with Secure, HttpOnly, and SameSite=strict attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="761">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="417">5. Send cookie in HTTPS requests (TLS enforced)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="758" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1146">6. Validate session using session ID, client fingerprint, and expiry check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1529" y1="353" x1="763"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="763">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="1149">7. Confirm active session and return user context</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="401" x2="766" y1="401" x1="1532"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1532">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="417">8. User requests privilege elevation (admin action)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="758" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1146">9. Trigger regeneration of session ID (invalidate old cookie)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1529" y1="497" x1="763"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="763">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1149">10. Issue new session ID and update session parameters set new cookie with hardened attributes</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="766" y1="545" x1="1532"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1532">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="420">11. Return updated session cookie via HTTPS with reissued session token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="79" y1="593" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="761">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="420">12. User performs logout or session times out server invalidates session ID</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="641" x2="79" y1="641" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="761">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="656" x="1149">13. Purge session data and mark token as revoked</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="689" x2="766" y1="689" x1="1532"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="693" x="1532">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="704" x="1734">14. Securely log detailed session metadata (encrypted logs) and audit events</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1734,737 C 1794,727 1794,767 1734,757"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="741" x="1734">14</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="782" x="420">15. Notify client via secure channel that session is terminated and cookie removed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="815" x2="79" y1="815" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="819" x="761">15</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure Implementation per Stage</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Session Establishment</strong></td><td dir="ltr">â€¢ Login via HTTP (plaintext credentials)<br>â€¢ Session created with default/random ID<br>â€¢ Cookie set without attributes</td><td dir="ltr">â€¢ Login via HTTPS with MFA<br>â€¢ Strong, unique session ID with expiration and client fingerprint<br>â€¢ Cookie set with Secure, HttpOnly, SameSite=strict</td><td dir="ltr">Always use HTTPS/TLS with multi-factor verification; generate cryptographically strong session IDs; set cookies with proper security attributes</td></tr><tr><td dir="ltr"><strong>2. Cookie Transmission</strong></td><td dir="ltr">â€¢ Cookies transmitted over HTTP<br>â€¢ No revalidation of session lifetime or client signature<br>â€¢ Vulnerable to interception</td><td dir="ltr">â€¢ Cookies sent over HTTPS<br>â€¢ Session validated for expiry and client fingerprint on each request<br>â€¢ Strict cookie validation</td><td dir="ltr">Use TLS exclusively; validate session parameters and enforce expiry at every request to prevent replay or theft</td></tr><tr><td dir="ltr"><strong>3. Privilege Elevation</strong></td><td dir="ltr">â€¢ Privilege elevation reuses the same static session ID<br>â€¢ No regeneration after escalation<br>â€¢ High risk if cookie is hijacked</td><td dir="ltr">â€¢ Triggers session regeneration with new ID upon privilege elevation<br>â€¢ Old session invalidated immediately<br>â€¢ Updated cookie hardening</td><td dir="ltr">Regenerate session after privilege elevation to prevent fixation; immediately invalidate old tokens and bind new tokens with hardened attributes</td></tr><tr><td dir="ltr"><strong>4. Termination &amp; Logging</strong></td><td dir="ltr">â€¢ Sessions not clearly terminated on logout<br>â€¢ Logging done in plaintext with insufficient context<br>â€¢ Revoked cookies accepted</td><td dir="ltr">â€¢ Session termination explicitly invalidates tokens<br>â€¢ Detailed, encrypted audit logs<br>â€¢ Client notification on logout and cookie removal</td><td dir="ltr">Implement a full session termination process with server-side invalidation; log all session events securely; integrate automated alerts to detect anomalous session behavior</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Granular API Versioning and Secure Deprecation" dir="auto" class="heading" id="Granular_API_Versioning_and_Secure_Deprecation"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Granular API Versioning and Secure Deprecation<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Develop a multi-stage API lifecycle strategy enabling secure API versioning; enforce deprecation timelines with clear security baselines for legacy endpoints.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Exploitation of legacy endpoints, unpatched vulnerabilities.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;API versioning best practices, OWASP API Security guidelines, vulnerability management.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Product managers, API architects, engineering leads; external API developers, internal app teams.</p></div><div class="el-p"><p dir="auto">Diagram A â€“ Insecure API Versioning and Deprecation Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2006 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-153" style="width:2006px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="AAAdm" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1756"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1831"><tspan dy="0" x="1831">API Admin</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1181"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1256"><tspan dy="0" x="1256">API Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="643"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="718"><tspan dy="0" x="718">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="AAAdm" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1831" y1="65" x1="1831" id="actor6116"></line><g id="root-6116"><rect class="actor actor-top" ry="3" rx="3" name="AAAdm" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1756"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1831"><tspan dy="0" x="1831">API Admin</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1256" y1="65" x1="1256" id="actor6115"></line><g id="root-6115"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1181"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1256"><tspan dy="0" x="1256">API Application</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="718" y1="65" x1="718" id="actor6114"></line><g id="root-6114"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="643"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="718"><tspan dy="0" x="718">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6113"></line><g id="root-6113"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-153{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-153 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-153 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-153 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-153 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-153 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-153 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-153 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-153 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-153 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-153 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-153 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-153 p{margin:0}#mermaid-6a213c2d99ee9aa5-153 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-153 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-153 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-153 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-153 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-153 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-153 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-153 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-153 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-153 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-153 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-153 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-153 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-153 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-153 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-153 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-153 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-153 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-153 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-153 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-153 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-153 .actor-man circle,#mermaid-6a213c2d99ee9aa5-153 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-153 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="395">1. Calls API without specifying version (defaults to v1)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="714" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="986">2. Routes request to legacy v1 endpoint automatically</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1252" y1="161" x1="719"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="719">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1545">3. Releases new v2 with new features but no clear version header</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="1260" y1="209" x1="1830"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1830">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="395">4. Continues calling v1 using old URL structure</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="714" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="986">5. Accepts requests for v1 even after v2 release</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1252" y1="305" x1="719"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="719">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1545">6. Does not restrict access to deprecated endpoints</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1260" y1="353" x1="1830"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1830">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="1545">7. Issues informal deprecation notice (via mailing list, not API headers)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1260" y1="401" x1="1830"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1830">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="986">8. No automated mechanism to block or warn on legacy API calls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1252" y1="449" x1="719"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="719">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="395">9. Legacy calls remain accepted without rate limits or access checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="714" y1="497" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1257">10. Legacy endpoints still run with outdated security configurations</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1257,545 C 1317,535 1317,575 1257,565"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1257">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="986">11. No version negotiation or transformation is applied</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="1252" y1="623" x1="719"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="719">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="1276">12. No automated audit or monitoring for legacy exploitation (e.g. injection or exploitation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="722" y1="671" x1="1830"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1830">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="395">13. Client experiences inconsistent behavior and potential vulnerabilities remain</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="714" y1="719" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto">Diagram B â€“ Secure API Versioning and Deprecation Implementation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2213 873" height="873" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-155" style="width:2213px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="AAAdm" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1963"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="2038"><tspan dy="0" x="2038">API Admin</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="1364"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="1439"><tspan dy="0" x="1439">API Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="677"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="752"><tspan dy="0" x="752">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="787" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="819.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="AAAdm" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="2038" y1="65" x1="2038" id="actor6120"></line><g id="root-6120"><rect class="actor actor-top" ry="3" rx="3" name="AAAdm" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1963"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2038"><tspan dy="0" x="2038">API Admin</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="1439" y1="65" x1="1439" id="actor6119"></line><g id="root-6119"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1364"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1439"><tspan dy="0" x="1439">API Application</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="752" y1="65" x1="752" id="actor6118"></line><g id="root-6118"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="677"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="752"><tspan dy="0" x="752">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="787" x2="75" y1="65" x1="75" id="actor6117"></line><g id="root-6117"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-155{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-155 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-155 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-155 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-155 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-155 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-155 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-155 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-155 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-155 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-155 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-155 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-155 p{margin:0}#mermaid-6a213c2d99ee9aa5-155 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-155 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-155 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-155 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-155 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-155 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-155 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-155 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-155 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-155 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-155 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-155 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-155 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-155 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-155 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-155 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-155 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-155 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-155 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-155 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-155 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-155 .actor-man circle,#mermaid-6a213c2d99ee9aa5-155 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-155 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="412">1. Sends API request with explicit version header (e.g. v2)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="748" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1094">2. Routes to new v2 endpoint per version header</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1435" y1="161" x1="753"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="753">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1740">3. Publishes new v2 release with clear versioning and mandatory headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="1443" y1="209" x1="2037"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="2037">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="412">4. Attempts to use v1 endpoint (legacy)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="748" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="1094">5. Detects legacy call and issues deprecation warning in response headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1435" y1="305" x1="753"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="753">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1397">6. Applies strict rate limiting and authentication to legacy endpoints</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="756" y1="353" x1="2037"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="2037">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="1740">7. Officially publishes deprecation timeline with API documentation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1443" y1="401" x1="2037"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="2037">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="415">8. Returns HTTP 299 or custom deprecation header advising migration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="79" y1="449" x1="751"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="751">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1094">9. Rejects calls to v1 after a specific cutâ€off (using version negotiation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1435" y1="497" x1="753"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="753">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1440">10. Enforces modern security baselines (secure coding, parameterized queries) on v2</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1440,545 C 1500,535 1500,575 1440,565"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1440">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="1094">11. Applies payload validation and transformation if needed during version negotiation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="1435" y1="623" x1="753"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="753">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="1397">12. Monitors all API traffic using SIEM and vulnerability scans, with automated alerts on legacy abuse</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="756" y1="671" x1="2037"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="2037">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="412">13. Client forced to migrate to v2 secure API behavior is verified during client testing</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="748" y1="719" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="76">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="734" x="415">14. Returns detailed guidance for API migration via API documentation links</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="767" x2="79" y1="767" x1="751"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="771" x="751">14</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table: Insecure vs. Secure API Versioning and Deprecation</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice / Remediation</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. API Version Release</strong></td><td dir="ltr">â€¢ No explicit version header<br>â€¢ Route defaults to legacy endpoint<br>â€¢ Informal release of new API version without enforced schema</td><td dir="ltr">â€¢ Requires explicit version header (v2, etc.)<br>â€¢ API gateway routes based on version<br>â€¢ Official release with clear documentation &amp; headers</td><td dir="ltr">Require version identification in every call; use versioned API endpoints being clearly documented and enforced in routing</td></tr><tr><td dir="ltr"><strong>2. Legacy Endpoint Exposure</strong></td><td dir="ltr">â€¢ Legacy endpoints remain open<br>â€¢ No automated blocking or rate limiting<br>â€¢ API clients continue using outdated versions</td><td dir="ltr">â€¢ Legacy endpoints are monitored<br>â€¢ API gateway responds with deprecation warnings<br>â€¢ Enforced rate limits and authentication on deprecated APIs</td><td dir="ltr">Apply controls for legacy endpoints even during deprecation; provide warning responses and limit access through rate limiting and auth</td></tr><tr><td dir="ltr"><strong>3. Deprecation Process</strong></td><td dir="ltr">â€¢ Deprecation announced informally<br>â€¢ No automated redirection or consistent warnings<br>â€¢ Legacy calls accepted despite announced sunset</td><td dir="ltr">â€¢ Official deprecation timeline published<br>â€¢ API gateway returns deprecation status codes and headers<br>â€¢ After cut-off, legacy calls are rejected</td><td dir="ltr">Publish clear deprecation policies and timelines; automate deprecation warnings and enforce sunsets in the API gateway</td></tr><tr><td dir="ltr"><strong>4. Security Enforcement &amp; Migration</strong></td><td dir="ltr">â€¢ No version negotiation or transformation<br>â€¢ Legacy endpoints run with outdated security baselines<br>â€¢ Little monitoring for exploitation</td><td dir="ltr">â€¢ New version enforces modern security practices (secure coding, validation)<br>â€¢ API Gateway transforms requests via schema negotiation<br>â€¢ Continuous monitoring and automated alerts on legacy abuse</td><td dir="ltr">Enforce security baselines for active versions only; use transformation/negotiation for migrations; integrate SIEM and vulnerability management</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Zero Trust Microservice Segmentation" dir="auto" class="heading" id="Zero_Trust_Microservice_Segmentation"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Zero Trust Microservice Segmentation<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Apply Zero Trust principles by enforcing microservice segmentation, validating every API call against an identity store, and isolating services with strict network policies.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Lateral movement, privilege escalation, microservice exploitation.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST Zero Trust Architecture, CIS Benchmarks, continuous micro-segmentation testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Cloud architects, network engineers, security operations; internal service-to-service communication, partner integrations.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Zero Trust Segmentation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1772 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-161" style="width:1772px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1522"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1597"><tspan dy="0" x="1597">Identity Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1084"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1159"><tspan dy="0" x="1159">Microservice</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="546"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="621"><tspan dy="0" x="621">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="IS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1597" y1="65" x1="1597" id="actor6124"></line><g id="root-6124"><rect class="actor actor-top" ry="3" rx="3" name="IS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1522"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1597"><tspan dy="0" x="1597">Identity Store</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1159" y1="65" x1="1159" id="actor6123"></line><g id="root-6123"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1084"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1159"><tspan dy="0" x="1159">Microservice</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="621" y1="65" x1="621" id="actor6122"></line><g id="root-6122"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="546"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="621"><tspan dy="0" x="621">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6121"></line><g id="root-6121"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-161{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-161 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-161 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-161 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-161 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-161 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-161 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-161 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-161 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-161 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-161 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-161 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-161 p{margin:0}#mermaid-6a213c2d99ee9aa5-161 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-161 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-161 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-161 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-161 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-161 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-161 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-161 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-161 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-161 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-161 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-161 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-161 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-161 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-161 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-161 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-161 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-161 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-161 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-161 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-161 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-161 .actor-man circle,#mermaid-6a213c2d99ee9aa5-161 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-161 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="347">1. Sends API request (no version or tenant info)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="617" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="622">2. Accepts request without authenticating identity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,161 C 682,151 682,191 622,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="622">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="889">3. Forwards request to microservice with no segmentation check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1155" y1="239" x1="622"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="622">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1160">4. Processes request without verifying caller credentials</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1160,287 C 1220,277 1220,317 1160,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1160">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1377">5. No query to Identity Store, legacy trust assumed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1593" y1="365" x1="1160"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1160">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1380">6. (No action identity not checked)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="413" x2="1163" y1="413" x1="1596"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1596">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="892">7. Responds to caller lateral movement possible among services</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="625" y1="461" x1="1158"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1158">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="350">8. Returns response (no context isolation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="79" y1="509" x1="620"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="620">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="347">9. Caller reuses token across services (no dynamic segmentation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="617" y1="557" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="622">10. No anomaly detection or segmentation enforcement triggered</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 622,605 C 682,595 682,635 622,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="622">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1160">11. No microsegmentation logs recorded flat network exposures exist</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1160,683 C 1220,673 1220,713 1160,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1160">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="350">12. Subsequent suspicious calls not blocked</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="620"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="620">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="1108">13. No enforcement of identity-based policies legacy permissions persist</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="1593" y1="809" x1="622"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="622">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Zero Trust Segmentation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1933 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-163" style="width:1933px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IS" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1683"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1758"><tspan dy="0" x="1758">Identity Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1180"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1255"><tspan dy="0" x="1255">Microservice</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="617"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="692"><tspan dy="0" x="692">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="IS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1758" y1="65" x1="1758" id="actor6128"></line><g id="root-6128"><rect class="actor actor-top" ry="3" rx="3" name="IS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1683"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1758"><tspan dy="0" x="1758">Identity Store</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1255" y1="65" x1="1255" id="actor6127"></line><g id="root-6127"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1180"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1255"><tspan dy="0" x="1255">Microservice</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="692" y1="65" x1="692" id="actor6126"></line><g id="root-6126"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="617"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="692"><tspan dy="0" x="692">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6125"></line><g id="root-6125"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-163{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-163 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-163 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-163 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-163 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-163 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-163 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-163 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-163 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-163 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-163 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-163 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-163 p{margin:0}#mermaid-6a213c2d99ee9aa5-163 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-163 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-163 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-163 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-163 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-163 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-163 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-163 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-163 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-163 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-163 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-163 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-163 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-163 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-163 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-163 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-163 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-163 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-163 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-163 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-163 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-163 .actor-man circle,#mermaid-6a213c2d99ee9aa5-163 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-163 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="382">1. Sends API request over TLS with explicit identity token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="688" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="693">2. Enforces TLS and validates client certificate and token</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 693,161 C 753,151 753,191 693,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="693">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="1224">3. Queries Identity Store for token verification and attribute lookup</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1754" y1="239" x1="693"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="693">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1227">4. Confirms identity with attributes and role claims</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="696" y1="287" x1="1757"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1757">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="693">5. Applies dynamic segmentation policies based on identity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 693,335 C 753,325 753,365 693,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="693">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="972">6. Forwards request with metadata ensuring service isolation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1251" y1="413" x1="693"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="693">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1256">7. Validates incoming metadata and performs fine-grained ACL checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1256,461 C 1316,451 1316,491 1256,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1256">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1505">8. Enforces identity binding for inter-service communication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1754" y1="539" x1="1256"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1256">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="975">9. Returns response after verifying strict segmentation rules</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="696" y1="587" x1="1254"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1254">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="385">10. Sends secured, segmented response to client</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="691"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="691">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1224">11. Logs transaction details and anomaly metrics for audit</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1754" y1="683" x1="693"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="693">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="972">12. Triggers automated policy updates and dynamic threat detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1251" y1="731" x1="693"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="693">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="385">13. Rejects subsequent requests that violate updated segmentation policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="691"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="691">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 10</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Request Initiation</strong></td><td dir="ltr">â€¢ Unauthenticated API requests sent over insecure channels.</td><td dir="ltr">â€¢ API requests sent over TLS with explicit identity tokens and client certificates.</td><td dir="ltr">Enforce TLS; require explicit identity and tenant data.</td></tr><tr><td dir="ltr"><strong>Authentication &amp; Segmentation</strong></td><td dir="ltr">â€¢ No identity validation; services trust any request; flat network.</td><td dir="ltr">â€¢ Identity Store queried and dynamic policies applied based on role/attribute; strict microsegmentation via metadata.</td><td dir="ltr">Validate identity using centralized directories; enforce dynamic, policy-based service segmentation.</td></tr><tr><td dir="ltr"><strong>Service-Level Enforcement</strong></td><td dir="ltr">â€¢ No ACL, no inter-service binding; lateral movement possible.</td><td dir="ltr">â€¢ Fine-grained ACL checks at microservice level and binding enforced; identity metadata used for authorization.</td><td dir="ltr">Use robust RBAC/ABAC models for microservice access; enforce per-request authorization.</td></tr><tr><td dir="ltr"><strong>Monitoring &amp; Enforcement</strong></td><td dir="ltr">â€¢ Minimal logging; no anomaly detection; legacy permissions persist.</td><td dir="ltr">â€¢ Continuous transaction logging with SIEM; automated policy updates, real-time threat detection, and adaptive rejection of nonconforming requests.</td><td dir="ltr">Integrate continuous monitoring; update policies dynamically based on threat intelligence and audit logs.</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="RBAC and ABAC-Based Access Control" dir="auto" class="heading" id="RBAC_and_ABAC-Based_Access_Control"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>RBAC and ABAC-Based Access Control<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement least privilege access using role-based (RBAC) and attribute-based (ABAC) methods with dynamic permissions embedded within API tokens; enforce context-aware access.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Insider threats, privilege abuse, unauthorized access.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-162, OWASP Authentication Cheat Sheet, regular access reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;IAM specialists, compliance officers, system administrators; employees, contractors, external partners.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ RBAC/ABAC without Dynamic Controls</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1783 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-169" style="width:1783px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RM" height="65" width="156" stroke="#666" fill="#eaeaea" y="769" x="1318"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1396"><tspan dy="0" x="1396">Resource Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1118"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1193"><tspan dy="0" x="1193">Directory Service</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="565"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="640"><tspan dy="0" x="640">Auth Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="RM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1396" y1="65" x1="1396" id="actor6132"></line><g id="root-6132"><rect class="actor actor-top" ry="3" rx="3" name="RM" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1318"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1396"><tspan dy="0" x="1396">Resource Manager</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1193" y1="65" x1="1193" id="actor6131"></line><g id="root-6131"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1118"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1193"><tspan dy="0" x="1193">Directory Service</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="640" y1="65" x1="640" id="actor6130"></line><g id="root-6130"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="565"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="640"><tspan dy="0" x="640">Auth Application</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6129"></line><g id="root-6129"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-169{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-169 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-169 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-169 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-169 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-169 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-169 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-169 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-169 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-169 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-169 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-169 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-169 p{margin:0}#mermaid-6a213c2d99ee9aa5-169 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-169 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-169 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-169 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-169 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-169 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-169 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-169 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-169 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-169 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-169 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-169 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-169 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-169 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-169 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-169 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-169 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-169 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-169 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-169 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-169 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-169 .actor-man circle,#mermaid-6a213c2d99ee9aa5-169 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-169 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="356">1. Provide credentials via unencrypted login (HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="636" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="915">2. Checks credentials using static password only</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1189" y1="161" x1="641"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="641">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="918">3. Returns basic role (e.g. 'user'), no attributes</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="644" y1="209" x1="1192"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1192">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="359">4. Issues API token with embedded static role, no dynamic attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="639"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="639">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="734">5. Presents API token with static role information</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1392" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1397">6. Grants access based solely on hardcoded RBAC rules</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1397,353 C 1457,343 1457,383 1397,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1397">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1397">7. Fails to evaluate environment/context or ABAC attributes (e.g., location, time)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1397,431 C 1457,421 1457,461 1397,451"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1397">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="734">8. Executes sensitive operation that should require elevated privileges</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1392" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1020">9. No real-time access review triggered token remains valid indefinitely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="644" y1="557" x1="1395"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1395">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="915">10. Logs minimal static role usage, no contextual details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1189" y1="605" x1="641"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="641">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="918">11. No automated review or periodic access revalidation conducted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="644" y1="653" x1="1192"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1192">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="737">12. User continues to access sensitive functions despite policy changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1395"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1395">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="359">13. No dynamic revocation or alerts on inappropriate privilege use</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="639"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="639">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Dynamic RBAC/ABAC Enforcement</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2003.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-171" style="width:2003.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="RM" height="65" width="156" stroke="#666" fill="#eaeaea" y="799" x="1539"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1617"><tspan dy="0" x="1617">Resource Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1339"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1414"><tspan dy="0" x="1414">Directory Service</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="709"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="784"><tspan dy="0" x="784">Auth Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="RM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1617" y1="65" x1="1617" id="actor6136"></line><g id="root-6136"><rect class="actor actor-top" ry="3" rx="3" name="RM" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1539"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1617"><tspan dy="0" x="1617">Resource Manager</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1414" y1="65" x1="1414" id="actor6135"></line><g id="root-6135"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1339"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1414"><tspan dy="0" x="1414">Directory Service</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="784" y1="65" x1="784" id="actor6134"></line><g id="root-6134"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="709"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="784"><tspan dy="0" x="784">Auth Application</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6133"></line><g id="root-6133"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-171{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-171 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-171 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-171 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-171 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-171 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-171 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-171 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-171 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-171 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-171 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-171 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-171 p{margin:0}#mermaid-6a213c2d99ee9aa5-171 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-171 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-171 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-171 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-171 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-171 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-171 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-171 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-171 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-171 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-171 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-171 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-171 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-171 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-171 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-171 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-171 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-171 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-171 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-171 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-171 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-171 .actor-man circle,#mermaid-6a213c2d99ee9aa5-171 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-171 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="428">1. Provide credentials over HTTPS with MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="780" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1098">2. Validates credentials plus attributes (role, group, context)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1410" y1="161" x1="785"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="785">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1101">3. Returns rich identity record with dynamic attributes</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="788" y1="209" x1="1413"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1413">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="431">4. Issues API token embedded with RBAC roles and ABAC attributes (e.g., location, time)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="783"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="783">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="845">5. Presents token with dynamic permission claims</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="1613" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1618">6. Evaluates token using current RBAC and ABAC rules (context-aware)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1618,353 C 1678,343 1678,383 1618,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1618">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1618">7. Checks contextual factors (IP location, time of day, device posture)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1618,431 C 1678,421 1678,461 1618,451"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1618">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="845">8. Attempts sensitive operation RM applies dynamic checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1613" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1618">9. Enforces least privilege conditions grants elevated access only if criteria met</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1618,557 C 1678,547 1678,587 1618,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1618">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1202">10. Sends detailed access logs to centralized audit system (SIEM)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="788" y1="635" x1="1616"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1616">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1098">11. Triggers periodic access reviews with dynamic revalidation of token claims</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1410" y1="683" x1="785"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="785">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1101">12. Revokes or reissues tokens automatically if anomalies occur</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="788" y1="731" x1="1413"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1413">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="848">13. Returns context-sensitive response alerts sent for suspicious access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="1616"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1616">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>User Authentication</strong></td><td dir="ltr">â€¢ Unencrypted logins, static passwords<br>â€¢ Minimal attribute checks</td><td dir="ltr">â€¢ HTTPS with MFA; identity lookup returns rich attributes (roles &amp; contextual data)</td><td dir="ltr">Secure login with MFA and HTTPS; enrich identity records with dynamic attributes</td></tr><tr><td dir="ltr"><strong>Token Issuance</strong></td><td dir="ltr">â€¢ Issues token with fixed role info; no ABAC<br>â€¢ No time/location data embedded</td><td dir="ltr">â€¢ Issues token with dynamic RBAC/ABAC claims, including contextual information</td><td dir="ltr">Embed dynamic attributes in tokens; enforce least privilege based on context</td></tr><tr><td dir="ltr"><strong>Contextual Authorization</strong></td><td dir="ltr">â€¢ Authorizes solely on static role; ignores context</td><td dir="ltr">â€¢ Evaluates token with current context (IP, time, device posture) and enforces dynamic access policies</td><td dir="ltr">Use context-sensitive authorization; apply both RBAC and ABAC to assess access requests</td></tr><tr><td dir="ltr"><strong>Audit &amp; Revocation</strong></td><td dir="ltr">â€¢ Minimal logging; token valid indefinitely; no dynamic revocation</td><td dir="ltr">â€¢ Continuous logging via SIEM; periodic reviews and automatic token revocation/renewal if contextual anomalies detected</td><td dir="ltr">Implement continuous audit; automate access reviews and immediate revocation upon detecting suspicious behavior</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Data Encryption at Rest and In Transit" dir="auto" class="heading" id="Data_Encryption_at_Rest_and_In_Transit"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Data Encryption at Rest and In Transit<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Ensure that sensitive data is encrypted at both rest and in transit using AES encryption and TLS, combined with centralized key management and automated key rotation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Data exfiltration, man-in-the-middle (MitM) attacks, unauthorized data access.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-57, PCI-DSS for data protection, regular encryption audits.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Database administrators, security architects; operational staff, end-users with sensitive data access.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Data Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-235.5 -10 1874.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-176" style="width:1874.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1350"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1425"><tspan dy="0" x="1425">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1152"><tspan dy="0" x="1152">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="512"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="587"><tspan dy="0" x="587">Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="APP" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1425" y1="65" x1="1425" id="actor6140"></line><g id="root-6140"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1350"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1425"><tspan dy="0" x="1425">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1152" y1="65" x1="1152" id="actor6139"></line><g id="root-6139"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1152"><tspan dy="0" x="1152">Key Manager</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="587" y1="65" x1="587" id="actor6138"></line><g id="root-6138"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="512"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="587"><tspan dy="0" x="587">Database</tspan></text></g></g><g><line name="APP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6137"></line><g id="root-6137"><rect class="actor actor-top" ry="3" rx="3" name="APP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-176{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-176 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-176 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-176 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-176 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-176 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-176 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-176 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-176 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-176 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-176 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-176 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-176 p{margin:0}#mermaid-6a213c2d99ee9aa5-176 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-176 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-176 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-176 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-176 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-176 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-176 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-176 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-176 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-176 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-176 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-176 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-176 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-176 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-176 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-176 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-176 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-176 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-176 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-176 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-176 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-176 .actor-man circle,#mermaid-6a213c2d99ee9aa5-176 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-176 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="330">1. Write sensitive data to DB without encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="583" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="868">2. Uses a static, embedded key (hardcoded) for minimal obfuscation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1148" y1="161" x1="588"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="588">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="871">3. Returns static key (no rotation)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="591" y1="209" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1151">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="76">4. Sends data over HTTP or weak TLS versions (no certificate validation)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,257 C 136,247 136,287 76,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="330">5. Data transmitted in plaintext or with outdated cipher suites</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="583" y1="335" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="1153">6. No automated key rotation or revocation policies applied</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1153,383 C 1213,373 1213,413 1153,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1153">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="871">7. Key used across multiple data sets minimal separation of duties</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="591" y1="461" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1151">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1005">8. Logs contain unencrypted sensitive data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1421" y1="509" x1="588"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="588">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1426">9. Logs stored in plaintext no access controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1426,557 C 1486,547 1486,587 1426,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1426">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="330">10. Data requests served without verifying key freshness</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="583" y1="635" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="333">11. Returns data without integrity checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="79" y1="683" x1="586"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="586">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="871">12. No centralized key audit key reuse persists</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="591" y1="731" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1151">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="749">13. No alerts on potential data exfiltration detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1421" y1="779" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Data Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1894.5 903" height="903" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-178" style="width:1894.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1502"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1577"><tspan dy="0" x="1577">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="1161"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="1236"><tspan dy="0" x="1236">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="570"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="645"><tspan dy="0" x="645">Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="APP" height="65" width="150" stroke="#666" fill="#eaeaea" y="817" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="849.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1577" y1="65" x1="1577" id="actor6144"></line><g id="root-6144"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1502"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1577"><tspan dy="0" x="1577">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="1236" y1="65" x1="1236" id="actor6143"></line><g id="root-6143"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1161"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1236"><tspan dy="0" x="1236">Key Manager</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="645" y1="65" x1="645" id="actor6142"></line><g id="root-6142"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="570"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="645"><tspan dy="0" x="645">Database</tspan></text></g></g><g><line name="APP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="817" x2="75" y1="65" x1="75" id="actor6141"></line><g id="root-6141"><rect class="actor actor-top" ry="3" rx="3" name="APP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-178{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-178 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-178 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-178 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-178 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-178 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-178 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-178 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-178 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-178 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-178 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-178 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-178 p{margin:0}#mermaid-6a213c2d99ee9aa5-178 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-178 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-178 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-178 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-178 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-178 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-178 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-178 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-178 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-178 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-178 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-178 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-178 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-178 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-178 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-178 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-178 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-178 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-178 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-178 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-178 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-178 .actor-man circle,#mermaid-6a213c2d99ee9aa5-178 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-178 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="359">1. Write sensitive data to DB with AES-256 encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="641" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="939">2. Request encryption keys via secure API call over TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1232" y1="161" x1="646"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="646">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="942">3. Provide ephemeral key with limited lifetime and usage policy</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="649" y1="209" x1="1235"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1235">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="359">4. Transmit data over HTTPS/TLS 1.3 with certificate pinning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="641" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="362">5. Data received with end-to-end encryption and integrity verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="79" y1="305" x1="644"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="644">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1237">6. Enforce automated key rotation, revocation, and key separation per dataset</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1237,353 C 1297,343 1297,383 1237,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="1237">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="942">7. Provide per-transaction keys and log key usage securely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="649" y1="431" x1="1235"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1235">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1110">8. Log all encryption/decryption events in encrypted logs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1573" y1="479" x1="646"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="646">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1578">9. Use audit trails with SIEM integration and access controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1578,527 C 1638,517 1638,557 1578,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1578">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="359">10. Validate data integrity using HMAC or digital signatures</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="641" y1="605" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="362">11. Return verified data integrity verified at both ends</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="644"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="644">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="942">12. Trigger alerts on key anomalies or unauthorized key access attempts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="649" y1="701" x1="1235"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1235">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="828">13. Generate real-time alerts dashboard displays key lifecycle events</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="1576"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1576">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="764" x="825">14. Continuous monitoring of data access with anomaly detection enabled</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="797" x2="1573" y1="797" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="801" x="76">14</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>1. Data at Rest</strong></td><td dir="ltr">â€¢ Data stored unencrypted<br>â€¢ Static, hardcoded key used<br>â€¢ No key rotation</td><td dir="ltr">â€¢ Data encrypted with AES-256<br>â€¢ Keys provided via secure API with short lifetime<br>â€¢ Automated key rotation enforced</td><td dir="ltr">Encrypt sensitive data; use strong encryption algorithms; implement automated key lifecycle management</td></tr><tr><td dir="ltr"><strong>2. Data in Transit</strong></td><td dir="ltr">â€¢ Data sent over HTTP or TLS with weak ciphers<br>â€¢ No certificate validation or pinning</td><td dir="ltr">â€¢ Data transmitted over TLS 1.3 with certificate pinning<br>â€¢ End-to-end encryption with integrity checks</td><td dir="ltr">Use upâ€‘toâ€‘date TLS; enforce certificate pinning and integrity verification</td></tr><tr><td dir="ltr"><strong>3. Key Management</strong></td><td dir="ltr">â€¢ Static key reused across data sets<br>â€¢ No rotation or separation of duties<br>â€¢ Lacks audit of key usage</td><td dir="ltr">â€¢ Centralized key management with per-transaction keys<br>â€¢ Enforced rotation and revocation policies<br>â€¢ Detailed key audit logs</td><td dir="ltr">Use centralized, automated key management; rotate keys frequently; audit key usage and enforce least privilege</td></tr><tr><td dir="ltr"><strong>4. Logging &amp; Audit</strong></td><td dir="ltr">â€¢ Logs contain plaintext sensitive data<br>â€¢ Minimal logging without access controls</td><td dir="ltr">â€¢ Encrypted logs with full access controls<br>â€¢ SIEM-integrated audit trails remotely monitored</td><td dir="ltr">Log all sensitive operations securely; use SIEM; enforce continuous monitoring and immediate alerting on anomalies</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Comprehensive Audit Logging and SIEM Integration" dir="auto" class="heading" id="Comprehensive_Audit_Logging_and_SIEM_Integration"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Comprehensive Audit Logging and SIEM Integration<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement a centralized logging system that aggregates API access logs, integrates with SIEM platforms, and supports real-time anomaly detection and forensic investigation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Undetected breaches, log tampering, lateral movement.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-92, ISO 27001, continuous log monitoring best practices.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Security analysts, incident response teams, compliance auditors; SOC and IT risk management.</p></div><div class="el-p"><p dir="auto"><strong>Insecure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1621 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-183" style="width:1621px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1226"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1301"><tspan dy="0" x="1301">SIEM Console</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="LS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="842"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="917"><tspan dy="0" x="917">Log Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="301"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="376"><tspan dy="0" x="376">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="SIEM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1301" y1="65" x1="1301" id="actor6148"></line><g id="root-6148"><rect class="actor actor-top" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1226"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1301"><tspan dy="0" x="1301">SIEM Console</tspan></text></g></g><g><line name="LS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="917" y1="65" x1="917" id="actor6147"></line><g id="root-6147"><rect class="actor actor-top" ry="3" rx="3" name="LS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="842"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="917"><tspan dy="0" x="917">Log Server</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="376" y1="65" x1="376" id="actor6146"></line><g id="root-6146"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="301"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="376"><tspan dy="0" x="376">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6145"></line><g id="root-6145"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-183{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-183 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-183 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-183 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-183 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-183 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-183 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-183 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-183 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-183 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-183 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-183 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-183 p{margin:0}#mermaid-6a213c2d99ee9aa5-183 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-183 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-183 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-183 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-183 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-183 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-183 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-183 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-183 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-183 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-183 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-183 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-183 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-183 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-183 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-183 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-183 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-183 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-183 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-183 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-183 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-183 .actor-man circle,#mermaid-6a213c2d99ee9aa5-183 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-183 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="224">1. Invoke API request over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="372" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="377">2. Process request without detailed context capture</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 377,161 C 437,151 437,191 377,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="377">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="645">3. Generate minimal plaintext logs (no timestamps, no identifiers)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="913" y1="239" x1="377"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="377">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="918">4. Store logs locally without encryption</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 918,287 C 978,277 978,317 918,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="918">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="648">5. Transmit logs over unencrypted channels</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="380" y1="365" x1="916"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="916">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="837">6. Forward logs in bulk without integrity protection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1297" y1="413" x1="377"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="377">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1302">7. Aggregation performed using default settings (no filtering)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1302,461 C 1362,451 1362,491 1302,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1302">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1302">8. Minimal anomaly detection thresholds static and outdated</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1302,539 C 1362,529 1362,569 1302,559"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1302">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="840">9. No correlation with threat intelligence feeds</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="617" x2="380" y1="617" x1="1300"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="1300">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="690">10. Alerts not generated in real time manual review required</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="79" y1="665" x1="1300"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1300">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="645">11. No audit of log tampering logs remain mutable</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="913" y1="713" x1="377"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="377">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1108">12. No automated forensic analysis initiated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1297" y1="761" x1="918"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="918">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="840">13. Continued use of logs with inconsistent metadata, allowing undetected breach</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="380" y1="809" x1="1300"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1300">13</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Secure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2033 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-185" style="width:2033px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1573"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1648"><tspan dy="0" x="1648">SIEM Console</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="LS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1071"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1146"><tspan dy="0" x="1146">Log Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="460"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="535"><tspan dy="0" x="535">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="SIEM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1648" y1="65" x1="1648" id="actor6152"></line><g id="root-6152"><rect class="actor actor-top" ry="3" rx="3" name="SIEM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1573"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1648"><tspan dy="0" x="1648">SIEM Console</tspan></text></g></g><g><line name="LS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1146" y1="65" x1="1146" id="actor6151"></line><g id="root-6151"><rect class="actor actor-top" ry="3" rx="3" name="LS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1071"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1146"><tspan dy="0" x="1146">Log Server</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="535" y1="65" x1="535" id="actor6150"></line><g id="root-6150"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="460"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="535"><tspan dy="0" x="535">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6149"></line><g id="root-6149"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-185{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-185 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-185 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-185 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-185 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-185 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-185 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-185 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-185 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-185 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-185 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-185 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-185 p{margin:0}#mermaid-6a213c2d99ee9aa5-185 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-185 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-185 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-185 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-185 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-185 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-185 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-185 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-185 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-185 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-185 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-185 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-185 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-185 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-185 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-185 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-185 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-185 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-185 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-185 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-185 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-185 .actor-man circle,#mermaid-6a213c2d99ee9aa5-185 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-185 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="304">1. Invoke API request over HTTPS with proper headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="531" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="536">2. Capture detailed context (timestamp, client ID, session, geo-IP)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 536,161 C 596,151 596,191 536,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="536">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="839">3. Generate structured logs in JSON with integrity checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1142" y1="239" x1="536"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="536">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1147">4. Encrypt log entries and sign them cryptographically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1147,287 C 1207,277 1207,317 1147,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1147">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="842">5. Transmit logs over TLS with mutual authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="539" y1="365" x1="1145"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1145">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1090">6. Forward logs with end-to-end encryption and message integrity codes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1644" y1="413" x1="536"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="536">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1649">7. Aggregate logs from multiple sources with normalization</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1649,461 C 1709,451 1709,491 1649,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1649">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1649">8. Apply dynamic, AI-driven anomaly detection and correlation with threat intel</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1649,539 C 1709,529 1709,569 1649,559"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1649">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="1093">9. Real-time filtering and enrichment with contextual metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="617" x2="539" y1="617" x1="1647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="1647">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="863">10. Generate immediate alerts via SOAR integration on suspicious activity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="79" y1="665" x1="1647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1647">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="839">11. Immutable log storage with automated tamper detection and audit trails</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1142" y1="713" x1="536"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="536">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1396">12. Auto-trigger forensic workflows upon anomaly detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1644" y1="761" x1="1147"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1147">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="1093">13. Continuous monitoring produces actionable intelligence logs reviewed and archived securely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="539" y1="809" x1="1647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1647">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Log Generation</strong></td><td dir="ltr">â€¢ Minimal plaintext logs; no critical metadata<br>â€¢ No data integrity or encryption applied</td><td dir="ltr">â€¢ Detailed JSON logs with timestamps, IDs, and context<br>â€¢ Cryptographically signed and encrypted log entries</td><td dir="ltr">Generate structured logs; enforce encryption and integrity checks</td></tr><tr><td dir="ltr"><strong>Log Transmission</strong></td><td dir="ltr">â€¢ Transmitted over unencrypted channels<br>â€¢ Bulk log forward with no authentication</td><td dir="ltr">â€¢ Endâ€‘toâ€‘end TLS with mutual authentication; use MACs</td><td dir="ltr">Secure log channels with TLS and strong authentication</td></tr><tr><td dir="ltr"><strong>Aggregation &amp; Analysis</strong></td><td dir="ltr">â€¢ Default aggregation with static thresholds<br>â€¢ No integration with threat intel</td><td dir="ltr">â€¢ AIâ€‘driven anomaly detection; dynamic correlation with threat intelligence; contextual enrichment</td><td dir="ltr">Use advanced SIEM capabilities and continuous monitoring</td></tr><tr><td dir="ltr"><strong>Incident Response</strong></td><td dir="ltr">â€¢ Manual review; no automated forensic workflows<br>â€¢ Logs mutable and lack audit trails</td><td dir="ltr">â€¢ Automated alerts via SOAR; immutable logging and automated forensic triggers</td><td dir="ltr">Integrate SIEM with SOAR; implement immutable audit logs and automated incident response</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Containerization and Orchestration" dir="auto" class="heading" id="Secure_Containerization_and_Orchestration"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Containerization and Orchestration<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Harden container images using best practices with vulnerability scanning, secure runtime configurations, and orchestration policies (e.g., Kubernetes network segmentation).<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Container breakout, insecure API orchestration, misconfigured services.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-190, CIS Kubernetes Benchmarks, regular container security assessments.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevOps, container security engineers; application developers, deployment teams.</p></div><div class="el-p"><p dir="auto"><strong>Insecure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1604 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-190" style="width:1604px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="NS" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1354"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1429"><tspan dy="0" x="1429">Network Switch</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="799" x="842.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="933"><tspan dy="0" x="933">Kubernetes Scheduler</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="799" x="453"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="530"><tspan dy="0" x="530">Container Registry</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="NS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1429" y1="65" x1="1429" id="actor6156"></line><g id="root-6156"><rect class="actor actor-top" ry="3" rx="3" name="NS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1354"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1429"><tspan dy="0" x="1429">Network Switch</tspan></text></g></g><g><line name="KS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="933" y1="65" x1="933" id="actor6155"></line><g id="root-6155"><rect class="actor actor-top" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="0" x="842.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="933"><tspan dy="0" x="933">Kubernetes Scheduler</tspan></text></g></g><g><line name="CR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="530" y1="65" x1="530" id="actor6154"></line><g id="root-6154"><rect class="actor actor-top" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="0" x="453"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="530"><tspan dy="0" x="530">Container Registry</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6153"></line><g id="root-6153"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-190{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-190 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-190 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-190 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-190 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-190 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-190 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-190 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-190 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-190 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-190 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-190 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-190 p{margin:0}#mermaid-6a213c2d99ee9aa5-190 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-190 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-190 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-190 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-190 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-190 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-190 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-190 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-190 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-190 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-190 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-190 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-190 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-190 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-190 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-190 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-190 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-190 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-190 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-190 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-190 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-190 .actor-man circle,#mermaid-6a213c2d99ee9aa5-190 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-190 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="301">1. Build container image with outdated base image</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="526" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="531">2. No automated vulnerability scans performed</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 531,161 C 591,151 591,191 531,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="531">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="730">3. Push image without signature or attestation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="929" y1="239" x1="531"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="531">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="934">4. Deploy container with default security context (root runs)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 934,287 C 994,277 994,317 934,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="934">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1180">5. Expose container over flat network no segmentation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1425" y1="365" x1="934"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="934">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="934">6. Run containers with full capabilities no resource limits set</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 934,413 C 994,403 994,443 934,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="934">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1180">7. Network policies not enforced lateral movement possible</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1425" y1="491" x1="934"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="934">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="301">8. Update image seldom legacy vulnerabilities persist</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="526" y1="539" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1183">9. Minimal logging no runtime anomaly detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="937" y1="587" x1="1428"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1428">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="506">10. No automated remediation for exploits detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="932"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="932">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1183">11. Outdated container metrics not correlated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="937" y1="683" x1="1428"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1428">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1180">12. Network breach remains undetected over time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1425" y1="731" x1="934"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="934">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="751">13. No role-based access controls applied for container orchestration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1425" y1="779" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Secure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1761.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-192" style="width:1761.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="NS" height="65" width="196" stroke="#666" fill="#eaeaea" y="799" x="1465.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1563.5"><tspan dy="0" x="1563.5">Network Policy Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="799" x="822"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="912.5"><tspan dy="0" x="912.5">Kubernetes Scheduler</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="799" x="574"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="651"><tspan dy="0" x="651">Container Registry</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="NS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1563.5" y1="65" x1="1563.5" id="actor6160"></line><g id="root-6160"><rect class="actor actor-top" ry="3" rx="3" name="NS" height="65" width="196" stroke="#666" fill="#eaeaea" y="0" x="1465.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1563.5"><tspan dy="0" x="1563.5">Network Policy Manager</tspan></text></g></g><g><line name="KS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="912.5" y1="65" x1="912.5" id="actor6159"></line><g id="root-6159"><rect class="actor actor-top" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="0" x="822"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="912.5"><tspan dy="0" x="912.5">Kubernetes Scheduler</tspan></text></g></g><g><line name="CR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="651" y1="65" x1="651" id="actor6158"></line><g id="root-6158"><rect class="actor actor-top" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="0" x="574"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="651"><tspan dy="0" x="651">Container Registry</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6157"></line><g id="root-6157"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-192{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-192 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-192 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-192 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-192 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-192 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-192 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-192 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-192 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-192 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-192 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-192 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-192 p{margin:0}#mermaid-6a213c2d99ee9aa5-192 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-192 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-192 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-192 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-192 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-192 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-192 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-192 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-192 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-192 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-192 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-192 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-192 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-192 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-192 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-192 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-192 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-192 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-192 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-192 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-192 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-192 .actor-man circle,#mermaid-6a213c2d99ee9aa5-192 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-192 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="362">1. Build container using hardened base images and secure Dockerfiles</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="647" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="652">2. Run automated vulnerability scans and static analysis</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 652,161 C 712,151 712,191 652,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="652">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="365">3. Sign image upon successful compliance audit</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="650"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="650">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="914">4. Deploy container with non-root security context and strict SCMP (Seccomp)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 913.5,287 C 973.5,277 973.5,317 913.5,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="913.5">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1237">5. Enforce mandatory network policies and segmentation at pod level</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1559.5" y1="365" x1="913.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="913.5">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="914">6. Run containers with limited capabilities and resource quotas</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 913.5,413 C 973.5,403 973.5,443 913.5,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="913.5">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1237">7. Apply Kubernetes Network Policies to restrict lateral movement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1559.5" y1="491" x1="913.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="913.5">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="362">8. Enable continuous image updates and automatic patching</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="647" y1="539" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1240">9. Collect and encrypt detailed runtime logs and metrics</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="916.5" y1="587" x1="1562.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1562.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="495">10. Deploy runtime anomaly detection and auto-remediation (e.g., pod restart)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="911.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="911.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1240">11. Correlate container metrics with threat intelligence via SIEM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="916.5" y1="683" x1="1562.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1562.5">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1237">12. Trigger automated alerts and quarantine affected pods on anomaly detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1559.5" y1="731" x1="913.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="913.5">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="818">13. Enforce RBAC for orchestration and continuous audit logging</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1559.5" y1="779" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="76">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Image Building</strong></td><td dir="ltr">â€¢ Use outdated base images; no vulnerability scanning<br>â€¢ Unsigned images</td><td dir="ltr">â€¢ Harden images with current base images; employ automated vulnerability scans<br>â€¢ Sign images cryptographically</td><td dir="ltr">Build with hardened base images; require nonâ€‘repudiation via image signing</td></tr><tr><td dir="ltr"><strong>Image Deployment</strong></td><td dir="ltr">â€¢ Deploy with default security context; no segmentation<br>â€¢ Flat network exposure</td><td dir="ltr">â€¢ Deploy with non-root contexts, proper security contexts and explicit pod security policies<br>â€¢ Enforce network segmentation</td><td dir="ltr">Use Kubernetes security contexts; apply network policies and least privilege deployments</td></tr><tr><td dir="ltr"><strong>Container Runtime</strong></td><td dir="ltr">â€¢ Full privileges and no resource limits; no runtime isolation</td><td dir="ltr">â€¢ Run containers with limited capabilities and resource quotas; enforce network segmentation</td><td dir="ltr">Limit container privileges; enforce runtime isolation and continuous patching</td></tr><tr><td dir="ltr"><strong>Monitoring &amp; Remediation</strong></td><td dir="ltr">â€¢ Minimal logging; no anomaly detection or automated response</td><td dir="ltr">â€¢ Integrate runtime monitoring, anomaly detection, SIEM correlation, and automated remediation; enforce RBAC and continuous audit logging</td><td dir="ltr">Maintain continuous monitoring; use automated remediation and enforce strict access controls</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="DevSecOps Integration into CI/CD Pipelines" dir="auto" class="heading" id="DevSecOps_Integration_into_CI/CD_Pipelines"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>DevSecOps Integration into CI/CD Pipelines<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Integrate security scanning (SAST, DAST), dependency checks, and automated policy enforcement within the CI/CD pipeline to ensure secure API code delivery.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Supply chain attacks, code injection, exploitation of vulnerabilities in dependencies.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;OWASP DevSecOps guidelines, SANS DevSecOps, automated security testing in CI/CD.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevOps, software developers, security automation engineers; product management, compliance teams.</p></div><div class="el-p"><p dir="auto"><strong>Insecure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1510 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-197" style="width:1510px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="AR" height="65" width="156" stroke="#666" fill="#eaeaea" y="799" x="1254"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1332"><tspan dy="0" x="1332">Artifact Repository</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DS" height="65" width="176" stroke="#666" fill="#eaeaea" y="799" x="1028"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1116"><tspan dy="0" x="1116">Dependency Scanner</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="566"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="641"><tspan dy="0" x="641">CI Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="AR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1332" y1="65" x1="1332" id="actor6164"></line><g id="root-6164"><rect class="actor actor-top" ry="3" rx="3" name="AR" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1254"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1332"><tspan dy="0" x="1332">Artifact Repository</tspan></text></g></g><g><line name="DS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1116" y1="65" x1="1116" id="actor6163"></line><g id="root-6163"><rect class="actor actor-top" ry="3" rx="3" name="DS" height="65" width="176" stroke="#666" fill="#eaeaea" y="0" x="1028"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1116"><tspan dy="0" x="1116">Dependency Scanner</tspan></text></g></g><g><line name="CI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="641" y1="65" x1="641" id="actor6162"></line><g id="root-6162"><rect class="actor actor-top" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="566"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="641"><tspan dy="0" x="641">CI Server</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6161"></line><g id="root-6161"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-197{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-197 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-197 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-197 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-197 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-197 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-197 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-197 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-197 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-197 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-197 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-197 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-197 p{margin:0}#mermaid-6a213c2d99ee9aa5-197 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-197 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-197 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-197 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-197 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-197 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-197 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-197 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-197 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-197 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-197 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-197 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-197 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-197 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-197 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-197 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-197 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-197 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-197 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-197 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-197 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-197 .actor-man circle,#mermaid-6a213c2d99ee9aa5-197 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-197 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="357">1. Commit code with potential vulnerabilities over unsecured channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="637" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="642">2. Build project without running SAST</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 642,161 C 702,151 702,191 642,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="642">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="877">3. Initiate minimal dependency check (infrequent scans)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1112" y1="239" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="642">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="880">4. Return outdated vulnerability report</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="645" y1="287" x1="1115"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1115">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="642">5. Run basic tests with no security focus</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 642,335 C 702,325 702,365 642,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="642">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="985">6. Create artifact without code signing or security attestations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1328" y1="413" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="642">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="988">7. Deploy artifact using default deployment scripts (no security checks)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="645" y1="461" x1="1331"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1331">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="642">8. Environment not scanned for misconfiguration during deployment</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 642,509 C 702,499 702,539 642,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="642">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="360">9. No automated vulnerability scanning post-deployment</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="79" y1="587" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="640">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="357">10. Manual security reviews required delays in patching</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="637" y1="635" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="985">11. Inadequate logging of deployment events</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1328" y1="683" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="642">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="988">12. No alerts generated for known vulnerable dependencies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="645" y1="731" x1="1331"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1331">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="360">13. Code injection vulnerabilities remain unaddressed in production</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="640">13</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Secure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1815 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-199" style="width:1815px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="AR" height="65" width="156" stroke="#666" fill="#eaeaea" y="799" x="1559"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1637"><tspan dy="0" x="1637">Artifact Repository</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DS" height="65" width="176" stroke="#666" fill="#eaeaea" y="799" x="1333"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1421"><tspan dy="0" x="1421">Dependency Scanner</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="697"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="772"><tspan dy="0" x="772">CI Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="AR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1637" y1="65" x1="1637" id="actor6168"></line><g id="root-6168"><rect class="actor actor-top" ry="3" rx="3" name="AR" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1559"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1637"><tspan dy="0" x="1637">Artifact Repository</tspan></text></g></g><g><line name="DS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1421" y1="65" x1="1421" id="actor6167"></line><g id="root-6167"><rect class="actor actor-top" ry="3" rx="3" name="DS" height="65" width="176" stroke="#666" fill="#eaeaea" y="0" x="1333"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1421"><tspan dy="0" x="1421">Dependency Scanner</tspan></text></g></g><g><line name="CI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="772" y1="65" x1="772" id="actor6166"></line><g id="root-6166"><rect class="actor actor-top" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="697"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="772"><tspan dy="0" x="772">CI Server</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6165"></line><g id="root-6165"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-199{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-199 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-199 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-199 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-199 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-199 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-199 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-199 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-199 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-199 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-199 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-199 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-199 p{margin:0}#mermaid-6a213c2d99ee9aa5-199 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-199 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-199 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-199 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-199 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-199 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-199 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-199 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-199 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-199 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-199 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-199 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-199 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-199 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-199 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-199 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-199 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-199 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-199 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-199 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-199 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-199 .actor-man circle,#mermaid-6a213c2d99ee9aa5-199 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-199 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="422">1. Commit code over secure channel with pre-commit hooks for secrets scanning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="768" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="773">2. Trigger automated SAST and linting during build</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 773,161 C 833,151 833,191 773,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="773">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="1095">3. Perform continuous dependency scanning with up-to-date vulnerability feeds</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1417" y1="239" x1="773"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="773">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1098">4. Return detailed vulnerability report with remediation guidance</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="776" y1="287" x1="1420"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1420">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="773">5. Run integrated functional, regression, and DAST tests on a staging environment</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 773,335 C 833,325 833,365 773,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="773">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1203">6. Create signed artifact accompanied by security attestations and metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1633" y1="413" x1="773"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="773">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1206">7. Use secure, automated deployment scripts that enforce policy checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="776" y1="461" x1="1636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1636">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="773">8. Scan deployment configurations for misconfigurations using IaC security tools</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 773,509 C 833,499 833,539 773,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="773">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="425">9. Deploy artifact trigger continuous runtime security monitoring via SIEM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="79" y1="587" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="771">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1203">10. Log detailed security events and correlate with vulnerability reports</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1633" y1="635" x1="773"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="773">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1206">11. Auto-trigger alerts on known vulnerable dependencies or misconfigurations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="776" y1="683" x1="1636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1636">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="425">12. Automated remediation steps and patch releases initiated based on SIEM feedback</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="771">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="422">13. Continuous improvement through regular security reviews and policy update cycles</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="768" y1="779" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="76">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Code Commit &amp; Build</strong></td><td dir="ltr">â€¢ Unsecured commit process; minimal SAST<br>â€¢ Outdated dependency scanning</td><td dir="ltr">â€¢ Secure commit with pre-commit scanning; full SAST integrated<br>â€¢ Continuous, upâ€‘toâ€‘date dependency vulnerability checks</td><td dir="ltr">Integrate SAST/DAST and enforce secure commit processes; use automated dependency scanning</td></tr><tr><td dir="ltr"><strong>Testing &amp; Artifact Creation</strong></td><td dir="ltr">â€¢ Basic tests; no code signing; no security attestations</td><td dir="ltr">â€¢ Comprehensive testing (functional + DAST); artifacts are signed and include security metadata</td><td dir="ltr">Sign artifacts and include security attestations; enforce rigorous test suites</td></tr><tr><td dir="ltr"><strong>Deployment Pipeline</strong></td><td dir="ltr">â€¢ Default scripts without security controls; misconfiguration risks</td><td dir="ltr">â€¢ Automated, secure deployment scripts that validate configurations with IaC security tools</td><td dir="ltr">Automate deployment with policy checks and IaC scans</td></tr><tr><td dir="ltr"><strong>Continuous Monitoring</strong></td><td dir="ltr">â€¢ No post-deployment scanning; minimal logging; delayed manual reviews</td><td dir="ltr">â€¢ Integrated SIEM with continuous monitoring; automated alerts and remediation; detailed logging</td><td dir="ltr">Use automated monitoring and SIEM integration; set alerts and auto-remediation for vulnerabilities</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Intelligent Anomaly Detection and API Traffic Monitoring" dir="auto" class="heading" id="Intelligent_Anomaly_Detection_and_API_Traffic_Monitoring"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Intelligent Anomaly Detection and API Traffic Monitoring<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy machine learning-based monitoring systems to profile normal API behavior, detect deviations in real time, and trigger automated incident responses.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;API abuse, automated bot attacks, exfiltration attempts.<br>â€¢&nbsp;<strong>Standards &amp; Best Practices:</strong>&nbsp;NIST SP 800-137, continuous monitoring standards, threat hunting frameworks.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Security operations, threat analysts; network teams, incident response coordinators.</p></div><div class="el-p"><p dir="auto"><strong>Insecure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1589 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-204" style="width:1589px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IR" height="65" width="161" stroke="#666" fill="#eaeaea" y="829" x="1328"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1408.5"><tspan dy="0" x="1408.5">Incident Responder</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="156" stroke="#666" fill="#eaeaea" y="829" x="1033"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1111"><tspan dy="0" x="1111">Monitoring System</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="519"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="594"><tspan dy="0" x="594">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="IR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1408.5" y1="65" x1="1408.5" id="actor6172"></line><g id="root-6172"><rect class="actor actor-top" ry="3" rx="3" name="IR" height="65" width="161" stroke="#666" fill="#eaeaea" y="0" x="1328"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1408.5"><tspan dy="0" x="1408.5">Incident Responder</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1111" y1="65" x1="1111" id="actor6171"></line><g id="root-6171"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1033"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1111"><tspan dy="0" x="1111">Monitoring System</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="594" y1="65" x1="594" id="actor6170"></line><g id="root-6170"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="519"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="594"><tspan dy="0" x="594">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6169"></line><g id="root-6169"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-204{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-204 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-204 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-204 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-204 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-204 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-204 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-204 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-204 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-204 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-204 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-204 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-204 p{margin:0}#mermaid-6a213c2d99ee9aa5-204 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-204 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-204 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-204 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-204 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-204 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-204 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-204 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-204 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-204 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-204 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-204 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-204 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-204 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-204 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-204 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-204 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-204 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-204 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-204 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-204 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-204 .actor-man circle,#mermaid-6a213c2d99ee9aa5-204 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-204 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="333">1. Sends API requests over HTTP with no contextual metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="590" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="595">2. Forwards requests without source validation or context tagging</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 595,161 C 655,151 655,191 595,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="595">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="851">3. Sends raw traffic logs unprocessed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1107" y1="239" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="595">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1112">4. Aggregates data using static thresholds (no learning)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1112,287 C 1172,277 1172,317 1112,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1112">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1112">5. Fails to detect subtle anomalies due to fixed rule sets</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1112,365 C 1172,355 1172,395 1112,385"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1112">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="854">6. No dynamic adjustments triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="443" x2="598" y1="443" x1="1110"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="447" x="1110">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1000">7. Alerts not generated suspicious activity ignored by default configuration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1404.5" y1="491" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="595">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1003">8. Manual investigation triggered only after major incident occurs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="598" y1="539" x1="1407.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1407.5">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1112">9. Log retention minimal no correlation to threat intelligence feeds</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1112,587 C 1172,577 1172,617 1112,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1112">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1000">10. No automated incident responses initiated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="1404.5" y1="665" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="595">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1003">11. Incident response is slow perpetrators remain undetected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="598" y1="713" x1="1407.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="1407.5">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="336">12. API continues to serve requests despite abnormal patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="593">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="854">13. Lacks continuous learning no model updates implemented</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="598" y1="809" x1="1110"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1110">13</text></svg></div></div><div class="el-p"><p dir="auto"><strong>Secure Implementation</strong></p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2093.5 963" height="963" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-206" style="width:2093.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="IR" height="65" width="161" stroke="#666" fill="#eaeaea" y="877" x="1832.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="1913"><tspan dy="0" x="1913">Incident Responder</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="156" stroke="#666" fill="#eaeaea" y="877" x="1206"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="1284"><tspan dy="0" x="1284">Monitoring System</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="704"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="779"><tspan dy="0" x="779">API Gateway</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="IR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="1913" y1="65" x1="1913" id="actor6176"></line><g id="root-6176"><rect class="actor actor-top" ry="3" rx="3" name="IR" height="65" width="161" stroke="#666" fill="#eaeaea" y="0" x="1832.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1913"><tspan dy="0" x="1913">Incident Responder</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="1284" y1="65" x1="1284" id="actor6175"></line><g id="root-6175"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="156" stroke="#666" fill="#eaeaea" y="0" x="1206"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1284"><tspan dy="0" x="1284">Monitoring System</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="779" y1="65" x1="779" id="actor6174"></line><g id="root-6174"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="704"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="779"><tspan dy="0" x="779">API Gateway</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="75" y1="65" x1="75" id="actor6173"></line><g id="root-6173"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-206{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-206 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-206 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-206 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-206 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-206 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-206 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-206 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-206 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-206 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-206 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-206 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-206 p{margin:0}#mermaid-6a213c2d99ee9aa5-206 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-206 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-206 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-206 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-206 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-206 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-206 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-206 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-206 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-206 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-206 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-206 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-206 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-206 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-206 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-206 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-206 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-206 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-206 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-206 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-206 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-206 .actor-man circle,#mermaid-6a213c2d99ee9aa5-206 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-206 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="426">1. Sends API requests over HTTPS with complete contextual metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="775" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="780">2. Validates source and tags requests with user/session details</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 780,161 C 840,151 840,191 780,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="780">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="1030">3. Transmits enriched, structured logs via secure channels</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1280" y1="239" x1="780"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="780">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1285">4. Applies machine learning to create dynamic baseline of normal behavior</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1285,287 C 1345,277 1345,317 1285,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1285">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1285">5. Continuously updates anomaly thresholds based on live data trends</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1285,365 C 1345,355 1345,395 1285,385"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1285">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="1033">6. Flags deviations in near real time with model-driven alerts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="443" x2="783" y1="443" x1="1283"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="447" x="1283">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1345">7. Receives automated alerts from monitoring system on detected anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1909" y1="491" x1="780"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="780">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1600">8. Triggers predefined auto-mitigation protocols (e.g., rate limiting, throttling)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1288" y1="539" x1="1912"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1912">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1348">9. Initiates immediate session isolation or blocking on abnormal traffic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="783" y1="587" x1="1912"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1912">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1285">10. Retains detailed, encrypted logs correlated with threat intelligence</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1285,635 C 1345,625 1345,665 1285,655"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1285">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1345">11. Automated incident response workflows update security policies in real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1909" y1="713" x1="780"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="780">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1600">12. Forensic engines analyze incidents generate remediation reports</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1288" y1="761" x1="1912"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1912">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="429">13. API gateway adapts routing dynamically sends advisory messages for risk mitigation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="778"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="778">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="1597">14. Model updates automatically retrain on new traffic, closing learning gaps</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="1909" y1="857" x1="1285"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="1285">14</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Traffic Ingestion</strong></td><td dir="ltr">â€¢ Unsecured HTTP, no metadata tagging<br>â€¢ Raw logs forwarded without enrichment</td><td dir="ltr">â€¢ HTTPS with complete contextual tagging; enriched structured logging</td><td dir="ltr">Enforce secure channels; tag logs with context (user/session, geo, device)</td></tr><tr><td dir="ltr"><strong>Dynamic Profiling</strong></td><td dir="ltr">â€¢ Static thresholds; no ML integration<br>â€¢ Fails to update baseline dynamically</td><td dir="ltr">â€¢ Machine learningâ€“based dynamic profiling; continuously updated anomaly thresholds</td><td dir="ltr">Use adaptive ML models for continuous monitoring</td></tr><tr><td dir="ltr"><strong>Automated Response</strong></td><td dir="ltr">â€¢ No automated alerts; manual investigation delayed<br>â€¢ Incidents ignored until major breach</td><td dir="ltr">â€¢ Real-time, automated incident response (session isolation, rate limiting) triggered based on MLâ€‘driven alerts</td><td dir="ltr">Automate incident response via SOAR; trigger remediation on anomalous behavior</td></tr><tr><td dir="ltr"><strong>Forensic &amp; Learning</strong></td><td dir="ltr">â€¢ Minimal log retention; no integration with threat intel<br>â€¢ No model updates leading to repeated vulnerabilities</td><td dir="ltr">â€¢ Encrypted, correlated logs with SIEM and threat intelligence; continuous forensic analysis and automatic model retraining</td><td dir="ltr">Maintain encrypted forensic logs and dynamically update models based on new threat patterns</td></tr></tbody></table></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Secure Access Control/Middleware" dir="auto" class="heading" id="Secure_Access_Control/Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Access Control/Middleware<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="Role-Based Access Control (RBAC) Middleware" dir="auto" class="heading" id="Role-Based_Access_Control_(RBAC)_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Role-Based Access Control (RBAC) Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement middleware that enforces RBAC across all incoming API and service requests. The solution dynamically maps usersâ€™ roles to permissions at runtime and logs every access decision through centralized policy engines.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Privilege escalation, unauthorized access via role misconfiguration, insider threats.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-162, OWASP Access Control, periodic access reviews and penetration testing of the middleware.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;IAM specialists, security architects, administrators; end-users, API consumers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ RBAC Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1492 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-212" style="width:1492px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1167"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1242"><tspan dy="0" x="1242">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="967"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1042"><tspan dy="0" x="1042">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="501"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="576"><tspan dy="0" x="576">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1242" y1="65" x1="1242" id="actor6180"></line><g id="root-6180"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1167"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1242"><tspan dy="0" x="1242">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1042" y1="65" x1="1042" id="actor6179"></line><g id="root-6179"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="967"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1042"><tspan dy="0" x="1042">Policy Engine</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="576" y1="65" x1="576" id="actor6178"></line><g id="root-6178"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="501"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="576"><tspan dy="0" x="576">Middleware</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6177"></line><g id="root-6177"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-212{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-212 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-212 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-212 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-212 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-212 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-212 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-212 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-212 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-212 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-212 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-212 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-212 p{margin:0}#mermaid-6a213c2d99ee9aa5-212 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-212 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-212 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-212 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-212 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-212 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-212 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-212 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-212 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-212 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-212 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-212 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-212 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-212 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-212 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-212 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-212 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-212 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-212 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-212 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-212 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-212 .actor-man circle,#mermaid-6a213c2d99ee9aa5-212 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-212 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="324">1. Send API request over HTTP without proper auth headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="572" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="577">2. Accept request and assign a default role ("guest")</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 577,161 C 637,151 637,191 577,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="577">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="327">3. Return response using default role mapping</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="575"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="575">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="808">4. Forward request with static role to Policy Engine</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1038" y1="287" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="577">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="811">5. Returns a fixed permission set (no dynamic checks)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="580" y1="335" x1="1041"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1041">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="577">6. Makes decision solely on default role no contextual evaluation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 577,383 C 637,373 637,413 577,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="577">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="327">7. Grants access despite potential misconfiguration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="575"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="575">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="908">8. Log access decision with minimal details (no user ID or timestamp)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1238" y1="509" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="577">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1243">9. Store plaintext log no integrity controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1243,557 C 1303,547 1303,587 1243,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1243">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="324">10. Client reuses same session no revalidation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="572" y1="635" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="808">11. Ignoring dynamic reâ€‘evaluation on subsequent calls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1038" y1="683" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="577">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="911">12. No anomaly alerts triggered on repeated default access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="580" y1="731" x1="1241"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1241">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="908">13. Audit trail remains incomplete and vulnerable</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1238" y1="779" x1="577"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="577">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ RBAC Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1706 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-214" style="width:1706px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1276"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1351"><tspan dy="0" x="1351">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1076"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1151"><tspan dy="0" x="1151">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="517"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="592"><tspan dy="0" x="592">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1351" y1="65" x1="1351" id="actor6184"></line><g id="root-6184"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1276"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1351"><tspan dy="0" x="1351">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1151" y1="65" x1="1151" id="actor6183"></line><g id="root-6183"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1076"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1151"><tspan dy="0" x="1151">Policy Engine</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="592" y1="65" x1="592" id="actor6182"></line><g id="root-6182"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="517"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="592"><tspan dy="0" x="592">Middleware</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6181"></line><g id="root-6181"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-214{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-214 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-214 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-214 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-214 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-214 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-214 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-214 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-214 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-214 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-214 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-214 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-214 p{margin:0}#mermaid-6a213c2d99ee9aa5-214 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-214 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-214 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-214 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-214 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-214 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-214 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-214 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-214 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-214 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-214 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-214 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-214 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-214 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-214 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-214 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-214 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-214 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-214 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-214 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-214 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-214 .actor-man circle,#mermaid-6a213c2d99ee9aa5-214 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-214 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="332">1. Send API request over HTTPS with valid auth and role token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="588" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="593">2. Validate client identity and extract assigned role securely</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 593,161 C 653,151 653,191 593,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="593">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="335">3. Attach verified role and context for downstream processing</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="591">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="870">4. Forward enriched request with role &amp; context to Policy Engine</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1147" y1="287" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="593">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="873">5. Evaluate dynamic policies based on role, time, location, etc.</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="596" y1="335" x1="1150"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1150">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="593">6. Make fineâ€‘grained access decision using least privilege methodology</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 593,383 C 653,373 653,413 593,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="593">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="335">7. Grant or deny request with detailed status and guidance</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="591">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="332">8. Client receives clear error messages if access is denied</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="588" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="970">9. Log full access decision with timestamp, userID, and role in encrypted storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1347" y1="557" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="593">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1352">10. Enforce integrity checks and automated anomaly detection on logs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1352,605 C 1412,595 1412,635 1352,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1352">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="870">11. Periodically revalidate roles on subsequent requests dynamically</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1147" y1="683" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="593">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="715">12. Trigger alerts upon detecting suspicious access patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="1350"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1350">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="970">13. Maintain complete audit trail for compliance and forensic analysis</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1347" y1="779" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="593">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Reception</td><td dir="ltr">â€¢ Unencrypted request<br>â€¢ Default role assignment without auth</td><td dir="ltr">â€¢ HTTPS with valid auth<br>â€¢ Role extracted from validated token</td><td dir="ltr">Use TLS; enforce proper authentication and role extraction</td></tr><tr><td dir="ltr">Policy Evaluation</td><td dir="ltr">â€¢ Static permission set<br>â€¢ No dynamic or contextual checks</td><td dir="ltr">â€¢ Dynamically evaluated policies using context (time, location, etc.)</td><td dir="ltr">Evaluate policies dynamically based on context and least privilege</td></tr><tr><td dir="ltr">Access Decision</td><td dir="ltr">â€¢ Decision solely based on defaults<br>â€¢ No user-specific adjustments</td><td dir="ltr">â€¢ Fineâ€‘grained decision using dynamic input<br>â€¢ Clear feedback on access decisions</td><td dir="ltr">Enforce least privilege and use clear roleâ€‘based decision logic</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal plaintext logging<br>â€¢ No integrity verification</td><td dir="ltr">â€¢ Encrypted, detailed logging with automated alerts and complete audit trails</td><td dir="ltr">Log all access decisions securely; integrate integrity checks and realâ€‘time alerting</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Attribute-Based Access Control (ABAC) Middleware" dir="auto" class="heading" id="Attribute-Based_Access_Control_(ABAC)_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Attribute-Based Access Control (ABAC) Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy middleware that leverages contextual attributes (user location, time, device type) to enforce access policies dynamically. Policies are managed centrally and evaluated in real time.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Context spoofing, manipulation of attribute data, insider misuse.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-162, XACML policy testing, continuous threat modeling and validation.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Policy engineers, security analysts, compliance teams; internal employees, SaaS users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ ABAC Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1530.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-219" style="width:1530.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1197"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1272"><tspan dy="0" x="1272">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="997"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1072"><tspan dy="0" x="1072">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="480"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="555"><tspan dy="0" x="555">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1272" y1="65" x1="1272" id="actor6188"></line><g id="root-6188"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1197"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1272"><tspan dy="0" x="1272">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1072" y1="65" x1="1072" id="actor6187"></line><g id="root-6187"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="997"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1072"><tspan dy="0" x="1072">Policy Engine</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="555" y1="65" x1="555" id="actor6186"></line><g id="root-6186"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="480"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="555"><tspan dy="0" x="555">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6185"></line><g id="root-6185"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-219{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-219 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-219 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-219 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-219 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-219 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-219 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-219 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-219 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-219 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-219 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-219 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-219 p{margin:0}#mermaid-6a213c2d99ee9aa5-219 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-219 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-219 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-219 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-219 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-219 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-219 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-219 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-219 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-219 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-219 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-219 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-219 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-219 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-219 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-219 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-219 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-219 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-219 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-219 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-219 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-219 .actor-man circle,#mermaid-6a213c2d99ee9aa5-219 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-219 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="314">1. Send API request over HTTP with limited attribute data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="551" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="556">2. Accept request without validating contextual attributes</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 556,161 C 616,151 616,191 556,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="556">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="317">3. Implicitly assign default attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="554"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="554">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="812">4. Forward request with minimal attribute info to Policy Engine</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1068" y1="287" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="556">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="815">5. Evaluate using static, hardcoded rules (ignores context)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="559" y1="335" x1="1071"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1071">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="556">6. Make access decision based on static attributes only</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 556,383 C 616,373 616,413 556,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="556">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="317">7. Grant access without considering dynamic context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="554"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="554">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="314">8. Reuse session no reâ€‘evaluation on changing context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="551" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="912">9. Log decision with scant attribute details in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1268" y1="557" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="556">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1273">10. No encryption or integrity check on logs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1273,605 C 1333,595 1333,635 1273,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1273">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="812">11. No periodic attribute reâ€‘validation is done</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1068" y1="683" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="556">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="675">12. No alerts on context anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="1271"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1271">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="912">13. Incomplete audit trail risk of undetected misuse</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1268" y1="779" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="556">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ ABAC Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1873 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-221" style="width:1873px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1477"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1552"><tspan dy="0" x="1552">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1277"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1352"><tspan dy="0" x="1352">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="685"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="760"><tspan dy="0" x="760">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1552" y1="65" x1="1552" id="actor6192"></line><g id="root-6192"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1477"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1552"><tspan dy="0" x="1552">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1352" y1="65" x1="1352" id="actor6191"></line><g id="root-6191"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1277"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1352"><tspan dy="0" x="1352">Policy Engine</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="760" y1="65" x1="760" id="actor6190"></line><g id="root-6190"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="685"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="760"><tspan dy="0" x="760">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6189"></line><g id="root-6189"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-221{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-221 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-221 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-221 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-221 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-221 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-221 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-221 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-221 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-221 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-221 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-221 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-221 p{margin:0}#mermaid-6a213c2d99ee9aa5-221 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-221 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-221 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-221 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-221 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-221 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-221 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-221 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-221 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-221 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-221 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-221 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-221 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-221 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-221 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-221 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-221 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-221 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-221 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-221 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-221 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-221 .actor-man circle,#mermaid-6a213c2d99ee9aa5-221 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-221 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="416">1. Send API request over HTTPS with full contextual attributes (location, device, time)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="756" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="761">2. Validate and enrich incoming attributes</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 761,161 C 821,151 821,191 761,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="761">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="419">3. Attach verified attributes to request context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="759"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="759">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1055">4. Forward enriched request to Policy Engine with complete attribute set</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1348" y1="287" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="761">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="1058">5. Dynamically evaluate policies using realâ€‘time contextual data</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="764" y1="335" x1="1351"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1351">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="761">6. Enforce access decision based on dynamic ABAC rules</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 761,383 C 821,373 821,413 761,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="761">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="419">7. Return clear access granted/denied response based on dynamic evaluation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="759"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="759">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="416">8. Require session reâ€‘validation on attribute changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="756" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1155">9. Log decision with full attribute context in encrypted log storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1548" y1="557" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="761">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1553">10. Apply integrity verification and anomaly detection on logs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1553,605 C 1613,595 1613,635 1553,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1553">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1055">11. Periodically reâ€‘validate attribute policies as context evolves</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1348" y1="683" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="761">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="815">12. Trigger alerts on any suspicious attribute inconsistencies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="1551"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1551">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="1155">13. Maintain comprehensive, tamperâ€‘proof audit trails for compliance reviews</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="1548" y1="779" x1="761"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="761">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 2</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Reception</td><td dir="ltr">â€¢ Minimal attribute data<br>â€¢ No validation/enrichment</td><td dir="ltr">â€¢ Full HTTPS-based request with complete attributes<br>â€¢ Attribute enrichment and validation</td><td dir="ltr">Collect and validate full contextual data</td></tr><tr><td dir="ltr">Attribute Evaluation</td><td dir="ltr">â€¢ Static rules; no dynamic context<br>â€¢ Hardcoded policy checks</td><td dir="ltr">â€¢ Dynamic evaluation using realâ€‘time contextual data</td><td dir="ltr">Use dynamic, contextâ€‘aware attribute evaluation</td></tr><tr><td dir="ltr">Access Decision</td><td dir="ltr">â€¢ Access decision based on defaults only</td><td dir="ltr">â€¢ Fineâ€‘grained decision incorporating dynamic attributes</td><td dir="ltr">Enforce dynamic ABAC; require periodic reâ€‘validation</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Plaintext logs without context<br>â€¢ No alerts on anomalies</td><td dir="ltr">â€¢ Encrypted, detailed logging with integrity checks and automated anomaly alerts</td><td dir="ltr">Log comprehensively and continuously monitor for context anomalies</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Zero Trust Middleware Enforcement" dir="auto" class="heading" id="Zero_Trust_Middleware_Enforcement"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Zero Trust Middleware Enforcement<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Design a middleware layer that implements Zero Trust principles by verifying every request with multi-factor authentication and continuous risk assessment before granting access.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Lateral movement, session hijacking, zero-day exploitation of trust relationships.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST Zero Trust Architecture, MITRE ATT&amp;CK assessments, continuous authentication testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;CISO, network security teams, risk analysts; all organizational users accessing sensitive resources.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Zero Trust Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1634 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-227" style="width:1634px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1246"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1321"><tspan dy="0" x="1321">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1046"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1121"><tspan dy="0" x="1121">Authenticator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="560"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="635"><tspan dy="0" x="635">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1321" y1="65" x1="1321" id="actor6196"></line><g id="root-6196"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1246"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1321"><tspan dy="0" x="1321">Logger</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1121" y1="65" x1="1121" id="actor6195"></line><g id="root-6195"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1046"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1121"><tspan dy="0" x="1121">Authenticator</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="635" y1="65" x1="635" id="actor6194"></line><g id="root-6194"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="560"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="635"><tspan dy="0" x="635">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6193"></line><g id="root-6193"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-227{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-227 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-227 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-227 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-227 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-227 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-227 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-227 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-227 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-227 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-227 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-227 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-227 p{margin:0}#mermaid-6a213c2d99ee9aa5-227 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-227 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-227 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-227 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-227 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-227 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-227 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-227 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-227 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-227 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-227 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-227 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-227 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-227 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-227 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-227 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-227 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-227 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-227 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-227 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-227 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-227 .actor-man circle,#mermaid-6a213c2d99ee9aa5-227 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-227 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="354">1. Send API request over HTTP without MFA</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="631" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="877">2. No verification of identity assume trust</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1117" y1="161" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="636">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="880">3. Returns default authentication without risk scoring</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="639" y1="209" x1="1120"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1120">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="636">4. Map user to a generic role no dynamic risk assessment</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 636,257 C 696,247 696,287 636,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="636">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="357">5. Grant access based on legacy trust relationships</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="634"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="634">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="354">6. Reuse session token across multiple requests no continuous auth</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="631" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="877">7. No reâ€‘authentication or risk reassessment is performed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1117" y1="431" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="636">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="880">8. Returns unchanged trust level</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="639" y1="479" x1="1120"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1120">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="977">9. Log access decisions with minimal context and no timestamp</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1317" y1="527" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="636">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1322">10. Logs stored in plaintext no anomaly detection triggered</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1322,575 C 1382,565 1382,605 1322,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1322">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="357">11. Subsequent access granted without additional checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="634"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="634">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="354">12. User session remains static despite contextual risk changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="631" y1="701" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="980">13. No automated alerts for potential lateral movement detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="639" y1="749" x1="1320"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1320">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Zero Trust Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1760 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-229" style="width:1760px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1334"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1409"><tspan dy="0" x="1409">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1134"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1209"><tspan dy="0" x="1209">Authenticator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="566"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="641"><tspan dy="0" x="641">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1409" y1="65" x1="1409" id="actor6200"></line><g id="root-6200"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1334"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1409"><tspan dy="0" x="1409">Logger</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1209" y1="65" x1="1209" id="actor6199"></line><g id="root-6199"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1134"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1209"><tspan dy="0" x="1209">Authenticator</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="641" y1="65" x1="641" id="actor6198"></line><g id="root-6198"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="566"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="641"><tspan dy="0" x="641">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6197"></line><g id="root-6197"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-229{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-229 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-229 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-229 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-229 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-229 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-229 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-229 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-229 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-229 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-229 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-229 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-229 p{margin:0}#mermaid-6a213c2d99ee9aa5-229 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-229 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-229 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-229 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-229 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-229 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-229 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-229 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-229 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-229 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-229 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-229 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-229 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-229 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-229 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-229 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-229 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-229 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-229 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-229 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-229 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-229 .actor-man circle,#mermaid-6a213c2d99ee9aa5-229 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-229 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="357">1. Send API request over HTTPS with MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="637" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="924">2. Validate identity with multiâ€‘factor authentication and risk scoring</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1205" y1="161" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="642">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="927">3. Return highâ€‘assurance authentication with contextual risk metrics</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="645" y1="209" x1="1208"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1208">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="642">4. Map user to specific roles with continuous risk assessment</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 642,257 C 702,247 702,287 642,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="642">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="360">5. Grant access based on dynamic, contextâ€‘aware trust levels</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="640">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="357">6. Periodic request triggers reâ€‘authentication and risk reassessment</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="637" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="924">7. Verify session integrity and update risk context based on behavior</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1205" y1="431" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="642">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="927">8. Return updated trust scores and enforce session refresh if needed</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="645" y1="479" x1="1208"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1208">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1024">9. Log each access decision with full context, encrypted and timestamped</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1405" y1="527" x1="642"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="642">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1410">10. Apply anomaly detection and correlate risk patterns automatically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1410,575 C 1470,565 1470,605 1410,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1410">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="360">11. Ensure session tokens are reissued dynamically on risk updates</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="640"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="640">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="357">12. Deny requests that fail continuous risk and authentication checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="637" y1="701" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1027">13. Trigger automated alerts via SIEM for any suspicious lateral movement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="645" y1="749" x1="1408"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1408">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 3</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Verification</td><td dir="ltr">â€¢ No MFA<br>â€¢ Default authentication with no risk scoring</td><td dir="ltr">â€¢ HTTPS with MFA<br>â€¢ Dynamic risk scoring with contextual metrics</td><td dir="ltr">Enforce MFA and continuous risk-based authentication</td></tr><tr><td dir="ltr">Trust Establishment</td><td dir="ltr">â€¢ Generic role mapping; static trust</td><td dir="ltr">â€¢ Dynamic, contextâ€‘aware trust mapping based on updated risk assessments</td><td dir="ltr">Continuously assess trust based on behavioral and contextual data</td></tr><tr><td dir="ltr">Session Reâ€‘Authentication</td><td dir="ltr">â€¢ Reuse of static session tokens with no reâ€‘evaluation</td><td dir="ltr">â€¢ Periodic reâ€‘authentication and session refresh on risk changes</td><td dir="ltr">Require continuous authentication and session refresh</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal logging; stored in plaintext; no alerts</td><td dir="ltr">â€¢ Encrypted, detailed logging with anomaly detection and realâ€‘time SIEM alerts</td><td dir="ltr">Log with full context; integrate with SIEM and trigger automated alerts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Policy-as-Code for Access Management" dir="auto" class="heading" id="Policy-as-Code_for_Access_Management"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Policy-as-Code for Access Management<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Leverage Infrastructure-as-Code (IaC) tools to define, deploy, and enforce access control policies across middleware components automatically as code.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Misconfiguration attacks, supply chain compromise, configuration drift.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;CIS Benchmarks, Terraform/Sentinel policy testing frameworks, GitOps reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevOps, SecOps, policy managers; developers, operations teams.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Policyâ€‘asâ€‘Code</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1733 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-235" style="width:1733px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1483"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1558"><tspan dy="0" x="1558">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1037"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1112"><tspan dy="0" x="1112">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="586"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="661"><tspan dy="0" x="661">CI/CD Pipeline</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1558" y1="65" x1="1558" id="actor6204"></line><g id="root-6204"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1483"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1558"><tspan dy="0" x="1558">Logger</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1112" y1="65" x1="1112" id="actor6203"></line><g id="root-6203"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1037"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1112"><tspan dy="0" x="1112">Middleware</tspan></text></g></g><g><line name="CI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="661" y1="65" x1="661" id="actor6202"></line><g id="root-6202"><rect class="actor actor-top" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="586"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="661"><tspan dy="0" x="661">CI/CD Pipeline</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6201"></line><g id="root-6201"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-235{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-235 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-235 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-235 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-235 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-235 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-235 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-235 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-235 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-235 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-235 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-235 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-235 p{margin:0}#mermaid-6a213c2d99ee9aa5-235 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-235 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-235 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-235 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-235 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-235 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-235 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-235 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-235 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-235 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-235 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-235 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-235 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-235 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-235 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-235 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-235 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-235 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-235 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-235 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-235 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-235 .actor-man circle,#mermaid-6a213c2d99ee9aa5-235 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-235 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="367">1. Push access control definitions in plain text IaC scripts (no validation)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="657" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="662">2. Deploy policy without automated security tests</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 662,161 C 722,151 722,191 662,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="662">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="885">3. Apply policies using default configurations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1108" y1="239" x1="662"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="662">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1113">4. Enforce policies with no version control configuration drift occurs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1113,287 C 1173,277 1173,317 1113,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1113">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="595">5. Accept changes without proper review or testing</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="79" y1="365" x1="1111"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1111">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="367">6. Detect misconfigurations manually delayed corrections</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="657" y1="413" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1334">7. Log policy changes without automated audit trails</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1554" y1="461" x1="1113"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1113">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1337">8. No automated alerts on policy violations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1116" y1="509" x1="1557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1557">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="888">9. Access persists even if policies are outdated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="665" y1="557" x1="1111"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1111">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="885">10. No integration with downstream security controls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1108" y1="605" x1="662"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="662">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="818">11. Manual audits triggered infrequently</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="1557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1557">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="595">12. Configuration drift remains, enabling potential exploitation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1111"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1111">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1337">13. No realâ€‘time forensic analysis on policy changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1116" y1="749" x1="1557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1557">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Policyâ€‘asâ€‘Code</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2031 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-237" style="width:2031px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1629"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1704"><tspan dy="0" x="1704">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1064"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1139"><tspan dy="0" x="1139">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="489"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="564"><tspan dy="0" x="564">CI/CD Pipeline</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1704" y1="65" x1="1704" id="actor6208"></line><g id="root-6208"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1629"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1704"><tspan dy="0" x="1704">Logger</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1139" y1="65" x1="1139" id="actor6207"></line><g id="root-6207"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1064"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1139"><tspan dy="0" x="1139">Middleware</tspan></text></g></g><g><line name="CI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="564" y1="65" x1="564" id="actor6206"></line><g id="root-6206"><rect class="actor actor-top" ry="3" rx="3" name="CI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="489"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="564"><tspan dy="0" x="564">CI/CD Pipeline</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6205"></line><g id="root-6205"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-237{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-237 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-237 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-237 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-237 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-237 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-237 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-237 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-237 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-237 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-237 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-237 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-237 p{margin:0}#mermaid-6a213c2d99ee9aa5-237 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-237 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-237 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-237 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-237 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-237 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-237 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-237 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-237 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-237 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-237 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-237 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-237 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-237 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-237 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-237 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-237 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-237 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-237 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-237 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-237 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-237 .actor-man circle,#mermaid-6a213c2d99ee9aa5-237 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-237 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="318">1. Push IaC access policies with version control and linting</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="560" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="565">2. Run automated static analysis (Terraform/Sentinel tests)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 565,161 C 625,151 625,191 565,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="565">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="850">3. Deploy policies only after passing security validations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1135" y1="239" x1="565"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="565">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1140">4. Enforce policies via automated configuration management (GitOps)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1140,287 C 1200,277 1200,317 1140,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1140">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="609">5. Notify developers of any policy deviations immediately</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="79" y1="365" x1="1138"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1138">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="853">6. Autoâ€‘reconcile configurations if drift is detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="568" y1="413" x1="1138"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1138">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="850">7. Update policies dynamically based on current compliance baselines</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1135" y1="461" x1="565"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="565">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1420">8. Log all policy enforcement decisions in secure, immutable storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1700" y1="509" x1="1140"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1140">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1705">9. Apply realâ€‘time anomaly detection and version comparisons</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1705,557 C 1765,547 1765,587 1705,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1705">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="609">10. Trigger automated alerts on any unauthorized changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="1138"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1138">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1136">11. Correlate policy changes with incident data in SIEM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="568" y1="683" x1="1703"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1703">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="850">12. Enforce automated rollback on nonâ€‘compliant changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1135" y1="731" x1="565"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="565">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="891">13. Provide complete audit trails for compliance reviews</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="1703"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1703">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 4</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Code Definition</td><td dir="ltr">â€¢ Plain text IaC with no validation<br>â€¢ No automated tests for access policies</td><td dir="ltr">â€¢ Versionâ€‘controlled IaC with linting and automated testing<br>â€¢ Policies deployed after security tests</td><td dir="ltr">Enforce IaC best practices and integrate automated testing (e.g., Sentinel)</td></tr><tr><td dir="ltr">Enforcement</td><td dir="ltr">â€¢ Inconsistent enforcement; drift occurs<br>â€¢ No automatic review</td><td dir="ltr">â€¢ Consistent, GitOpsâ€‘driven enforcement with dynamic updates</td><td dir="ltr">Use automated configuration management to maintain policy consistency</td></tr><tr><td dir="ltr">Remediation</td><td dir="ltr">â€¢ Manual remediation; delayed detection of drift</td><td dir="ltr">â€¢ Automated drift detection and instantaneous remediation</td><td dir="ltr">Enable automated drift correction and rollback on failures</td></tr><tr><td dir="ltr">Monitoring &amp; Audit</td><td dir="ltr">â€¢ Minimal logging; no realâ€‘time alerts; manual audits</td><td dir="ltr">â€¢ Immutable, encrypted logs; continuous SIEM integration; automated forensic analysis</td><td dir="ltr">Integrate continuous monitoring and forensic audit systems</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Multi-Factor Authentication (MFA) Middleware Integration" dir="auto" class="heading" id="Multi-Factor_Authentication_(MFA)_Middleware_Integration"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Multi-Factor Authentication (MFA) Middleware Integration<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Integrate MFA challenges into the middleware such that sensitive operations require an extra authentication step. This includes OTPs, biometrics, or hardware token verification before sessions are established.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Password guessing, session hijacking, credential stuffing.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-63B, OWASP Multi-Factor Authentication guidelines, regular phishing simulations.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Identity and Access Management teams, mobile security engineers; privileged users, remote workforce.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ MFA Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1644 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-243" style="width:1644px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1277"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1352"><tspan dy="0" x="1352">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1152"><tspan dy="0" x="1152">Authenticator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="552"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="627"><tspan dy="0" x="627">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1352" y1="65" x1="1352" id="actor6212"></line><g id="root-6212"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1277"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1352"><tspan dy="0" x="1352">Logger</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1152" y1="65" x1="1152" id="actor6211"></line><g id="root-6211"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1152"><tspan dy="0" x="1152">Authenticator</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="627" y1="65" x1="627" id="actor6210"></line><g id="root-6210"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="552"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="627"><tspan dy="0" x="627">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6209"></line><g id="root-6209"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-243{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-243 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-243 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-243 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-243 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-243 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-243 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-243 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-243 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-243 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-243 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-243 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-243 p{margin:0}#mermaid-6a213c2d99ee9aa5-243 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-243 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-243 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-243 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-243 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-243 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-243 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-243 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-243 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-243 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-243 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-243 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-243 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-243 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-243 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-243 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-243 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-243 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-243 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-243 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-243 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-243 .actor-man circle,#mermaid-6a213c2d99ee9aa5-243 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-243 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="350">1. Send login request over HTTP without MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="623" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="888">2. Verify static credentials with no secondary factor</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1148" y1="161" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="628">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="891">3. Return basic session token without additional checks</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="631" y1="209" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1151">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="353">4. Establish session using token transmitted in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="626"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="626">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="350">5. Proceed with sensitive operations using same token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="623" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="350">6. Request access to sensitive operation without MFA reâ€‘challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="623" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="888">7. No secondary authentication triggered static token accepted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1148" y1="401" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="628">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="891">8. Validate access solely on original credential</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="449" x2="631" y1="449" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1151">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="988">9. Log authentication events with minimal details (no MFA event)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1348" y1="497" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="628">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1353">10. Store logs in plaintext no trace of MFA challenges</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1353,545 C 1413,535 1413,575 1353,565"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1353">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="350">11. Reuse session for subsequent sensitive requests insecurely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="623" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="888">12. No dynamic reâ€‘authentication on each sensitive operation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="1148" y1="671" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="628">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="991">13. No alerts on brute-force or credential stuffing attempts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="631" y1="719" x1="1351"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="1351">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ MFA Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1756 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-245" style="width:1756px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1329"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1404"><tspan dy="0" x="1404">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1129"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1204"><tspan dy="0" x="1204">Authenticator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="654"><tspan dy="0" x="654">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1404" y1="65" x1="1404" id="actor6216"></line><g id="root-6216"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1329"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1404"><tspan dy="0" x="1404">Logger</tspan></text></g></g><g><line name="AA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1204" y1="65" x1="1204" id="actor6215"></line><g id="root-6215"><rect class="actor actor-top" ry="3" rx="3" name="AA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1129"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1204"><tspan dy="0" x="1204">Authenticator</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="654" y1="65" x1="654" id="actor6214"></line><g id="root-6214"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="579"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="654"><tspan dy="0" x="654">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6213"></line><g id="root-6213"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-245{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-245 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-245 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-245 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-245 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-245 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-245 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-245 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-245 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-245 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-245 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-245 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-245 p{margin:0}#mermaid-6a213c2d99ee9aa5-245 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-245 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-245 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-245 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-245 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-245 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-245 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-245 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-245 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-245 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-245 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-245 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-245 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-245 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-245 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-245 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-245 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-245 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-245 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-245 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-245 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-245 .actor-man circle,#mermaid-6a213c2d99ee9aa5-245 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-245 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="363">1. Send login request over HTTPS with primary credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="650" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="928">2. Trigger MFA challenge (OTP/biometric/hardware token)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1200" y1="161" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="655">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="931">3. Validate secondary factor and return highâ€‘assurance token</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="658" y1="209" x1="1203"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1203">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="366">4. Establish session with token bound to MFA event (sent over HTTPS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="653"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="653">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="363">5. Perform sensitive operations using refreshed tokens</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="650" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="363">6. Attempt sensitive transaction triggering another MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="650" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="928">7. Validate secondary factor for privileged access in real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1200" y1="401" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="655">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="931">8. Return updated token with elevated privileges and short lifetime</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="449" x2="658" y1="449" x1="1203"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1203">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="363">9. Use updated token session reâ€‘authenticated on sensitive actions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="650" y1="497" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1028">10. Log each MFA event with detailed, encrypted metadata and timestamps</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="545" x2="1400" y1="545" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="655">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="1405">11. Enforce integrity checks and continuous monitoring of MFA events</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1405,593 C 1465,583 1465,623 1405,613"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="1405">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="928">12. Periodically force reâ€‘authentication on prolonged sessions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="1200" y1="671" x1="655"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="655">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="1031">13. Trigger automated alerts on abnormal MFA patterns or failures</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="658" y1="719" x1="1403"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="1403">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 5</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Initial Authentication</td><td dir="ltr">â€¢ Login over HTTP with static credentials<br>â€¢ No MFA enforced</td><td dir="ltr">â€¢ HTTPS-login with MFA challenge (OTP/biometric/token)</td><td dir="ltr">Always enforce MFA on initial login over secure channels</td></tr><tr><td dir="ltr">Session Establishment</td><td dir="ltr">â€¢ Use static, longâ€‘lived token; session established insecurely</td><td dir="ltr">â€¢ Bind session token to MFA event with short lifetime; transmitted over HTTPS</td><td dir="ltr">Tie session tokens to MFA events; refresh tokens frequently</td></tr><tr><td dir="ltr">Privileged Actions</td><td dir="ltr">â€¢ No MFA challenge on sensitive actions; reâ€‘use same token</td><td dir="ltr">â€¢ Trigger contextual MFA challenge before performing sensitive operations</td><td dir="ltr">Require dynamic MFA for highâ€‘risk/privileged actions</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal logging; plaintext logs; no MFA event trace</td><td dir="ltr">â€¢ Detailed, encrypted logs including MFA challenge events; automated alerts on anomalies</td><td dir="ltr">Log all authentication events securely; integrate with SIEM for continuous monitoring</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Context-Aware Access Middleware" dir="auto" class="heading" id="Context-Aware_Access_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Context-Aware Access Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy middleware that considers real-time context signals (such as endpoint security status from MDM/EDR/XDR) to determine if access should be granted or if additional verification is needed.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Device spoofing, endpoint compromise, bypassing context checks.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;CIS Controls, NIST SP 800-171, endpoint security integration testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Endpoint security teams, IT administrators; remote users, BYOD scenarios.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Contextâ€‘Aware Access</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1647.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-251" style="width:1647.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1294"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1369"><tspan dy="0" x="1369">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ED" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1094"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1169"><tspan dy="0" x="1169">Endpoint Monitor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="574"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="649"><tspan dy="0" x="649">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1369" y1="65" x1="1369" id="actor6220"></line><g id="root-6220"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1294"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1369"><tspan dy="0" x="1369">Logger</tspan></text></g></g><g><line name="ED" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1169" y1="65" x1="1169" id="actor6219"></line><g id="root-6219"><rect class="actor actor-top" ry="3" rx="3" name="ED" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1094"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1169"><tspan dy="0" x="1169">Endpoint Monitor</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="649" y1="65" x1="649" id="actor6218"></line><g id="root-6218"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="574"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="649"><tspan dy="0" x="649">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6217"></line><g id="root-6217"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-251{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-251 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-251 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-251 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-251 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-251 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-251 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-251 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-251 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-251 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-251 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-251 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-251 p{margin:0}#mermaid-6a213c2d99ee9aa5-251 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-251 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-251 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-251 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-251 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-251 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-251 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-251 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-251 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-251 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-251 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-251 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-251 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-251 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-251 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-251 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-251 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-251 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-251 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-251 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-251 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-251 .actor-man circle,#mermaid-6a213c2d99ee9aa5-251 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-251 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="361">1. Send API request over HTTP with minimal context info</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="645" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="650">2. Accept request without verifying device posture</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 650,161 C 710,151 710,191 650,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="650">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="364">3. Route request to backend with default trust</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="648"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="648">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="908">4. Forward request but use stale context from a cached profile</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1165" y1="287" x1="650"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="650">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="911">5. Return generic, nonâ€‘dynamic endpoint status (e.g. â€œOKâ€)</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="653" y1="335" x1="1168"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1168">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="650">6. Ignore differences between secure and compromised devices</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 650,383 C 710,373 710,413 650,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="650">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="364">7. Grant access based solely on basic IP and user agent string</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="648"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="648">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="361">8. User continues interaction no dynamic reâ€‘evaluation triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="645" y1="509" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1008">9. Log request details with fixed context tags (no MDM/EDR info)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1365" y1="557" x1="650"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="650">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1370">10. Write plaintext logs with incomplete metadata</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1370,605 C 1430,595 1430,635 1370,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1370">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1008">11. No trigger for additional verification on abnormal signatures</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1365" y1="683" x1="650"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="650">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1011">12. No realâ€‘time alert generated on inconsistent context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="653" y1="731" x1="1368"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1368">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="364">13. Subsequent requests processed identically without further checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="648"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="648">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Contextâ€‘Aware Access</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1903.5 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-253" style="width:1903.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1482"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1557"><tspan dy="0" x="1557">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ED" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1282"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1357"><tspan dy="0" x="1357">Endpoint Monitor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="640"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="715"><tspan dy="0" x="715">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1557" y1="65" x1="1557" id="actor6224"></line><g id="root-6224"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1482"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1557"><tspan dy="0" x="1557">Logger</tspan></text></g></g><g><line name="ED" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1357" y1="65" x1="1357" id="actor6223"></line><g id="root-6223"><rect class="actor actor-top" ry="3" rx="3" name="ED" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1282"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1357"><tspan dy="0" x="1357">Endpoint Monitor</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="715" y1="65" x1="715" id="actor6222"></line><g id="root-6222"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="640"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="715"><tspan dy="0" x="715">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6221"></line><g id="root-6221"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-253{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-253 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-253 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-253 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-253 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-253 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-253 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-253 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-253 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-253 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-253 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-253 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-253 p{margin:0}#mermaid-6a213c2d99ee9aa5-253 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-253 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-253 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-253 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-253 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-253 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-253 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-253 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-253 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-253 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-253 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-253 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-253 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-253 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-253 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-253 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-253 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-253 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-253 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-253 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-253 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-253 .actor-man circle,#mermaid-6a213c2d99ee9aa5-253 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-253 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="394">1. Send API request over HTTPS with complete context (device ID, MDM token)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="711" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="716">2. Validate TLS session and extract security context</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 716,161 C 776,151 776,191 716,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="716">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="397">3. Attach secure nonce and context header for further evaluation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="714"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="714">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1035">4. Query live endpoint security status (EDR/XDR/MDM) in real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1353" y1="287" x1="716"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="716">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="1038">5. Return current posture such as OS version, patch level, security agent status</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="335" x2="719" y1="335" x1="1356"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1356">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="716">6. Compare live results against trusted profiles dynamically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 716,383 C 776,373 776,413 716,403"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="716">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="397">7. Evaluate risk and enforce additional MFA/challenge if context is borderline</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="79" y1="461" x1="714"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="714">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="397">8. Deny or permit access based on dynamic risk score computed per request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="79" y1="509" x1="714"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="714">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="394">9. User receives clear feedback if extra verification is required</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="711" y1="557" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1135">10. Log each access decision with rich context (MDM/EDR data, timestamps) in encrypted logs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1553" y1="605" x1="716"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="716">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1558">11. Apply automated integrity checks and anomaly detection on logs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1558,653 C 1618,643 1618,683 1558,673"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1558">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1135">12. Trigger realâ€‘time SIEM alerts on context mismatches or suspicious device posture</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1553" y1="731" x1="716"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="716">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="818">13. Maintain complete audit trail for compliance and forensic analysis</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="1556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1556">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Reception</td><td dir="ltr">â€¢ Minimal context over HTTP<br>â€¢ No device posture validation</td><td dir="ltr">â€¢ Full HTTPS with complete context data<br>â€¢ Validate device identity &amp; MDM token</td><td dir="ltr">Use secure channels; require complete endpoint context</td></tr><tr><td dir="ltr">Context Evaluation</td><td dir="ltr">â€¢ Cached/stale context<br>â€¢ Generic â€œOKâ€ response to context query</td><td dir="ltr">â€¢ Realâ€‘time query to EDR/MDM<br>â€¢ Dynamic evaluation against live, trusted device profiles</td><td dir="ltr">Query live context and compare against trusted profiles</td></tr><tr><td dir="ltr">Access Decision</td><td dir="ltr">â€¢ Grant access with basic IP/user agent check</td><td dir="ltr">â€¢ Enforce fineâ€‘grained risk-based challenges; add MFA for borderline cases</td><td dir="ltr">Use dynamic risk scoring and challenge extra factors if needed</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Plaintext logs with limited metadata<br>â€¢ No automated alerts</td><td dir="ltr">â€¢ Encrypted, detailed logging with SIEM integration<br>â€¢ Realâ€‘time alerts on context anomalies</td><td dir="ltr">Log rich access details securely and integrate continuous anomaly detection</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Dynamic Session Management and Token Rotation Middleware" dir="auto" class="heading" id="Dynamic_Session_Management_and_Token_Rotation_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Dynamic Session Management and Token Rotation Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Create middleware that manages session lifecycle actively by rotating tokens frequently, enforcing short token lifetimes, and continuously validating session activity.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Session fixation, replay attacks, token hijacking.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;OWASP Session Management Cheat Sheet, JWT Best Practices, periodic token replay testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Application security engineers, network operators; enterprise users, API consumers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Dynamic Session Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1750 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-258" style="width:1750px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1336"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1411"><tspan dy="0" x="1411">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1136"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1211"><tspan dy="0" x="1211">Session Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="613"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="688"><tspan dy="0" x="688">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1411" y1="65" x1="1411" id="actor6228"></line><g id="root-6228"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1336"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1411"><tspan dy="0" x="1411">Logger</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1211" y1="65" x1="1211" id="actor6227"></line><g id="root-6227"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1136"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1211"><tspan dy="0" x="1211">Session Manager</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="688" y1="65" x1="688" id="actor6226"></line><g id="root-6226"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="613"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="688"><tspan dy="0" x="688">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6225"></line><g id="root-6225"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-258{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-258 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-258 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-258 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-258 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-258 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-258 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-258 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-258 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-258 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-258 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-258 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-258 p{margin:0}#mermaid-6a213c2d99ee9aa5-258 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-258 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-258 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-258 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-258 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-258 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-258 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-258 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-258 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-258 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-258 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-258 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-258 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-258 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-258 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-258 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-258 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-258 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-258 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-258 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-258 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-258 .actor-man circle,#mermaid-6a213c2d99ee9aa5-258 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-258 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="380">1. Send login request over HTTP without proper session binding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="684" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="948">2. Create session using static token with long lifetime</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1207" y1="161" x1="689"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="689">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="951">3. Return session token without rotation metadata</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="692" y1="209" x1="1210"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1210">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="383">4. Establish session and reuse token for all transactions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="687"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="687">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="380">5. Transmit token in subsequent requests over insecure channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="684" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="948">6. Validate token purely by matching fixed value</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1207" y1="353" x1="689"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="689">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="951">7. No reâ€‘generation or short expiry enforced</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="401" x2="692" y1="401" x1="1210"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1210">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="380">8. Use the same token for privileged operations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="684" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="948">9. No reâ€‘authentication or token refresh upon sensitive actions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1207" y1="497" x1="689"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="689">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="951">10. Accepts token without reevaluating session risk</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="692" y1="545" x1="1210"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1210">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="1048">11. Log session events with minimal token lifecycle details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="1407" y1="593" x1="689"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="689">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="1412">12. Logs stored in plaintext no token rotation audit trail maintained</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1412,641 C 1472,631 1472,671 1412,661"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="1412">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="383">13. Continues to allow requests on stale tokens despite detected anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="687"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="687">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Dynamic Session Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2060 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-260" style="width:2060px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1683"><tspan dy="0" x="1683">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1408"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1483"><tspan dy="0" x="1483">Session Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="766"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="841"><tspan dy="0" x="841">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1683" y1="65" x1="1683" id="actor6232"></line><g id="root-6232"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1683"><tspan dy="0" x="1683">Logger</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1483" y1="65" x1="1483" id="actor6231"></line><g id="root-6231"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1408"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1483"><tspan dy="0" x="1483">Session Manager</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="841" y1="65" x1="841" id="actor6230"></line><g id="root-6230"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="766"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="841"><tspan dy="0" x="841">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6229"></line><g id="root-6229"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-260{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-260 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-260 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-260 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-260 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-260 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-260 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-260 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-260 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-260 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-260 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-260 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-260 p{margin:0}#mermaid-6a213c2d99ee9aa5-260 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-260 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-260 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-260 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-260 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-260 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-260 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-260 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-260 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-260 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-260 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-260 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-260 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-260 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-260 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-260 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-260 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-260 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-260 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-260 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-260 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-260 .actor-man circle,#mermaid-6a213c2d99ee9aa5-260 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-260 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="457">1. Send login request over HTTPS with MFA and device binding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="837" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1161">2. Create session with a cryptographically strong token and short lifetime</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1479" y1="161" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="842">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1164">3. Return token with metadata for rotation and expiry</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="845" y1="209" x1="1482"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1482">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="460">4. Establish session with token transmitted securely and bound to the session</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="840"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="840">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="457">5. Transmit token in each request over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="837" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="1161">6. Validate token with current expiry and risk score check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="1479" y1="353" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="842">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="1164">7. Trigger automatic token rotation if near expiry or suspicious activity detected</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="401" x2="845" y1="401" x1="1482"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="1482">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="457">8. Request sensitive transaction triggering mandatory reâ€‘authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="837" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1161">9. Enforce token refresh and generate a new token after successful reâ€‘auth</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1479" y1="497" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="842">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1164">10. Issue a shortâ€‘lived token with elevated privileges after risk verification</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="545" x2="845" y1="545" x1="1482"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1482">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="560" x="1261">11. Log every session token event with timestamps and rotation details (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="593" x2="1679" y1="593" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="597" x="842">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="608" x="1684">12. Apply realâ€‘time anomaly detection and alert on replay or misuse patterns</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1684,641 C 1744,631 1744,671 1684,661"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="645" x="1684">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="460">13. Deny requests using tokens past their rotation window feedback provided via secure channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="840"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="840">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 8</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Session Initialization</td><td dir="ltr">â€¢ Static, longâ€‘lived tokens over HTTP<br>â€¢ No bindings or rotation</td><td dir="ltr">â€¢ HTTPS with MFA; strong token with short lifetime and rotation metadata</td><td dir="ltr">Issue shortâ€‘lived tokens bound with device/session data; enforce MFA at login</td></tr><tr><td dir="ltr">Token Transmission</td><td dir="ltr">â€¢ Token validated only by fixed value<br>â€¢ Insecure channel; no rotation</td><td dir="ltr">â€¢ Validate token against expiry and risk; rotate tokens automatically upon nearing expiry</td><td dir="ltr">Validate tokens continuously and enforce automated rotation</td></tr><tr><td dir="ltr">Privileged Actions</td><td dir="ltr">â€¢ No reâ€‘authentication on sensitive operations</td><td dir="ltr">â€¢ Force reâ€‘authentication and token refresh for privileged actions</td><td dir="ltr">Require additional reâ€‘auth for sensitive operations</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal plaintext logging; no trace of token lifecycle</td><td dir="ltr">â€¢ Encrypted, detailed logging; automated SIEM alerts on replay/hijacking detected</td><td dir="ltr">Log each token event securely with continuous audit and SIEM integration</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Identity Federation and SSO Middleware" dir="auto" class="heading" id="Identity_Federation_and_SSO_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Identity Federation and SSO Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement middleware that integrates with federated identity providers to allow Single Sign-On (SSO) across multiple domains, ensuring seamless identity propagation and role-based delegation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Federation hijacking, SAML/OIDC injection, misconfiguration of cross-domain policies.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;SAML/OIDC testing guidelines, CSA Cloud Controls Matrix, regular identity federation assessments.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;IAM specialists, security architects; external partners, multi-cloud users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Identity Federation and SSO</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1758.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-266" style="width:1758.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1367"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1442"><tspan dy="0" x="1442">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1167"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1242"><tspan dy="0" x="1242">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="620"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="695"><tspan dy="0" x="695">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1442" y1="65" x1="1442" id="actor6236"></line><g id="root-6236"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1367"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1442"><tspan dy="0" x="1442">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1242" y1="65" x1="1242" id="actor6235"></line><g id="root-6235"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1167"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1242"><tspan dy="0" x="1242">Identity Provider</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="695" y1="65" x1="695" id="actor6234"></line><g id="root-6234"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="620"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="695"><tspan dy="0" x="695">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6233"></line><g id="root-6233"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-266{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-266 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-266 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-266 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-266 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-266 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-266 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-266 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-266 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-266 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-266 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-266 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-266 p{margin:0}#mermaid-6a213c2d99ee9aa5-266 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-266 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-266 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-266 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-266 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-266 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-266 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-266 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-266 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-266 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-266 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-266 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-266 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-266 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-266 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-266 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-266 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-266 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-266 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-266 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-266 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-266 .actor-man circle,#mermaid-6a213c2d99ee9aa5-266 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-266 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="384">1. Send SSO authentication request over HTTP without secure token binding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="691" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="967">2. Forward request without enforcing strict SAML/OIDC assertions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1238" y1="161" x1="696"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="696">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="970">3. Return token with minimal validation and static attributes</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="699" y1="209" x1="1241"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1241">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="387">4. Pass static token across domains without re-signing</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="694">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="384">5. Use token across multiple applications without domain checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="691" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="696">6. Process role delegation using default trust no granular access controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 696,353 C 756,343 756,383 696,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="696">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="387">7. Grant crossâ€‘domain access without verifying scopes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="694">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1067">8. Log federation events with limited auditing (plaintext)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1438" y1="479" x1="696"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="696">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1443">9. Logs lack timestamps, token details, and integrity checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1443,527 C 1503,517 1503,557 1443,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1443">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="387">10. Token misuse not detected in real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="79" y1="605" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="694">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="384">11. Requests using misconfigured tokens are accepted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="691" y1="653" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1070">12. No automated reviews of crossâ€‘domain authentication anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="699" y1="701" x1="1441"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1441">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="387">13. Federation remains vulnerable to hijacking attempts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="694">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Identity Federation and SSO</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1764.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-268" style="width:1764.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1337"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1412"><tspan dy="0" x="1412">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1137"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1212"><tspan dy="0" x="1212">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="600"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="675"><tspan dy="0" x="675">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1412" y1="65" x1="1412" id="actor6240"></line><g id="root-6240"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1337"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1412"><tspan dy="0" x="1412">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1212" y1="65" x1="1212" id="actor6239"></line><g id="root-6239"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1137"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1212"><tspan dy="0" x="1212">Identity Provider</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="675" y1="65" x1="675" id="actor6238"></line><g id="root-6238"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="600"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="675"><tspan dy="0" x="675">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6237"></line><g id="root-6237"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-268{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-268 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-268 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-268 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-268 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-268 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-268 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-268 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-268 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-268 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-268 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-268 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-268 p{margin:0}#mermaid-6a213c2d99ee9aa5-268 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-268 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-268 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-268 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-268 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-268 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-268 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-268 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-268 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-268 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-268 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-268 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-268 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-268 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-268 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-268 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-268 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-268 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-268 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-268 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-268 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-268 .actor-man circle,#mermaid-6a213c2d99ee9aa5-268 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-268 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="374">1. Send SSO request over HTTPS with signed SAML/OIDC assertions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="671" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="942">2. Forward request with strict audience and temporal constraints</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1208" y1="161" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="676">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="945">3. Return a signed token with rich attributes and dynamic roles</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="679" y1="209" x1="1211"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1211">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="377">4. Pass reâ€‘signed, domainâ€‘bound token across applications</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="674"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="674">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="374">5. Use token in a multiâ€‘domain environment token binding enforced</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="671" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="676">6. Evaluate role delegation with attribute and context checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 676,353 C 736,343 736,383 676,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="676">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="377">7. Grant or deny access based on granular scopes and least privilege</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="674"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="674">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="374">8. Dynamic token refresh triggered on scope changes or revocations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="671" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1042">9. Log all federation events with encrypted, detailed metadata and timestamps</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1408" y1="527" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="676">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1413">10. Apply realâ€‘time anomaly detection and correlation with threat intel</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1413,575 C 1473,565 1473,605 1413,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1413">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="377">11. Deny requests on token misuse immediately via SIEM integrated alerts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="674"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="674">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1045">12. Automated audits ensure compliance with federation policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="679" y1="701" x1="1411"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1411">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="377">13. Provide clear guidance on SSO usage via secure response headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="674"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="674">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 9</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Federated Reception</td><td dir="ltr">â€¢ HTTP without secure binding<br>â€¢ Minimal SAML/OIDC validation</td><td dir="ltr">â€¢ HTTPS with signed assertions<br>â€¢ Enforce audience and temporal constraints</td><td dir="ltr">Use signed assertions over secure channels; enforce strict federation criteria</td></tr><tr><td dir="ltr">Token Propagation</td><td dir="ltr">â€¢ Pass static tokens across domains</td><td dir="ltr">â€¢ Reâ€‘sign tokens with domain binding; enforce token binding</td><td dir="ltr">Reâ€‘sign and bind tokens to domain; enforce token integrity across environments</td></tr><tr><td dir="ltr">Role Delegation Check</td><td dir="ltr">â€¢ Default trust; no granular scopes</td><td dir="ltr">â€¢ Evaluate delegation with context, dynamic roles, and least privilege</td><td dir="ltr">Use granular, attributeâ€‘based delegation and dynamic token refresh</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal, plaintext logs; no realâ€‘time alerts</td><td dir="ltr">â€¢ Encrypted, detailed logging with automated SIEM alerts</td><td dir="ltr">Log comprehensively and correlate federation events with SIEM</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Microservices Communication via Service Mesh" dir="auto" class="heading" id="Secure_Microservices_Communication_via_Service_Mesh"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Microservices Communication via Service Mesh<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Use a service mesh that provides secure, encrypted communication between microservices using mutual TLS and centralized policy enforcement to control access at the service level.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Inter-service man-in-the-middle, lateral movement, misdirected requests.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;Istio security best practices, CNCF guidelines, continuous service mesh policy auditing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Cloud architects, DevOps engineers; internal service-to-service communications, microservice developers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Service Mesh Communication</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1644.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-274" style="width:1644.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1300.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1375.5"><tspan dy="0" x="1375.5">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="S2" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1071"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1146"><tspan dy="0" x="1146">Service B</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="560"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="635"><tspan dy="0" x="635">Service Mesh</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="S1" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Service A</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1375.5" y1="65" x1="1375.5" id="actor6244"></line><g id="root-6244"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1300.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1375.5"><tspan dy="0" x="1375.5">Logger</tspan></text></g></g><g><line name="S2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1146" y1="65" x1="1146" id="actor6243"></line><g id="root-6243"><rect class="actor actor-top" ry="3" rx="3" name="S2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1071"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1146"><tspan dy="0" x="1146">Service B</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="635" y1="65" x1="635" id="actor6242"></line><g id="root-6242"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="560"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="635"><tspan dy="0" x="635">Service Mesh</tspan></text></g></g><g><line name="S1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6241"></line><g id="root-6241"><rect class="actor actor-top" ry="3" rx="3" name="S1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Service A</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-274{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-274 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-274 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-274 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-274 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-274 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-274 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-274 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-274 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-274 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-274 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-274 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-274 p{margin:0}#mermaid-6a213c2d99ee9aa5-274 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-274 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-274 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-274 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-274 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-274 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-274 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-274 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-274 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-274 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-274 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-274 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-274 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-274 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-274 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-274 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-274 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-274 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-274 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-274 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-274 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-274 .actor-man circle,#mermaid-6a213c2d99ee9aa5-274 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-274 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="354">1. Send interâ€‘service request over unencrypted channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="631" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="357">2. Accept request without mutual TLS handshake</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="634"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="634">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="889">3. Forward request without verifying certificate authenticity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="1142" y1="209" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="636">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="889">4. No fineâ€‘grained policy enforcement use open routing rules</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1142" y1="257" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="636">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="1147">5. Process request with legacy access controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1147,305 C 1207,295 1207,335 1147,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1147">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="892">6. Send response with plaintext sensitive data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="639" y1="383" x1="1145"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1145">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="357">7. Relay response without reâ€‘encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="634"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="634">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="354">8. Continuously reuse same channels no dynamic certificate refresh</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="631" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1004">9. Log basic routing events with no security context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1371.5" y1="527" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="636">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1377">10. Store logs unencrypted no integrity checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1376.5,575 C 1436.5,565 1436.5,605 1376.5,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1376.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="892">11. No anomaly detection on interâ€‘service traffic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="639" y1="653" x1="1145"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1145">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1004">12. No automated alerts on misdirected requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="1371.5" y1="701" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="636">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1007">13. Logs do not trigger forensic review on lateral movement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="639" y1="749" x1="1374.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1374.5">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Service Mesh Communication</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1794.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-276" style="width:1794.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1414"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1489"><tspan dy="0" x="1489">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="S2" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1152"><tspan dy="0" x="1152">Service B</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="562"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="637"><tspan dy="0" x="637">Service Mesh</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="S1" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Service A</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1489" y1="65" x1="1489" id="actor6248"></line><g id="root-6248"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1414"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1489"><tspan dy="0" x="1489">Logger</tspan></text></g></g><g><line name="S2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1152" y1="65" x1="1152" id="actor6247"></line><g id="root-6247"><rect class="actor actor-top" ry="3" rx="3" name="S2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1077"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1152"><tspan dy="0" x="1152">Service B</tspan></text></g></g><g><line name="SM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="637" y1="65" x1="637" id="actor6246"></line><g id="root-6246"><rect class="actor actor-top" ry="3" rx="3" name="SM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="562"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="637"><tspan dy="0" x="637">Service Mesh</tspan></text></g></g><g><line name="S1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6245"></line><g id="root-6245"><rect class="actor actor-top" ry="3" rx="3" name="S1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Service A</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-276{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-276 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-276 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-276 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-276 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-276 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-276 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-276 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-276 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-276 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-276 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-276 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-276 p{margin:0}#mermaid-6a213c2d99ee9aa5-276 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-276 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-276 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-276 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-276 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-276 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-276 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-276 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-276 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-276 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-276 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-276 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-276 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-276 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-276 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-276 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-276 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-276 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-276 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-276 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-276 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-276 .actor-man circle,#mermaid-6a213c2d99ee9aa5-276 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-276 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="355">1. Send interâ€‘service request over TLS with mTLS handshake</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="633" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="358">2. Validate client certificate and exchange mutual keys</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="636">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="893">3. Forward request after verifying mTLS and policy metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="1148" y1="209" x1="638"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="638">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="893">4. Enforce fineâ€‘grained access control via centralized policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1148" y1="257" x1="638"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="638">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="1153">5. Process request using secure coding practices and parameterized queries</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1153,305 C 1213,295 1213,335 1153,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1153">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="896">6. Reply over mTLS with payload encrypted endâ€‘toâ€‘end</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="641" y1="383" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1151">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="358">7. Relay response after dynamic certificate reâ€‘negotiation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="636"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="636">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="355">8. Trigger session-specific certificate refresh on prolonged sessions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="633" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1062">9. Log all interâ€‘service transactions with full security metadata (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1485" y1="527" x1="638"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="638">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1490">10. Apply realâ€‘time integrity checks and SIEM integration</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1490,575 C 1550,565 1550,605 1490,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1490">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="896">11. Monitor anomalous traffic patterns for lateral movement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="641" y1="653" x1="1151"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1151">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1062">12. Autoâ€‘trigger alerts on policy violations or misdirected requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="1485" y1="701" x1="638"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="638">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1065">13. Archive logs for continuous forensic readiness and compliance reviews</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="641" y1="749" x1="1488"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1488">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 11</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Initiation</td><td dir="ltr">â€¢ Unencrypted requests; no mTLS handshake</td><td dir="ltr">â€¢ Enforce TLS with mutual authentication</td><td dir="ltr">Use mTLS to secure all interâ€‘service communications</td></tr><tr><td dir="ltr">Policy Enforcement</td><td dir="ltr">â€¢ Open routing; legacy access controls</td><td dir="ltr">â€¢ Fineâ€‘grained, centralized policy enforcement</td><td dir="ltr">Enforce policies centrally; audit each request</td></tr><tr><td dir="ltr">Communication Security</td><td dir="ltr">â€¢ Plaintext response relayed</td><td dir="ltr">â€¢ Endâ€‘toâ€‘end encryption with dynamic certificate reâ€‘negotiation</td><td dir="ltr">Secure responses with dynamic certificate refresh and encryption</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Minimal logging; unencrypted logs; no SIEM integration</td><td dir="ltr">â€¢ Detailed, encrypted logs with realâ€‘time SIEM alerts and forensic audits</td><td dir="ltr">Log fully and integrate with SIEM for continuous monitoring and alerting</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Cache-Control and Data Exfiltration Prevention Middleware" dir="auto" class="heading" id="Cache-Control_and_Data_Exfiltration_Prevention_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Cache-Control and Data Exfiltration Prevention Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Build middleware that controls caching policies and monitors API responses to detect and prevent data exfiltration through unauthorized caching or side channels.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Data leakage via cache poisoning, unauthorized data aggregation, exfiltration channels.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;OWASP Cache Control, data loss prevention (DLP) tools, periodic security reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Data protection officers, security auditors; IT compliance teams, application developers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Cache-Control Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1661.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-282" style="width:1661.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1314"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1389"><tspan dy="0" x="1389">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1056"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1131"><tspan dy="0" x="1131">Cache Processor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="515"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="590"><tspan dy="0" x="590">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1389" y1="65" x1="1389" id="actor6252"></line><g id="root-6252"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1314"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1389"><tspan dy="0" x="1389">Logger</tspan></text></g></g><g><line name="CP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1131" y1="65" x1="1131" id="actor6251"></line><g id="root-6251"><rect class="actor actor-top" ry="3" rx="3" name="CP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1056"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1131"><tspan dy="0" x="1131">Cache Processor</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="590" y1="65" x1="590" id="actor6250"></line><g id="root-6250"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="515"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="590"><tspan dy="0" x="590">Middleware</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6249"></line><g id="root-6249"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-282{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-282 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-282 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-282 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-282 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-282 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-282 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-282 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-282 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-282 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-282 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-282 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-282 p{margin:0}#mermaid-6a213c2d99ee9aa5-282 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-282 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-282 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-282 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-282 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-282 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-282 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-282 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-282 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-282 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-282 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-282 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-282 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-282 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-282 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-282 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-282 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-282 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-282 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-282 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-282 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-282 .actor-man circle,#mermaid-6a213c2d99ee9aa5-282 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-282 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="331">1. Send API request over HTTP without cache control headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="586" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="859">2. Process request and store response using default caching</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1127" y1="161" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="591">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1132">3. Cache data without verifying sensitivity or expiration</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1132,209 C 1192,199 1192,239 1132,229"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1132">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="862">4. Return cached responses that include sensitive data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="594" y1="287" x1="1130"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1130">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="334">5. Relay response without modification or watermarking</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="589"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="589">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="331">6. Multiple requests lead to aggregation of cached data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="586" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="859">7. No inspection for abnormal data aggregation patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1127" y1="431" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="591">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="862">8. Serve cached responses despite potential exfiltration channels</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="594" y1="479" x1="1130"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1130">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="988">9. Log cache hits and misses with minimal detail</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1385" y1="527" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="591">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1390">10. Store logs in plaintext without DLP scanning</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1390,575 C 1450,565 1450,605 1390,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1390">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="988">11. No automated alerts on large volume cache access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1385" y1="653" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="591">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="991">12. No integration of logs with DLP tools to detect leaks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="594" y1="701" x1="1388"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1388">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="334">13. Continues serving cached data despite exfiltration risk</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="589"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="589">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Cache-Control Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2002 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-284" style="width:2002px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1589.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1664.5"><tspan dy="0" x="1664.5">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1278"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1353"><tspan dy="0" x="1353">Cache Processor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="654"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="729"><tspan dy="0" x="729">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1664.5" y1="65" x1="1664.5" id="actor6256"></line><g id="root-6256"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1589.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1664.5"><tspan dy="0" x="1664.5">Logger</tspan></text></g></g><g><line name="CP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1353" y1="65" x1="1353" id="actor6255"></line><g id="root-6255"><rect class="actor actor-top" ry="3" rx="3" name="CP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1278"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1353"><tspan dy="0" x="1353">Cache Processor</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="729" y1="65" x1="729" id="actor6254"></line><g id="root-6254"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="654"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="729"><tspan dy="0" x="729">Middleware</tspan></text></g></g><g><line name="C" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6253"></line><g id="root-6253"><rect class="actor actor-top" ry="3" rx="3" name="C" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-284{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-284 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-284 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-284 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-284 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-284 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-284 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-284 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-284 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-284 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-284 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-284 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-284 p{margin:0}#mermaid-6a213c2d99ee9aa5-284 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-284 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-284 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-284 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-284 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-284 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-284 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-284 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-284 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-284 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-284 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-284 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-284 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-284 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-284 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-284 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-284 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-284 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-284 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-284 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-284 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-284 .actor-man circle,#mermaid-6a213c2d99ee9aa5-284 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-284 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="401">1. Send API request over HTTPS with Cacheâ€‘Control headers specifying noâ€‘store</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="725" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1040">2. Process request and apply strict cache policies (no sensitive data cached)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1349" y1="161" x1="730"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="730">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1354">3. Enforce expiration and sensitivity validation on all stored responses</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1354,209 C 1414,199 1414,239 1354,229"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1354">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1043">4. Return responses with additional watermarking and DLPâ€‘tags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="733" y1="287" x1="1352"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1352">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="404">5. Relay responses with secure headers (Cacheâ€‘Control: noâ€‘store, noâ€‘cache)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="728"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="728">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="401">6. Monitor request patterns and aggregate cache access metrics</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="725" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1040">7. Apply anomaly detection and rate limiting on cache retrievals</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1349" y1="431" x1="730"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="730">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1043">8. Block responses if aggregated access exceeds preâ€‘defined thresholds</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="733" y1="479" x1="1352"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1352">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1195">9. Log all cache transactions with encryption and DLP scanning metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1660.5" y1="527" x1="730"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="730">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1666">10. Correlate log data with DLP tools and trigger automated alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1665.5,575 C 1725.5,565 1725.5,605 1665.5,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1665.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1195">11. Periodically review access patterns enforced by middleware</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1660.5" y1="653" x1="730"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="730">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1198">12. Automated forensic analysis runs on detected anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="733" y1="701" x1="1663.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1663.5">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="404">13. Enforce continuous updates to cache policies based on threat feedback</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="728"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="728">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 16</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request &amp; Caching</td><td dir="ltr">â€¢ No cacheâ€‘control headers; default caching of sensitive responses</td><td dir="ltr">â€¢ Enforce strict cacheâ€‘control (noâ€‘store, noâ€‘cache) with sensitivity validation</td><td dir="ltr">Block caching of sensitive data using strict HTTP cacheâ€‘control headers</td></tr><tr><td dir="ltr">Response Modification</td><td dir="ltr">â€¢ Cached responses not modified; no watermarking</td><td dir="ltr">â€¢ Add watermarking and DLPâ€‘tags to responses</td><td dir="ltr">Tag sensitive responses and prevent unauthorized caching</td></tr><tr><td dir="ltr">Exfiltration Prevention</td><td dir="ltr">â€¢ No monitoring of cache access; risk of aggregation</td><td dir="ltr">â€¢ Rate limit cache access; apply anomaly detection on aggregated requests</td><td dir="ltr">Monitor and rate limit cache retrievals to block data exfiltration channels</td></tr><tr><td dir="ltr">Logging &amp; DLP</td><td dir="ltr">â€¢ Minimal, plaintext logging; no DLP integration</td><td dir="ltr">â€¢ Encrypted, detailed logging with DLP scanning; automated alerts on suspicious access</td><td dir="ltr">Integrate logs with DLP and SIEM for continuous monitoring and automated response</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Containerized Middleware for Cloud-Native Access Control" dir="auto" class="heading" id="Containerized_Middleware_for_Cloud-Native_Access_Control"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Containerized Middleware for Cloud-Native Access Control<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Use containerization and orchestration (e.g., Kubernetes) to deploy access control middleware at scale with built-in network policies, secrets management, and automated updates.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Container breakout, API misconfigurations, supply chain attacks in container images.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;CIS Kubernetes Benchmarks, NIST SP 800-190, frequent vulnerability scanning and patch management.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevOps, container security engineers; cloud administrators, internal developers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Containerized Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1807 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-290" style="width:1807px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1557"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1632"><tspan dy="0" x="1632">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="769" x="948.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1039"><tspan dy="0" x="1039">Kubernetes Scheduler</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="769" x="448"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="525"><tspan dy="0" x="525">Container Registry</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1632" y1="65" x1="1632" id="actor6260"></line><g id="root-6260"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1557"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1632"><tspan dy="0" x="1632">Logger</tspan></text></g></g><g><line name="KS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1039" y1="65" x1="1039" id="actor6259"></line><g id="root-6259"><rect class="actor actor-top" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="0" x="948.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1039"><tspan dy="0" x="1039">Kubernetes Scheduler</tspan></text></g></g><g><line name="CR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="525" y1="65" x1="525" id="actor6258"></line><g id="root-6258"><rect class="actor actor-top" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="0" x="448"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="525"><tspan dy="0" x="525">Container Registry</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6257"></line><g id="root-6257"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-290{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-290 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-290 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-290 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-290 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-290 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-290 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-290 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-290 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-290 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-290 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-290 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-290 p{margin:0}#mermaid-6a213c2d99ee9aa5-290 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-290 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-290 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-290 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-290 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-290 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-290 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-290 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-290 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-290 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-290 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-290 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-290 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-290 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-290 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-290 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-290 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-290 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-290 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-290 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-290 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-290 .actor-man circle,#mermaid-6a213c2d99ee9aa5-290 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-290 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="299">1. Build container image using outdated base images</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="521" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="526">2. No automated vulnerability scans performed</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 526,161 C 586,151 586,191 526,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="526">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="299">3. Push image without signing or attestations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="521" y1="239" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1040">4. Deploy container with default privileges (root access)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1040,287 C 1100,277 1100,317 1040,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1040">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1334">5. Expose container on flat network no segmentation enforced</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1628" y1="365" x1="1040"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1040">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="784">6. Run container without resource limits or seccomp profiles</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="529" y1="413" x1="1038"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1038">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1334">7. No automated patching legacy vulnerabilities persist</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1628" y1="461" x1="1040"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="1040">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1334">8. Minimal logging of container events logs stored in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1628" y1="509" x1="1040"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1040">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1337">9. No integration with vulnerability scanning tools at runtime</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1043" y1="557" x1="1631"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1631">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="784">10. No automatic update or rollback on vulnerability detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="529" y1="605" x1="1038"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1038">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1337">11. No alerts on anomalous container behavior triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1043" y1="653" x1="1631"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1631">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="559">12. Inconsistent policy enforcement across container clusters</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1038"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1038">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1337">13. Audit trails incomplete potential for supply chain exploitation remains</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1043" y1="749" x1="1631"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1631">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Containerized Middleware</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1882.5 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-292" style="width:1882.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1479"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1554"><tspan dy="0" x="1554">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="829" x="915.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1006"><tspan dy="0" x="1006">Kubernetes Scheduler</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="829" x="614"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="691"><tspan dy="0" x="691">Container Registry</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1554" y1="65" x1="1554" id="actor6264"></line><g id="root-6264"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1479"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1554"><tspan dy="0" x="1554">Logger</tspan></text></g></g><g><line name="KS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1006" y1="65" x1="1006" id="actor6263"></line><g id="root-6263"><rect class="actor actor-top" ry="3" rx="3" name="KS" height="65" width="181" stroke="#666" fill="#eaeaea" y="0" x="915.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1006"><tspan dy="0" x="1006">Kubernetes Scheduler</tspan></text></g></g><g><line name="CR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="691" y1="65" x1="691" id="actor6262"></line><g id="root-6262"><rect class="actor actor-top" ry="3" rx="3" name="CR" height="65" width="154" stroke="#666" fill="#eaeaea" y="0" x="614"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="691"><tspan dy="0" x="691">Container Registry</tspan></text></g></g><g><line name="Dev" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6261"></line><g id="root-6261"><rect class="actor actor-top" ry="3" rx="3" name="Dev" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Developer</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-292{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-292 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-292 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-292 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-292 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-292 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-292 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-292 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-292 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-292 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-292 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-292 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-292 p{margin:0}#mermaid-6a213c2d99ee9aa5-292 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-292 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-292 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-292 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-292 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-292 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-292 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-292 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-292 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-292 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-292 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-292 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-292 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-292 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-292 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-292 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-292 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-292 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-292 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-292 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-292 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-292 .actor-man circle,#mermaid-6a213c2d99ee9aa5-292 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-292 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="382">1. Build container image using hardened base images and secure Dockerfile</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="687" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="692">2. Run automated vulnerability scans and sign image cryptographically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 692,161 C 752,151 752,191 692,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="692">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="382">3. Push signed image with attestations to registry</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="687" y1="239" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1007">4. Deploy container with nonâ€‘root security contexts and resource quotas</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1007,287 C 1067,277 1067,317 1007,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1007">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1279">5. Enforce podâ€‘level network segmentation and isolation policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="1550" y1="365" x1="1007"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1007">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1007">6. Configure container with strict seccomp, AppArmor, and limited capabilities</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1007,413 C 1067,403 1067,443 1007,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1007">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1279">7. Enable automatic patching and vulnerability scanning at runtime</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1550" y1="491" x1="1007"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1007">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1279">8. Log all container events in encrypted, centralized storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1550" y1="539" x1="1007"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1007">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1555">9. Integrate logs with SIEM and vulnerability management tools</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1555,587 C 1615,577 1615,617 1555,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1555">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="542">10. Enforce automated rollbacks and updates on policy violations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="79" y1="665" x1="1005"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1005">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1282">11. Trigger alerts on anomalous container behavior in real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1010" y1="713" x1="1553"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="1553">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1279">12. Maintain complete, immutable audit trails for compliance</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="1550" y1="761" x1="1007"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1007">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="816">13. Continuous monitoring and periodic penetration tests verify container integrity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="1553"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1553">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 19</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Container Image Build</td><td dir="ltr">â€¢ Outdated images; no scans; unsigned uploads</td><td dir="ltr">â€¢ Hardened images; automated scans; signed images with attestations</td><td dir="ltr">Use hardened base images and enforce automated vulnerability scanning and image signing</td></tr><tr><td dir="ltr">Deployment &amp; Exposure</td><td dir="ltr">â€¢ Default privileges; flat network exposure</td><td dir="ltr">â€¢ Nonâ€‘root contexts; podâ€‘level network policies; resource quotas</td><td dir="ltr">Deploy with least privilege; enforce network segmentation and resource limits</td></tr><tr><td dir="ltr">Hardened Runtime</td><td dir="ltr">â€¢ No seccomp/AppArmor; unpatched vulnerabilities</td><td dir="ltr">â€¢ Configure strict seccomp, AppArmor, and limited capabilities; automatic runtime patching</td><td dir="ltr">Harden container runtime with strict controls</td></tr><tr><td dir="ltr">Monitoring &amp; Updates</td><td dir="ltr">â€¢ Minimal logging; plaintext; no autoâ€‘remediation</td><td dir="ltr">â€¢ Centralized, encrypted logs integrated with SIEM; automated rollbacks on violations</td><td dir="ltr">Ensure continuous monitoring, automated vulnerability management, and immutable audit trails</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Federated Identity and Risk-Based Authorization Middleware" dir="auto" class="heading" id="Federated_Identity_and_Risk-Based_Authorization_Middleware"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Federated Identity and Risk-Based Authorization Middleware<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Integrate federated identity solutions with risk-based authorization, allowing dynamic determination of access permissions based on real-time risk assessments and aggregated identity attributes.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Federation attacks, unauthorized role escalation, weak risk assessments.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;SAML/OIDC standards, NIST SP 800-63, regular federation and risk-based authorization tests.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Identity and Access Management teams, security architects; external partners, multi-cloud users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Federated Identity and Riskâ€‘Based Authorization</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1836 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-298" style="width:1836px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1418"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1493"><tspan dy="0" x="1493">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1218"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1293"><tspan dy="0" x="1293">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="668"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="743"><tspan dy="0" x="743">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1493" y1="65" x1="1493" id="actor6268"></line><g id="root-6268"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1418"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1493"><tspan dy="0" x="1493">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1293" y1="65" x1="1293" id="actor6267"></line><g id="root-6267"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1218"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1293"><tspan dy="0" x="1293">Identity Provider</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="743" y1="65" x1="743" id="actor6266"></line><g id="root-6266"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="668"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="743"><tspan dy="0" x="743">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6265"></line><g id="root-6265"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-298{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-298 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-298 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-298 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-298 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-298 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-298 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-298 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-298 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-298 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-298 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-298 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-298 p{margin:0}#mermaid-6a213c2d99ee9aa5-298 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-298 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-298 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-298 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-298 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-298 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-298 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-298 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-298 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-298 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-298 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-298 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-298 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-298 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-298 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-298 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-298 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-298 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-298 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-298 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-298 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-298 .actor-man circle,#mermaid-6a213c2d99ee9aa5-298 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-298 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="408">1. Send federated auth request over HTTP without risk data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="739" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1017">2. Forward request without enforcing strict SAML/OIDC validations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1289" y1="161" x1="744"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="744">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1020">3. Return token with minimal risk attributes and static roles</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="747" y1="209" x1="1292"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1292">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="411">4. Pass the token unchanged across applications with no risk recalculation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="742"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="742">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="408">5. Use token for access without dynamic risk evaluation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="739" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="744">6. Map identity to roles using static rules ignore realâ€‘time risk data</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 744,353 C 804,343 804,383 744,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="744">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="411">7. Grant access without performing additional risk assessment</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="742"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="742">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="408">8. Reuse token for crossâ€‘domain operations insecurely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="739" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1117">9. Log federated transactions with minimal risk context, plaintext stored</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1489" y1="527" x1="744"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="744">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1494">10. No correlation with external threat intelligence feeds performed</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1494,575 C 1554,565 1554,605 1494,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1494">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1117">11. No automated alerts on anomalous role escalations triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1489" y1="653" x1="744"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="744">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1120">12. Manual periodic review only risk data remains outdated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="747" y1="701" x1="1492"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1492">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="411">13. Continues to permit access despite potential propagation of elevated privileges</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="742"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="742">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Federated Identity and Riskâ€‘Based Authorization</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1940 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-300" style="width:1940px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1497"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1572"><tspan dy="0" x="1572">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1297"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1372"><tspan dy="0" x="1372">Identity Provider</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="755"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="830"><tspan dy="0" x="830">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1572" y1="65" x1="1572" id="actor6272"></line><g id="root-6272"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1497"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1572"><tspan dy="0" x="1572">Logger</tspan></text></g></g><g><line name="IdP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1372" y1="65" x1="1372" id="actor6271"></line><g id="root-6271"><rect class="actor actor-top" ry="3" rx="3" name="IdP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1297"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1372"><tspan dy="0" x="1372">Identity Provider</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="830" y1="65" x1="830" id="actor6270"></line><g id="root-6270"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="755"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="830"><tspan dy="0" x="830">Middleware</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6269"></line><g id="root-6269"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-300{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-300 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-300 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-300 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-300 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-300 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-300 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-300 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-300 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-300 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-300 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-300 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-300 p{margin:0}#mermaid-6a213c2d99ee9aa5-300 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-300 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-300 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-300 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-300 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-300 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-300 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-300 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-300 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-300 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-300 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-300 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-300 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-300 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-300 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-300 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-300 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-300 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-300 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-300 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-300 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-300 .actor-man circle,#mermaid-6a213c2d99ee9aa5-300 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-300 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="451">1. Send federated auth request over HTTPS with signed SAML/OIDC assertions and risk signals</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="826" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1100">2. Forward request enforcing strict validation and risk parameters</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1368" y1="161" x1="831"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="831">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1103">3. Return token with rich risk attributes and dynamic roles</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="834" y1="209" x1="1371"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1371">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="454">4. Re-sign token with domainâ€‘specific binding and current risk context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="829"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="829">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="451">5. Use token where middleware dynamically recalculates risk per request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="826" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="831">6. Evaluate token dynamically with current risk score, identity attributes, and context</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 831,353 C 891,343 891,383 831,373"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="831">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="454">7. Grant or deny access based on realâ€‘time risk and role matching</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="829"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="829">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="451">8. Trigger dynamic token refresh if risk level changes (shorter lifetime)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="826" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1200">9. Log all identity federation events enriched with risk data in encrypted storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1568" y1="527" x1="831"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="831">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1573">10. Apply realâ€‘time anomaly detection correlating with external threat intel</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1573,575 C 1633,565 1633,605 1573,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1573">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1200">11. Trigger automated alerts and risk-based remediations on escalated privileges</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1568" y1="653" x1="831"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="831">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1203">12. Continuously audit risk trends and federation events update policies in near real time</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="834" y1="701" x1="1571"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1571">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="454">13. Securely communicate access decisions with detailed guidance on risk levels</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="829"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="829">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 20</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure</strong></th><th dir="ltr"><strong>Secure</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Identity Reception</td><td dir="ltr">â€¢ HTTP without risk signals; minimal token content</td><td dir="ltr">â€¢ HTTPS with signed SAML/OIDC assertions; rich risk attributes embedded</td><td dir="ltr">Enforce strict, signed federated signâ€‘in with risk signals</td></tr></tbody></table></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Secure Execution/File Management" dir="auto" class="heading" id="Secure_Execution/File_Management"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Execution/File Management<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="Encrypted File Storage with Granular Access Controls" dir="auto" class="heading" id="Encrypted_File_Storage_with_Granular_Access_Controls"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Encrypted File Storage with Granular Access Controls<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Design a multi-layered file storage system that encrypts data at rest using AES-256 and applies RBAC/ABAC policies at the file system level with audit logging.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Data exfiltration via stolen credentials, unauthorized file access, brute-forcing weak cryptographic keys.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-57, FIPS 140-2, regular penetration tests, and automated file access reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Security architects, file system administrators, compliance officers; end-users, backup operators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Encrypted File Storage</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1552 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-307" style="width:1552px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1205"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1280"><tspan dy="0" x="1280">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1005"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1080"><tspan dy="0" x="1080">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FS" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="481"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="556"><tspan dy="0" x="556">File Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1280" y1="65" x1="1280" id="actor6276"></line><g id="root-6276"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1205"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1280"><tspan dy="0" x="1280">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1080" y1="65" x1="1080" id="actor6275"></line><g id="root-6275"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1005"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1080"><tspan dy="0" x="1080">Policy Engine</tspan></text></g></g><g><line name="FS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="556" y1="65" x1="556" id="actor6274"></line><g id="root-6274"><rect class="actor actor-top" ry="3" rx="3" name="FS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="481"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="556"><tspan dy="0" x="556">File Server</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6273"></line><g id="root-6273"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-307{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-307 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-307 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-307 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-307 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-307 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-307 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-307 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-307 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-307 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-307 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-307 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-307 p{margin:0}#mermaid-6a213c2d99ee9aa5-307 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-307 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-307 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-307 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-307 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-307 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-307 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-307 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-307 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-307 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-307 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-307 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-307 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-307 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-307 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-307 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-307 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-307 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-307 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-307 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-307 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-307 .actor-man circle,#mermaid-6a213c2d99ee9aa5-307 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-307 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="314">1. Upload file over HTTP without encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="552" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="557">2. Accept file in plaintext with weak or no encryption</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 557,161 C 617,151 617,191 557,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="557">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="817">3. Forward file metadata with default (insecure) role mapping</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1076" y1="239" x1="557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="557">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="820">4. Apply static RBAC rules without dynamic attribute checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="560" y1="287" x1="1079"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1079">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="557">5. Store file on disk without using AESâ€‘256 use default file permissions</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 557,335 C 617,325 617,365 557,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="557">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="317">6. Acknowledge storage without encryption status</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="555">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="917">7. Log access decision with minimal details (no timestamp, user ID)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1276" y1="461" x1="557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="557">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1281">8. Store plaintext logs without integrity controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1281,509 C 1341,499 1341,539 1281,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1281">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="314">9. Request file access with default credentials</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="552" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="817">10. Validate access using hardcoded (outdated) permission set</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1076" y1="635" x1="557"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="557">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="317">11. Return file in plaintext access decision not revalidated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="79" y1="683" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="555">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="920">12. No anomaly detection logs remain unprotected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="560" y1="731" x1="1279"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1279">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="317">13. Subsequent unauthorized access not blocked</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="555">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Encrypted File Storage</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1813 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-309" style="width:1813px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1375"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1450"><tspan dy="0" x="1450">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1175"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1250"><tspan dy="0" x="1250">Policy Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FS" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="567"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="642"><tspan dy="0" x="642">File Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1450" y1="65" x1="1450" id="actor6280"></line><g id="root-6280"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1375"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1450"><tspan dy="0" x="1450">Logger</tspan></text></g></g><g><line name="PE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1250" y1="65" x1="1250" id="actor6279"></line><g id="root-6279"><rect class="actor actor-top" ry="3" rx="3" name="PE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1175"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1250"><tspan dy="0" x="1250">Policy Engine</tspan></text></g></g><g><line name="FS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="642" y1="65" x1="642" id="actor6278"></line><g id="root-6278"><rect class="actor actor-top" ry="3" rx="3" name="FS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="567"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="642"><tspan dy="0" x="642">File Server</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6277"></line><g id="root-6277"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-309{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-309 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-309 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-309 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-309 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-309 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-309 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-309 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-309 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-309 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-309 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-309 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-309 p{margin:0}#mermaid-6a213c2d99ee9aa5-309 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-309 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-309 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-309 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-309 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-309 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-309 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-309 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-309 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-309 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-309 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-309 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-309 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-309 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-309 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-309 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-309 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-309 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-309 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-309 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-309 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-309 .actor-man circle,#mermaid-6a213c2d99ee9aa5-309 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-309 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="357">1. Upload file over HTTPS with client authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="638" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="643">2. Encrypt file using AESâ€‘256 with ephemeral keys</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 643,161 C 703,151 703,191 643,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="643">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="945">3. Forward file metadata with verified user roles and attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1246" y1="239" x1="643"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="643">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="948">4. Evaluate dynamic RBAC/ABAC policies based on context (time, location)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="646" y1="287" x1="1249"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1249">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="643">5. Store file on an encrypted disk with strict permissions</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 643,335 C 703,325 703,365 643,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="643">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="360">6. Acknowledge secure storage with status details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="641"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="641">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1045">7. Log access decisions with full metadata (userID, timestamp, action)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1446" y1="461" x1="643"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="643">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1451">8. Store logs in an encrypted, immutable repository with integrity checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1451,509 C 1511,499 1511,539 1451,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1451">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="357">9. Request file access over HTTPS with valid session token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="638" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="945">10. Dynamically reâ€‘validate access using updated policies and context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1246" y1="635" x1="643"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="643">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="948">11. Confirm access based on least privilege and risk factors</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="683" x2="646" y1="683" x1="1249"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1249">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="360">12. Return file decrypted on the fly in secure session log audit details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="641"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="641">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="1048">13. Trigger alerts on anomalous file access enforce continuous monitoring</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="646" y1="779" x1="1449"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1449">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Intake</td><td dir="ltr">â€¢ Unencrypted HTTP upload<br>â€¢ No client authentication<br>â€¢ Weak/no encryption applied</td><td dir="ltr">â€¢ HTTPS upload with client authentication<br>â€¢ AESâ€‘256 file encryption<br>â€¢ Verified metadata passed</td><td dir="ltr">Enforce TLS/HTTPS; require strong encryption and authentication</td></tr><tr><td dir="ltr">Access Evaluation</td><td dir="ltr">â€¢ Static, hardcoded RBAC<br>â€¢ No dynamic ABAC<br>â€¢ Default file permissions</td><td dir="ltr">â€¢ Dynamic RBAC/ABAC based on time, location, etc.<br>â€¢ Strict file system ACLs</td><td dir="ltr">Evaluate access using dynamic, contextâ€‘aware policies</td></tr><tr><td dir="ltr">Audit Logging</td><td dir="ltr">â€¢ Minimal details; plaintext logs; no integrity controls</td><td dir="ltr">â€¢ Detailed, encrypted log entries with full audit trail and integrity checks</td><td dir="ltr">Log all access details securely and integrate with SIEM</td></tr><tr><td dir="ltr">File Retrieval</td><td dir="ltr">â€¢ Plaintext file return<br>â€¢ No reâ€‘validation on each request, allowing unauthorized reuse</td><td dir="ltr">â€¢ Continuous reâ€‘validation of access tokens<br>â€¢ Secure, onâ€‘theâ€‘fly decryption within an active session</td><td dir="ltr">Reâ€‘validate on each access; enforce short-lived tokens and session monitoring</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure File Transfer with End-to-End Encryption" dir="auto" class="heading" id="Secure_File_Transfer_with_End-to-End_Encryption"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure File Transfer with End-to-End Encryption<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Implement a secure file transfer platform that uses TLS 1.3 and S/MIME for email attachments, with file integrity checks (hashing) and digital signatures.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Man-in-the-middle (MitM) interception, replay attacks, tampering during transit.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-52, TLS Best Practices, vulnerability scans, and file integrity monitoring.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Network security engineers, file transfer administrators; remote users, third-party partners.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Secure File Transfer</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1558 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-314" style="width:1558px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1207"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1282"><tspan dy="0" x="1282">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1007"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1082"><tspan dy="0" x="1082">Certificate Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FT" height="65" width="160" stroke="#666" fill="#eaeaea" y="829" x="532"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="612"><tspan dy="0" x="612">File Transfer Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1282" y1="65" x1="1282" id="actor6284"></line><g id="root-6284"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1207"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1282"><tspan dy="0" x="1282">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1082" y1="65" x1="1082" id="actor6283"></line><g id="root-6283"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1007"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1082"><tspan dy="0" x="1082">Certificate Store</tspan></text></g></g><g><line name="FT" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="612" y1="65" x1="612" id="actor6282"></line><g id="root-6282"><rect class="actor actor-top" ry="3" rx="3" name="FT" height="65" width="160" stroke="#666" fill="#eaeaea" y="0" x="532"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="612"><tspan dy="0" x="612">File Transfer Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6281"></line><g id="root-6281"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-314{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-314 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-314 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-314 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-314 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-314 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-314 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-314 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-314 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-314 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-314 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-314 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-314 p{margin:0}#mermaid-6a213c2d99ee9aa5-314 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-314 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-314 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-314 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-314 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-314 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-314 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-314 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-314 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-314 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-314 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-314 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-314 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-314 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-314 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-314 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-314 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-314 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-314 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-314 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-314 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-314 .actor-man circle,#mermaid-6a213c2d99ee9aa5-314 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-314 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="342">1. Initiate file transfer via email attachment over HTTP/wrong TLS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="608" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="613">2. Accept connection without verifying client's certificate</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 613,161 C 673,151 673,191 613,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="613">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="345">3. Acknowledge file transfer request in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="611"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="611">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="342">4. Transmit file data without S/MIME wrapping or proper signing</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="608" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="613">5. Accept file and compute basic (weak) hash for integrity check</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 613,335 C 673,325 673,365 613,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="613">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="846">6. Use selfâ€signed certificate no proper chain validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1078" y1="413" x1="613"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="613">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="613">7. Use static digital signature no nonce or timestamp embedded</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 613,461 C 673,451 673,491 613,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="613">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="345">8. Forgo replay protection file accepted as-is</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="79" y1="539" x1="611"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="611">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="342">9. Resend file data repeatedly no rate limiting</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="608" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="946">10. Log transfer events in plaintext without integrity modifiers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1278" y1="635" x1="613"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="613">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1283">11. Logs stored without encryption no audit trails</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1283,683 C 1343,673 1343,713 1283,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1283">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="345">12. No alerts on tampering attempts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="611"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="611">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="949">13. Incomplete log correlation manual audit required</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="616" y1="809" x1="1281"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1281">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Secure File Transfer</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1688.5 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-316" style="width:1688.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1232"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1307"><tspan dy="0" x="1307">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1032"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1107"><tspan dy="0" x="1107">Certificate Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FT" height="65" width="160" stroke="#666" fill="#eaeaea" y="829" x="520"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="600"><tspan dy="0" x="600">File Transfer Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1307" y1="65" x1="1307" id="actor6288"></line><g id="root-6288"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1232"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1307"><tspan dy="0" x="1307">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1107" y1="65" x1="1107" id="actor6287"></line><g id="root-6287"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1032"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1107"><tspan dy="0" x="1107">Certificate Store</tspan></text></g></g><g><line name="FT" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="600" y1="65" x1="600" id="actor6286"></line><g id="root-6286"><rect class="actor actor-top" ry="3" rx="3" name="FT" height="65" width="160" stroke="#666" fill="#eaeaea" y="0" x="520"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="600"><tspan dy="0" x="600">File Transfer Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6285"></line><g id="root-6285"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-316{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-316 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-316 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-316 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-316 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-316 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-316 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-316 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-316 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-316 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-316 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-316 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-316 p{margin:0}#mermaid-6a213c2d99ee9aa5-316 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-316 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-316 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-316 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-316 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-316 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-316 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-316 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-316 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-316 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-316 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-316 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-316 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-316 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-316 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-316 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-316 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-316 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-316 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-316 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-316 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-316 .actor-man circle,#mermaid-6a213c2d99ee9aa5-316 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-316 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="336">1. Initiate file transfer via HTTPS (TLS 1.3) with S/MIME enabled</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="596" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="601">2. Validate client certificate chain using CS</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 601,161 C 661,151 661,191 601,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="601">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="339">3. Acknowledge request with secure session handshake</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="599"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="599">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="336">4. Transmit file wrapped in S/MIME file digitally signed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="596" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="601">5. Compute strong hash (SHAâ€‘256) to ensure integrity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 601,335 C 661,325 661,365 601,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="601">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="852">6. Validate digital signature using trusted certificate provider</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="1103" y1="413" x1="601"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="601">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="601">7. Embed nonce, timestamp, and unique identifier in digital signature</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 601,461 C 661,451 661,491 601,481"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="601">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="339">8. Enforce oneâ€‘time transfer token reject replayed transfers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="79" y1="539" x1="599"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="599">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="336">9. Ensure rate limiting and session binding on file submission</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="596" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="952">10. Log each transfer event with encrypted metadata and full audit trail</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1303" y1="635" x1="601"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="601">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1308">11. Store logs in SIEMâ€‘integrated, tamperâ€‘proof storage with automated alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1308,683 C 1368,673 1368,713 1308,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1308">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="339">12. Return file delivery confirmation with integrity status details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="599"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="599">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="955">13. Correlate anomalies trigger automatic incident response if discrepancies found</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="604" y1="809" x1="1306"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1306">13</text></svg></div></div><div class="el-p"><p dir="auto">Cheatsheet Table â€“ Scenario 2</p></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Transfer Initiation</td><td dir="ltr">â€¢ Unencrypted transfer; no certificate chain validation</td><td dir="ltr">â€¢ HTTPS with TLS 1.3 and S/MIME; full certificate and client validation</td><td dir="ltr">Always use TLS 1.3; verify certificates properly</td></tr><tr><td dir="ltr">File Transmission</td><td dir="ltr">â€¢ File sent without digital wrapping; weak hash integrity</td><td dir="ltr">â€¢ File wrapped in S/MIME; strong hash (SHAâ€‘256) computed; digital signatures verified</td><td dir="ltr">Ensure file data is wrapped, signed, and integrity verified</td></tr><tr><td dir="ltr">Replay Protection</td><td dir="ltr">â€¢ Static signature without nonce; no replay protection</td><td dir="ltr">â€¢ Embed nonce/timestamp and enforce oneâ€‘time tokens; rate-limiting applied</td><td dir="ltr">Embed dynamic data in signatures; enforce replay prevention</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Plaintext logs; no encryption or automated review</td><td dir="ltr">â€¢ Encrypted logs with full audit trails integrated into SIEM; automatic anomaly detection</td><td dir="ltr">Encrypt logs; integrate with SIEM and enable automated alerts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure File Execution with Sandbox Isolation" dir="auto" class="heading" id="Secure_File_Execution_with_Sandbox_Isolation"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure File Execution with Sandbox Isolation<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy a sandbox environment to execute uploaded files in isolated containers or virtual machines, limiting process privileges and using deterministic isolation.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Code injection, malicious file execution, container breakout.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;OWASP Secure Execution, CIS Benchmarks, regular container security assessments, and sandbox penetration testing.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;DevSecOps engineers, system administrators; application developers, QA testers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ File Execution Sandbox</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1925.5 945" height="945" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-322" style="width:1925.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="1569"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="1644"><tspan dy="0" x="1644">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CT" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="987"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="1062"><tspan dy="0" x="1062">Container/VM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="438"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="513"><tspan dy="0" x="513">File Executor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="1644" y1="65" x1="1644" id="actor6292"></line><g id="root-6292"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1569"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1644"><tspan dy="0" x="1644">Logger</tspan></text></g></g><g><line name="CT" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="1062" y1="65" x1="1062" id="actor6291"></line><g id="root-6291"><rect class="actor actor-top" ry="3" rx="3" name="CT" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="987"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1062"><tspan dy="0" x="1062">Container/VM</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="513" y1="65" x1="513" id="actor6290"></line><g id="root-6290"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="438"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="513"><tspan dy="0" x="513">File Executor</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="75" y1="65" x1="75" id="actor6289"></line><g id="root-6289"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-322{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-322 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-322 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-322 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-322 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-322 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-322 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-322 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-322 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-322 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-322 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-322 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-322 p{margin:0}#mermaid-6a213c2d99ee9aa5-322 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-322 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-322 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-322 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-322 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-322 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-322 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-322 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-322 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-322 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-322 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-322 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-322 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-322 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-322 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-322 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-322 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-322 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-322 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-322 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-322 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-322 .actor-man circle,#mermaid-6a213c2d99ee9aa5-322 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-322 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="293">1. Upload file over HTTP with no content scanning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="509" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="514">2. Accept file without malware or injection scanning</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 514,161 C 574,151 574,191 514,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="514">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="786">3. Forward file to execution environment without sandbox isolation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1058" y1="239" x1="514"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="514">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1063">4. Launch container with default (root) privileges</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1063,287 C 1123,277 1123,317 1063,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1063">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1063">5. No resource limits or isolation enforced</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1063,365 C 1123,355 1123,395 1063,385"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1063">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="789">6. Execute file with minimal checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="443" x2="517" y1="443" x1="1061"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="447" x="1061">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="786">7. Run file in environment susceptible to injection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1058" y1="491" x1="514"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="514">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1063">8. No process-level confinement privileges are overâ€‘broad</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1063,539 C 1123,529 1123,569 1063,559"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1063">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="570">9. Return execution output without sandbox context validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="617" x2="79" y1="617" x1="1061"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="1061">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1352">10. Log execution events with insufficient details (missing container ID)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="1640" y1="665" x1="1063"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1063">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1645">11. Store logs in plaintext no tamperâ€‘proof storage</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1645,713 C 1705,703 1705,743 1645,733"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="1645">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="758" x="296">12. No sandbox breach alerts output returned as-is</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="791" x2="79" y1="791" x1="512"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="795" x="512">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="1355">13. Manual review needed no automated sandbox remediation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="839" x2="1066" y1="839" x1="1643"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="1643">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ File Execution Sandbox</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2211 945" height="945" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-324" style="width:2211px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="1780"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="1855"><tspan dy="0" x="1855">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CT" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="1124"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="1199"><tspan dy="0" x="1199">Container/VM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="533"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="608"><tspan dy="0" x="608">File Executor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="859" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="891.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="1855" y1="65" x1="1855" id="actor6296"></line><g id="root-6296"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1780"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1855"><tspan dy="0" x="1855">Logger</tspan></text></g></g><g><line name="CT" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="1199" y1="65" x1="1199" id="actor6295"></line><g id="root-6295"><rect class="actor actor-top" ry="3" rx="3" name="CT" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1124"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1199"><tspan dy="0" x="1199">Container/VM</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="608" y1="65" x1="608" id="actor6294"></line><g id="root-6294"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="533"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="608"><tspan dy="0" x="608">File Executor</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="859" x2="75" y1="65" x1="75" id="actor6293"></line><g id="root-6293"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-324{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-324 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-324 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-324 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-324 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-324 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-324 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-324 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-324 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-324 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-324 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-324 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-324 p{margin:0}#mermaid-6a213c2d99ee9aa5-324 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-324 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-324 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-324 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-324 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-324 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-324 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-324 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-324 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-324 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-324 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-324 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-324 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-324 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-324 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-324 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-324 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-324 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-324 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-324 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-324 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-324 .actor-man circle,#mermaid-6a213c2d99ee9aa5-324 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-324 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="340">1. Upload file over HTTPS preliminary static scanning performed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="604" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="609">2. Scan file for malware, injection signatures and validate metadata</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 609,161 C 669,151 669,191 609,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="609">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="902">3. Forward file to an isolated sandbox container with defined constraints</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1195" y1="239" x1="609"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="609">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1200">4. Launch container with nonâ€‘root user and strict security contexts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1200,287 C 1260,277 1260,317 1200,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1200">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="1200">5. Enforce resource quotas, seccomp, and limited capabilities</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1200,365 C 1260,355 1260,395 1200,385"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1200">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="905">6. Execute file with monitored environment and isolation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="443" x2="612" y1="443" x1="1198"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="447" x="1198">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="902">7. Dynamically monitor file process for abnormal behavior</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="1195" y1="491" x1="609"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="609">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1200">8. Apply process-level confinement and realâ€‘time threat detection</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1200,539 C 1260,529 1260,569 1200,559"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="1200">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="584" x="639">9. Return sanitized output with evidence of sandbox scanning</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="617" x2="79" y1="617" x1="1198"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="621" x="1198">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1526">10. Log execution details with container ID, timestamp, and user context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="1851" y1="665" x1="1200"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="1200">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1856">11. Store logs in encrypted, tamperâ€‘proof storage integrated with SIEM</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1856,713 C 1916,703 1916,743 1856,733"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="1856">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="758" x="343">12. Generate alert if sandbox breach is detected output filtered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="791" x2="79" y1="791" x1="607"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="795" x="607">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="806" x="1529">13. Trigger auto-remediation and forensic collection on abnormal process activity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="839" x2="1203" y1="839" x1="1854"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="843" x="1854">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">File Reception</td><td dir="ltr">â€¢ Unencrypted file upload; no malware scan<br>â€¢ No content validation</td><td dir="ltr">â€¢ HTTPS file upload; thorough malware/injection scanning conducted</td><td dir="ltr">Secure file uploads and perform deep content analysis</td></tr><tr><td dir="ltr">Execution Environment</td><td dir="ltr">â€¢ Launch container with root privileges<br>â€¢ No resource limits or confinement</td><td dir="ltr">â€¢ Use sandbox with nonâ€‘root user, seccomp, and resource limits</td><td dir="ltr">Run files in hardened, isolated environments with minimal privileges</td></tr><tr><td dir="ltr">Runtime Protection</td><td dir="ltr">â€¢ No process monitoring; wide privileges granted</td><td dir="ltr">â€¢ Dynamically monitor process behavior; enforce runtime confinement</td><td dir="ltr">Apply realâ€‘time monitoring and process confinement</td></tr><tr><td dir="ltr">Logging &amp; Incident Response</td><td dir="ltr">â€¢ Minimal logging in plaintext; manual review needed</td><td dir="ltr">â€¢ Detailed, encrypted logging integrated with SIEM; automated alerting and response</td><td dir="ltr">Log securely; automate incident response and forensic analysis</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Endpoint File Integrity Monitoring and Alerting" dir="auto" class="heading" id="Endpoint_File_Integrity_Monitoring_and_Alerting"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Endpoint File Integrity Monitoring and Alerting<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Use endpoint agents and file integrity monitoring (FIM) technology to detect unauthorized changes in file systems across enterprise endpoints.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Rootkit installation, file tampering, ransomware encryption.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;NIST SP 800-171, CIS Controls, continuous FIM and SIEM integration with real-time alerts.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;SOC analysts, incident responders, IT auditors; end-users, system administrators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Endpoint FIM</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1830.5 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-329" style="width:1830.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1497"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1572"><tspan dy="0" x="1572">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SI" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1048"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1123"><tspan dy="0" x="1123">SIEM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="511"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="586"><tspan dy="0" x="586">FIM Agent</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="EP" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Endpoint</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1572" y1="65" x1="1572" id="actor6300"></line><g id="root-6300"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1497"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1572"><tspan dy="0" x="1572">Logger</tspan></text></g></g><g><line name="SI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1123" y1="65" x1="1123" id="actor6299"></line><g id="root-6299"><rect class="actor actor-top" ry="3" rx="3" name="SI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1048"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1123"><tspan dy="0" x="1123">SIEM</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="586" y1="65" x1="586" id="actor6298"></line><g id="root-6298"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="511"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="586"><tspan dy="0" x="586">FIM Agent</tspan></text></g></g><g><line name="EP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6297"></line><g id="root-6297"><rect class="actor actor-top" ry="3" rx="3" name="EP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Endpoint</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-329{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-329 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-329 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-329 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-329 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-329 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-329 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-329 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-329 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-329 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-329 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-329 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-329 p{margin:0}#mermaid-6a213c2d99ee9aa5-329 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-329 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-329 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-329 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-329 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-329 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-329 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-329 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-329 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-329 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-329 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-329 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-329 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-329 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-329 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-329 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-329 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-329 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-329 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-329 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-329 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-329 .actor-man circle,#mermaid-6a213c2d99ee9aa5-329 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-329 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="329">1. Deploy agent with outdated baseline configurations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="582" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="587">2. Compute file hashes infrequently baseline not updated</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 587,161 C 647,151 647,191 587,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="587">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="332">3. Monitor files with minimal change detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="585">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="329">4. File changes made by local user</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="582" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="587">5. Detect changes using static hash values no contextual analysis</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 587,335 C 647,325 647,365 587,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="587">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="332">6. Report change without risk scoring</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="585">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1078">7. Log change events in plaintext with limited metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1568" y1="461" x1="587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="587">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1573">8. Logs stored locally no encryption applied</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1573,509 C 1633,499 1633,539 1573,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1573">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="332">9. No immediate block or remediation triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="79" y1="587" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="585">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1349">10. Forward logs in bulk after delay no realâ€‘time feed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1127" y1="635" x1="1571"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1571">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1124">11. SIEM correlates logs using static rule sets</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1124,683 C 1184,673 1184,713 1124,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1124">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="856">12. No automated alerts generated manual investigation required</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="590" y1="761" x1="1122"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1122">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="332">13. Endpoint remains exposed despite evidence of tampering</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="585">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Endpoint FIM</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2022 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-331" style="width:2022px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1611"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1686"><tspan dy="0" x="1686">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SI" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1183"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1258"><tspan dy="0" x="1258">SIEM</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="621"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="696"><tspan dy="0" x="696">FIM Agent</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="EP" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">Endpoint</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1686" y1="65" x1="1686" id="actor6304"></line><g id="root-6304"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1611"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1686"><tspan dy="0" x="1686">Logger</tspan></text></g></g><g><line name="SI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1258" y1="65" x1="1258" id="actor6303"></line><g id="root-6303"><rect class="actor actor-top" ry="3" rx="3" name="SI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1183"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1258"><tspan dy="0" x="1258">SIEM</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="696" y1="65" x1="696" id="actor6302"></line><g id="root-6302"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="621"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="696"><tspan dy="0" x="696">FIM Agent</tspan></text></g></g><g><line name="EP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6301"></line><g id="root-6301"><rect class="actor actor-top" ry="3" rx="3" name="EP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Endpoint</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-331{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-331 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-331 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-331 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-331 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-331 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-331 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-331 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-331 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-331 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-331 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-331 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-331 p{margin:0}#mermaid-6a213c2d99ee9aa5-331 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-331 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-331 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-331 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-331 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-331 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-331 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-331 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-331 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-331 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-331 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-331 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-331 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-331 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-331 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-331 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-331 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-331 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-331 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-331 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-331 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-331 .actor-man circle,#mermaid-6a213c2d99ee9aa5-331 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-331 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="384">1. Deploy updated agent with dynamic baseline initialization</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="692" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="697">2. Compute file hashes continuously update baseline periodically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 697,161 C 757,151 757,191 697,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="697">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="387">3. Establish secure baseline with context-aware metrics</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="695"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="695">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="384">4. File change event triggered by local process</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="692" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="697">5. Compute differential hash and risk score in real time</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 697,335 C 757,325 757,365 697,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="697">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="387">6. Immediately flag anomalous changes for further analysis</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="695"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="695">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="1190">7. Log file change events with full metadata, encrypted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="1682" y1="461" x1="697"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="697">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="1687">8. Store logs in tamperâ€‘proof format realâ€‘time replication to SIEM</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1687,509 C 1747,499 1747,539 1687,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="1687">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="387">9. Initiate immediate remediation (e.g. rollback, quarantine)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="79" y1="587" x1="695"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="695">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="1474">10. Transmit logs continuously via secure channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="1262" y1="635" x1="1685"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="1685">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="1259">11. Correlate endpoints data with threat intelligence dynamically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1259,683 C 1319,673 1319,713 1259,703"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1259">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="979">12. Autoâ€trigger alerts and incident response workflows immediately</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="700" y1="761" x1="1257"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1257">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="387">13. Enforce rapid isolation and notify administrators of potential compromise</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="695"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="695">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Agent Deployment</td><td dir="ltr">â€¢ Outdated baseline; infrequent hash computation</td><td dir="ltr">â€¢ Continuous, dynamic baseline update with context-aware monitoring</td><td dir="ltr">Update agents; compute hashes continuously; enforce dynamic baselines</td></tr><tr><td dir="ltr">Change Detection</td><td dir="ltr">â€¢ Static hash check; no risk scoring</td><td dir="ltr">â€¢ Differential hashing with realâ€‘time risk scoring</td><td dir="ltr">Use differential checks with realâ€‘time risk assessment</td></tr><tr><td dir="ltr">Logging</td><td dir="ltr">â€¢ Plaintext local logs; no encryption or realâ€‘time replication</td><td dir="ltr">â€¢ Encrypted, tamperâ€‘proof logs with full metadata; realâ€‘time SIEM feeds</td><td dir="ltr">Encrypt logs and integrate with SIEM for continuous monitoring</td></tr><tr><td dir="ltr">SIEM Integration</td><td dir="ltr">â€¢ Delayed log feed; manual investigation; no automated remediation</td><td dir="ltr">â€¢ Automated alerts; correlation with threat intel; immediate incident response</td><td dir="ltr">Transmit logs continuously; automate incident response</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Cloud File Storage with Encryption and Tokenization" dir="auto" class="heading" id="Secure_Cloud_File_Storage_with_Encryption_and_Tokenization"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Cloud File Storage with Encryption and Tokenization<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong>&nbsp;Deploy a cloud-based file management system that uses client-side encryption, tokenization for file references, and multi-factor authentication for access control.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong>&nbsp;Cloud misconfigurations, unauthorized cloud API access, key theft.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong>&nbsp;Cloud Security Alliance (CSA) guidelines, NIST SP 800-144, continuous cloud configuration scans, and vulnerability assessments.<br>â€¢&nbsp;<strong>Roles and Users:</strong>&nbsp;Cloud architects, security operations; enterprise employees, cloud service administrators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Cloud File Storage</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1605 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-336" style="width:1605px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1199"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1274"><tspan dy="0" x="1274">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="999"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1074"><tspan dy="0" x="1074">Token Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="464"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="539"><tspan dy="0" x="539">Cloud Storage</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1274" y1="65" x1="1274" id="actor6308"></line><g id="root-6308"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1199"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1274"><tspan dy="0" x="1274">Logger</tspan></text></g></g><g><line name="TM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1074" y1="65" x1="1074" id="actor6307"></line><g id="root-6307"><rect class="actor actor-top" ry="3" rx="3" name="TM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="999"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1074"><tspan dy="0" x="1074">Token Manager</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="539" y1="65" x1="539" id="actor6306"></line><g id="root-6306"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="464"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="539"><tspan dy="0" x="539">Cloud Storage</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6305"></line><g id="root-6305"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-336{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-336 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-336 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-336 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-336 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-336 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-336 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-336 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-336 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-336 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-336 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-336 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-336 p{margin:0}#mermaid-6a213c2d99ee9aa5-336 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-336 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-336 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-336 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-336 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-336 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-336 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-336 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-336 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-336 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-336 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-336 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-336 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-336 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-336 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-336 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-336 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-336 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-336 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-336 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-336 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-336 .actor-man circle,#mermaid-6a213c2d99ee9aa5-336 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-336 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="306">1. Upload file over HTTP without clientâ€side encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="535" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="805">2. Generate static file reference token without randomization</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1070" y1="161" x1="540"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="540">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="808">3. Return token with no expiration or revocation controls</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="543" y1="209" x1="1073"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1073">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="540">4. Store file in plaintext on cloud disk (or with weak encryption)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 540,257 C 600,247 600,287 540,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="540">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="309">5. Acknowledge storage token returned unencrypted</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="538"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="538">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="306">6. Request file using token over unsecured API calls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="535" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="805">7. Validate token using static mapping no MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1070" y1="431" x1="540"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="540">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="808">8. Return validation result without revoking compromised tokens</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="543" y1="479" x1="1073"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1073">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="905">9. Log file access events in plaintext with minimal metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1270" y1="527" x1="540"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="540">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1275">10. Store logs without encryption no anomaly detection enabled</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1275,575 C 1335,565 1335,605 1275,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1275">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="309">11. Return file as-is no reâ€‘encryption during transit</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="538"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="538">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="908">12. No automated alerts for suspicious API access patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="543" y1="701" x1="1273"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1273">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="309">13. Subsequent unauthorized access not prevented</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="538"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="538">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Cloud File Storage</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1732.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-338" style="width:1732.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1303"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1378"><tspan dy="0" x="1378">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1103"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1178"><tspan dy="0" x="1178">Token Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="521"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="596"><tspan dy="0" x="596">Cloud Storage</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1378" y1="65" x1="1378" id="actor6312"></line><g id="root-6312"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1303"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1378"><tspan dy="0" x="1378">Logger</tspan></text></g></g><g><line name="TM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1178" y1="65" x1="1178" id="actor6311"></line><g id="root-6311"><rect class="actor actor-top" ry="3" rx="3" name="TM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1103"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1178"><tspan dy="0" x="1178">Token Manager</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="596" y1="65" x1="596" id="actor6310"></line><g id="root-6310"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="521"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="596"><tspan dy="0" x="596">Cloud Storage</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6309"></line><g id="root-6309"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-338{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-338 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-338 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-338 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-338 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-338 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-338 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-338 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-338 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-338 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-338 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-338 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-338 p{margin:0}#mermaid-6a213c2d99ee9aa5-338 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-338 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-338 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-338 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-338 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-338 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-338 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-338 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-338 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-338 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-338 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-338 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-338 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-338 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-338 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-338 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-338 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-338 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-338 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-338 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-338 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-338 .actor-man circle,#mermaid-6a213c2d99ee9aa5-338 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-338 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="334">1. Upload file over HTTPS with clientâ€‘side encryption applied</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="592" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="886">2. Generate a randomized, timeâ€‘bound token for file reference</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1174" y1="161" x1="597"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="597">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="889">3. Return token with expiration and revocation controls</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="600" y1="209" x1="1177"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1177">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="597">4. Store file using strong encryption (AESâ€‘256) on encrypted cloud volume</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 597,257 C 657,247 657,287 597,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="597">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="337">5. Acknowledge receipt and store file metadata securely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="595">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="334">6. Request file using token over HTTPS with MFA challenge</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="592" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="886">7. Validate token with dynamic revocation checks and context (IP, MFA)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1174" y1="431" x1="597"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="597">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="889">8. Return successful validation token rotation triggered if needed</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="600" y1="479" x1="1177"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1177">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="986">9. Log access events with full metadata in encrypted, immutable log storage</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1374" y1="527" x1="597"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="597">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1379">10. Integrate logs with SIEM for realâ€‘time anomaly detection and alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1379,575 C 1439,565 1439,605 1379,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1379">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="337">11. Return file over secure channel with reâ€‘encryption in transit</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="595">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="989">12. Automated alerts trigger on access pattern deviations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="600" y1="701" x1="1377"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1377">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="337">13. Enforce periodic token refresh for continued access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="595"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="595">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">File Upload &amp; Tokenization</td><td dir="ltr">â€¢ Unencrypted upload<br>â€¢ Static, nonâ€‘expiring tokens</td><td dir="ltr">â€¢ HTTPS upload with clientâ€‘side encryption<br>â€¢ Randomized, timeâ€‘bound tokens with revocation control</td><td dir="ltr">Enforce clientâ€‘side encryption and secure tokenization with expiration and revocation</td></tr><tr><td dir="ltr">Data at Rest</td><td dir="ltr">â€¢ File stored in plaintext or weak encryption</td><td dir="ltr">â€¢ File stored with AESâ€‘256 on encrypted cloud volumes</td><td dir="ltr">Use strong encryption algorithms and secure cloud storage settings</td></tr><tr><td dir="ltr">Access Request</td><td dir="ltr">â€¢ Unsecured API calls; no MFA, static token validation</td><td dir="ltr">â€¢ Authenticated access over HTTPS with MFA; dynamic token validation using context</td><td dir="ltr">Enforce multifactor authentication and dynamic token validation</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Logs in plaintext; no anomaly detection; manual review</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logging; automated alerts for suspicious access</td><td dir="ltr">Log events securely; integrate with SIEM and enforce continuous monitoring</td></tr></tbody></table></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Front-end" dir="auto" class="heading" id="Front-end"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Front-end<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Output Encoding" dir="auto" class="heading" id="Secure_Output_Encoding"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Output Encoding<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Design a multi-stage client-side rendering pipeline that automatically encodes output from all user-supplied data in templates and components, leveraging framework-native sanitization libraries.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Cross-Site Scripting (XSS), DOM-based XSS, injection attacks.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>OWASP XSS Prevention Cheat Sheet, SANS Top 25, automated SAST scans using ESLint plugins.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Frontend developers, security architect, QA/testers; end-users accessing the web application.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Output Encoding &amp; XSS Prevention</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1478 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-344" style="width:1478px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1164.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1239.5"><tspan dy="0" x="1239.5">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TP" height="65" width="164" stroke="#666" fill="#eaeaea" y="799" x="939"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1021"><tspan dy="0" x="1021">Template Processor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="480"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="555"><tspan dy="0" x="555">Frontend App</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1239.5" y1="65" x1="1239.5" id="actor6316"></line><g id="root-6316"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1164.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1239.5"><tspan dy="0" x="1239.5">Logger</tspan></text></g></g><g><line name="TP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1021" y1="65" x1="1021" id="actor6315"></line><g id="root-6315"><rect class="actor actor-top" ry="3" rx="3" name="TP" height="65" width="164" stroke="#666" fill="#eaeaea" y="0" x="939"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1021"><tspan dy="0" x="1021">Template Processor</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="555" y1="65" x1="555" id="actor6314"></line><g id="root-6314"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="480"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="555"><tspan dy="0" x="555">Frontend App</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6313"></line><g id="root-6313"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-344{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-344 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-344 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-344 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-344 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-344 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-344 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-344 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-344 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-344 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-344 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-344 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-344 p{margin:0}#mermaid-6a213c2d99ee9aa5-344 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-344 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-344 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-344 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-344 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-344 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-344 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-344 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-344 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-344 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-344 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-344 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-344 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-344 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-344 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-344 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-344 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-344 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-344 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-344 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-344 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-344 .actor-man circle,#mermaid-6a213c2d99ee9aa5-344 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-344 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="314">1. Submit data with malicious script tags via form (HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="551" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="556">2. Accept raw input without sanitization</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 556,161 C 616,151 616,191 556,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="556">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="787">3. Forward unsanitized data to template renderer</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1017" y1="239" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="556">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1022">4. Insert raw user data into HTML templates</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1022,287 C 1082,277 1082,317 1022,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1022">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="790">5. Generate page output with injected script tags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="559" y1="365" x1="1020"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1020">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="317">6. Deliver output causing script execution (DOM XSS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="554"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="554">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="314">7. Attack payload executed in browser context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="551" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="787">8. No encoding of dynamic content data remains raw</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1017" y1="509" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="556">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="896">9. Log rendering event with minimal context (plaintext)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1235.5" y1="557" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="556">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1241">10. Store log without integrity controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1240.5,605 C 1300.5,595 1300.5,635 1240.5,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1240.5">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="787">11. No automated sanitization feedback loop triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="1017" y1="683" x1="556"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="556">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="790">12. Continue using legacy unsanitized render functions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="559" y1="731" x1="1020"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1020">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="659">13. No alerts raised on suspicious script injections</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="1238.5"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1238.5">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Output Encoding &amp; XSS Prevention</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1848 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-346" style="width:1848px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1454"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1529"><tspan dy="0" x="1529">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TP" height="65" width="164" stroke="#666" fill="#eaeaea" y="799" x="1138"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1220"><tspan dy="0" x="1220">Template Processor</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="571"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="646"><tspan dy="0" x="646">Frontend App</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1529" y1="65" x1="1529" id="actor6320"></line><g id="root-6320"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1454"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1529"><tspan dy="0" x="1529">Logger</tspan></text></g></g><g><line name="TP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1220" y1="65" x1="1220" id="actor6319"></line><g id="root-6319"><rect class="actor actor-top" ry="3" rx="3" name="TP" height="65" width="164" stroke="#666" fill="#eaeaea" y="0" x="1138"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1220"><tspan dy="0" x="1220">Template Processor</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="646" y1="65" x1="646" id="actor6318"></line><g id="root-6318"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="571"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="646"><tspan dy="0" x="646">Frontend App</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6317"></line><g id="root-6317"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-346{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-346 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-346 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-346 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-346 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-346 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-346 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-346 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-346 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-346 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-346 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-346 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-346 p{margin:0}#mermaid-6a213c2d99ee9aa5-346 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-346 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-346 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-346 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-346 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-346 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-346 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-346 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-346 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-346 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-346 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-346 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-346 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-346 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-346 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-346 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-346 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-346 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-346 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-346 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-346 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-346 .actor-man circle,#mermaid-6a213c2d99ee9aa5-346 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-346 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="359">1. Submit data over HTTPS with proper content-type</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="642" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="647">2. Validate input via whitelist and context checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 647,161 C 707,151 707,191 647,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="647">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="932">3. Sanitize and encode input before sending to renderer</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1216" y1="239" x1="647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="647">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1221">4. Apply frameworkâ€‘native encoding functions to all dynamic content</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1221,287 C 1281,277 1281,317 1221,307"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1221">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="935">5. Render HTML output with encoded data (e.g., &amp;lt instead of &lt;)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="365" x2="650" y1="365" x1="1219"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="369" x="1219">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="362">6. Deliver output over HTTPS encoded data prevents script execution</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="645"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="645">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="359">7. Browser displays safe rendered page with no injected code run</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="642" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="932">8. Enforce data binding using secure templating functions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1216" y1="509" x1="647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="647">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="935">9. Use strict mode and autoâ€‘escaping features consistently</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="650" y1="557" x1="1219"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1219">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1086">10. Log every render event with encoded data, userID, and timestamp</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1525" y1="605" x1="647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="647">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1530">11. Store logs in encrypted repository with integrity checking</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1530,653 C 1590,643 1590,683 1530,673"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1530">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="932">12. Trigger automated alerts on detection of suspicious input patterns</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="1216" y1="731" x1="647"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="647">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="804">13. Continuous monitoring feeds anomaly alerts to security dashboard</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="1528"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1528">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Data Input</td><td dir="ltr">â€¢ Accepts raw input; no validation<br>â€¢ Uses HTTP</td><td dir="ltr">â€¢ Uses HTTPS; validates data against whitelist; performs encoding</td><td dir="ltr">Secure transmission and input validation</td></tr><tr><td dir="ltr">Template Rendering</td><td dir="ltr">â€¢ Inserts raw input directly<br>â€¢ No output encoding</td><td dir="ltr">â€¢ Applies frameworkâ€‘native autoâ€‘escaping and context-sensitive encoding</td><td dir="ltr">Always encode output appropriately</td></tr><tr><td dir="ltr">Browser Rendering</td><td dir="ltr">â€¢ Delivers output that executes injected scripts</td><td dir="ltr">â€¢ Delivers fully encoded output preventing XSS</td><td dir="ltr">Prevent script execution via proper sanitization</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Minimal, plaintext logging; no alerts<br>â€¢ No monitoring of injections</td><td dir="ltr">â€¢ Detailed, encrypted logs; automated anomaly alerts integrated into SIEM</td><td dir="ltr">Implement comprehensive logging and realâ€‘time alerting</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Content Security Policy (CSP) Enforcement with Nonce-based Scripts" dir="auto" class="heading" id="Content_Security_Policy_(CSP)_Enforcement_with_Nonce-based_Scripts"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Content Security Policy (CSP) Enforcement with Nonce-based Scripts<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Implement a strict CSP with dynamic nonce generation on script tags and inline styles to ensure that only approved scripts are executed.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Inline script injection, code injection, and mixed-content attacks.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>OWASP CSP Cheat Sheet, NIST SP 800-53 rev. 4 AC-3, periodic CSP header audits.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Security engineers, DevOps, frontend architects; web users and API clients.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ CSP without Nonce Enforcement</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1709.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-351" style="width:1709.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1378"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1453"><tspan dy="0" x="1453">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CSP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="950"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1025"><tspan dy="0" x="1025">CSP Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="479"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="554"><tspan dy="0" x="554">Frontend</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SV" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1453" y1="65" x1="1453" id="actor6324"></line><g id="root-6324"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1378"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1453"><tspan dy="0" x="1453">Logger</tspan></text></g></g><g><line name="CSP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1025" y1="65" x1="1025" id="actor6323"></line><g id="root-6323"><rect class="actor actor-top" ry="3" rx="3" name="CSP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="950"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1025"><tspan dy="0" x="1025">CSP Module</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="554" y1="65" x1="554" id="actor6322"></line><g id="root-6322"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="479"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="554"><tspan dy="0" x="554">Frontend</tspan></text></g></g><g><line name="SV" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6321"></line><g id="root-6321"><rect class="actor actor-top" ry="3" rx="3" name="SV" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-351{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-351 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-351 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-351 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-351 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-351 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-351 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-351 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-351 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-351 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-351 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-351 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-351 p{margin:0}#mermaid-6a213c2d99ee9aa5-351 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-351 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-351 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-351 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-351 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-351 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-351 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-351 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-351 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-351 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-351 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-351 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-351 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-351 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-351 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-351 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-351 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-351 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-351 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-351 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-351 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-351 .actor-man circle,#mermaid-6a213c2d99ee9aa5-351 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-351 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="313">1. Serve HTML over HTTP without CSP headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="550" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="788">2. Load page without CSP enforcement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1021" y1="161" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="555">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="791">3. Render inline scripts without nonce attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="558" y1="209" x1="1024"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1024">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="316">4. Execute all inline scripts, including untrusted code</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="553"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="553">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="555">5. Malicious scripts injected into page execute automatically</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 555,305 C 615,295 615,335 555,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="555">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="788">6. No runtime check of inline content unsafe scripts run</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="1021" y1="383" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="555">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="1002">7. Log page load events without CSP violation data</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1449" y1="431" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="555">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="1454">8. Store logs in plaintext no CSP audit trails</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1454,479 C 1514,469 1514,509 1454,499"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1454">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="313">9. No CSP header modifications on subsequent requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="550" y1="557" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="788">10. No dynamic enforcement of nonce-based policies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="1021" y1="605" x1="555"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="555">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1238">11. Fails to log CSP errors due to misconfiguration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1449" y1="653" x1="1026"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="1026">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1005">12. No alerts for inline script injections</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="558" y1="701" x1="1452"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1452">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="316">13. Client shows vulnerable page subject to XSS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="553"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="553">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ CSP with Nonce-based Scripts</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-159 -10 1802 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-353" style="width:1802px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1250"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1325"><tspan dy="0" x="1325">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CSP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1050"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1125"><tspan dy="0" x="1125">CSP Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="552"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="627"><tspan dy="0" x="627">Frontend</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SV" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1325" y1="65" x1="1325" id="actor6328"></line><g id="root-6328"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1250"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1325"><tspan dy="0" x="1325">Logger</tspan></text></g></g><g><line name="CSP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1125" y1="65" x1="1125" id="actor6327"></line><g id="root-6327"><rect class="actor actor-top" ry="3" rx="3" name="CSP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1050"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1125"><tspan dy="0" x="1125">CSP Module</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="627" y1="65" x1="627" id="actor6326"></line><g id="root-6326"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="552"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="627"><tspan dy="0" x="627">Frontend</tspan></text></g></g><g><line name="SV" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6325"></line><g id="root-6325"><rect class="actor actor-top" ry="3" rx="3" name="SV" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Server</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-353{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-353 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-353 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-353 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-353 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-353 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-353 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-353 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-353 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-353 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-353 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-353 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-353 p{margin:0}#mermaid-6a213c2d99ee9aa5-353 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-353 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-353 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-353 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-353 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-353 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-353 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-353 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-353 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-353 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-353 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-353 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-353 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-353 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-353 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-353 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-353 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-353 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-353 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-353 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-353 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-353 .actor-man circle,#mermaid-6a213c2d99ee9aa5-353 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-353 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="76">1. Generate dynamic nonce per request serverâ€‘side</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,113 C 136,103 136,143 76,133"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="158" x="350">2. Serve HTML over HTTPS with strict CSP header including nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="191" x2="623" y1="191" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="195" x="76">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="599">3. Inject nonce attributes into all inline script/style tags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1121" y1="239" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="878">4. Render page with valid nonces attached to inline content</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="631" y1="287" x1="1124"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1124">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="353">5. Browser enforces CSP executes only scripts with valid nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="626"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="626">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="350">6. Reject any inline scripts lacking proper nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="623" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="875">7. Validate inline script integrity using nonce match</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1121" y1="431" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="628">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="878">8. Allow only approved scripts block others</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="631" y1="479" x1="1124"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1124">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="975">9. Log CSP events with nonce values, userID, and violation details</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1321" y1="527" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="628">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1326">10. Store logs in encrypted SIEMâ€‘integrated repository with alerts enabled</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1326,575 C 1386,565 1386,605 1326,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1326">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="875">11. Periodically refresh nonce per session to prevent replay</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1121" y1="653" x1="628"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="628">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="602">12. Monitor CSP injection attempts trigger security responses</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1124"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1124">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="702">13. Generate automated alerts on CSP violations and notify security teams</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="1324"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1324">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Response Delivery</td><td dir="ltr">â€¢ No CSP headers<br>â€¢ Served over unsecured HTTP</td><td dir="ltr">â€¢ HTTPS with strict CSP headers including dynamic nonce</td><td dir="ltr">Always serve content over HTTPS with strict CSP</td></tr><tr><td dir="ltr">Nonce Generation</td><td dir="ltr">â€¢ No dynamic nonce; inline scripts lack nonce attributes</td><td dir="ltr">â€¢ Dynamic nonce injected into all inline script/style tags</td><td dir="ltr">Use dynamic nonce on inline scripts to prevent injection</td></tr><tr><td dir="ltr">CSP Enforcement</td><td dir="ltr">â€¢ Browser executes all inline scripts</td><td dir="ltr">â€¢ Browser enforces CSP; only scripts carrying the valid nonce are executed</td><td dir="ltr">Enforce CSP at runtime to restrict script execution</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Minimal logging; no CSP audit trail</td><td dir="ltr">â€¢ Detailed, encrypted logging of all CSP events with automated alerts</td><td dir="ltr">Monitor CSP violations in real time and integrate with SIEM</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Cross-Origin Resource Sharing (CORS) Enforcement" dir="auto" class="heading" id="Secure_Cross-Origin_Resource_Sharing_(CORS)_Enforcement"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Cross-Origin Resource Sharing (CORS) Enforcement<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Design a middleware layer and frontend configuration that whitelists trusted domains and implements strict CORS policies with dynamic preflight requests handled securely.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Cross-site request forgery (CSRF), data exfiltration through misconfigured headers.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>OWASP CORS Cheat Sheet, ISO/IEC 27001 guidelines, regular header configuration validation.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Network security engineers, frontend developers; third-party integrators and external users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ CORS without Proper Whitelisting</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1718 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-358" style="width:1718px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1362"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1437"><tspan dy="0" x="1437">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1162"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1237"><tspan dy="0" x="1237">API Service</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="548"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="623"><tspan dy="0" x="623">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1437" y1="65" x1="1437" id="actor6332"></line><g id="root-6332"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1362"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1437"><tspan dy="0" x="1437">Logger</tspan></text></g></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1237" y1="65" x1="1237" id="actor6331"></line><g id="root-6331"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1162"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1237"><tspan dy="0" x="1237">API Service</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="623" y1="65" x1="623" id="actor6330"></line><g id="root-6330"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="548"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="623"><tspan dy="0" x="623">Middleware</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6329"></line><g id="root-6329"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-358{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-358 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-358 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-358 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-358 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-358 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-358 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-358 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-358 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-358 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-358 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-358 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-358 p{margin:0}#mermaid-6a213c2d99ee9aa5-358 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-358 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-358 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-358 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-358 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-358 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-358 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-358 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-358 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-358 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-358 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-358 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-358 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-358 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-358 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-358 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-358 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-358 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-358 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-358 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-358 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-358 .actor-man circle,#mermaid-6a213c2d99ee9aa5-358 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-358 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="348">1. Send cross-origin request from untrusted domain (HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="619" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="624">2. Accept request without checking origin header</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 624,161 C 684,151 684,191 624,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="624">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="929">3. Forward request with permissive Access-Control-Allow-Origin header (*)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1233" y1="239" x1="624"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="624">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="348">4. Send preflight OPTIONS request without verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="619" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="929">5. Respond with default permissive headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="1233" y1="335" x1="624"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="624">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="932">6. Return sensitive data without CORS protection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="627" y1="383" x1="1236"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1236">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="351">7. Allow client from any origin to access response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="622"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="622">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="348">8. Repeated requests from untrusted domains yield data exposure</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="619" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1029">9. Log request details without origin validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1433" y1="527" x1="624"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="624">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1438">10. Store logs in plaintext no CORS violation alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1438,575 C 1498,565 1498,605 1438,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1438">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="929">11. No correlation of suspicious origins is done</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1233" y1="653" x1="624"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="624">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="932">12. Continue serving requests to any domain</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="627" y1="701" x1="1236"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1236">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1032">13. No alerts on anomalous cross-origin activity generated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="627" y1="749" x1="1436"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1436">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Strict CORS Enforcement</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1839 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-360" style="width:1839px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1401"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1476"><tspan dy="0" x="1476">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1276"><tspan dy="0" x="1276">API Service</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="683"><tspan dy="0" x="683">Middleware</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1476" y1="65" x1="1476" id="actor6336"></line><g id="root-6336"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1401"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1476"><tspan dy="0" x="1476">Logger</tspan></text></g></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1276" y1="65" x1="1276" id="actor6335"></line><g id="root-6335"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1201"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1276"><tspan dy="0" x="1276">API Service</tspan></text></g></g><g><line name="MW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="683" y1="65" x1="683" id="actor6334"></line><g id="root-6334"><rect class="actor actor-top" ry="3" rx="3" name="MW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="683"><tspan dy="0" x="683">Middleware</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6333"></line><g id="root-6333"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-360{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-360 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-360 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-360 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-360 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-360 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-360 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-360 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-360 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-360 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-360 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-360 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-360 p{margin:0}#mermaid-6a213c2d99ee9aa5-360 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-360 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-360 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-360 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-360 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-360 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-360 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-360 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-360 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-360 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-360 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-360 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-360 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-360 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-360 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-360 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-360 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-360 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-360 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-360 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-360 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-360 .actor-man circle,#mermaid-6a213c2d99ee9aa5-360 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-360 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="378">1. Send cross-origin request from trusted domain over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="679" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="684">2. Validate Origin header against whitelist</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 684,161 C 744,151 744,191 684,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="684">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="978">3. Forward request only if origin is trusted set strict CORS headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1272" y1="239" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="684">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="378">4. Send preflight OPTIONS request with valid headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="679" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="978">5. Respond with Access-Control-Allow-Origin set to trusted domain only</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="1272" y1="335" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="684">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="981">6. Return sensitive data secured with strict CORS headers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="687" y1="383" x1="1275"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="1275">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="381">7. Deliver data only to allowed origins enforce additional header validations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="682"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="682">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="378">8. Subsequent requests require valid preflight verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="679" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1078">9. Log each request with origin, timestamp, and header details in encrypted logs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1472" y1="527" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="684">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1477">10. Integrate logs with SIEM for dynamic correlation of suspicious origins</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1477,575 C 1537,565 1537,605 1477,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1477">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="978">11. Block requests from nonâ€‘whitelisted origins immediately</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1272" y1="653" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="684">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="981">12. Return error responses to unauthorized domains</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="687" y1="701" x1="1275"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1275">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1081">13. Trigger instant alerts on any CORS policy violations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="687" y1="749" x1="1475"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1475">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Request Handling</td><td dir="ltr">â€¢ Accepts all origins; uses wildcard (*)</td><td dir="ltr">â€¢ Validates origin against a trusted whitelist</td><td dir="ltr">Whitelist trusted origins only</td></tr><tr><td dir="ltr">Preflight Handling</td><td dir="ltr">â€¢ Responds permissively to OPTIONS requests without check</td><td dir="ltr">â€¢ Enforces strict preflight validation; returns CORS header for trusted domain only</td><td dir="ltr">Validate preflight requests thoroughly</td></tr><tr><td dir="ltr">Data Exposure</td><td dir="ltr">â€¢ Sensitive data returned to any origin</td><td dir="ltr">â€¢ Sensitive data delivered only to trusted origins with strict headers</td><td dir="ltr">Prevent unauthorized access via strict CORS enforcement</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal logging with plaintext; no alerts on cross-origin anomalies</td><td dir="ltr">â€¢ Detailed, encrypted logging with SIEM integration and automated alerts</td><td dir="ltr">Monitor CORS events and generate realâ€‘time alerts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Framework Hardening for Modern SPA (React/Angular/Vue)" dir="auto" class="heading" id="Framework_Hardening_for_Modern_SPA_(React/Angular/Vue)"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Framework Hardening for Modern SPA (React/Angular/Vue)<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Configure the chosen SPA framework with secure defaults (e.g., strict mode, secure state handling) and disable unused APIs.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Client-side injection, DOM manipulation, unintentional data leakage due to framework misconfiguration.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>OWASP SPA Security guidelines, vendor-specific security bulletins, automated config scans in CI/CD.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Frontend developers, application architects, security auditors; enterprise web app users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Unhardened SPA Framework</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1635.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-365" style="width:1635.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1258"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1333"><tspan dy="0" x="1333">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1058"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1133"><tspan dy="0" x="1133">Config Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="514"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="589"><tspan dy="0" x="589">Framework Core</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Frontend SPA</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1333" y1="65" x1="1333" id="actor6340"></line><g id="root-6340"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1258"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1333"><tspan dy="0" x="1333">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1133" y1="65" x1="1133" id="actor6339"></line><g id="root-6339"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1058"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1133"><tspan dy="0" x="1133">Config Store</tspan></text></g></g><g><line name="FW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="589" y1="65" x1="589" id="actor6338"></line><g id="root-6338"><rect class="actor actor-top" ry="3" rx="3" name="FW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="514"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="589"><tspan dy="0" x="589">Framework Core</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6337"></line><g id="root-6337"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Frontend SPA</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-365{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-365 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-365 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-365 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-365 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-365 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-365 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-365 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-365 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-365 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-365 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-365 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-365 p{margin:0}#mermaid-6a213c2d99ee9aa5-365 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-365 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-365 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-365 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-365 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-365 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-365 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-365 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-365 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-365 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-365 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-365 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-365 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-365 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-365 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-365 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-365 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-365 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-365 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-365 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-365 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-365 .actor-man circle,#mermaid-6a213c2d99ee9aa5-365 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-365 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="331">1. Initialize SPA with default insecure configuration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="585" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="860">2. Load settings with lax security (no strict mode, debug enabled)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1129" y1="161" x1="590"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="590">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="334">3. Enable all APIs and unused functions by default</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="79" y1="209" x1="588"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="588">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="331">4. Render components without state isolation or strict checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="585" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="331">5. Bind user data directly to DOM without sanitization</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="585" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="334">6. Render output with risk of injection and DOM manipulation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="588"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="588">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="960">7. Log rendering events without security context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1329" y1="401" x1="590"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="590">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1334">8. Store logs in plaintext no alerts for suspicious activity</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1334,449 C 1394,439 1394,479 1334,469"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1334">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="331">9. Continue processing insecure configurations on refresh</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="585" y1="527" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="860">10. No configuration update or autoâ€‘hardening</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="1129" y1="575" x1="590"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="590">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="706">11. No proactive monitoring for DOM anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="79" y1="623" x1="1332"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="1332">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="331">12. Reuse session state without secure validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="585" y1="671" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="960">13. Minimal logging no overwatch of critical configuration changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="1329" y1="719" x1="590"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="590">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Hardened SPA Framework</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1846.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-367" style="width:1846.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1374"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1449"><tspan dy="0" x="1449">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1174"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1249"><tspan dy="0" x="1249">Config Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FW" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="683"><tspan dy="0" x="683">Framework Core</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Frontend SPA</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1449" y1="65" x1="1449" id="actor6344"></line><g id="root-6344"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1374"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1449"><tspan dy="0" x="1449">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1249" y1="65" x1="1249" id="actor6343"></line><g id="root-6343"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1174"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1249"><tspan dy="0" x="1249">Config Store</tspan></text></g></g><g><line name="FW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="683" y1="65" x1="683" id="actor6342"></line><g id="root-6342"><rect class="actor actor-top" ry="3" rx="3" name="FW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="608"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="683"><tspan dy="0" x="683">Framework Core</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6341"></line><g id="root-6341"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Frontend SPA</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-367{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-367 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-367 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-367 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-367 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-367 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-367 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-367 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-367 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-367 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-367 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-367 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-367 p{margin:0}#mermaid-6a213c2d99ee9aa5-367 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-367 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-367 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-367 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-367 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-367 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-367 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-367 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-367 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-367 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-367 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-367 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-367 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-367 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-367 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-367 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-367 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-367 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-367 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-367 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-367 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-367 .actor-man circle,#mermaid-6a213c2d99ee9aa5-367 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-367 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="378">1. Initialize SPA over HTTPS with secure boot parameters</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="679" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="965">2. Load hardened settings (strict mode, secure state, disable debug)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1245" y1="161" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="684">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="378">3. Verify that unused APIs are disabled secure defaults enforced</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="679" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="381">4. Expose only essential APIs with secure endpoints</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="682"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="682">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="378">5. Render components with strict state isolation and error boundaries</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="679" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="378">6. Bind user data with automatic sanitization via frameworkâ€‘native libraries</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="679" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="381">7. Render output with proper contextâ€‘aware encoding preventing injection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="79" y1="401" x1="682"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="682">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1065">8. Log all framework initialization and rendering events with security metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1445" y1="449" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="684">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1450">9. Store logs encrypted with SIEM integration and automated alerts for config drift</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1450,497 C 1510,487 1510,527 1450,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1450">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="378">10. Enforce periodic reâ€‘initialization with secure settings</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="679" y1="575" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="965">11. Automatic hardening updates pushed to configuration store</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="1245" y1="623" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="684">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="764">12. Trigger alerts on anomalous state changes or DOM manipulations</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="79" y1="671" x1="1448"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1448">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="1065">13. Maintain continuous audit trail of secure configuration enforcement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="1445" y1="719" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="684">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">SPA Initialization</td><td dir="ltr">â€¢ Loads insecure default config; debug mode enabled</td><td dir="ltr">â€¢ Loads hardened config with strict mode; debug and unused APIs disabled</td><td dir="ltr">Harden default configuration; enforce secure bootstrap settings</td></tr><tr><td dir="ltr">API Exposure</td><td dir="ltr">â€¢ Exposes all APIs; lacks state isolation</td><td dir="ltr">â€¢ Exposes only necessary APIs; enforces secure state handling</td><td dir="ltr">Minimize exposed APIs and enforce state isolation</td></tr><tr><td dir="ltr">Data Binding</td><td dir="ltr">â€¢ Direct data binding without sanitization</td><td dir="ltr">â€¢ Autoâ€‘sanitization with frameworkâ€‘native libraries preventing injection</td><td dir="ltr">Always sanitize output using framework tools</td></tr><tr><td dir="ltr">Logging &amp; Hardening</td><td dir="ltr">â€¢ Minimal, plaintext logs; no automated configuration drift monitoring</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logs; periodic autoâ€‘hardening and alerts for config changes</td><td dir="ltr">Secure logging and continuous configuration hardening</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Third-Party Script Management and Subresource Integrity" dir="auto" class="heading" id="Secure_Third-Party_Script_Management_and_Subresource_Integrity"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Third-Party Script Management and Subresource Integrity<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Integrate third-party scripts with Subresource Integrity (SRI) checks and sandboxing mechanisms to minimize risks from external resources.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Supply chain compromise, malicious modifications, script injection.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST SP 800-161, OWASP Secure Third-Party Libraries, continuous monitoring for external resource changes.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Vendor management, DevOps, security analysts; end-users, integration teams.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Thirdâ€‘Party Script Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-187.5 -10 1411 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-372" style="width:1411px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="919"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="994"><tspan dy="0" x="994">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SB" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="719"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="794"><tspan dy="0" x="794">Sandbox (absent)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TS" height="65" width="204" stroke="#666" fill="#eaeaea" y="799" x="465"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="567"><tspan dy="0" x="567">Thirdâ€‘Party Script Loader</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Frontend App</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="994" y1="65" x1="994" id="actor6348"></line><g id="root-6348"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="919"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="994"><tspan dy="0" x="994">Logger</tspan></text></g></g><g><line name="SB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="794" y1="65" x1="794" id="actor6347"></line><g id="root-6347"><rect class="actor actor-top" ry="3" rx="3" name="SB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="719"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="794"><tspan dy="0" x="794">Sandbox (absent)</tspan></text></g></g><g><line name="TS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="567" y1="65" x1="567" id="actor6346"></line><g id="root-6346"><rect class="actor actor-top" ry="3" rx="3" name="TS" height="65" width="204" stroke="#666" fill="#eaeaea" y="0" x="465"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="567"><tspan dy="0" x="567">Thirdâ€‘Party Script Loader</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6345"></line><g id="root-6345"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Frontend App</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-372{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-372 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-372 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-372 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-372 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-372 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-372 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-372 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-372 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-372 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-372 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-372 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-372 p{margin:0}#mermaid-6a213c2d99ee9aa5-372 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-372 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-372 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-372 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-372 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-372 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-372 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-372 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-372 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-372 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-372 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-372 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-372 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-372 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-372 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-372 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-372 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-372 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-372 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-372 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-372 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-372 .actor-man circle,#mermaid-6a213c2d99ee9aa5-372 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-372 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="320">1. Include thirdâ€‘party script from external URL without SRI</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="563" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="323">2. Load script into global scope without integrity validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="566"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="566">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="76">3. Execute thirdâ€‘party script without sandbox restrictions</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,209 C 136,199 136,239 76,229"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="320">4. Allow script access to DOM and sensitive functions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="563" y1="287" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="76">5. Script may modify DOM or exfiltrate data without checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,335 C 136,325 136,365 76,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="323">6. No cryptographic check prevents tampering</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="566"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="566">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="533">7. Log loading events in plaintext without SRI checks recorded</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="990" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="995">8. Store logs without alerts for script modification</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 995,509 C 1055,499 1055,539 995,529"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="995">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="320">9. Continue to load scripts even when altered at source</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="587" x2="563" y1="587" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="323">10. No fallback or block on signature mismatch</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="566"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="566">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="536">11. No automated audits of external script versions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="79" y1="683" x1="993"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="993">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="533">12. No sandbox restrictions applied risk persists</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="990" y1="731" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="782">13. Inadequate response to external script anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="571" y1="779" x1="993"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="993">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Thirdâ€‘Party Script Management</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1399.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-374" style="width:1399.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="968"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1043"><tspan dy="0" x="1043">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SB" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="768"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="843"><tspan dy="0" x="843">Security Sandbox</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TS" height="65" width="204" stroke="#666" fill="#eaeaea" y="739" x="514"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="616"><tspan dy="0" x="616">Thirdâ€‘Party Script Loader</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Frontend App</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1043" y1="65" x1="1043" id="actor6352"></line><g id="root-6352"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="968"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1043"><tspan dy="0" x="1043">Logger</tspan></text></g></g><g><line name="SB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="843" y1="65" x1="843" id="actor6351"></line><g id="root-6351"><rect class="actor actor-top" ry="3" rx="3" name="SB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="768"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="843"><tspan dy="0" x="843">Security Sandbox</tspan></text></g></g><g><line name="TS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="616" y1="65" x1="616" id="actor6350"></line><g id="root-6350"><rect class="actor actor-top" ry="3" rx="3" name="TS" height="65" width="204" stroke="#666" fill="#eaeaea" y="0" x="514"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="616"><tspan dy="0" x="616">Thirdâ€‘Party Script Loader</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6349"></line><g id="root-6349"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Frontend App</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-374{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-374 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-374 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-374 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-374 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-374 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-374 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-374 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-374 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-374 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-374 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-374 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-374 p{margin:0}#mermaid-6a213c2d99ee9aa5-374 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-374 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-374 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-374 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-374 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-374 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-374 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-374 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-374 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-374 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-374 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-374 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-374 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-374 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-374 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-374 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-374 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-374 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-374 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-374 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-374 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-374 .actor-man circle,#mermaid-6a213c2d99ee9aa5-374 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-374 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="344">1. Include thirdâ€‘party script with SRI hash attribute in HTTPS tags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="612" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="347">2. Retrieve script and verify SRI hash before execution</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="615"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="615">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="458">3. Execute script within an isolated sandboxed iframe or worker context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="839" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="461">4. Restrict script's access to DOM and sensitive functions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="842">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="344">5. Periodically reâ€‘validate script SRI hash via automated checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="612" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="347">6. Block or fallback if SRI mismatch is detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="615"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="615">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="458">7. Enforce runtime policies preventing data exfiltration</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="839" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="461">8. Monitor script behavior dynamically and block suspicious actions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="79" y1="449" x1="842"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="842">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="558">9. Log thirdâ€‘party script load events with SRI validation results (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="497" x2="1039" y1="497" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="512" x="1044">10. Integrate logs with SIEM to trigger alerts on external script changes</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1044,545 C 1104,535 1104,575 1044,565"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="549" x="1044">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="344">11. Automatically update or rollback scripts on SRI failure</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="612" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="347">12. Enforce version pinning and integrity checks regularly</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="79" y1="671" x1="615"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="615">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="561">13. Continuous review of script usage metrics with automated incident response</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="1042"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="1042">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Script Inclusion</td><td dir="ltr">â€¢ No SRI; scripts loaded into global scope</td><td dir="ltr">â€¢ Include scripts using SRI and HTTPS</td><td dir="ltr">Use SRI and HTTPS to verify thirdâ€‘party scripts</td></tr><tr><td dir="ltr">Script Execution</td><td dir="ltr">â€¢ Executes without sandbox; full DOM access</td><td dir="ltr">â€¢ Execute scripts in a sandboxed environment to control permissions</td><td dir="ltr">Sandbox thirdâ€‘party code to minimize exposure</td></tr><tr><td dir="ltr">Integrity Verification</td><td dir="ltr">â€¢ No periodic checks; no fallback on tampering</td><td dir="ltr">â€¢ Automated, periodic SRI reâ€‘validation; block on mismatch</td><td dir="ltr">Continuously monitor and validate external scripts</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Logs minimal events; no automated alerts</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logs; automated alerts and version pinning</td><td dir="ltr">Log and alert on any modifications to external scripts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Handling of Cookies and Client-Side Storage" dir="auto" class="heading" id="Secure_Handling_of_Cookies_and_Client-Side_Storage"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Handling of Cookies and Client-Side Storage<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Enforce secure cookie attributes (HttpOnly, Secure, SameSite) and encrypt data stored in client-side storage (localStorage, IndexedDB) when needed.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Session hijacking, cookie theft, local data tampering.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>OWASP Cookie Security Guidelines, NIST SP 800-63B, browser security testing tools.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Frontend and backend developers, security operations; end-users, compliance officers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Cookie &amp; Storage Handling</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1704.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-379" style="width:1704.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1340"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1415"><tspan dy="0" x="1415">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1140"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1215"><tspan dy="0" x="1215">Client Storage</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="153" stroke="#666" fill="#eaeaea" y="739" x="614.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="691"><tspan dy="0" x="691">Application Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1415" y1="65" x1="1415" id="actor6356"></line><g id="root-6356"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1340"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1415"><tspan dy="0" x="1415">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1215" y1="65" x1="1215" id="actor6355"></line><g id="root-6355"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1140"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1215"><tspan dy="0" x="1215">Client Storage</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="691" y1="65" x1="691" id="actor6354"></line><g id="root-6354"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="153" stroke="#666" fill="#eaeaea" y="0" x="614.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="691"><tspan dy="0" x="691">Application Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6353"></line><g id="root-6353"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-379{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-379 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-379 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-379 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-379 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-379 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-379 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-379 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-379 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-379 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-379 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-379 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-379 p{margin:0}#mermaid-6a213c2d99ee9aa5-379 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-379 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-379 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-379 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-379 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-379 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-379 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-379 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-379 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-379 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-379 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-379 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-379 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-379 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-379 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-379 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-379 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-379 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-379 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-379 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-379 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-379 .actor-man circle,#mermaid-6a213c2d99ee9aa5-379 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-379 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="382">1. Log in over HTTP server issues session cookie without flags</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="687" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="385">2. Set cookie without HttpOnly, Secure, or SameSite attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="690">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="382">3. Transmit cookie on subsequent HTTP requests cookie vulnerable to theft</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="687" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="952">4. Store minimal config data in localStorage without encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1211" y1="257" x1="692"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="692">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="647">5. Expose sensitive data in localStorage which is readable by scripts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="79" y1="305" x1="1214"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1214">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="382">6. Reuse insecure cookie across sessions no reâ€‘validation triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="687" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="952">7. Fail to refresh cookie or data encryption on session renewal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1211" y1="401" x1="692"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="692">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1052">8. Log cookie issuance and usage in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1411" y1="449" x1="692"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="692">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1416">9. Store logs without integrity or encryption controls</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1416,497 C 1476,487 1476,527 1416,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1416">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="385">10. Continue accepting cookies even after session hijack detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="79" y1="575" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="690">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="382">11. No MFA or dynamic reâ€‘authentication triggered by abnormal access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="687" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="1055">12. No automated alerts on cookie modification or tampering detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="695" y1="671" x1="1414"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1414">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="385">13. Client-side storage remains exposed to crossâ€‘site script access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="690"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="690">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Cookie &amp; Storage Handling</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1955 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-381" style="width:1955px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1495"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1570"><tspan dy="0" x="1570">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1295"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1370"><tspan dy="0" x="1370">Client Storage</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="153" stroke="#666" fill="#eaeaea" y="739" x="633.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="710"><tspan dy="0" x="710">Application Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1570" y1="65" x1="1570" id="actor6360"></line><g id="root-6360"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1495"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1570"><tspan dy="0" x="1570">Logger</tspan></text></g></g><g><line name="CS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1370" y1="65" x1="1370" id="actor6359"></line><g id="root-6359"><rect class="actor actor-top" ry="3" rx="3" name="CS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1295"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1370"><tspan dy="0" x="1370">Client Storage</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="710" y1="65" x1="710" id="actor6358"></line><g id="root-6358"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="153" stroke="#666" fill="#eaeaea" y="0" x="633.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="710"><tspan dy="0" x="710">Application Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6357"></line><g id="root-6357"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-381{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-381 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-381 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-381 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-381 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-381 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-381 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-381 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-381 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-381 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-381 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-381 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-381 p{margin:0}#mermaid-6a213c2d99ee9aa5-381 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-381 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-381 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-381 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-381 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-381 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-381 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-381 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-381 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-381 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-381 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-381 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-381 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-381 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-381 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-381 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-381 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-381 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-381 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-381 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-381 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-381 .actor-man circle,#mermaid-6a213c2d99ee9aa5-381 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-381 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="391">1. Log in over HTTPS with MFA server issues session cookie</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="706" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="394">2. Set cookie with HttpOnly, Secure, and SameSite=strict attributes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="709"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="709">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="391">3. Transmit cookie only over HTTPS with certificate validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="706" y1="209" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="76">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="1039">4. Store sensitive data in localStorage/IndexedDB encrypted via clientâ€‘side crypto</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1366" y1="257" x1="711"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="711">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="391">5. Request sensitive operation cookie dynamically reâ€‘validated with short TTL</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="706" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="394">6. Rotate token and enforce dynamic reâ€‘authentication upon abnormal activity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="709"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="709">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="391">7. Subsequent requests require cookie reâ€‘validation and context check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="706" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1139">8. Log every cookie issuance and update event with full metadata in encrypted logs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1566" y1="449" x1="711"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="711">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1571">9. Store logs in SIEMâ€‘integrated, tamperâ€‘proof repository with integrity checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1571,497 C 1631,487 1631,527 1571,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1571">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="394">10. Proactively notify client of imminent nonce expiry and require renewal</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="79" y1="575" x1="709"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="709">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="1142">11. Trigger immediate alerts on any detected cookie tampering</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="714" y1="623" x1="1569"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="1569">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="394">12. Deny access if cookie fails reâ€‘authentication and integrity verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="79" y1="671" x1="709"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="709">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="1142">13. Continuously monitor and correlate abnormal session patterns with risk engines</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="714" y1="719" x1="1569"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="1569">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Cookie Issuance</td><td dir="ltr">â€¢ Issued over HTTP; missing HttpOnly, Secure, SameSite</td><td dir="ltr">â€¢ Issued over HTTPS; proper cookie attributes enforce security</td><td dir="ltr">Always issue cookies securely with strict attributes</td></tr><tr><td dir="ltr">Client-Side Storage</td><td dir="ltr">â€¢ Data stored unencrypted; accessible via scripts</td><td dir="ltr">â€¢ Store sensitive data in encrypted client storage</td><td dir="ltr">Encrypt clientâ€‘side data and restrict script access</td></tr><tr><td dir="ltr">Session Management</td><td dir="ltr">â€¢ Longâ€‘lived cookie; no dynamic reâ€‘validation</td><td dir="ltr">â€¢ Short token lifetime; dynamic token rotation with contextâ€‘based reâ€‘authentication</td><td dir="ltr">Implement short sessions and frequent token rotation</td></tr><tr><td dir="ltr">Logging &amp; Auditing</td><td dir="ltr">â€¢ Logs in plaintext; no anomaly alerts</td><td dir="ltr">â€¢ Encrypted logs with SIEM integration and realâ€‘time alerts</td><td dir="ltr">Securely log authentication events and monitor session anomalies</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Client-Side Encryption and Key Management" dir="auto" class="heading" id="Client-Side_Encryption_and_Key_Management"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Client-Side Encryption and Key Management<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Implement JavaScript libraries that perform client-side encryption before data is transmitted or stored, with keys managed via secure browser APIs or external key vaults.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Key leakage, man-in-the-middle decryption, crypto attacks on weak algorithms.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST Cryptographic Standards, FIPS 140-2, periodic cryptographic code reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Security architects, frontend developers, cryptography experts; high-privilege users, data officers.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Clientâ€‘Side Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1645.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-386" style="width:1645.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1253"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1328"><tspan dy="0" x="1328">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1053"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1128"><tspan dy="0" x="1128">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="517"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="592"><tspan dy="0" x="592">Frontend App</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1328" y1="65" x1="1328" id="actor6364"></line><g id="root-6364"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1253"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1328"><tspan dy="0" x="1328">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1128" y1="65" x1="1128" id="actor6363"></line><g id="root-6363"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1053"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1128"><tspan dy="0" x="1128">Key Manager</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="592" y1="65" x1="592" id="actor6362"></line><g id="root-6362"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="517"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="592"><tspan dy="0" x="592">Frontend App</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6361"></line><g id="root-6361"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-386{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-386 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-386 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-386 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-386 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-386 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-386 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-386 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-386 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-386 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-386 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-386 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-386 p{margin:0}#mermaid-6a213c2d99ee9aa5-386 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-386 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-386 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-386 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-386 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-386 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-386 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-386 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-386 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-386 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-386 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-386 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-386 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-386 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-386 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-386 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-386 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-386 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-386 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-386 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-386 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-386 .actor-man circle,#mermaid-6a213c2d99ee9aa5-386 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-386 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="332">1. User submits data over HTTP FE uses hardcoded weak key</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="588" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="859">2. Retrieves static key from local config without secure API</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1124" y1="161" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="593">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="862">3. Returns weak, hardcoded key with no rotation</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="596" y1="209" x1="1127"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1127">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="593">4. Encrypts user data with weak symmetric encryption (e.g., DES)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 593,257 C 653,247 653,287 593,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="593">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="335">5. Sends encrypted data over unsecured connection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="591">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="859">6. Key stored locally without proper protection vulnerable to leak</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="1124" y1="383" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="593">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="862">7. No secure key exchange static key reused across sessions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="596" y1="431" x1="1127"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1127">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="335">8. Encrypted data susceptible to decryption by MITM attacker</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="79" y1="479" x1="591"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="591">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="959">9. Log encryption event in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1324" y1="527" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="593">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1329">10. Logs stored without encryption no key audit trail created</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1329,575 C 1389,565 1389,605 1329,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1329">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="859">11. No automated key rotation triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1124" y1="653" x1="593"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="593">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="862">12. Key compromise remains undetected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="596" y1="701" x1="1127"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1127">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="962">13. No alerts insecure key usage persists</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="596" y1="749" x1="1327"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1327">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Clientâ€‘Side Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1787.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-388" style="width:1787.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1397"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1472"><tspan dy="0" x="1472">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1197"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1272"><tspan dy="0" x="1272">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="600"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="675"><tspan dy="0" x="675">Frontend App</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1472" y1="65" x1="1472" id="actor6368"></line><g id="root-6368"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1397"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1472"><tspan dy="0" x="1472">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1272" y1="65" x1="1272" id="actor6367"></line><g id="root-6367"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1197"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1272"><tspan dy="0" x="1272">Key Manager</tspan></text></g></g><g><line name="FE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="675" y1="65" x1="675" id="actor6366"></line><g id="root-6366"><rect class="actor actor-top" ry="3" rx="3" name="FE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="600"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="675"><tspan dy="0" x="675">Frontend App</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6365"></line><g id="root-6365"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-388{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-388 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-388 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-388 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-388 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-388 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-388 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-388 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-388 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-388 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-388 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-388 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-388 p{margin:0}#mermaid-6a213c2d99ee9aa5-388 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-388 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-388 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-388 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-388 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-388 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-388 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-388 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-388 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-388 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-388 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-388 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-388 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-388 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-388 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-388 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-388 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-388 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-388 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-388 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-388 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-388 .actor-man circle,#mermaid-6a213c2d99ee9aa5-388 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-388 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="374">1. User submits data over HTTPS FE initiates secure key request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="671" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="972">2. Request ephemeral, cryptographically strong key via secure API</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1268" y1="161" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="676">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="975">3. Return a unique AESâ€‘256 key with a short lifetime and usage policy</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="679" y1="209" x1="1271"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1271">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="676">4. Encrypt user data using AESâ€‘256 with the ephemeral key</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 676,257 C 736,247 736,287 676,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="676">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="377">5. Transmit encrypted data over HTTPS with integrity verification (HMAC)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="674"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="674">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="972">6. Request key rotation if session context changes or on expiry</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="1268" y1="383" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="676">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="975">7. Automatically rotate keys with audit trace enabled</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="431" x2="679" y1="431" x1="1271"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="1271">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="972">8. Enforce secure key exchange using Diffieâ€‘Hellman or similar protocols</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1268" y1="479" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="676">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1072">9. Log all encryption events with key ID, timestamp, and integrity metrics (encrypted logs)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1468" y1="527" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="676">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1473">10. Store logs in a tamperâ€‘proof SIEMâ€‘integrated repository</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1473,575 C 1533,565 1533,605 1473,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1473">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="972">11. Validate key usage continuously trigger rotation on anomaly detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1268" y1="653" x1="676"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="676">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="975">12. Audit key lifecycle events and revoke compromised keys immediately</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="679" y1="701" x1="1271"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1271">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1075">13. Generate automated alerts on any key management anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="679" y1="749" x1="1471"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1471">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Key Management</td><td dir="ltr">â€¢ Uses hardcoded, weak key<br>â€¢ No secure key exchange, no rotation</td><td dir="ltr">â€¢ Retrieves ephemeral AESâ€‘256 key via secure API<br>â€¢ Automated rotation and secure key exchange</td><td dir="ltr">Use strong, ephemeral keys with automated rotation and secure exchange</td></tr><tr><td dir="ltr">Data Encryption</td><td dir="ltr">â€¢ Weak encryption (e.g., DES); transmitted over insecure connection</td><td dir="ltr">â€¢ Encrypt data with AESâ€‘256; transmit over HTTPS with HMAC integrity verification</td><td dir="ltr">Use strong encryption algorithms (AESâ€‘256) and integrity verification</td></tr><tr><td dir="ltr">Key Exposure</td><td dir="ltr">â€¢ Key stored locally without protection; static key reused</td><td dir="ltr">â€¢ Keys managed externally and rotated securely; key lifecycle audited</td><td dir="ltr">Protect key storage and enforce periodic, secure key rotation</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal plaintext logging; no audit trail for key management</td><td dir="ltr">â€¢ Detailed, encrypted logging with SIEM integration; automated alerts and full key audit trail</td><td dir="ltr">Log all key events securely and monitor continuously</td></tr></tbody></table></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Cryptography" dir="auto" class="heading" id="Cryptography"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Cryptography<div class="heading-after">...</div></h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="Symmetric Encryption for Data-at-Rest" dir="auto" class="heading" id="Symmetric_Encryption_for_Data-at-Rest"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Symmetric Encryption for Data-at-Rest<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Utilize AES-256 in GCM or CBC mode for encrypting files and databases. Multi-stage implementation covers encryption during storage, secure key management, and decryption controlled by access policies.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Side-channel attacks, key-reuse vulnerabilities, padding oracle attacks.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST SP 800-38, FIPS 197, periodic cryptographic code reviews and penetration tests.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Data protection officers, storage admins; cloud engineers, backup operators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Symmetric Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1599 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-394" style="width:1599px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1310"><tspan dy="0" x="1310">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KC" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1035"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1110"><tspan dy="0" x="1110">Key Config</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ST" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="511"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="586"><tspan dy="0" x="586">Storage Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1310" y1="65" x1="1310" id="actor6372"></line><g id="root-6372"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1310"><tspan dy="0" x="1310">Logger</tspan></text></g></g><g><line name="KC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1110" y1="65" x1="1110" id="actor6371"></line><g id="root-6371"><rect class="actor actor-top" ry="3" rx="3" name="KC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1035"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1110"><tspan dy="0" x="1110">Key Config</tspan></text></g></g><g><line name="ST" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="586" y1="65" x1="586" id="actor6370"></line><g id="root-6370"><rect class="actor actor-top" ry="3" rx="3" name="ST" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="511"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="586"><tspan dy="0" x="586">Storage Server</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6369"></line><g id="root-6369"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-394{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-394 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-394 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-394 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-394 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-394 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-394 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-394 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-394 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-394 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-394 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-394 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-394 p{margin:0}#mermaid-6a213c2d99ee9aa5-394 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-394 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-394 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-394 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-394 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-394 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-394 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-394 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-394 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-394 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-394 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-394 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-394 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-394 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-394 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-394 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-394 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-394 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-394 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-394 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-394 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-394 .actor-man circle,#mermaid-6a213c2d99ee9aa5-394 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-394 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="329">1. Upload file over HTTP with no encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="582" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="847">2. Retrieve hardcoded symmetric key (weak key)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1106" y1="161" x1="587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="587">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="850">3. Returns static key no rotation enforced</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="590" y1="209" x1="1109"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1109">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="587">4. Encrypt file using AESâ€‘256 in CBC mode with fixed IV</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 587,257 C 647,247 647,287 587,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="587">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="332">5. Confirm storage with basic status (unencrypted metadata)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="585">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="329">6. Request file retrieval with no reâ€‘authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="582" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="847">7. Reuse same static key to decrypt file without context checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1106" y1="431" x1="587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="587">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="850">8. Returns same key no integrity or freshness verification</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="590" y1="479" x1="1109"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1109">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="947">9. Log encryption/decryption events in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1306" y1="527" x1="587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="587">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1311">10. Store logs without encryption or integrity checks</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1311,575 C 1371,565 1371,605 1311,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1311">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="332">11. Deliver decrypted file over plain HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="585"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="585">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="950">12. No alerts on repeated key use detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="590" y1="701" x1="1309"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1309">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="947">13. Audit trail remains incomplete and vulnerable</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1306" y1="749" x1="587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="587">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Symmetric Encryption</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1824.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-396" style="width:1824.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1358"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1433"><tspan dy="0" x="1433">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1158"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1233"><tspan dy="0" x="1233">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ST" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="520"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="595"><tspan dy="0" x="595">Storage Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1433" y1="65" x1="1433" id="actor6376"></line><g id="root-6376"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1358"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1433"><tspan dy="0" x="1433">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1233" y1="65" x1="1233" id="actor6375"></line><g id="root-6375"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1158"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1233"><tspan dy="0" x="1233">Key Manager</tspan></text></g></g><g><line name="ST" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="595" y1="65" x1="595" id="actor6374"></line><g id="root-6374"><rect class="actor actor-top" ry="3" rx="3" name="ST" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="520"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="595"><tspan dy="0" x="595">Storage Server</tspan></text></g></g><g><line name="CL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6373"></line><g id="root-6373"><rect class="actor actor-top" ry="3" rx="3" name="CL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Client</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-396{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-396 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-396 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-396 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-396 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-396 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-396 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-396 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-396 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-396 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-396 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-396 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-396 p{margin:0}#mermaid-6a213c2d99ee9aa5-396 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-396 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-396 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-396 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-396 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-396 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-396 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-396 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-396 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-396 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-396 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-396 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-396 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-396 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-396 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-396 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-396 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-396 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-396 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-396 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-396 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-396 .actor-man circle,#mermaid-6a213c2d99ee9aa5-396 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-396 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="334">1. Upload file over HTTPS with client authentication</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="591" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="913">2. Request ephemeral AESâ€‘256 key via secure API</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1229" y1="161" x1="596"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="596">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="916">3. Return a unique key with a short lifetime and usage policy</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="599" y1="209" x1="1232"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1232">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="596">4. Encrypt file using AESâ€‘256 in GCM mode (integrity builtâ€‘in) with randomized IV</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 596,257 C 656,247 656,287 596,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="596">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="337">5. Acknowledge secure storage with encryption metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="594"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="594">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="334">6. Request file retrieval over HTTPS with valid token</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="591" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="913">7. Validate and, if needed, rotate key before decryption based on access policy</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="1229" y1="431" x1="596"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="596">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="916">8. Confirm key validity and provide updated key if necessary</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="479" x2="599" y1="479" x1="1232"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="1232">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1013">9. Log each encryption/decryption event with key ID, timestamp, and user context (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="1429" y1="527" x1="596"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="596">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="1434">10. Store logs in a tamperâ€‘proof, SIEMâ€‘integrated repository with realâ€‘time alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1434,575 C 1494,565 1494,605 1434,595"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="1434">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="337">11. Deliver decrypted file over HTTPS with integrity verification</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="79" y1="653" x1="594"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="594">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="1016">12. Autoâ€‘trigger alerts on anomalous key usage or repeated requests</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="599" y1="701" x1="1432"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1432">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="1013">13. Maintain complete, audited trail for compliance and forensic review</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1429" y1="749" x1="596"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="596">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Data Upload &amp; Key Retrieval</td><td dir="ltr">â€¢ Upload over HTTP; hardcoded static key; no rotation</td><td dir="ltr">â€¢ HTTPS upload; dynamic ephemeral key fetched via secure API; key lifetime enforced</td><td dir="ltr">Use TLS, dynamic key generation, and enforce key rotation</td></tr><tr><td dir="ltr">Encryption Process</td><td dir="ltr">â€¢ Uses AESâ€‘256 CBC with fixed IV; no integrity checks</td><td dir="ltr">â€¢ Uses AESâ€‘256 GCM with randomized IV; builtâ€‘in integrity verification</td><td dir="ltr">Use strong modes with random IVs and integrity guarantees</td></tr><tr><td dir="ltr">Access &amp; Decryption</td><td dir="ltr">â€¢ No reâ€‘authentication; reused static key for decryption; no context check</td><td dir="ltr">â€¢ Dynamic reâ€‘authentication and key validation before decryption</td><td dir="ltr">Reâ€‘validate access continuously and rotate keys if needed</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Plaintext logs; no integrity; no alerts</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logging; automated alerts on anomalies</td><td dir="ltr">Secure logging with automated monitoring and complete audit trails</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Hardware Security Module (HSM) Integration" dir="auto" class="heading" id="Hardware_Security_Module_(HSM)_Integration"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Hardware Security Module (HSM) Integration<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Deploy HSMs for secure key generation, storage, and cryptographic operations. Multi-stage integration covers key lifecycle management, access control policies on HSMs, and secure channel communication with applications.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Physical tampering, side-channel leakage, key extraction via hardware exploits.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>FIPS 140-2/3, Common Criteria, periodic HSM penetration testing and attestation reviews.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Hardware security engineers, cryptographic key managers; enterprise security operations, compliance teams.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ HSM Integration</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-143 -10 1807.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-401" style="width:1807.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1324"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1399"><tspan dy="0" x="1399">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KC" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1124"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1199"><tspan dy="0" x="1199">Key Config</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="HSM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="671"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="746"><tspan dy="0" x="746">HSM Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1399" y1="65" x1="1399" id="actor6380"></line><g id="root-6380"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1324"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1399"><tspan dy="0" x="1399">Logger</tspan></text></g></g><g><line name="KC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1199" y1="65" x1="1199" id="actor6379"></line><g id="root-6379"><rect class="actor actor-top" ry="3" rx="3" name="KC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1124"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1199"><tspan dy="0" x="1199">Key Config</tspan></text></g></g><g><line name="HSM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="746" y1="65" x1="746" id="actor6378"></line><g id="root-6378"><rect class="actor actor-top" ry="3" rx="3" name="HSM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="671"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="746"><tspan dy="0" x="746">HSM Module</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6377"></line><g id="root-6377"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-401{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-401 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-401 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-401 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-401 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-401 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-401 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-401 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-401 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-401 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-401 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-401 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-401 p{margin:0}#mermaid-6a213c2d99ee9aa5-401 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-401 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-401 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-401 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-401 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-401 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-401 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-401 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-401 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-401 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-401 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-401 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-401 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-401 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-401 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-401 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-401 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-401 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-401 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-401 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-401 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-401 .actor-man circle,#mermaid-6a213c2d99ee9aa5-401 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-401 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="409">1. Request key generation over unencrypted channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="742" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="971">2. Generate key using default, lowâ€‘entropy settings</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1195" y1="161" x1="747"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="747">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="974">3. Return key without attestation or tamper detection</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="750" y1="209" x1="1198"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1198">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="412">4. Provide key for cryptographic operations without access controls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="745">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="76">5. Store key in volatile memory with no rotation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,305 C 136,295 136,335 76,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="409">6. Perform cryptographic operations no secure channel used between AP and HSM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="742" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="412">7. Return results without additional integrity scheduling</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="745">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="736">8. Log key usage events in plaintext with minimal metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1395" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1400">9. Store logs locally without encryption or tamper detection</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1400,527 C 1460,517 1460,557 1400,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1400">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="412">10. No periodic attestation or self-test initiated</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="79" y1="605" x1="745"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="745">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="409">11. Reuse key for extended periods</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="742" y1="653" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="739">12. No alerts on potential physical tampering or sideâ€‘channel anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1398"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1398">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="736">13. Audit trail lacks critical HSM configuration changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1395" y1="749" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ HSM Integration</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-243 -10 2131 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-403" style="width:2131px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1475"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1550"><tspan dy="0" x="1550">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1275"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1350"><tspan dy="0" x="1350">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="HSM" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="662"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="737"><tspan dy="0" x="737">HSM Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1550" y1="65" x1="1550" id="actor6384"></line><g id="root-6384"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1475"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1550"><tspan dy="0" x="1550">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1350" y1="65" x1="1350" id="actor6383"></line><g id="root-6383"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1275"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1350"><tspan dy="0" x="1350">Key Manager</tspan></text></g></g><g><line name="HSM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="737" y1="65" x1="737" id="actor6382"></line><g id="root-6382"><rect class="actor actor-top" ry="3" rx="3" name="HSM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="662"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="737"><tspan dy="0" x="737">HSM Module</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6381"></line><g id="root-6381"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-403{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-403 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-403 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-403 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-403 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-403 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-403 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-403 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-403 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-403 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-403 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-403 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-403 p{margin:0}#mermaid-6a213c2d99ee9aa5-403 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-403 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-403 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-403 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-403 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-403 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-403 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-403 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-403 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-403 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-403 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-403 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-403 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-403 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-403 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-403 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-403 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-403 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-403 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-403 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-403 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-403 .actor-man circle,#mermaid-6a213c2d99ee9aa5-403 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-403 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="405">1. Request key generation over TLS-secured channel with attestation request</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="733" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1042">2. Generate highâ€‘entropy key with builtâ€‘in tamper detection and attestation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1346" y1="161" x1="738"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="738">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1045">3. Return key with digital certificate and secure audit trail</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="741" y1="209" x1="1349"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1349">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="408">4. Provide key for cryptographic operations over a mutually authenticated channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="736"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="736">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="76">5. Use key in volatile secure memory with enforced periodic rotation policy</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,305 C 136,295 136,335 76,325"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="405">6. Perform operations (sign, decrypt) with key using secure API calls</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="733" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="408">7. Return cryptographic results with integrity and confidentiality checks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="736"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="736">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="811">8. Log all HSM interactions, including key generation and usage, with full metadata (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1546" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1551">9. Store logs in tamperâ€‘proof, SIEMâ€‘integrated repository with automated alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1551,527 C 1611,517 1611,557 1551,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1551">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="405">10. Periodically request key attestation and selfâ€‘tests from HSM</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="733" y1="605" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="1042">11. Rotate keys automatically upon policy triggers</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1346" y1="653" x1="738"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="738">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="814">12. Trigger alerts on any abnormal HSM activity or configuration changes</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1549"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1549">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="811">13. Maintain continuous audit trail for regulatory compliance and forensic review</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="1546" y1="749" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="76">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Key Generation</td><td dir="ltr">â€¢ Unencrypted requests; lowâ€‘entropy keys; no attestation</td><td dir="ltr">â€¢ TLSâ€‘secured key requests; highâ€‘entropy keys with digital attestation; tamper detection</td><td dir="ltr">Use secure channels and require attestation for key generation</td></tr><tr><td dir="ltr">Key Storage/Usage</td><td dir="ltr">â€¢ Key stored insecurely; reused for extended periods; no dynamic rotation</td><td dir="ltr">â€¢ Keys used only transiently in secure memory; periodic rotation enforced with mutual auth</td><td dir="ltr">Enforce strict key lifetime and rotation policies</td></tr><tr><td dir="ltr">Cryptographic Operations</td><td dir="ltr">â€¢ Operations performed over unsecure channels; no integrated integrity checks</td><td dir="ltr">â€¢ Secure API calls between app and HSM; integrity and confidentiality verified within operations</td><td dir="ltr">Use mutually authenticated channels and verified cryptographic operations</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Plaintext logs; no SIEM integration; missing tamper alerts</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logs with detailed HSM event tracking and automated alerts</td><td dir="ltr">Log all HSM events securely and monitor continuously</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Digital Signature Implementation and Verification" dir="auto" class="heading" id="Digital_Signature_Implementation_and_Verification"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Digital Signature Implementation and Verification<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Implement digital signatures using RSA, ECDSA, or EdDSA to establish non-repudiation. Multi-stage signature process includes document digest creation, signing with a private key, and verification using a public key distributed via PKI.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Forgeries, replay attacks, key compromise.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>X.509, RFC 7519, continuous signature verification and audit trails; regular red teaming assessments.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Application developers, legal compliance teams, security testers; end-users, document control administrators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Digital Signatures</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1636 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-408" style="width:1636px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1223"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1298"><tspan dy="0" x="1298">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PK" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1023"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1098"><tspan dy="0" x="1098">Private Key Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="583"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="658"><tspan dy="0" x="658">Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Document</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1298" y1="65" x1="1298" id="actor6388"></line><g id="root-6388"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1223"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1298"><tspan dy="0" x="1298">Logger</tspan></text></g></g><g><line name="PK" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1098" y1="65" x1="1098" id="actor6387"></line><g id="root-6387"><rect class="actor actor-top" ry="3" rx="3" name="PK" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1023"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1098"><tspan dy="0" x="1098">Private Key Store</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="658" y1="65" x1="658" id="actor6386"></line><g id="root-6386"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="583"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="658"><tspan dy="0" x="658">Application</tspan></text></g></g><g><line name="DOC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6385"></line><g id="root-6385"><rect class="actor actor-top" ry="3" rx="3" name="DOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Document</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-408{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-408 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-408 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-408 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-408 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-408 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-408 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-408 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-408 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-408 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-408 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-408 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-408 p{margin:0}#mermaid-6a213c2d99ee9aa5-408 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-408 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-408 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-408 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-408 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-408 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-408 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-408 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-408 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-408 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-408 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-408 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-408 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-408 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-408 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-408 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-408 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-408 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-408 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-408 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-408 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-408 .actor-man circle,#mermaid-6a213c2d99ee9aa5-408 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-408 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="365">1. Submit document for signing with unsanitized input over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="654" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="659">2. Compute message digest using weak hash (e.g. MD5)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 659,161 C 719,151 719,191 659,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="659">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="877">3. Retrieve static private key stored in plaintext</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1094" y1="239" x1="659"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="659">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="880">4. Return private key without proper access control</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="662" y1="287" x1="1097"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1097">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="659">5. Create digital signature using weak signature algorithm</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 659,335 C 719,325 719,365 659,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="659">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="368">6. Distribute signed document with no timestamp or nonce</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="657"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="657">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="365">7. Accept document on subsequent replays without verification context</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="654" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="977">8. Log signing events with minimal data (plaintext digest)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="1294" y1="509" x1="659"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="659">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1299">9. Store logs without encryption and without PKI validation events</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1299,557 C 1359,547 1359,587 1299,577"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="1299">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="602" x="368">10. Allow signature forgery due to missing revocation lists</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="635" x2="79" y1="635" x1="657"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="639" x="657">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="980">11. No alerts on reâ€‘play or duplicate signing events</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="662" y1="683" x1="1297"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="1297">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="368">12. Document delivered without verification of integrity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="79" y1="731" x1="657"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="657">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="980">13. Absence of audit trails for later forensic review</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="662" y1="779" x1="1297"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="1297">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Digital Signatures</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1909 885" height="885" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-410" style="width:1909px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1444"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1519"><tspan dy="0" x="1519">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="1244"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="1319"><tspan dy="0" x="1319">Key Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="672"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="747"><tspan dy="0" x="747">Application</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="799" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="831.5" x="75"><tspan dy="0" x="75">Document</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1519" y1="65" x1="1519" id="actor6392"></line><g id="root-6392"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1444"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1519"><tspan dy="0" x="1519">Logger</tspan></text></g></g><g><line name="KM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="1319" y1="65" x1="1319" id="actor6391"></line><g id="root-6391"><rect class="actor actor-top" ry="3" rx="3" name="KM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1244"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1319"><tspan dy="0" x="1319">Key Manager</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="747" y1="65" x1="747" id="actor6390"></line><g id="root-6390"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="672"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="747"><tspan dy="0" x="747">Application</tspan></text></g></g><g><line name="DOC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="799" x2="75" y1="65" x1="75" id="actor6389"></line><g id="root-6389"><rect class="actor actor-top" ry="3" rx="3" name="DOC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Document</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-410{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-410 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-410 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-410 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-410 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-410 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-410 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-410 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-410 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-410 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-410 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-410 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-410 p{margin:0}#mermaid-6a213c2d99ee9aa5-410 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-410 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-410 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-410 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-410 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-410 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-410 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-410 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-410 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-410 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-410 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-410 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-410 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-410 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-410 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-410 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-410 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-410 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-410 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-410 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-410 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-410 .actor-man circle,#mermaid-6a213c2d99ee9aa5-410 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-410 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="410">1. Submit document over HTTPS with validated input</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="743" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="748">2. Compute strong digest (e.g. SHA-256) with added salt/nonce</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 748,161 C 808,151 808,191 748,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="748">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="1032">3. Request private key via secure interface from PKI vault</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="1315" y1="239" x1="748"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="748">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1035">4. Return private key via secure, ephemeral method with usage policy</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="287" x2="751" y1="287" x1="1318"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="1318">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="748">5. Sign document with robust algorithm (e.g. RSA-4096, ECDSA) incorporating timestamp</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 748,335 C 808,325 808,365 748,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="748">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="413">6. Embed signature, timestamp, and nonce in signed document</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="413" x2="79" y1="413" x1="746"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="746">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="428" x="410">7. Verify signatures using public key from trusted PKI repository</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="461" x2="743" y1="461" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="465" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="476" x="413">8. Validate certificate chain and revocation status</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="509" x2="79" y1="509" x1="746"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="513" x="746">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="524" x="1132">9. Log signing events with full metadata (key ID, timestamp, hash) in encrypted format</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="557" x2="1515" y1="557" x1="748"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="561" x="748">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="1520">10. Store logs in SIEM-integrated tamperâ€‘proof repository with automated alerts</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1520,605 C 1580,595 1580,635 1520,625"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="1520">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="650" x="413">11. Return verified, signed document and certificate information to client</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="683" x2="79" y1="683" x1="746"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="687" x="746">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="698" x="1135">12. Trigger alerts on any verification failure or suspicious re-use</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="731" x2="751" y1="731" x1="1518"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="735" x="1518">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="746" x="413">13. Enforce continuous verification and periodic reâ€‘assessment of digital signatures</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="779" x2="79" y1="779" x1="746"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="783" x="746">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Digest Creation</td><td dir="ltr">â€¢ Uses weak hash (MD5); no nonce or salt; delivered over HTTP</td><td dir="ltr">â€¢ Uses strong hash (SHAâ€‘256) with salt/nonce; delivered over HTTPS</td><td dir="ltr">Use strong hashing and include nonce/timestamp</td></tr><tr><td dir="ltr">Signing Process</td><td dir="ltr">â€¢ Retrieves static key from plaintext store; weak algorithm; no timestamp</td><td dir="ltr">â€¢ Secure key retrieval via PKI vault; robust algorithm (RSAâ€‘4096/ECDSA) with timestamp</td><td dir="ltr">Secure private key storage and use robust signing algorithms</td></tr><tr><td dir="ltr">Verification Process</td><td dir="ltr">â€¢ No certificate chain validation; acceptance of replayed documents</td><td dir="ltr">â€¢ Verify signature with trusted PKI; validate certificate chain and revocation</td><td dir="ltr">Validate certificate status and enforce replay prevention</td></tr><tr><td dir="ltr">Logging &amp; Audit</td><td dir="ltr">â€¢ Minimal plaintext logging; no forensic trail</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logging with full audit trail and automatic alerts</td><td dir="ltr">Log all signing events securely and enable continuous audit trails</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Key Management and Rotation Policies" dir="auto" class="heading" id="Secure_Key_Management_and_Rotation_Policies"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Key Management and Rotation Policies<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Design an automated key management system that handles key generation, secure storage, periodic rotation, and destruction. Sensitive keys are segregated by function and managed via a centralized key vault.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Key leakage, overuse of long-lived keys, cryptographic failure due to key reuse.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST SP 800-57, ISO/IEC 19790, automated key rotation testing and logging.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Cryptographic key managers, DevOps, security architects; IT administrators, compliance teams.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Key Management &amp; Rotation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1724.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-415" style="width:1724.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1291"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1366"><tspan dy="0" x="1366">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1091"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1166"><tspan dy="0" x="1166">Database/System</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KV" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="572"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="647"><tspan dy="0" x="647">Key Vault</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1366" y1="65" x1="1366" id="actor6396"></line><g id="root-6396"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1291"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1366"><tspan dy="0" x="1366">Logger</tspan></text></g></g><g><line name="DS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1166" y1="65" x1="1166" id="actor6395"></line><g id="root-6395"><rect class="actor actor-top" ry="3" rx="3" name="DS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1091"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1166"><tspan dy="0" x="1166">Database/System</tspan></text></g></g><g><line name="KV" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="647" y1="65" x1="647" id="actor6394"></line><g id="root-6394"><rect class="actor actor-top" ry="3" rx="3" name="KV" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="572"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="647"><tspan dy="0" x="647">Key Vault</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6393"></line><g id="root-6393"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-415{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-415 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-415 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-415 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-415 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-415 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-415 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-415 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-415 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-415 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-415 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-415 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-415 p{margin:0}#mermaid-6a213c2d99ee9aa5-415 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-415 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-415 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-415 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-415 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-415 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-415 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-415 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-415 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-415 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-415 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-415 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-415 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-415 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-415 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-415 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-415 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-415 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-415 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-415 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-415 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-415 .actor-man circle,#mermaid-6a213c2d99ee9aa5-415 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-415 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="360">1. Generate key using manual, adâ€‘hoc process over unsecure channel</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="643" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="363">2. Return same longâ€‘lived key stored in plaintext config</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="646"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="646">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="908">3. Retrieve key from plaintext store no access controls applied</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="651" y1="209" x1="1165"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1165">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="619">4. Use key for encryption/decryption across multiple sessions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1162" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="622">5. Reuse key without triggering rotation logic</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="79" y1="305" x1="1165"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1165">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="360">6. Fail to differentiate keys based on function keys mixed in one vault</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="643" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="363">7. Provide key on request with no logging or policy enforcement</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="79" y1="401" x1="646"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="646">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="719">8. Log key usage events in basic plaintext files</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1362" y1="449" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1367">9. Store logs without encryption no rotation or expiration events logged</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1367,497 C 1427,487 1427,527 1367,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1367">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="619">10. Continue using compromised key after breach detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="1162" y1="575" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="76">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="622">11. No forced key renewal scheduled</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="79" y1="623" x1="1165"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="1165">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="722">12. No alerts triggered on key overuse or anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="79" y1="671" x1="1365"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1365">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="719">13. Audit trail incomplete key lifecycle not monitored</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="1362" y1="719" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Key Management &amp; Rotation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1836 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-417" style="width:1836px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1380"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1455"><tspan dy="0" x="1455">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1180"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1255"><tspan dy="0" x="1255">Database/System</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KV" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="661"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="736"><tspan dy="0" x="736">Key Vault</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1455" y1="65" x1="1455" id="actor6400"></line><g id="root-6400"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1380"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1455"><tspan dy="0" x="1455">Logger</tspan></text></g></g><g><line name="DS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1255" y1="65" x1="1255" id="actor6399"></line><g id="root-6399"><rect class="actor actor-top" ry="3" rx="3" name="DS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1180"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1255"><tspan dy="0" x="1255">Database/System</tspan></text></g></g><g><line name="KV" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="736" y1="65" x1="736" id="actor6398"></line><g id="root-6398"><rect class="actor actor-top" ry="3" rx="3" name="KV" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="661"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="736"><tspan dy="0" x="736">Key Vault</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6397"></line><g id="root-6397"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-417{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-417 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-417 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-417 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-417 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-417 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-417 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-417 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-417 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-417 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-417 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-417 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-417 p{margin:0}#mermaid-6a213c2d99ee9aa5-417 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-417 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-417 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-417 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-417 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-417 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-417 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-417 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-417 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-417 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-417 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-417 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-417 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-417 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-417 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-417 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-417 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-417 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-417 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-417 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-417 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-417 .actor-man circle,#mermaid-6a213c2d99ee9aa5-417 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-417 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="404">1. Request generation of new key via secure, authenticated channel (HTTPS)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="732" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="407">2. Generate highâ€‘entropy key and store in encrypted vault with roleâ€‘based access</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="79" y1="161" x1="735"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="735">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="997">3. Retrieve key via secure API call with access token validation</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="740" y1="209" x1="1254"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1254">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="664">4. Use key for encryption/decryption with enforced short lifetime</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="1251" y1="257" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="76">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="667">5. Trigger automatic key rotation on expiry or policy breach</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="79" y1="305" x1="1254"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="1254">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="404">6. Segregate keys by function and tag with metadata for audit</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="732" y1="353" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="764">7. Log each key usage event with secure metadata (key ID, timestamp) in encrypted log system</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="1451" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1456">8. Store logs in SIEMâ€‘integrated tamperâ€‘proof repository correlate key events</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1456,449 C 1516,439 1516,479 1456,469"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="1456">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="404">9. Monitor keys continuously for overuse or anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="527" x2="732" y1="527" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="76">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="407">10. Automatically trigger key revocation and issuance on risk detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="79" y1="575" x1="735"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="735">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="767">11. Generate automated alerts on key anomalies and rotation failures</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="79" y1="623" x1="1454"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="1454">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="664">12. Enforce immediate reâ€‘encryption if key compromise is suspected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="1251" y1="671" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="76">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="767">13. Maintain full, auditable key lifecycle for compliance reviews</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="1454"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="1454">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Key Generation &amp; Storage</td><td dir="ltr">â€¢ Manual generation over unsecure channels; plaintext storage; shared key across functions</td><td dir="ltr">â€¢ Automated generation over TLS; keys stored encrypted in a roleâ€‘based vault; unique per function</td><td dir="ltr">Automate key generation; store keys securely with proper segregation</td></tr><tr><td dir="ltr">Key Rotation &amp; Usage</td><td dir="ltr">â€¢ Longâ€‘lived keys; no enforced rotation; reâ€‘used across sessions</td><td dir="ltr">â€¢ Shortâ€‘lived keys; automatic rotation triggered on expiry or anomaly; keys functionally segregated</td><td dir="ltr">Enforce periodic key rotation and assign keys based on function</td></tr><tr><td dir="ltr">Monitoring &amp; Audit</td><td dir="ltr">â€¢ Minimal plaintext logging; no alerting; incomplete audit trails</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logs; continuous monitoring; full audit trail with automatic alerts</td><td dir="ltr">Monitor key events continuously and log them securely</td></tr><tr><td dir="ltr">Automated Alerts</td><td dir="ltr">â€¢ No alerts on abnormal key usage</td><td dir="ltr">â€¢ Automated alerts and immediate remediation (revocation, reâ€‘encryption) triggered by key anomalies</td><td dir="ltr">Implement remediation procedures and enforce realâ€‘time alerts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Random Number Generation" dir="auto" class="heading" id="Secure_Random_Number_Generation"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Random Number Generation<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Utilize cryptographically secure pseudo-random number generators (CSPRNGs) for key generation, nonce creation, and session tokens. Multi-stage involves entropy source validation, randomness quality testing, and failover mechanisms.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Predictable RNG output, entropy depletion, RNG backdoors.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST SP 800-90A, FIPS 140-2 randomness tests, regular entropy source audits.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Security engineers, cryptography specialists; software developers, QA teams.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Random Number Generation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1653.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-422" style="width:1653.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1281"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1356"><tspan dy="0" x="1356">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ES" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1081"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1156"><tspan dy="0" x="1156">Entropy Source</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RNG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="563"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="638"><tspan dy="0" x="638">RNG Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1356" y1="65" x1="1356" id="actor6404"></line><g id="root-6404"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1281"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1356"><tspan dy="0" x="1356">Logger</tspan></text></g></g><g><line name="ES" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1156" y1="65" x1="1156" id="actor6403"></line><g id="root-6403"><rect class="actor actor-top" ry="3" rx="3" name="ES" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1081"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1156"><tspan dy="0" x="1156">Entropy Source</tspan></text></g></g><g><line name="RNG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="638" y1="65" x1="638" id="actor6402"></line><g id="root-6402"><rect class="actor actor-top" ry="3" rx="3" name="RNG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="563"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="638"><tspan dy="0" x="638">RNG Module</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6401"></line><g id="root-6401"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-422{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-422 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-422 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-422 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-422 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-422 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-422 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-422 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-422 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-422 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-422 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-422 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-422 p{margin:0}#mermaid-6a213c2d99ee9aa5-422 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-422 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-422 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-422 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-422 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-422 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-422 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-422 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-422 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-422 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-422 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-422 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-422 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-422 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-422 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-422 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-422 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-422 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-422 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-422 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-422 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-422 .actor-man circle,#mermaid-6a213c2d99ee9aa5-422 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-422 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="355">1. Request random number using default RNG algorithm over HTTP</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="634" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="896">2. Sample entropy from lowâ€‘quality source (e.g. system clock)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1152" y1="161" x1="639"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="639">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="899">3. Return predictable entropy with low randomness</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="642" y1="209" x1="1155"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1155">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="639">4. Generate random number using insecure PRNG (e.g. linear congruence)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 639,257 C 699,247 699,287 639,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="639">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="358">5. Return random number with low entropy and predictable pattern</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="637"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="637">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="355">6. Use random number for key/nonce generation no validation check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="634" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="358">7. Provide repeated values due to lack of robust seeding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="637"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="637">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="714">8. Log random number generation events without quality metrics</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1352" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1357">9. Store logs unencrypted no statistical tests recorded</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1357,527 C 1417,517 1417,557 1357,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1357">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="358">10. No fallback if entropy source fails</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="79" y1="605" x1="637"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="637">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="714">11. Continue using predictable random numbers for security functions</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1352" y1="653" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="717">12. No automated alerts on RNG anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="1355"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="1355">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="355">13. Overall security compromised by poor randomness</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="634" y1="749" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="76">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Random Number Generation</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1887.5 855" height="855" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-424" style="width:1887.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1435"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1510"><tspan dy="0" x="1510">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ES" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="1235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="1310"><tspan dy="0" x="1310">Entropy Source</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RNG" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="620"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="695"><tspan dy="0" x="695">RNG Module</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="769" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="801.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1510" y1="65" x1="1510" id="actor6408"></line><g id="root-6408"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1435"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1510"><tspan dy="0" x="1510">Logger</tspan></text></g></g><g><line name="ES" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="1310" y1="65" x1="1310" id="actor6407"></line><g id="root-6407"><rect class="actor actor-top" ry="3" rx="3" name="ES" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1310"><tspan dy="0" x="1310">Entropy Source</tspan></text></g></g><g><line name="RNG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="695" y1="65" x1="695" id="actor6406"></line><g id="root-6406"><rect class="actor actor-top" ry="3" rx="3" name="RNG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="620"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="695"><tspan dy="0" x="695">RNG Module</tspan></text></g></g><g><line name="AP" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="769" x2="75" y1="65" x1="75" id="actor6405"></line><g id="root-6405"><rect class="actor actor-top" ry="3" rx="3" name="AP" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Application</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-424{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-424 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-424 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-424 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-424 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-424 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-424 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-424 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-424 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-424 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-424 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-424 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-424 p{margin:0}#mermaid-6a213c2d99ee9aa5-424 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-424 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-424 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-424 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-424 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-424 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-424 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-424 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-424 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-424 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-424 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-424 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-424 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-424 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-424 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-424 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-424 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-424 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-424 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-424 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-424 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-424 .actor-man circle,#mermaid-6a213c2d99ee9aa5-424 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-424 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="384">1. Request random number via secure API over HTTPS</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="691" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1001">2. Sample highâ€‘quality entropy from multiple sources (e.g. hardware TRNG)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1306" y1="161" x1="696"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="696">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1004">3. Return highâ€‘quality entropy with statistical randomness verified</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="699" y1="209" x1="1309"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1309">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="696">4. Generate random number using a CSPRNG per NIST SP 800â€‘90A standards</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 696,257 C 756,247 756,287 696,277"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="696">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="387">5. Return cryptographically secure random number with sufficient entropy</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="335" x2="79" y1="335" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="694">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="350" x="384">6. Validate generated number if quality test fails, trigger fallback mechanism</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="383" x2="691" y1="383" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="387" x="76">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="398" x="387">7. Automatically switch to alternate entropy source if necessary</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="431" x2="79" y1="431" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="435" x="694">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="446" x="791">8. Log random number generation events with quality metrics and entropy statistics (encrypted)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="479" x2="1506" y1="479" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="483" x="76">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="494" x="1511">9. Store logs in tamperâ€‘proof repository with continuous statistical validation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1511,527 C 1571,517 1571,557 1511,547"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="531" x="1511">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="572" x="387">10. Regularly perform randomness tests and update CSPRNG seed</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="605" x2="79" y1="605" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="609" x="694">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="620" x="791">11. Trigger immediate alerts if entropy deviation is detected</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="653" x2="1506" y1="653" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="657" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="668" x="387">12. Provide updated random numbers after successful reâ€‘seeding</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="701" x2="79" y1="701" x1="694"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="705" x="694">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="716" x="794">13. Maintain full audit trail for randomness quality reviews</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="749" x2="79" y1="749" x1="1509"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="753" x="1509">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Entropy Source</td><td dir="ltr">â€¢ Uses lowâ€‘quality entropy (e.g. system clock)</td><td dir="ltr">â€¢ Samples highâ€‘quality entropy from multiple hardware/software sources</td><td dir="ltr">Use multiple highâ€‘quality entropy sources and validate statistically</td></tr><tr><td dir="ltr">Random Number Generation</td><td dir="ltr">â€¢ Insecure PRNG (e.g. linear congruence); predictable output</td><td dir="ltr">â€¢ CSPRNG per NIST SP 800â€‘90A; outputs cryptographically secure random numbers</td><td dir="ltr">Use standardsâ€‘compliant CSPRNG algorithms</td></tr><tr><td dir="ltr">Failover Mechanism</td><td dir="ltr">â€¢ No fallback if entropy source fails; repeated values occur</td><td dir="ltr">â€¢ Automatic fallback to alternate entropy source and continuous quality testing</td><td dir="ltr">Implement robust fallback and quality validation mechanisms</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Minimal logging with no quality metrics; no alerts</td><td dir="ltr">â€¢ Encrypted logs with statistical randomness quality metrics; automated alerts upon deviation</td><td dir="ltr">Continuously monitor RNG output and log quality metrics</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Encrypted Email and Secure Messaging Systems" dir="auto" class="heading" id="Encrypted_Email_and_Secure_Messaging_Systems"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Encrypted Email and Secure Messaging Systems<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Deploy solutions (e.g., S/MIME, PGP, or modern end-to-end encrypted messaging protocols) to secure email and messaging communications. Multi-stage approach covers key exchange, message encryption, and decryption with user-managed keys.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Man-in-the-middle, key theft, spoofed messaging.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>IETF RFCs for S/MIME/PGP, NIST guidelines, periodic email security audits and phishing simulations.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>IT security teams, messaging system administrators; enterprise employees, executive users.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Encrypted Email/Messaging</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1681.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-429" style="width:1681.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1303"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1378"><tspan dy="0" x="1378">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1103"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1178"><tspan dy="0" x="1178">Key Exchange</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="610"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="685"><tspan dy="0" x="685">Messaging Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="US" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1378" y1="65" x1="1378" id="actor6412"></line><g id="root-6412"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1303"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1378"><tspan dy="0" x="1378">Logger</tspan></text></g></g><g><line name="KE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1178" y1="65" x1="1178" id="actor6411"></line><g id="root-6411"><rect class="actor actor-top" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1103"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1178"><tspan dy="0" x="1178">Key Exchange</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="685" y1="65" x1="685" id="actor6410"></line><g id="root-6410"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="610"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="685"><tspan dy="0" x="685">Messaging Server</tspan></text></g></g><g><line name="US" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6409"></line><g id="root-6409"><rect class="actor actor-top" ry="3" rx="3" name="US" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-429{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-429 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-429 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-429 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-429 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-429 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-429 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-429 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-429 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-429 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-429 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-429 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-429 p{margin:0}#mermaid-6a213c2d99ee9aa5-429 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-429 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-429 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-429 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-429 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-429 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-429 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-429 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-429 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-429 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-429 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-429 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-429 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-429 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-429 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-429 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-429 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-429 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-429 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-429 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-429 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-429 .actor-man circle,#mermaid-6a213c2d99ee9aa5-429 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-429 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="379">1. Compose email over unsecured channel no encryption applied</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="681" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="930">2. Retrieve public key from an unverified directory</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1174" y1="161" x1="686"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="686">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="933">3. Return public key with no attestation or expiry validation</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="689" y1="209" x1="1177"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1177">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="382">4. Encrypt message with weak algorithm no digital signatures appended</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="684">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="379">5. Transmit message over unencrypted channel susceptible to interception</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="681" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="382">6. Decrypt message without context verification no nonce or timestamp</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="684">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="379">7. Allow message replay attacks due to lack of freshness check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="681" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1030">8. Log email events in plaintext with minimal metadata</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1374" y1="449" x1="686"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="686">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1379">9. Store logs unencrypted no alerts linked to key misuse</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1379,497 C 1439,487 1439,527 1379,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1379">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="382">10. Deliver message without integrity check</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="79" y1="575" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="684">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="379">11. Accept potentially spoofed messages</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="681" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="1033">12. No forensic audit triggered on key theft detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="689" y1="671" x1="1377"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1377">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="382">13. Email system remains vulnerable to MitM and spoofing attacks</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="684"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="684">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Encrypted Email/Messaging</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1964.5 825" height="825" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-431" style="width:1964.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1485"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1560"><tspan dy="0" x="1560">Logger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="1285"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="1360"><tspan dy="0" x="1360">Key Exchange</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="697"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="772"><tspan dy="0" x="772">Messaging Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="US" height="65" width="150" stroke="#666" fill="#eaeaea" y="739" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="771.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="LG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1560" y1="65" x1="1560" id="actor6416"></line><g id="root-6416"><rect class="actor actor-top" ry="3" rx="3" name="LG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1485"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1560"><tspan dy="0" x="1560">Logger</tspan></text></g></g><g><line name="KE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="1360" y1="65" x1="1360" id="actor6415"></line><g id="root-6415"><rect class="actor actor-top" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1285"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1360"><tspan dy="0" x="1360">Key Exchange</tspan></text></g></g><g><line name="MS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="772" y1="65" x1="772" id="actor6414"></line><g id="root-6414"><rect class="actor actor-top" ry="3" rx="3" name="MS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="697"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="772"><tspan dy="0" x="772">Messaging Server</tspan></text></g></g><g><line name="US" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="739" x2="75" y1="65" x1="75" id="actor6413"></line><g id="root-6413"><rect class="actor actor-top" ry="3" rx="3" name="US" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-431{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-431 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-431 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-431 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-431 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-431 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-431 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-431 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-431 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-431 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-431 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-431 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-431 p{margin:0}#mermaid-6a213c2d99ee9aa5-431 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-431 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-431 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-431 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-431 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-431 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-431 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-431 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-431 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-431 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-431 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-431 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-431 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-431 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-431 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-431 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-431 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-431 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-431 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-431 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-431 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-431 .actor-man circle,#mermaid-6a213c2d99ee9aa5-431 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-431 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="422">1. Compose email over HTTPS with S/MIME/PGP integrated in client</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="768" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="1065">2. Retrieve recipientâ€™s public key from a trusted, attested directory (PKI)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="1356" y1="161" x1="773"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="773">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="1068">3. Return verified public key with expiration and revocation status</text><line style="stroke-dasharray:3,3;fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="209" x2="776" y1="209" x1="1359"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="213" x="1359">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="425">4. Encrypt message using strong algorithm and attach digital signature with timestamp</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="79" y1="257" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="261" x="771">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="422">5. Transmit message over TLSâ€‘secured channel ensuring data integrity</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="305" x2="768" y1="305" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="309" x="76">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="425">6. Decrypt message using secure private key verify signature and freshness (nonce)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="353" x2="79" y1="353" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="357" x="771">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="422">7. Reject replayed messages based on unique identifiers and timestamps</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="401" x2="768" y1="401" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="405" x="76">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="416" x="1165">8. Log all message events with full metadata (key IDs, signature status) in encrypted logs</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="449" x2="1556" y1="449" x1="773"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="453" x="773">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="464" x="1561">9. Store logs in SIEMâ€‘integrated, tamperâ€‘proof repository with alerting on anomalies</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1561,497 C 1621,487 1621,527 1561,517"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="501" x="1561">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="542" x="425">10. Confirm delivery via integrity check responses</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="575" x2="79" y1="575" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="579" x="771">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="590" x="422">11. Validate sender signature and check certificate chain</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="623" x2="768" y1="623" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="627" x="76">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="638" x="1168">12. Trigger immediate alerts on suspected key misuse or message tampering</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="671" x2="776" y1="671" x1="1559"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="675" x="1559">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="686" x="425">13. Enforce continuous monitoring and regular key audits to maintain trust</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="719" x2="79" y1="719" x1="771"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="723" x="771">13</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr">Key Exchange</td><td dir="ltr">â€¢ Uses unverified public keys from an untrusted directory</td><td dir="ltr">â€¢ Retrieves verified public keys from a trusted PKI with attestation</td><td dir="ltr">Always use trusted key exchange mechanisms with certificate validation</td></tr><tr><td dir="ltr">Encryption &amp; Signing</td><td dir="ltr">â€¢ Weak encryption; no digital signatures; no timestamp</td><td dir="ltr">â€¢ Strong encryption with digital signatures, nonce, and timestamp</td><td dir="ltr">Use robust encryption with proper signing and freshness checks</td></tr><tr><td dir="ltr">Decryption &amp; Replay</td><td dir="ltr">â€¢ Decrypts without context verification; replays allowed</td><td dir="ltr">â€¢ Verifies message integrity, signature, and freshness; rejects replayed messages</td><td dir="ltr">Enforce replay prevention through nonces, timestamps, and unique identifiers</td></tr><tr><td dir="ltr">Logging &amp; Monitoring</td><td dir="ltr">â€¢ Plaintext logging; no integrity or alerting</td><td dir="ltr">â€¢ Encrypted, SIEMâ€‘integrated logs; automated alerts on key misuse and message tampering</td><td dir="ltr">Log all messaging events securely with realâ€‘time monitoring and automated alerts</td></tr></tbody></table></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Secure Randomized Salt and Key Derivation Functions" dir="auto" class="heading" id="Secure_Randomized_Salt_and_Key_Derivation_Functions"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Secure Randomized Salt and Key Derivation Functions<div class="heading-after">...</div></h4><div class="heading-children"><div class="el-p"><p dir="auto">â€¢&nbsp;<strong>Architect:</strong><br>Implement secure key derivation functions (e.g., PBKDF2, bcrypt, or Argon2) with randomized salts for password and key hashing. Multi-stage process covers salt generation, iterative hashing, and storage with secure parameters.<br>â€¢&nbsp;<strong>Attacks/TTPs:</strong><br>Rainbow table attacks, brute force against weak derivation parameters, salt reuse vulnerabilities.<br>â€¢&nbsp;<strong>Standards for Security Testing and Best Practices:</strong><br>NIST SP 800-63, OWASP Password Storage Cheat Sheet, regular hashing algorithm reviews, and performance/security balancing.<br>â€¢&nbsp;<strong>Roles and Users:</strong><br>Application developers, security architects; identity management teams, system administrators.</p></div><div class="el-p"><p dir="auto">Insecure Implementation â€“ Randomized Salt and Key Derivation Functions</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1817 915" height="915" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-436" style="width:1817px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1411.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1486.5"><tspan dy="0" x="1486.5">Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="1112"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="1187"><tspan dy="0" x="1187">KDF Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="542"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="617"><tspan dy="0" x="617">App Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="829" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="861.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1486.5" y1="65" x1="1486.5" id="actor6420"></line><g id="root-6420"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1411.5"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1486.5"><tspan dy="0" x="1486.5">Database</tspan></text></g></g><g><line name="KE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="1187" y1="65" x1="1187" id="actor6419"></line><g id="root-6419"><rect class="actor actor-top" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1112"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1187"><tspan dy="0" x="1187">KDF Engine</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="617" y1="65" x1="617" id="actor6418"></line><g id="root-6418"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="542"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="617"><tspan dy="0" x="617">App Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="829" x2="75" y1="65" x1="75" id="actor6417"></line><g id="root-6417"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-436{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-436 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-436 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-436 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-436 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-436 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-436 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-436 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-436 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-436 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-436 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-436 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-436 p{margin:0}#mermaid-6a213c2d99ee9aa5-436 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-436 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-436 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-436 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-436 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-436 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-436 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-436 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-436 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-436 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-436 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-436 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-436 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-436 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-436 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-436 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-436 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-436 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-436 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-436 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-436 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-436 .actor-man circle,#mermaid-6a213c2d99ee9aa5-436 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-436 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="345">1. Submit password via unencrypted channel (HTTP)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="613" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="618">2. Accept password without input validation</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 618,161 C 678,151 678,191 618,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="618">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="348">3. Immediately echo basic acknowledgment (no MFA)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="616"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="616">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="901">4. Forward password to KDF engine</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1183" y1="287" x1="618"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="618">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="1188">5. Use a static or poorly randomized salt (e.g., fixed value reused)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1188,335 C 1248,325 1248,365 1188,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1188">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1188">6. Apply low iteration count and weak hash algorithm (e.g., SHA-1)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1188,413 C 1248,403 1248,443 1188,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1188">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="904">7. Compute derived key and return weak hash value</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="621" y1="491" x1="1186"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1186">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1050">8. Store hash and static salt in plaintext without encryption</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="1482.5" y1="539" x1="618"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="618">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="1488">9. Save credentials without proper access controls or audit logs</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1487.5,587 C 1547.5,577 1547.5,617 1487.5,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="1487.5">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1050">10. Minimal logging of derivation events (no metadata, timestamps)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="1482.5" y1="665" x1="618"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="618">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="901">11. No automated rehashing on user update or compromise detection</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1183" y1="713" x1="618"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="618">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="348">12. Continue to use same weak parameters on each login attempt</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="79" y1="761" x1="616"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="616">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="904">13. No proactive key rotation or improved derivation triggered</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="621" y1="809" x1="1186"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="1186">13</text></svg></div></div><div class="el-p"><p dir="auto">Secure Implementation â€“ Randomized Salt and Key Derivation Functions</p></div><div class="el-pre"><div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2592.5 963" height="963" xmlns="http://www.w3.org/2000/svg" id="mermaid-6a213c2d99ee9aa5-438" style="width:2592.5px;max-width:100%"><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="2144"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="2219"><tspan dy="0" x="2219">Database</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="1513"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="1588"><tspan dy="0" x="1588">KDF Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="782"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="857"><tspan dy="0" x="857">App Server</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="877" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="909.5" x="75"><tspan dy="0" x="75">User</tspan></text></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="2219" y1="65" x1="2219" id="actor6424"></line><g id="root-6424"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="2144"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2219"><tspan dy="0" x="2219">Database</tspan></text></g></g><g><line name="KE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="1588" y1="65" x1="1588" id="actor6423"></line><g id="root-6423"><rect class="actor actor-top" ry="3" rx="3" name="KE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1513"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1588"><tspan dy="0" x="1588">KDF Engine</tspan></text></g></g><g><line name="AS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="857" y1="65" x1="857" id="actor6422"></line><g id="root-6422"><rect class="actor actor-top" ry="3" rx="3" name="AS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="782"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="857"><tspan dy="0" x="857">App Server</tspan></text></g></g><g><line name="U" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="877" x2="75" y1="65" x1="75" id="actor6421"></line><g id="root-6421"><rect class="actor actor-top" ry="3" rx="3" name="U" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">User</tspan></text></g></g><style>#mermaid-6a213c2d99ee9aa5-438{font-family:var(--font-mermaid);font-size:16px;fill:#333}#mermaid-6a213c2d99ee9aa5-438 .error-icon{fill:#552222}#mermaid-6a213c2d99ee9aa5-438 .error-text{fill:#552222;stroke:#552222}#mermaid-6a213c2d99ee9aa5-438 .edge-thickness-normal{stroke-width:1px}#mermaid-6a213c2d99ee9aa5-438 .edge-thickness-thick{stroke-width:3.5px}#mermaid-6a213c2d99ee9aa5-438 .edge-pattern-solid{stroke-dasharray:0}#mermaid-6a213c2d99ee9aa5-438 .edge-thickness-invisible{stroke-width:0;fill:none}#mermaid-6a213c2d99ee9aa5-438 .edge-pattern-dashed{stroke-dasharray:3}#mermaid-6a213c2d99ee9aa5-438 .edge-pattern-dotted{stroke-dasharray:2}#mermaid-6a213c2d99ee9aa5-438 .marker{fill:#333333;stroke:#333333}#mermaid-6a213c2d99ee9aa5-438 .marker.cross{stroke:#333333}#mermaid-6a213c2d99ee9aa5-438 svg{font-family:var(--font-mermaid);font-size:16px}#mermaid-6a213c2d99ee9aa5-438 p{margin:0}#mermaid-6a213c2d99ee9aa5-438 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-438 .actor-line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-438 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-6a213c2d99ee9aa5-438 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333}#mermaid-6a213c2d99ee9aa5-438 #arrowhead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-438 .sequenceNumber{fill:white}#mermaid-6a213c2d99ee9aa5-438 #sequencenumber{fill:#333}#mermaid-6a213c2d99ee9aa5-438 #crosshead path{fill:#333;stroke:#333}#mermaid-6a213c2d99ee9aa5-438 .messageText{fill:#333;stroke:none}#mermaid-6a213c2d99ee9aa5-438 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-438 .labelText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-438 .loopText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-438 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%)}#mermaid-6a213c2d99ee9aa5-438 .note{stroke:#aaaa33;fill:#fff5ad}#mermaid-6a213c2d99ee9aa5-438 .noteText{fill:black;stroke:none}#mermaid-6a213c2d99ee9aa5-438 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-438 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-438 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-6a213c2d99ee9aa5-438 .actorPopupMenu{position:absolute}#mermaid-6a213c2d99ee9aa5-438 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / .4))}#mermaid-6a213c2d99ee9aa5-438 .actor-man line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF}#mermaid-6a213c2d99ee9aa5-438 .actor-man circle,#mermaid-6a213c2d99ee9aa5-438 line{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;stroke-width:2px}#mermaid-6a213c2d99ee9aa5-438 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0,0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="465">1. Submit password over HTTPS with proper content-type</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="853" y1="113" x1="76"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="117" x="76">1</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="858">2. Validate input against established security policies (length, complexity)</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 858,161 C 918,151 918,191 858,181"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="165" x="858">2</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="468">3. Acknowledge receipt and initiate secure session</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="79" y1="239" x1="856"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="243" x="856">3</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="1221">4. Forward password to KDF engine securely</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="287" x2="1584" y1="287" x1="858"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="291" x="858">4</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="302" x="1589">5. Generate a unique, randomized salt using a CSPRNG per user</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1589,335 C 1649,325 1649,365 1589,355"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="339" x="1589">5</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="380" x="1589">6. Apply strong derivation (e.g., Argon2/ bcrypt/ PBKDF2) with high iterations</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 1589,413 C 1649,403 1649,443 1589,433"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="417" x="1589">6</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="1224">7. Return derived key and securely generated salt with metadata (iteration count, algorithm)</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="491" x2="861" y1="491" x1="1587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="495" x="1587">7</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="1537">8. Store derived key hash and salt in an encrypted database table</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="539" x2="2215" y1="539" x1="858"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="543" x="858">8</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="554" x="2220">9. Enforce strict access controls and role-based permissions on credentials</text><path style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 2220,587 C 2280,577 2280,617 2220,607"></path><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="591" x="2220">9</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="632" x="1537">10. Log key derivation events with full metadata (timestamp, userID, parameters) in encrypted format</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="665" x2="2215" y1="665" x1="858"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="669" x="858">10</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="680" x="1221">11. Trigger periodic rehashing based on risk-based assessments and login behavior</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="713" x2="1584" y1="713" x1="858"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="717" x="858">11</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="728" x="1224">12. Automatically rotate keys/rehash on configuration updates or detected anomalies</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="761" x2="861" y1="761" x1="1587"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="765" x="1587">12</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="776" x="468">13. Prompt user reâ€‘authentication if derivation parameters require update provide secure feedback</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="809" x2="79" y1="809" x1="856"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="813" x="856">13</text><text style="font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="824" x="1902">14. Audit key lifecycle events and update system policies via automated alerts</text><line style="fill:none" marker-start="url(#sequencenumber)" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="857" x2="2215" y1="857" x1="1589"></line><text class="sequenceNumber" text-anchor="middle" font-size="12px" font-family="sans-serif" y="861" x="1589">14</text></svg></div></div><div class="el-table" dir="ltr" style="overflow-x:auto"><table><thead><tr><th dir="ltr"><strong>Stage</strong></th><th dir="ltr"><strong>Insecure Implementation</strong></th><th dir="ltr"><strong>Secure Implementation</strong></th><th dir="ltr"><strong>Best Practice</strong></th></tr></thead><tbody><tr><td dir="ltr"><strong>Password Submission</strong></td><td dir="ltr">â€¢ Transmits password via unencrypted channel<br>â€¢ No strong validation or MFA</td><td dir="ltr">â€¢ Uses HTTPS; validates password per security policy<br>â€¢ Initiates secure session</td><td dir="ltr">Enforce encrypted channels and validate inputs with MFA where possible</td></tr><tr><td dir="ltr"><strong>Salt Generation &amp; KDF</strong></td><td dir="ltr">â€¢ Uses static/poorly randomized salt<br>â€¢ Low iterations with weak hash (e.g., SHAâ€‘1)</td><td dir="ltr">â€¢ Generates fresh, randomized salt with CSPRNG<br>â€¢ Uses strong KDF (e.g., Argon2, bcrypt, PBKDF2) with high iteration count</td><td dir="ltr">Use secure KDFs with per-user random salts and proper iteration counts</td></tr><tr><td dir="ltr"><strong>Storage &amp; Logging</strong></td><td dir="ltr">â€¢ Stores credentials plaintext; minimal logging without metadata</td><td dir="ltr">â€¢ Stores credentials encrypted with strict access controls<br>â€¢ Logs derivation events with full metadata (encrypted)</td><td dir="ltr">Encrypt stored credentials and log all key management events securely</td></tr><tr><td dir="ltr"><strong>Key Management &amp; Rehashing</strong></td><td dir="ltr">â€¢ No periodic rehashing or reâ€‘keying; static parameters reused</td><td dir="ltr">â€¢ Proactively trigger key rotation and periodic rehashing based on risk<br>â€¢ Automate reâ€‘authentication upon anomalies</td><td dir="ltr">Implement periodic rehashing and automated key lifecycle management with continuous monitoring</td></tr></tbody></table></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_By_Design"><span class="tree-item-title"><p dir="auto">Secure By Design</p></span></a></div><div class="tree-item-children"><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Software_Architecture"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Software Architecture</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Authentication/Identity"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Authentication/Identity</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Enterprise-Wide_Passwordless_Authentication_Implementation**"><span class="tree-item-title"><p dir="auto"><strong>Enterprise-Wide Passwordless Authentication Implementation</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Multi-Factor_Authentication_(MFA)_&amp;_Phishing-Resistant_Methods**"><span class="tree-item-title"><p dir="auto"><strong>Multi-Factor Authentication (MFA) &amp; Phishing-Resistant Methods</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Single_Sign-On_(SSO)_with_Identity_Federation_(SAML,_OAuth,_OIDC,_Kerberos)**"><span class="tree-item-title"><p dir="auto"><strong>Single Sign-On (SSO) with Identity Federation (SAML, OAuth, OIDC, Kerberos)</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**OAuth_2.0_&amp;_OpenID_Connect_(OIDC)_for_Secure_API_Authentication**"><span class="tree-item-title"><p dir="auto"><strong>OAuth 2.0 &amp; OpenID Connect (OIDC) for Secure API Authentication</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Enterprise_Device_Identity_&amp;_Certificate-Based_Authentication_(CBA)**"><span class="tree-item-title"><p dir="auto"><strong>Enterprise Device Identity &amp; Certificate-Based Authentication (CBA)</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Secure_Authentication_for_Privileged_Access_Management_(PAM)_Users**"><span class="tree-item-title"><p dir="auto"><strong>Secure Authentication for Privileged Access Management (PAM) Users</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Delegated_Authentication_&amp;_Trust_Management_in_a_Multi-Tenant_Enterprise**"><span class="tree-item-title"><p dir="auto"><strong>Delegated Authentication &amp; Trust Management in a Multi-Tenant Enterprise</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Identity_and_Access_Governance:_Compliance-Driven_Authentication**"><span class="tree-item-title"><p dir="auto"><strong>Identity and Access Governance: Compliance-Driven Authentication</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Authentication_for_Remote_Workforce_&amp;_BYOD_Security**"><span class="tree-item-title"><p dir="auto"><strong>Authentication for Remote Workforce &amp; BYOD Security</strong></p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#**Blockchain-Based_Decentralized_Identity_(DID)_Authentication**"><span class="tree-item-title"><p dir="auto"><strong>Blockchain-Based Decentralized Identity (DID) Authentication</strong></p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Web_Service_and_API"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Web Service and API</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#End-to-End_TLS_Enforcement_&amp;_HSTS_Deployment"><span class="tree-item-title"><p dir="auto">End-to-End TLS Enforcement &amp; HSTS Deployment</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#OAuth_2.0_with_PKCE_&amp;_mTLS_for_API_Access"><span class="tree-item-title"><p dir="auto">OAuth 2.0 with PKCE &amp; mTLS for API Access</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#JWT_Lifecycle_Management_and_Signature_Validation"><span class="tree-item-title"><p dir="auto">JWT Lifecycle Management and Signature Validation</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Mutual_TLS_(mTLS)_Client_Authentication"><span class="tree-item-title"><p dir="auto">Mutual TLS (mTLS) Client Authentication</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Dynamic_Rate_Limiting,_Throttling,_and_DDoS_Protection"><span class="tree-item-title"><p dir="auto">Dynamic Rate Limiting, Throttling, and DDoS Protection</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Strict_Input_Validation_and_Output_Encoding"><span class="tree-item-title"><p dir="auto">Strict Input Validation and Output Encoding</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Dynamic_API_Gateway_with_Integrated_WAF"><span class="tree-item-title"><p dir="auto">Dynamic API Gateway with Integrated WAF</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Session_Management_and_Cookie_Hardening"><span class="tree-item-title"><p dir="auto">Secure Session Management and Cookie Hardening</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Granular_API_Versioning_and_Secure_Deprecation"><span class="tree-item-title"><p dir="auto">Granular API Versioning and Secure Deprecation</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Zero_Trust_Microservice_Segmentation"><span class="tree-item-title"><p dir="auto">Zero Trust Microservice Segmentation</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#RBAC_and_ABAC-Based_Access_Control"><span class="tree-item-title"><p dir="auto">RBAC and ABAC-Based Access Control</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Data_Encryption_at_Rest_and_In_Transit"><span class="tree-item-title"><p dir="auto">Data Encryption at Rest and In Transit</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Comprehensive_Audit_Logging_and_SIEM_Integration"><span class="tree-item-title"><p dir="auto">Comprehensive Audit Logging and SIEM Integration</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Containerization_and_Orchestration"><span class="tree-item-title"><p dir="auto">Secure Containerization and Orchestration</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#DevSecOps_Integration_into_CI/CD_Pipelines"><span class="tree-item-title"><p dir="auto">DevSecOps Integration into CI/CD Pipelines</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Intelligent_Anomaly_Detection_and_API_Traffic_Monitoring"><span class="tree-item-title"><p dir="auto">Intelligent Anomaly Detection and API Traffic Monitoring</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Access_Control/Middleware"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Secure Access Control/Middleware</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Role-Based_Access_Control_(RBAC)_Middleware"><span class="tree-item-title"><p dir="auto">Role-Based Access Control (RBAC) Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Attribute-Based_Access_Control_(ABAC)_Middleware"><span class="tree-item-title"><p dir="auto">Attribute-Based Access Control (ABAC) Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Zero_Trust_Middleware_Enforcement"><span class="tree-item-title"><p dir="auto">Zero Trust Middleware Enforcement</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Policy-as-Code_for_Access_Management"><span class="tree-item-title"><p dir="auto">Policy-as-Code for Access Management</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Multi-Factor_Authentication_(MFA)_Middleware_Integration"><span class="tree-item-title"><p dir="auto">Multi-Factor Authentication (MFA) Middleware Integration</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Context-Aware_Access_Middleware"><span class="tree-item-title"><p dir="auto">Context-Aware Access Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Dynamic_Session_Management_and_Token_Rotation_Middleware"><span class="tree-item-title"><p dir="auto">Dynamic Session Management and Token Rotation Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Identity_Federation_and_SSO_Middleware"><span class="tree-item-title"><p dir="auto">Identity Federation and SSO Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Microservices_Communication_via_Service_Mesh"><span class="tree-item-title"><p dir="auto">Secure Microservices Communication via Service Mesh</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Cache-Control_and_Data_Exfiltration_Prevention_Middleware"><span class="tree-item-title"><p dir="auto">Cache-Control and Data Exfiltration Prevention Middleware</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Containerized_Middleware_for_Cloud-Native_Access_Control"><span class="tree-item-title"><p dir="auto">Containerized Middleware for Cloud-Native Access Control</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Federated_Identity_and_Risk-Based_Authorization_Middleware"><span class="tree-item-title"><p dir="auto">Federated Identity and Risk-Based Authorization Middleware</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Execution/File_Management"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Secure Execution/File Management</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Encrypted_File_Storage_with_Granular_Access_Controls"><span class="tree-item-title"><p dir="auto">Encrypted File Storage with Granular Access Controls</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_File_Transfer_with_End-to-End_Encryption"><span class="tree-item-title"><p dir="auto">Secure File Transfer with End-to-End Encryption</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_File_Execution_with_Sandbox_Isolation"><span class="tree-item-title"><p dir="auto">Secure File Execution with Sandbox Isolation</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Endpoint_File_Integrity_Monitoring_and_Alerting"><span class="tree-item-title"><p dir="auto">Endpoint File Integrity Monitoring and Alerting</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Cloud_File_Storage_with_Encryption_and_Tokenization"><span class="tree-item-title"><p dir="auto">Secure Cloud File Storage with Encryption and Tokenization</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Front-end"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Front-end</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Output_Encoding"><span class="tree-item-title"><p dir="auto">Secure Output Encoding</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Content_Security_Policy_(CSP)_Enforcement_with_Nonce-based_Scripts"><span class="tree-item-title"><p dir="auto">Content Security Policy (CSP) Enforcement with Nonce-based Scripts</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Cross-Origin_Resource_Sharing_(CORS)_Enforcement"><span class="tree-item-title"><p dir="auto">Secure Cross-Origin Resource Sharing (CORS) Enforcement</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Framework_Hardening_for_Modern_SPA_(React/Angular/Vue)"><span class="tree-item-title"><p dir="auto">Framework Hardening for Modern SPA (React/Angular/Vue)</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Third-Party_Script_Management_and_Subresource_Integrity"><span class="tree-item-title"><p dir="auto">Secure Third-Party Script Management and Subresource Integrity</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Handling_of_Cookies_and_Client-Side_Storage"><span class="tree-item-title"><p dir="auto">Secure Handling of Cookies and Client-Side Storage</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Client-Side_Encryption_and_Key_Management"><span class="tree-item-title"><p dir="auto">Client-Side Encryption and Key Management</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Cryptography"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p dir="auto">Cryptography</p></span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Symmetric_Encryption_for_Data-at-Rest"><span class="tree-item-title"><p dir="auto">Symmetric Encryption for Data-at-Rest</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Hardware_Security_Module_(HSM)_Integration"><span class="tree-item-title"><p dir="auto">Hardware Security Module (HSM) Integration</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Digital_Signature_Implementation_and_Verification"><span class="tree-item-title"><p dir="auto">Digital Signature Implementation and Verification</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Key_Management_and_Rotation_Policies"><span class="tree-item-title"><p dir="auto">Secure Key Management and Rotation Policies</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Random_Number_Generation"><span class="tree-item-title"><p dir="auto">Secure Random Number Generation</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Encrypted_Email_and_Secure_Messaging_Systems"><span class="tree-item-title"><p dir="auto">Encrypted Email and Secure Messaging Systems</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Secure_Randomized_Salt_and_Key_Derivation_Functions"><span class="tree-item-title"><p dir="auto">Secure Randomized Salt and Key Derivation Functions</p></span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>